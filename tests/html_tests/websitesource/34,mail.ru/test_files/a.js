aRadar("additionalJSLoad",1);aRadar("additionalJSInit");window.__portal={};
(function(){function c(a){return a&&1==a.nodeType}function f(a,d){return c(a)&&b?a.classList.contains(d):!!~(" "+a.className+" ").indexOf(" "+d+" ")}function e(a,d){c(a)&&(b?a.classList.add(d):!f(a,d)&&(a.className+=" "+d))}function a(a,d){c(a)&&(b?a.classList.remove(d):a.className=a.className.replace(RegExp("(^|\\s)"+d+"(\\s|$)","g"),"$1"))}var b="classList"in document.documentElement,d=window.__portal,g=/\s*(\S+)\s*/g,h=!/\[native\s+code\]/i.test(document.getElementsByClass+""),j=/\./g;d.__fn={byId:function(a){return document.getElementById(a)},
byClassName:function(a,b,d){var e,c;"string"===typeof a&&(d=b,b=a,a=document);d=d||"";if(!a||null==b)return[];b=b.replace(/\s+/ig,".");"."!=b[0]&&(b="."+b);if("querySelectorAll"in a){d=a.querySelectorAll(d+b);if(h){e=-1;for(a=[];c=d[++e];)a.push(c);return a}return d}d=a.getElementsByTagName(d||"*");b&&(b=b.replace(j," "),b=RegExp(b.replace(g,"(?=(^|.*\\s)$1(\\s|$))")));e=-1;for(a=[];c=d[++e];)1===c.nodeType&&(!b||b.test(c.className))&&a.push(c);return a},arrayIndexOf:function(a,b){for(var d=0,e=a.length;d<
e;d++)if(a[d]==b)return d;return-1},bind:function(a,b){return function(){return a.apply(b,arguments)}},extend:function(a,b){for(var a=a||{},d=1,e=arguments.length;d<e;d++){var c=arguments[d],f;for(f in c)c.hasOwnProperty(f)&&(a[f]=c[f])}return a},append:function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&!Object.prototype.hasOwnProperty.call(a,d)&&(a[d]=b[d]);return a},isNode:c,hasParent:function(a,b){var d;d=c(b)?function(a,b){return a==b}:function(a,b){return f(a,b)};for(var e=
a.parentNode;e;){if(d(e,b))return e;e=e.parentNode}return!1},hasClass:f,addClass:e,removeClass:a,toggleClass:function(d,g){if(c(d))return b?d.classList.toggle(g):f(d,g)?(a(d,g),!1):(e(d,g),!0)}}})();var p=__portal,fn=p.__fn;__portal.PortalEvents={};var PortalEvents=p.PortalEvents;
void function(c,f){function e(a){if(!("__isFixed"in a)){g||(g=document.body);var b="button"in a&&a.button;a.__isFixed=!0;if("click"===a.type||"dblclick"===a.type)void 0===a.detail&&(a.detail="click"===a.type?1:2),!a.button&&void 0!==e._clickButton&&(b=e._clickButton);h(a,q);a.defaultPrevented||(a.defaultPrevented=!1);a.target||(a.target=a.srcElement||document);void 0===a.relatedTarget&&a.fromElement&&(a.relatedTarget=a.fromElement==a.target?a.toElement:a.fromElement);"clientX"in a&&null==a.pageX&&
(a.pageX=a.clientX+(d.scrollLeft||g&&g.scrollLeft||0)-(d.clientLeft||0),a.pageY=a.clientY+(d.scrollTop||g&&g.scrollTop||0)-(d.clientTop||0));!a.which&&b&&(a.which=b&1?1:b&2?3:b&4?2:0);"timeStamp"in a||(a.timeStamp=+new Date);"eventPhase"in a||(a.eventPhase=a.target==this?2:3);"currentTarget"in a||(a.currentTarget=this);"isTrusted"in a||(a.isTrusted=!0);"keyCode"in a||(a.keyCode=a.charCode||a.which);return a}}function a(a){if(void 0!==e){var b=this._,d=[],c=[];if(b&&b._e_8vj&&(a||(a=window.event),
e.call(this,a),b=b._e_8vj[a.type])){for(var f in b)if(i(b,f)){var g=b[f],h;"object"===typeof g&&(h=g,g=g.handleEvent);try{if(g&&!1===(a.result=l.call(g,h||this,a)))a.preventDefault(),a.stopPropagation()}catch(j){window.logError&&logError(j,"portalEventHandler"),d.push(j),c.push(j.message),window.console&&console.error(j)}if(a.__stopNow)break}b[0]=void 0;delete b[0];1==d.length?n(d[0]):1<d.length&&(a=Error("Multiple errors thrown : "+a.type+" :  : "+c.join("|")),a.errors=d,n(a))}}}var b=window.eval&&
window.eval("/*@cc_on 1;@*/")&&+((/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0)||void 0,d=document.documentElement,g=document.body,h=f.append,j=1,i=Function.prototype.call.bind(Object.prototype.hasOwnProperty),l=Function.prototype.call,n=function(a){throw a instanceof Error?a:Error(a);},k=!("createEvent"in document),m,q={preventDefault:function(){!1!==this.cancelable&&(this.returnValue=!1,this.defaultPrevented=!0)},stopPropagation:function(){this.cancelBubble=!0},stopImmediatePropagation:function(){this.__stopNow=
!0;this.stopPropagation()},defaultPrevented:!1};b&&9>b&&(document.attachEvent("onmousedown",function(){e._clickButton=event.button}),document.attachEvent("onclick",function(){e._clickButton=void 0}));c.addListener=k?function(d,e,c){if("function"==typeof c||"object"===typeof c&&c.handleEvent){var g=d._,f,h=!1;g||(g=d._={});if(b&&9>b){if("DOMContentLoaded"==e){if("complete"==document.readyState)return;d===global&&(d=document);h=!0;if(!m){m=!0;var i=function(){try{document.documentElement.doScroll("left")}catch(b){setTimeout(i,
50);return}a.call(d,{type:e,isTrusted:!0})};if("createEventObject"in document&&"doScroll"in document.documentElement)try{global.frameElement||i()}catch(k){}}}d.setInterval&&(d!=global&&!d.frameElement)&&(d=global)}c.uuid||(c.uuid=++j);if(!(f=g._h_9e2))f=g._h_9e2=a.bind(d);g._e_8vj||(g._e_8vj={});g._e_8vj[e]||(g._e_8vj[e]={},b&&9>b?h||d.attachEvent("on"+e,f):d.addEventListener(e,f,!1));g._e_8vj[e][c.uuid]=c}}:function(a,b,d){a.addEventListener(b,d,!1)};c.removeListener=k?function(a,d,e){var c=a._,
g,f,h;if(!("function"!=typeof e&&!("object"===typeof e&&e.handleEvent)||!e.uuid||!c))if(g=c._h_9e2){f=c._e_8vj&&c._e_8vj[d];delete f[e.uuid];for(h in f)if(i(f,h))return;b&&9>b?a.detachEvent("on"+d,g):a.removeEventListener(d,g,!1);delete c._e_8vj[d];for(h in c._e_8vj)if(i(c._e_8vj,h))return;delete c._e_8vj}}:function(a,b,d){a.removeEventListener(b,d,!1)}}(__portal.PortalEvents,window.__portal.__fn);
void function(){function c(){}c.prototype={emit:function(f,e,a){function b(){--g||a&&a()}void 0==e&&(e={});var d=this.listeners(f);if(d)for(var d=d.slice(),f=new c.Event(f,e),g=d.length,e=0,h=g;e<h;e++){var j=d[e];if("function"===typeof j)try{j.call(this,f,b)}catch(i){window.logError&&logError(i,"emit"),window.console&&window.console.error&&window.console.error(i),b()}}else a&&a()},listeners:function(c){return this._events&&this._events[c]&&this._events[c].length&&this._events[c]},addListener:function(c,
e){if("function"!==typeof e)throw Error("invalid argument");this._events||(this._events={});this._events[c]||(this._events[c]=[]);this._events[c].push(e);return this},once:function(c,e){function a(){this.removeListener(c,a);e.apply(this,arguments)}if("function"!==typeof e)throw Error("invalid argument");this.on(c,a);return this},removeListener:function(c,e){if("function"!==typeof e)throw Error("invalid argument");if(!this._events[c])return this;var a=this._events[c],b=fn.arrayIndexOf(a,e);if(0>b)return this;
a.splice(b,1);0===a.length&&delete this._events[c];return this}};c.prototype.on=c.prototype.addListener;c.Event=function(c,e){this.type=c;this.data=e};__portal.PortalEventEmitter=c}();
void function(){function c(b){if(!(this instanceof c))return new c;this.__settings=e.extend({},a,b);this.__baseClass="portal-overlay";this.__visible=!1}var f=__portal,e=f.__fn,a={hideByClick:!0};c.prototype=new f.PortalEventEmitter;e.extend(c.prototype,{show:function(){this.__visible||(this.__visible=!0,this.__init(),this.emit("beforeShow"),f.PortalEvents.addListener(document,"keyup",this.____hideByEsc||(this.____hideByEsc=e.bind(this.__hideByEsc,this))),e.addClass(this.__node,this.__baseClass+"_visible"),
this.emit("show"))},hide:function(){this.__visible&&(this.__visible=!1,this.__init(),this.emit("beforeHide"),this.____hideByEsc&&f.PortalEvents.removeListener(document,"keyup",this.____hideByEsc),e.removeClass(this.__node,this.__baseClass+"_visible"),this.emit("hide"))},__hideByEsc:function(a){27==a.keyCode&&this.hide()},__init:function(){this.__node||(this.__node=document.createElement("div"),this.__node.className=this.__baseClass,this.__settings.hideByClick&&f.PortalEvents.addListener(this.__node,
"click",e.bind(this.hide,this)),document.body.appendChild(this.__node))}});f.PortalOverlay=c}();
void function(){function c(c){if(!c||!fn.isNode(c.node))throw Error("Invalid arguments");this.__settings=fn.extend({},f,c);this.__baseClass="portal-popup";this.__wBaseClass="w-"+this.__baseClass;this.__node=this.__settings.node;this.__wNode=fn.hasParent(this.__node,this.__wBaseClass);this.__visible=!1;this.__settings.overlay&&(this.__overlay=new p.PortalOverlay,this.__overlay.on("hide",fn.bind(this.hide,this)));this.__wNode&&PortalEvents.addListener(this.__wNode,"click",fn.bind(this.__wHide,this));
(this.__closeButton=fn.byClassName(this.__node,".js-close")[0])&&PortalEvents.addListener(this.__closeButton,"click",fn.bind(this.__closeButtonHide,this));(this.__controls=fn.byClassName(this.__node,".js-controls")[0])&&PortalEvents.addListener(this.__controls,"click",fn.bind(this.__controlsHandler,this))}var f={overlay:!0,node:null};c.prototype=new p.PortalEventEmitter;fn.extend(c.prototype,{__init:function(){this.__inited||(this.__inited=!0)},isVisible:function(){return this.__visible},show:function(){this.__visible||
(this.__visible=!0,this.__init(),this.__overlay&&this.__overlay.show(),this.emit("beforeShow"),this.__wNode&&fn.addClass(this.__wNode,this.__wBaseClass+"_visible"),fn.addClass(this.__node,this.__baseClass+"_visible"),window.scrollTo(0,0),this.emit("show"))},hide:function(){this.__visible&&(this.__visible=!1,this.__overlay&&this.__overlay.hide(),this.emit("beforeHide"),this.__wNode&&fn.removeClass(this.__wNode,this.__wBaseClass+"_visible"),fn.removeClass(this.__node,this.__baseClass+"_visible"),this.emit("hide"))},
__wHide:function(c){fn.hasParent(c.target,this.__node)||this.hide()},__closeButtonHide:function(c){c.preventDefault();this.hide()},__controlsHandler:function(c){var a=c.target,b=fn.hasParent(a,"js-control"),d;!b&&fn.hasClass(a,"js-control")&&(b=a);b&&(d=b.getAttribute("data-action"));d&&(this.emit("action"+d.substr(0,1).toUpperCase()+d.substr(1)),c.preventDefault())}});p.PortalPopup=c}();
void function(){function c(a){if(this instanceof c){if(f)return f}else return new c;f=this;this.__settings=fn.extend({},e,a);this.__node=fn.byId("portal-region");this.__form=fn.byClassName(this.__node,"js-region-form")[0];this.__autoCheckbox=fn.byId("regionAutoDetectInput");this.__autoCheckboxCity=fn.byClassName(this.__node,"js-auto-city")[0];this.__manualCheckbox=fn.byId("regionManualInput");this.__regionSearchInput=fn.byId("regionSearchInput");this.__regionSearchInputBaseClass="portal-input";this.__regionSearchPlaceholderBaseClass=
"portal-input__placeholder";this.__regionSearchPlaceholder=fn.byClassName(this.__node,this.__regionSearchPlaceholderBaseClass)[0];this.__regionSuggestsBaseClass="portal-region__suggests";this.__regionSuggests=fn.byClassName(this.__node,this.__regionSuggestsBaseClass)[0];this.__regionSuggestsGroups={current:fn.byClassName(this.__regionSuggests,"js-current-regions")[0],russia:fn.byClassName(this.__regionSuggests,"js-russia-regions")[0],other:fn.byClassName(this.__regionSuggests,"js-other-regions")[0]};
this.__regionSuggestsGroupLists={current:fn.byClassName(this.__regionSuggestsGroups.current,"js-region-items")[0],russia:fn.byClassName(this.__regionSuggestsGroups.russia,"js-region-items")[0],other:fn.byClassName(this.__regionSuggestsGroups.other,"js-region-items")[0]};this.__regionSuggestsGroupBaseClass="portal-region__suggests__group";this.__regionSuggestsGroupItemBaseClass="portal-region__suggests__group__item";this.__autoCheckboxCity.innerHTML=this.__settings.cityName||"";PortalEvents.addListener(this.__autoCheckbox,
"click",fn.bind(this.__switchToAuto,this));PortalEvents.addListener(this.__manualCheckbox,"click",fn.bind(function(){this.__switchToManual();this.__regionSearchInput.focus()},this));PortalEvents.addListener(this.__regionSearchInput,"click",fn.bind(this.__searchInputKeys,this));PortalEvents.addListener(this.__regionSearchInput,"keydown",fn.bind(this.__searchInputKeys,this));PortalEvents.addListener(this.__regionSearchInput,"keyup",fn.bind(this.__searchInputKeys,this));PortalEvents.addListener(this.__regionSearchInput,
"paste",fn.bind(this.__searchInputKeys,this));PortalEvents.addListener(this.__regionSearchInput,"cut",fn.bind(this.__searchInputKeys,this));PortalEvents.addListener(this.__regionSearchInput,"input",fn.bind(function(){this.__validate()},this));PortalEvents.addListener(this.__regionSearchInput,"paste",fn.bind(function(){this.__validate()},this));PortalEvents.addListener(this.__regionSearchInput,"cut",fn.bind(function(){this.__validate()},this));PortalEvents.addListener(this.__regionSuggests,"click",
fn.bind(this.__searchInputKeys,this));PortalEvents.addListener(this.__regionSuggests,"keydown",fn.bind(this.__searchInputKeys,this));PortalEvents.addListener(this.__regionSuggests,"scroll",fn.bind(this.__onScroll,this));if(this.__placeholderEmulation=!("placeholder"in document.createElement("input"))){if(a=this.__regionSearchInput.getAttribute("placeholder"))this.__regionSearchPlaceholder.innerHTML=a;PortalEvents.addListener(this.__regionSearchInput,"keydown",fn.bind(this.__placeHolderKeys,this));
PortalEvents.addListener(this.__regionSearchInput,"keyup",fn.bind(this.__placeHolderKeys,this));PortalEvents.addListener(this.__regionSearchInput,"paste",fn.bind(this.__togglePlaceholder,this));PortalEvents.addListener(this.__regionSearchInput,"cut",fn.bind(this.__togglePlaceholder,this));PortalEvents.addListener(this.__regionSearchInput,"input",fn.bind(this.__togglePlaceholder,this))}else this.__regionSearchPlaceholder.style.display="none";PortalEvents.addListener(fn.byClassName(this.__regionSuggests,
"js-message-all")[0],"click",fn.bind(function(){this.__reset();this.__regionSearchInput.focus()},this));PortalEvents.addListener(fn.byClassName(this.__regionSuggests,"js-message-reload")[0],"click",fn.bind(this.__reload,this));this.__popup=new __portal.PortalPopup({node:fn.byId("regional-popup")});this.__popup.on("actionCancel",fn.bind(function(){this.__actionCancel=!0;mr.counter("clb1221592");this.__popup.hide()},this));this.__popup.on("hide",fn.bind(function(){this.__actionCancel||mr.counter("clb1264381");
this.__actionCancel=!1},this));this.__popup.on("actionSave",fn.bind(function(){mr.counter("clb1221591");this.__save()},this));PortalEvents.addListener(this.__form,"submit",fn.bind(function(a){a&&a.preventDefault();this.__save()},this));this.on("beforeShow",this.__init);this.on("show",function(){this.__regionSuggestsOffsetHeight=this.__regionSuggests.offsetHeight;this.__regionSuggestsScrollHeight=this.__regionSuggests.scrollHeight});this.__autocompletedValue=this.__q="";this.__cacheQ={};this.__cacheNoQ=
void 0;this.__regionsCache={}}var f,e={startRegion:null,auto:!0,notification:!1,cityName:"",pageSize:50,inputTimeout:400,lastItemsToLoad:15,preloaderPause:200,region:null,effRegion:null};c.prototype=new __portal.PortalEventEmitter;fn.extend(c.prototype,{__init:function(){this.__settings.auto?(this.__autoCheckbox.checked=!0,this.__manualCheckbox.checked=!1,this.__switchToAuto(),this.once("show",fn.bind(function(){this.__manualCheckbox.focus()},this))):(this.__autoCheckbox.checked=!1,this.__manualCheckbox.checked=
!0,this.__switchToManual(),this.once("show",fn.bind(function(){this.__regionSearchInput.focus()},this)));this.__page=0;this.once("show",fn.bind(function(){this.__regionSuggests.scrollTop=0},this));this.__selectCity();this.__loadRegions(0)},__reload:function(){this.__loadRegions(this.__page)},__reset:function(){this.__regionSuggests.scrollTop=0;this.__setQ("");this.__loadRegions(0)},__save:function(){var a=mr.s_cookie.getGlobal("geo");mr.s_cookie.getGlobal("georb");(new Image).src="//rs.mail.ru/f?new="+
(this.__selectedCity?this.__selectedCity.getAttribute("data-id"):"auto")+"&old="+this.__settings.effRegion.id+"&ipR="+this.__settings.region.id+"&ipLevel2="+this.__settings.region.level2+"&effLevel2="+this.__settings.effRegion.level2+"&ipLevel1="+this.__settings.region.level1+"&effLevel1="+this.__settings.effRegion.level1+"&geod="+mr.s_cookie.getGlobal("geod")+"&georb="+mr.s_cookie.getGlobal("georb")+"&geol1="+mr.s_cookie.getGlobal("geol1")+"&geo="+mr.s_cookie.getGlobal("geo");if(this.__autoCheckbox.checked)mr.counter("clb1221593"),
mr.s_cookie.removeGlobal("geo"),mr.s_cookie.removeGlobal("georb"),mr.s_cookie.removeGlobal("geol1");else{if(!this.__selectedCity){this.__setError(!0);return}this.__selectedCity.parentNode===this.__regionSuggestsGroupLists.current?mr.counter("clb1264632"):mr.counter("clb1221598");mr.s_cookie.setGlobal("geo",this.__selectedCity.getAttribute("data-id"));mr.s_cookie[this.__settings.region.level2?"setGlobal":"removeGlobal"]("georb",this.__settings.region.level2);mr.s_cookie[this.__settings.region.level1?
"setGlobal":"removeGlobal"]("geol1",this.__settings.region.level1)}mr.s_cookie.removeGlobal("geod");this.__popup.hide();a!==mr.s_cookie.getGlobal("geo")&&setTimeout(function(){var a=window.location.toString(),a=a.replace("#region","");setTimeout(function(){try{window.location.replace(a)}catch(d){}setTimeout(function(){try{window.location.replace(a)}catch(d){}setTimeout(function(){try{window.location.reload()}catch(a){}},10)},10)},10)},50)},__cache:function(a,b,d){var c,e=d&&d.regionsCount&&Math.ceil(d.regionsCount/
this.__settings.pageSize);(a=this.__getNormalizedQ(a))?(c=this.__cacheQ[a],!c&&e?c=this.__cacheQ[a]=Array(e):!c&&(!e&&d)&&(c=this.__cacheQ[a]=!1)):(c=this.__cacheNoQ,!c&&e&&(c=this.__cacheNoQ=Array(e)));if(!c)return c;if(e&&b>e-1)return null;a=c[b];d&&(a||(c[b]=a={current:[],russia:[],other:[]}),a.current=d.current,a.russia=d.russia,a.other=d.other,c.regionsCount=d.regionsCount,fn.append(this.__regionsCache,d.regions));return a},__inCache:function(a,b){return this.__cache(a,b)},__pages:function(a){a=
this.__getNormalizedQ(a);return(a=""==a?this.__cacheNoQ:this.__cacheQ[a])?a.length:void 0},__scrollToCity:function(a,b){var d=fn.arrayIndexOf(this.__items,a),c=a.offsetTop,e=a.offsetHeight,f=this.__regionSuggests.scrollTop,i=this.__regionSuggestsOffsetHeight;0===d?this.__regionSuggests.scrollTop=0:d===this.__items.length-1?this.__regionSuggests.scrollTop=this.__regionSuggestsScrollHeight-i:(d=(b?e:0)+c-f,d>i?this.__regionSuggests.scrollTop=c+e-i:0>=d&&(this.__regionSuggests.scrollTop=c))},__onScroll:function(){this.__items.length&&
this.__regionSuggests.scrollTop+this.__regionSuggestsOffsetHeight>this.__regionSuggestsScrollHeight-this.__items[0].offsetHeight*this.__settings.lastItemsToLoad&&this.__loadRegions(this.__page+1)},__selectCity:function(a,b){a||(this.__selectedCity=null,fn.removeClass(this.__selectedCity,"portal-region__suggests__group__item_selected"));this.__selectedCity&&fn.removeClass(this.__selectedCity,"portal-region__suggests__group__item_selected");a&&(this.__selectedCity=a,b||this.__setQ(this.__getQ(),this.__regionsCache[a.getAttribute("data-id")].cityName),
fn.addClass(this.__selectedCity,"portal-region__suggests__group__item_selected"))},__searchInputKeys:function(a){if("click"===a.type&&(a.target===this.__regionSuggests||fn.hasParent(a.target,this.__regionSuggests)))this.__autoCheckbox.checked?a.preventDefault():(a=fn.hasParent(a.target,"portal-region__suggests__group__item")||fn.hasClass(a.target,"portal-region__suggests__group__item")&&a.target)&&this.__selectCity(a);else if("keydown"===a.type)switch(a.keyCode){case 13:if(this.__autoCheckbox.checked){a.preventDefault();
break}a.target===this.__regionSuggests&&(this.__save(),this.__hasError()&&setTimeout(fn.bind(function(){this.__regionSearchInput.focus()},this),10));break;case 40:case 38:if(this.__autoCheckbox.checked||!this.__items.length){a.preventDefault();break}var b;if(40==a.keyCode)if(this.__selectedCity){b=fn.arrayIndexOf(this.__items,this.__selectedCity)+1;if(b>=this.__items.length){if(this.__loading)break;b=0}b=this.__items[b]}else b=this.__items[0];else this.__selectedCity?(b=fn.arrayIndexOf(this.__items,
this.__selectedCity)-1,0>b&&(b=this.__items.length-1),b=this.__items[b]):b=this.__items[this.__items.length-1];this.__selectCity(b);this.__scrollToCity(this.__selectedCity,40==a.keyCode);a.preventDefault()}else if("keyup"===a.type||("paste"===a.type||"cut"===a.type)&&a.target===this.__regionSearchInput||"click"===a.type&&(a.target===this.__regionSearchInput||fn.hasParent(a.target,this.__regionSearchInput)))clearTimeout(this.__qEntertimeout),"cut"===a.type||"paste"===a.type?this.__qEntertimeout=setTimeout(fn.bind(function(){this.__searchInputKeys({type:"keyup"})},
this),0):13!==a.keyCode&&this.__validate(this.__regionSearchInput.value)&&(b=(a=this.__getSelection())?this.__regionSearchInput.value.substr(0,this.__regionSearchInput.value.toLowerCase().indexOf(a)):this.__regionSearchInput.value,b=b.toLowerCase(),b===this.__getNormalizedQ()||a===this.__regionSearchInput.value.toLowerCase()&&""!==this.__regionSearchInput.value||(this.__qEntertimeout=setTimeout(fn.bind(function(){this.__q=this.__regionSearchInput.value;this.__autocompletedValue="";this.__getNormalizedQ()!==
this.__getQLoaded()&&this.__loadRegions(0)},this),this.__settings.inputTimeout)))},__placeHolderKeys:function(a){this.__placeholderEmulation&&("keydown"===a.type?91==a.keyCode||92==a.keyCode?this.__commandKey=!0:-1<[8,46].indexOf(a.keyCode)&&1==this.__getQ().length?this.__togglePlaceholder(!0):48<=a.keyCode&&(90>=a.keyCode&&!a.altKey&&!a.ctrlKey&&!this.__commandKey)&&this.__togglePlaceholder(!1):"keyup"===a.type&&(91==a.keyCode||92==a.keyCode?this.__commandKey=!1:this.__togglePlaceholder()))},__togglePlaceholder:function(a){this.__placeholderEmulation&&
(this.__regionSearchPlaceholder.style.display=!0===a||!1===a?a?"block":"none":!this.__regionSearchInput.value?"block":"none")},__validate:function(a){a=void 0===a?this.__regionSearchInput.value:a;(a=""===a||/^[a-zA-Z\u0430-\u044f\u0410-\u042f\u0451() \-]+$/i.test(a))?this.__removeError(!0):this.__setError();return a},__getQ:function(){return this.__q},__setQ:function(a,b){this.__autocompletedValue=b||"";this.__q=a;this.__regionSearchInput.value=this.__autocompletedValue?this.__autocompletedValue:
this.__q;var d=this.__getNormalizedQ(this.__q).length,c=this.__autocompletedValue.length;if(this.__popup.isVisible())if(this.__regionSearchInput.setSelectionRange)this.__regionSearchInput.setSelectionRange(d,c);else if(this.__regionSearchInput.createTextRange){var e=this.__regionSearchInput.createTextRange();e.collapse(!0);e.moveEnd("character",c);e.moveStart("character",d);e.select()}this.__togglePlaceholder()},__getNormalizedQ:function(a){a=void 0!==a?a:this.__getQ();return a.toLowerCase()},__getSelection:function(){var a=
this.__getNormalizedQ(this.__q).length;return!this.__autocompletedValue?"":-1!==this.__regionSearchInput.value.toLowerCase().indexOf(this.__autocompletedValue.toLowerCase())?this.__autocompletedValue.substr(a).toLowerCase():""},__getQLoaded:function(){return this.__qLoaded},__setQLoaded:function(a){this.__qLoaded=a.toLowerCase()},__hasError:function(){return fn.hasClass(this.__regionSearchInput.parentNode.parentNode,this.__regionSearchInputBaseClass+"_error")},__setError:function(a){clearTimeout(this.__hightlightTimeout);
fn.addClass(this.__regionSearchInput.parentNode.parentNode,this.__regionSearchInputBaseClass+"_error");a?(this.__hightlightTimeout=setTimeout(fn.bind(function(){this.__validate()},this),1E3),fn.addClass(this.__regionSuggests.parentNode,"w-"+this.__regionSuggestsBaseClass+"_highlight")):this.__removeError(!0,!0)},__removeError:function(a,b){b||fn.removeClass(this.__regionSearchInput.parentNode.parentNode,this.__regionSearchInputBaseClass+"_error");a&&fn.removeClass(this.__regionSuggests.parentNode,
"w-"+this.__regionSuggestsBaseClass+"_highlight")},__switchToAuto:function(){this.__reset();this.__regionSearchInput.setAttribute("disabled","disabled");fn.addClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_disabled")},__switchToManual:function(){this.__reset();this.__regionSearchInput.removeAttribute("disabled");fn.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_disabled")},__url:"//swa.mail.ru/region_suggest",__loadRegions:function(a){if(!(this.__loading&&this.__getQLoaded()===
this.__getNormalizedQ())){var b=this.__getParams(a),d=b.q;if(!(a>this.__pages(d)-1)){this.__setQLoaded(d);this.__page=a;var c=this.__inCache(d,a);if(void 0===c){for(var e=d,f;2<=(e=e.substr(0,e.length-1)).length&&void 0===(f=this.__inCache(e,a)););if(!1===f){this.__updateList();return}}else if(!1===c){this.__updateList();return}c?this.__updateList(c,a):(clearTimeout(this.__loaderTimeout),a||(this.__loaderTimeout=setTimeout(fn.bind(function(){fn.addClass(this.__regionSuggests,this.__regionSuggestsBaseClass+
"_loading")},this),this.__settings.preloaderPause)),this.__loading=!0,mr.JSONP({url:this.__url,params:b,callback:fn.bind(function(b){clearTimeout(this.__loaderTimeout);fn.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_loading");this.__loading=!1;b=this.__cache(d,a,b);this.__getNormalizedQ()===this.__getQLoaded()&&this.__page===a&&this.__updateList(b,a)},this),error:fn.bind(function(b){clearTimeout(this.__loaderTimeout);fn.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+
"_loading");this.__loading=!1;this.__getNormalizedQ()===this.__getQLoaded()&&this.__page===a&&this.__message(null,b)},this),timeout:6E4}))}}},__message:function(a,b){b?(this.__scrollTop=this.__regionSuggests.scrollTop,fn.addClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_message"),fn.addClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_error"),fn.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_empty")):(a?(fn.addClass(this.__regionSuggests,this.__regionSuggestsBaseClass+
"_message"),fn.addClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_empty")):(fn.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_message"),fn.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_empty")),fn.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_error"));!b&&this.__scrollTop&&(this.__regionSuggests.scrollTop=this.__scrollTop,this.__scrollTop=null)},__updateList:function(a,b){if(0===b||!a)this.__selectCity(),this.__regionSuggests.scrollTop=
0,fn.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_hasMore"),this.__regionSuggestsGroupLists.current.innerHTML="",this.__regionSuggestsGroupLists.russia.innerHTML="",this.__regionSuggestsGroupLists.other.innerHTML="";this.__message(!a);a&&(a.current.length&&this.__regionSuggestsGroupLists.current.appendChild(this.__groupHTML(this.__regionsCache,a.current)),a.russia.length&&this.__regionSuggestsGroupLists.russia.appendChild(this.__groupHTML(this.__regionsCache,a.russia)),a.other.length&&
this.__regionSuggestsGroupLists.other.appendChild(this.__groupHTML(this.__regionsCache,a.other)),void 0!==b&&b!==this.__pages(this.__getNormalizedQ())-1?fn.addClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_hasMore"):fn.removeClass(this.__regionSuggests,this.__regionSuggestsBaseClass+"_hasMore"),(!this.__regionSuggestsGroupLists.current.childNodes.length?fn.addClass:fn.removeClass)(this.__regionSuggestsGroups.current,this.__regionSuggestsGroupBaseClass+"_empty"),(!this.__regionSuggestsGroupLists.russia.childNodes.length?
fn.addClass:fn.removeClass)(this.__regionSuggestsGroups.russia,this.__regionSuggestsGroupBaseClass+"_empty"),(!this.__regionSuggestsGroupLists.other.childNodes.length?fn.addClass:fn.removeClass)(this.__regionSuggestsGroups.other,this.__regionSuggestsGroupBaseClass+"_empty"));var c=this.__items;this.__items=fn.byClassName(this.__regionSuggests,this.__regionSuggestsGroupItemBaseClass);1===this.__items.length&&this.__selectCity(this.__items[0],1==c.length&&c[0].getAttribute("data-id")===this.__items[0].getAttribute("data-id"));
this.__regionSuggestsScrollHeight=this.__regionSuggests.scrollHeight},__groupHTML:function(a,b){if(!b||!b.length)return"";for(var c=document.createDocumentFragment(),e=0,f=b.length;e<f;e++){var j=b[e],i=a[j],l=i.parentId&&a[i.parentId],n=l&&l.parentId&&a[l.parentId],k=document.createElement("div"),m=document.createElement("span"),q=document.createElement("span");k.setAttribute("data-id",j);k.className="portal-region__suggests__group__item";m.className="portal-region__suggests__group__item__name";
q.className="portal-region__suggests__group__item__info";m.innerHTML=i.cityName;q.innerHTML=l?"("+l.regionName+(n?", "+n.regionName:"")+")":"";k.appendChild(m);k.appendChild(q);c.appendChild(k)}return c},__getParams:function(a){var b={q:this.__getNormalizedQ()},a=this.__settings.pageSize*a,c=this.__settings.pageSize;this.__settings.startRegion&&(b.rId=this.__settings.startRegion);void 0!==a&&(b.M=a);void 0!==c&&(b.N=c);return b},show:function(){function a(){this.__popup.show();this.emit("show");mr.counter("d1221590")}
this.__popup.isVisible()||(this.emit("beforeShow"),this.__inCache(this.__getNormalizedQ(),this.__page)?a.call(this):setTimeout(fn.bind(a,this),this.__settings.preloaderPause))},hide:function(){this.__popup.isVisible()&&(this.emit("beforeHide"),this.__popup.hide(),this.emit("hide"))}});p.PortalRegion=c}();
(function(c){function f(a){this.__settings=c.extend({},e,a);this.showVariant=this.__settings.show;this.variant=0;this.popup=mr.id("region-confirm");this.citySelect=mr.id("citySelect");this.choose=mr.id("region-confirm__choose");this.closeButton=mr.id("region-confirm__close");this.confirm=mr.id("region-confirm__confirm");this.link=mr.id("region-confirm__link");this.city=mr.id("region-confirm__city");this.yes=mr.id("region-confirm__yes");this.no=mr.id("region-confirm__no");this.citySelect.appendChild(this.popup);
PortalEvents.addListener(this.closeButton,"click",c.bind(this.hideByButton,this));PortalEvents.addListener(this.closeButton,"keyup",c.bind(function(a){13===a.keyCode&&this.hideByButton()},this));var a=mr.s_cookie.getGlobal("geo"),b=mr.s_cookie.getGlobal("georb"),d=mr.s_cookie.getGlobal("geod"),f=mr.s_cookie.getGlobal("geol1")||null,b=b||null,h=this.__settings.region,j=this.__settings.effRegion;if(1===this.showVariant||0===this.__settings.region.id&&!a)this.variant=1;else if(2===this.showVariant||
a&&a!==h.id&&(null!==b&&j.level2!=h.level2&&b!=h.level2&&null!==h.level2||null!==f&&j.level1!=h.level1&&f!=h.level1)&&(!d||d&&d!=h.level1))this.variant=2;1===this.variant?(this.choose.style.display="inline-block",this.confirm.style.display="none",PortalEvents.addListener(this.link,"click",c.bind(this.showRegionalSelector,this))):2===this.variant?(this.choose.style.display="none",this.confirm.style.display="inline-block",this.city.innerHTML=this.__settings.cityName,PortalEvents.addListener(this.yes,
"click",c.bind(this.save,this)),PortalEvents.addListener(this.no,"click",c.bind(this.save,this)),PortalEvents.addListener(this.yes,"keyup",c.bind(this.save,this)),PortalEvents.addListener(this.no,"keyup",c.bind(this.save,this))):this.__disabled=!0}var e={cityName:"",region:null,effRegion:null};f.prototype={save:function(a){if("click"===a.type||"keyup"===a.type&&13===a.keyCode){var b;if(a.target===this.yes||c.hasParent(a.target,this.yes))b="yes";else if(a.target===this.no||c.hasParent(a.target,this.no))b=
"no";b&&((new Image).src="//rs.mail.ru/f?geo="+mr.s_cookie.getGlobal("geo")+"&ipR="+this.__settings.region.id+"&ipLevel2="+this.__settings.region.level2+"&effLevel2="+this.__settings.effRegion.level2+"&ipLevel1="+this.__settings.region.level1+"&effLevel1="+this.__settings.effRegion.level1+"&geod="+mr.s_cookie.getGlobal("geod")+"&georb="+mr.s_cookie.getGlobal("georb")+"&geol1="+mr.s_cookie.getGlobal("geol1")+"&button="+b);"yes"===b?(mr.counter("clb1283927"),mr.s_cookie.removeGlobal("geo"),mr.s_cookie.removeGlobal("georb"),
mr.s_cookie.removeGlobal("geol1"),mr.s_cookie.removeGlobal("geod"),setTimeout(function(){location.reload()},20),this.hide()):"no"===b&&(mr.counter("clb1283928"),a=mr.s_cookie.getGlobal("geod"),mr.s_cookie[this.__settings.region.level2?"setGlobal":"removeGlobal"]("georb",this.__settings.region.level2),mr.s_cookie[this.__settings.region.level1?"setGlobal":"removeGlobal"]("geol1",this.__settings.region.level1),-1==a?mr.s_cookie.setGlobal("geod",this.__settings.region.level1):mr.s_cookie.setGlobal("geod",
"-1"),this.hide())}},hideByButton:function(){this.hide();this.variant&&mr.counter("clb"+(1==this.variant?"1283920":"1283930"))},hide:function(){this.popup.style.display="none"},show:function(){this.__disabled||(this.popup.style.display="block",this.variant&&mr.counter("d"+(1==this.variant?"1283915":"1283926")))},showRegionalSelector:function(){showRegionSelector=!0;"regionalSelector"in window&&(mr.counter("clb1283918"),window.regionalSelector.show());this.hide()}};window.RegionConfirm=f})(window.__portal.__fn);
function vpWidth(){return parseInt(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,10)}function vpHeight(){return parseInt(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,10)}var cookieName="s_vp";function saveToCookie(c){var f=getFromCookie().match(/\((\d+)\/(\d+)\)/i),e=vpHeight();(c||!f||f[2]<e)&&__PH.cookie.s.setGlobal(cookieName,"("+vpWidth()+"/"+e+")")}
function getFromCookie(){return __PH.cookie.s.getGlobal(cookieName)||""}var cookie=getFromCookie();cookie&&mr.logViewport&&((new Image).src="//gstat.imgsmail.ru/gstat?logme="+encodeURIComponent("splashViewport;"+cookie)+"&rnd="+(new Date).getTime()+Math.random());var onresize=window.onresize,timeout;Splash.DOMEvent.on(window,"resize",function(c){"function"==typeof onresize&&onresize(c);clearTimeout(timeout);timeout=setTimeout(function(){saveToCookie()},50)});saveToCookie(1);
aRadar("additionalJSInit",1);
