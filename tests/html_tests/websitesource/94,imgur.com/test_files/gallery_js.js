(function(f,e){function h(a,l){var k=a.nodeName.toLowerCase();if("area"===k){var j=a.parentNode,i=j.name,d;return !a.href||!i||j.nodeName.toLowerCase()!=="map"?!1:(d=f("img[usemap=#"+i+"]")[0],!!d&&g(d))}return(/input|select|textarea|button|object/.test(k)?!a.disabled:"a"==k?a.href||l:l)&&g(a)}function g(a){return !f(a).parents().andSelf().filter(function(){return f.curCSS(this,"visibility")==="hidden"||f.expr.filters.hidden(this)}).length}f.ui=f.ui||{};if(f.ui.version){return}f.extend(f.ui,{version:"1.8.23",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),f.fn.extend({propAttr:f.fn.prop||f.fn.attr,_focus:f.fn.focus,focus:function(a,d){return typeof a=="number"?this.each(function(){var b=this;setTimeout(function(){f(b).focus(),d&&d.call(b)},a)}):this._focus.apply(this,arguments)},scrollParent:function(){var a;return f.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?a=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(f.curCSS(this,"position",1))&&/(auto|scroll)/.test(f.curCSS(this,"overflow",1)+f.curCSS(this,"overflow-y",1)+f.curCSS(this,"overflow-x",1))}).eq(0):a=this.parents().filter(function(){return/(auto|scroll)/.test(f.curCSS(this,"overflow",1)+f.curCSS(this,"overflow-y",1)+f.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!a.length?f(document):a},zIndex:function(j){if(j!==e){return this.css("zIndex",j)}if(this.length){var i=f(this[0]),b,a;while(i.length&&i[0]!==document){b=i.css("position");if(b==="absolute"||b==="relative"||b==="fixed"){a=parseInt(i.css("zIndex"),10);if(!isNaN(a)&&a!==0){return a}}i=i.parent()}}return 0},disableSelection:function(){return this.bind((f.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(b){b.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),f("<a>").outerWidth(1).jquery||f.each(["Width","Height"],function(l,k){function a(m,p,o,n){return f.each(j,function(){p-=parseFloat(f.curCSS(m,"padding"+this,!0))||0,o&&(p-=parseFloat(f.curCSS(m,"border"+this+"Width",!0))||0),n&&(p-=parseFloat(f.curCSS(m,"margin"+this,!0))||0)}),p}var j=k==="Width"?["Left","Right"]:["Top","Bottom"],i=k.toLowerCase(),b={innerWidth:f.fn.innerWidth,innerHeight:f.fn.innerHeight,outerWidth:f.fn.outerWidth,outerHeight:f.fn.outerHeight};f.fn["inner"+k]=function(d){return d===e?b["inner"+k].call(this):this.each(function(){f(this).css(i,a(this,d)+"px")})},f.fn["outer"+k]=function(d,m){return typeof d!="number"?b["outer"+k].call(this,d):this.each(function(){f(this).css(i,a(this,d,!0,m)+"px")})}}),f.extend(f.expr[":"],{data:f.expr.createPseudo?f.expr.createPseudo(function(a){return function(b){return !!f.data(b,a)}}):function(a,j,i){return !!f.data(a,i[3])},focusable:function(a){return h(a,!isNaN(f.attr(a,"tabindex")))},tabbable:function(a){var i=f.attr(a,"tabindex"),c=isNaN(i);return(c||i>=0)&&h(a,!c)}}),f(function(){var a=document.body,d=a.appendChild(d=document.createElement("div"));d.offsetHeight,f.extend(d.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),f.support.minHeight=d.offsetHeight===100,f.support.selectstart="onselectstart" in d,a.removeChild(d).style.display="none"}),f.curCSS||(f.curCSS=f.css),f.extend(f.ui,{plugin:{add:function(a,l,k){var j=f.ui[a].prototype;for(var i in k){j.plugins[i]=j.plugins[i]||[],j.plugins[i].push([l,k[i]])}},call:function(j,i,m){var l=j.plugins[i];if(!l||!j.element[0].parentNode){return}for(var k=0;k<l.length;k++){j.options[l[k][0]]&&l[k][1].apply(j.element,m)}}},contains:function(d,c){return document.compareDocumentPosition?d.compareDocumentPosition(c)&16:d!==c&&d.contains(c)},hasScroll:function(a,k){if(f(a).css("overflow")==="hidden"){return !1}var j=k&&k==="left"?"scrollLeft":"scrollTop",i=!1;return a[j]>0?!0:(a[j]=1,i=a[j]>0,a[j]=0,i)},isOverAxis:function(i,d,j){return i>d&&i<d+j},isOver:function(a,m,l,k,j,i){return f.ui.isOverAxis(a,l,j)&&f.ui.isOverAxis(m,k,i)}})})(jQuery);(function(f,e){if(f.cleanData){var h=f.cleanData;f.cleanData=function(a){for(var j=0,i;(i=a[j])!=null;j++){try{f(i).triggerHandler("remove")}catch(c){}}h(a)}}else{var g=f.fn.remove;f.fn.remove=function(a,d){return this.each(function(){return d||(!a||f.filter(a,[this]).length)&&f("*",this).add([this]).each(function(){try{f(this).triggerHandler("remove")}catch(c){}}),g.call(f(this),a,d)})}}f.widget=function(a,m,l){var k=a.split(".")[0],j;a=a.split(".")[1],j=k+"-"+a,l||(l=m,m=f.Widget),f.expr[":"][j]=function(b){return !!f.data(b,a)},f[k]=f[k]||{},f[k][a]=function(d,c){arguments.length&&this._createWidget(d,c)};var i=new m;i.options=f.extend(!0,{},i.options),f[k][a].prototype=f.extend(!0,i,{namespace:k,widgetName:a,widgetEventPrefix:f[k][a].prototype.widgetEventPrefix||a,widgetBaseClass:j},l),f.widget.bridge(a,f[k][a])
},f.widget.bridge=function(b,a){f.fn[b]=function(j){var i=typeof j=="string",d=Array.prototype.slice.call(arguments,1),c=this;return j=!i&&d.length?f.extend.apply(null,[!0,j].concat(d)):j,i&&j.charAt(0)==="_"?c:(i?this.each(function(){var l=f.data(this,b),k=l&&f.isFunction(l[j])?l[j].apply(l,d):l;if(k!==l&&k!==e){return c=k,!1}}):this.each(function(){var k=f.data(this,b);k?k.option(j||{})._init():f.data(this,b,new a(j,this))}),c)}},f.Widget=function(d,c){arguments.length&&this._createWidget(d,c)},f.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(a,j){f.data(j,this.widgetName,this),this.element=f(j),this.options=f.extend(!0,{},this.options,this._getCreateOptions(),a);var i=this;this.element.bind("remove."+this.widgetName,function(){i.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return f.metadata&&f.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(i,b){var a=i;if(arguments.length===0){return f.extend({},this.options)}if(typeof i=="string"){if(b===e){return this.options[i]}a={},a[i]=b}return this._setOptions(a),this},_setOptions:function(a){var d=this;return f.each(a,function(i,c){d._setOption(i,c)}),this},_setOption:function(d,c){return this.options[d]=c,d==="disabled"&&this.widget()[c?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",c),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(a,m,l){var k,j,i=this.options[a];l=l||{},m=f.Event(m),m.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase(),m.target=this.element[0],j=m.originalEvent;if(j){for(k in j){k in m||(m[k]=j[k])}}return this.element.trigger(m,l),!(f.isFunction(i)&&i.call(this.element[0],m,l)===!1||m.isDefaultPrevented())}}})(jQuery);(function(e,d){var f=!1;e(document).mouseup(function(b){f=!1}),e.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var a=this;this.element.bind("mousedown."+this.widgetName,function(b){return a._mouseDown(b)}).bind("click."+this.widgetName,function(b){if(!0===e.data(b.target,a.widgetName+".preventClickEvent")){return e.removeData(b.target,a.widgetName+".preventClickEvent"),b.stopImmediatePropagation(),!1}}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(a){if(f){return}this._mouseStarted&&this._mouseUp(a),this._mouseDownEvent=a;var h=this,g=a.which==1,c=typeof this.options.cancel=="string"&&a.target.nodeName?e(a.target).closest(this.options.cancel).length:!1;if(!g||c||!this._mouseCapture(a)){return !0}this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){h.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)){this._mouseStarted=this._mouseStart(a)!==!1;if(!this._mouseStarted){return a.preventDefault(),!0}}return !0===e.data(a.target,this.widgetName+".preventClickEvent")&&e.removeData(a.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(b){return h._mouseMove(b)},this._mouseUpDelegate=function(b){return h._mouseUp(b)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),a.preventDefault(),f=!0,!0},_mouseMove:function(a){return !e.browser.msie||document.documentMode>=9||!!a.button?this._mouseStarted?(this._mouseDrag(a),a.preventDefault()):(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,a)!==!1,this._mouseStarted?this._mouseDrag(a):this._mouseUp(a)),!this._mouseStarted):this._mouseUp(a)},_mouseUp:function(a){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,a.target==this._mouseDownEvent.target&&e.data(a.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(a)),!1},_mouseDistanceMet:function(b){return Math.max(Math.abs(this._mouseDownEvent.pageX-b.pageX),Math.abs(this._mouseDownEvent.pageY-b.pageY))>=this.options.distance},_mouseDelayMet:function(b){return this.mouseDelayMet},_mouseStart:function(b){},_mouseDrag:function(b){},_mouseStop:function(b){},_mouseCapture:function(b){return !0}})})(jQuery);(function(e,d){var f=5;e.widget("ui.slider",e.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var a=this,n=this.options,m=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),l="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",k=n.values&&n.values.length||1,j=[];
this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(n.disabled?" ui-slider-disabled ui-disabled":"")),this.range=e([]),n.range&&(n.range===!0&&(n.values||(n.values=[this._valueMin(),this._valueMin()]),n.values.length&&n.values.length!==2&&(n.values=[n.values[0],n.values[0]])),this.range=e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(n.range==="min"||n.range==="max"?" ui-slider-range-"+n.range:"")));for(var c=m.length;c<k;c+=1){j.push(l)}this.handles=m.add(e(j.join("")).appendTo(a.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(b){b.preventDefault()}).hover(function(){n.disabled||e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover")}).focus(function(){n.disabled?e(this).blur():(e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),e(this).addClass("ui-state-focus"))}).blur(function(){e(this).removeClass("ui-state-focus")}),this.handles.each(function(g){e(this).data("index.ui-slider-handle",g)}),this.handles.keydown(function(s){var r=e(this).data("index.ui-slider-handle"),q,p,o,b;if(a.options.disabled){return}switch(s.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:s.preventDefault();if(!a._keySliding){a._keySliding=!0,e(this).addClass("ui-state-active"),q=a._start(s,r);if(q===!1){return}}}b=a.options.step,a.options.values&&a.options.values.length?p=o=a.values(r):p=o=a.value();switch(s.keyCode){case e.ui.keyCode.HOME:o=a._valueMin();break;case e.ui.keyCode.END:o=a._valueMax();break;case e.ui.keyCode.PAGE_UP:o=a._trimAlignValue(p+(a._valueMax()-a._valueMin())/f);break;case e.ui.keyCode.PAGE_DOWN:o=a._trimAlignValue(p-(a._valueMax()-a._valueMin())/f);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(p===a._valueMax()){return}o=a._trimAlignValue(p+b);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(p===a._valueMin()){return}o=a._trimAlignValue(p-b)}a._slide(s,r,o)}).keyup(function(g){var b=e(this).data("index.ui-slider-handle");a._keySliding&&(a._keySliding=!1,a._stop(g,b),a._change(g,b),e(this).removeClass("ui-state-active"))}),this._refreshValue(),this._animateOff=!1},destroy:function(){return this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider"),this._mouseDestroy(),this},_mouseCapture:function(v){var u=this.options,t,s,r,q,p,o,n,m,a;return u.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),t={x:v.pageX,y:v.pageY},s=this._normValueFromMouse(t),r=this._valueMax()-this._valueMin()+1,p=this,this.handles.each(function(g){var h=Math.abs(s-p.values(g));r>h&&(r=h,q=e(this),o=g)}),u.range===!0&&this.values(1)===u.min&&(o+=1,q=e(this.handles[o])),n=this._start(v,o),n===!1?!1:(this._mouseSliding=!0,p._handleIndex=o,q.addClass("ui-state-active").focus(),m=q.offset(),a=!e(v.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=a?{left:0,top:0}:{left:v.pageX-m.left-q.width()/2,top:v.pageY-m.top-q.height()/2-(parseInt(q.css("borderTopWidth"),10)||0)-(parseInt(q.css("borderBottomWidth"),10)||0)+(parseInt(q.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(v,o,s),this._animateOff=!0,!0))},_mouseStart:function(b){return !0},_mouseDrag:function(h){var g={x:h.pageX,y:h.pageY},i=this._normValueFromMouse(g);return this._slide(h,this._handleIndex,i),!1},_mouseStop:function(b){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(b,this._handleIndex),this._change(b,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(h){var g,l,k,j,i;return this.orientation==="horizontal"?(g=this.elementSize.width,l=h.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(g=this.elementSize.height,l=h.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),k=l/g,k>1&&(k=1),k<0&&(k=0),this.orientation==="vertical"&&(k=1-k),j=this._valueMax()-this._valueMin(),i=this._valueMin()+k*j,this._trimAlignValue(i)},_start:function(h,g){var i={handle:this.handles[g],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(g),i.values=this.values()),this._trigger("start",h,i)},_slide:function(h,g,l){var k,j,i;this.options.values&&this.options.values.length?(k=this.values(g?0:1),this.options.values.length===2&&this.options.range===!0&&(g===0&&l>k||g===1&&l<k)&&(l=k),l!==this.values(g)&&(j=this.values(),j[g]=l,i=this._trigger("slide",h,{handle:this.handles[g],value:l,values:j}),k=this.values(g?0:1),i!==!1&&this.values(g,l,!0))):l!==this.value()&&(i=this._trigger("slide",h,{handle:this.handles[g],value:l}),i!==!1&&this.value(l))
},_stop:function(h,g){var i={handle:this.handles[g],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(g),i.values=this.values()),this._trigger("stop",h,i)},_change:function(h,g){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[g],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(g),i.values=this.values()),this._trigger("change",h,i)}},value:function(b){if(arguments.length){this.options.value=this._trimAlignValue(b),this._refreshValue(),this._change(null,0);return}return this._value()},values:function(a,j){var i,h,g;if(arguments.length>1){this.options.values[a]=this._trimAlignValue(j),this._refreshValue(),this._change(null,a);return}if(!arguments.length){return this._values()}if(!e.isArray(arguments[0])){return this.options.values&&this.options.values.length?this._values(a):this.value()}i=this.options.values,h=arguments[0];for(g=0;g<i.length;g+=1){i[g]=this._trimAlignValue(h[g]),this._change(null,g)}this._refreshValue()},_setOption:function(a,i){var h,g=0;e.isArray(this.options.values)&&(g=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments);switch(a){case"disabled":i?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":this._animateOff=!0,this._refreshValue();for(h=0;h<g;h+=1){this._change(null,h)}this._animateOff=!1}},_value:function(){var b=this.options.value;return b=this._trimAlignValue(b),b},_values:function(h){var g,j,i;if(arguments.length){return g=this.options.values[h],g=this._trimAlignValue(g),g}j=this.options.values.slice();for(i=0;i<j.length;i+=1){j[i]=this._trimAlignValue(j[i])}return j},_trimAlignValue:function(h){if(h<=this._valueMin()){return this._valueMin()}if(h>=this._valueMax()){return this._valueMax()}var g=this.options.step>0?this.options.step:1,j=(h-this._valueMin())%g,i=h-j;return Math.abs(j)*2>=g&&(i+=j>0?g:-g),parseFloat(i.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t=this.options.range,s=this.options,r=this,q=this._animateOff?!1:s.animate,p,o={},n,m,l,a;this.options.values&&this.options.values.length?this.handles.each(function(c,g){p=(r.values(c)-r._valueMin())/(r._valueMax()-r._valueMin())*100,o[r.orientation==="horizontal"?"left":"bottom"]=p+"%",e(this).stop(1,1)[q?"animate":"css"](o,s.animate),r.options.range===!0&&(r.orientation==="horizontal"?(c===0&&r.range.stop(1,1)[q?"animate":"css"]({left:p+"%"},s.animate),c===1&&r.range[q?"animate":"css"]({width:p-n+"%"},{queue:!1,duration:s.animate})):(c===0&&r.range.stop(1,1)[q?"animate":"css"]({bottom:p+"%"},s.animate),c===1&&r.range[q?"animate":"css"]({height:p-n+"%"},{queue:!1,duration:s.animate}))),n=p}):(m=this.value(),l=this._valueMin(),a=this._valueMax(),p=a!==l?(m-l)/(a-l)*100:0,o[r.orientation==="horizontal"?"left":"bottom"]=p+"%",this.handle.stop(1,1)[q?"animate":"css"](o,s.animate),t==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[q?"animate":"css"]({width:p+"%"},s.animate),t==="max"&&this.orientation==="horizontal"&&this.range[q?"animate":"css"]({width:100-p+"%"},{queue:!1,duration:s.animate}),t==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[q?"animate":"css"]({height:p+"%"},s.animate),t==="max"&&this.orientation==="vertical"&&this.range[q?"animate":"css"]({height:100-p+"%"},{queue:!1,duration:s.animate}))}}),e.extend(e.ui.slider,{version:"1.8.23"})})(jQuery);
;jQuery.fn.imageZoom=function(b){var a=jQuery.extend({speed:150,dontFadeIn:1,hideClicked:1,imageMargin:15,className:"jquery-image-zoom",loading:"Loading..."},b);a.doubleSpeed=a.speed/4;return this.click(function(j){var g=jQuery(j.target);var f=g.is("a")?g:g.parents("a");f=(f&&f.is("a")&&f.attr("href").search(/(.*)\.(jpg|jpeg|gif|png|bmp|tif|tiff)(\?.*)?$/gi)!=-1)?f:false;var h=(f&&f.find("img").length)?f.find("img"):false;if(f){f.oldText=f.text();f.setLoadingImg=function(){if(h){h.css({opacity:"0.5"})}else{f.text(a.loading)}};f.setNotLoadingImg=function(){if(h){h.css({opacity:"1"})}else{f.text(f.oldText)}};var c=f.attr("href");if(jQuery("div."+a.className+' img[src="'+c+'"]').length){return false}var d=new Image();d.src=c;var i=function(){f.setNotLoadingImg();var r=h?h:f;var o=h?a.hideClicked:0;var n=r.offset();var l={width:r.outerWidth(),height:r.outerHeight(),left:n.left,top:n.top};var m=jQuery('<div><img src="'+c+'" alt="" /></div>').css("position","absolute").appendTo(document.body);var k={width:d.width,height:d.height};var q={width:jQuery(window).width(),height:jQuery(window).height()};if(k.width>(q.width-a.imageMargin*2)){var p=q.width-a.imageMargin*2;k.height=(p/k.width)*k.height;k.width=p}k.left=(q.width-k.width)/2+jQuery(window).scrollLeft();k.top=(q.height-k.height)/2+jQuery(window).scrollTop();var e=jQuery('<a href="#">Close</a>').appendTo(m).hide();m.attr("tabindex","1");if(k.top<0){k.top=20}if(o){f.css("visibility","hidden")}m.addClass(a.className).css(l).animate(k,a.speed,function(){e.fadeIn(a.doubleSpeed);m.focus()});var s=function(){e.fadeOut(a.doubleSpeed,function(){m.animate(l,a.speed,function(){f.css("visibility","visible");m.remove()})});return false};m.click(s);m.blur(s);e.click(s)};if(d.complete){i()}else{f.setLoadingImg();d.onload=i}return false}})};$(document).keydown(function(a){if(a.keyCode==27){$("div.jquery-image-zoom a").click()}});
;jQuery.fn.imageZoom=function(b){var a=jQuery.extend({speed:150,dontFadeIn:1,hideClicked:1,imageMargin:15,className:"jquery-image-zoom",loading:"Loading..."},b);a.doubleSpeed=a.speed/4;return this.click(function(j){var g=jQuery(j.target);var f=g.is("a")?g:g.parents("a");f=(f&&f.is("a")&&f.attr("href").search(/(.*)\.(jpg|jpeg|gif|png|bmp|tif|tiff)(\?.*)?$/gi)!=-1)?f:false;var h=(f&&f.find("img").length)?f.find("img"):false;if(f){f.oldText=f.text();f.setLoadingImg=function(){if(h){h.css({opacity:"0.5"})}else{f.text(a.loading)}};f.setNotLoadingImg=function(){if(h){h.css({opacity:"1"})}else{f.text(f.oldText)}};var c=f.attr("href");if(jQuery("div."+a.className+' img[src="'+c+'"]').length){return false}var d=new Image();d.src=c;var i=function(){f.setNotLoadingImg();var r=h?h:f;var o=h?a.hideClicked:0;var n=r.offset();var l={width:r.outerWidth(),height:r.outerHeight(),left:n.left,top:n.top};var m=jQuery('<div><img src="'+c+'" alt="" /></div>').css("position","absolute").appendTo(document.body);var k={width:d.width,height:d.height};var q={width:jQuery(window).width(),height:jQuery(window).height()};if(k.width>(q.width-a.imageMargin*2)){var p=q.width-a.imageMargin*2;k.height=(p/k.width)*k.height;k.width=p}k.left=(q.width-k.width)/2+jQuery(window).scrollLeft();k.top=(q.height-k.height)/2+jQuery(window).scrollTop();var e=jQuery('<a href="#">Close</a>').appendTo(m).hide();m.attr("tabindex","1");if(k.top<0){k.top=20}if(o){f.css("visibility","hidden")}m.addClass(a.className).css(l).animate(k,a.speed,function(){e.fadeIn(a.doubleSpeed);m.focus()});var s=function(){e.fadeOut(a.doubleSpeed,function(){m.animate(l,a.speed,function(){f.css("visibility","visible");m.remove()})});return false};m.click(s);m.blur(s);e.click(s)};if(d.complete){i()}else{f.setLoadingImg();d.onload=i}return false}})};$(document).keydown(function(a){if(a.keyCode==27){$("div.jquery-image-zoom a").click()}});
;/*!
 * jCarousel v@VERSION - Riding carousels with jQuery
 * http://sorgalla.com/jcarousel/
 *
 * Copyright 2011, Jan Sorgalla
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * or GPL Version 2 (http://www.opensource.org/licenses/gpl-2.0.php) licenses.
 *
 * Date: @DATE
 */
(function(c,b,e){var a=/^([+\-]=)?(.+)$/;var d=c.jcarousel={intval:function(f){f=parseInt(f,10);return isNaN(f)?0:f},parseTarget:function(h){var f=false,g=typeof h!=="object"?a.exec(h):null;if(g){h=d.intval(g[2]);if(g[1]){f=true;if(g[1]==="-="){h*=-1}}}else{if(typeof h!=="object"){h=d.intval(h)}}return{target:h,relative:f}},base:{version:"@VERSION",options:{},_options:c.noop,_init:c.noop,option:function(f,g){if(arguments.length===0){return c.extend({},this.options)}if(typeof f==="string"){if(g===e){return this.options[f]===e?null:this.options[f]}this.options[f]=g}else{if(c.isFunction(f)){f=f.call(this)}this.options=c.extend({},this.options,f)}return this},carousel:function(f){if(!!this.options.carousel){return this.options.carousel}var g=f||this.element,h=g.filter(":jcarousel");if(h.length){return h}while(g.size()>0){h=g.find(":jcarousel");if(h.length){return h}g=g.parent()}return c()},_trigger:function(h,g,k,j){g=g||this.element;j=c.Event(j);j.type=(this._event+h).toLowerCase();k=[this].concat(k||[]);if(j.originalEvent){for(var f=c.event.props.length,l;f;){l=c.event.props[--f];j[l]=j.originalEvent[l]}}g.trigger(j,k);return !j.isDefaultPrevented()}},create:function(h,g){var f,i;if(h!=="jcarousel"){f="jcarousel-"+h.toLowerCase();i="jcarousel"+h.toLowerCase();h="jcarousel"+h.charAt(0).toUpperCase()+h.slice(1)}else{f=i=h}d[h]=function(k,j){if(!this._init){return new d[h](k,j)}this.element=c(k).data(f,this);this.options=c.extend({},this.options,this._options(),j);this._init()};d[h].prototype=c.extend({},d.base,{_selector:f,_event:i},g);c.fn[h]=function(k){var j=Array.prototype.slice.call(arguments,1),l=this;if(typeof k==="string"){this.each(function(){var m=c.data(this,f);if(!m){return c.error("Cannot call methods on "+h+' prior to initialization; attempted to call method "'+k+'"')}if(!c.isFunction(m[k])||k.charAt(0)==="_"){return c.error('No such method "'+k+'" for '+h+" instance")}var n=m[k].apply(m,j);if(n!==m&&n!==e){l=n;return false}})}else{this.each(function(){var m=c.data(this,f);if(m){if(k){m.option(k)}}else{d[h](this,k)}})}return l}}};d.create("jcarousel",{options:{list:">ul:eq(0)",items:">li",animation:"normal",wrap:null,vertical:null,rtl:null,center:false},list:null,animating:false,tail:0,inTail:false,resizeTimer:null,lt:null,vertical:false,rtl:false,circular:false,_init:function(){if(false===this._trigger("init")){return this}this.list=this.element.find(this.options.list);this._reload();var f=this;this.onWindowResize=function(){if(f.resizeTimer){clearTimeout(f.resizeTimer)}f.resizeTimer=setTimeout(function(){f.reload()},100)};c(b).bind("resize.jcarousel",this.onWindowResize);this.onAnimationComplete=function(h){f.animating=false;var g=f.list.find(".jcarousel-clone");if(g.size()>0){g.remove();f.reload()}f._trigger("animateEnd");if(c.isFunction(h)){h.call(f,true)}};this._trigger("initEnd");return this},destroy:function(){if(false===this._trigger("destroy")){return this}var f=this.items().unbind(".jcarousel");c.each(["first","last","visible","fullyvisible"],function(h,g){f.removeData("jcarousel-item-"+g)});c(b).unbind("resize.jcarousel",this.onWindowResize);this.element.unbind(".jcarousel").removeData("jcarousel");this._trigger("destroyEnd");return this},reload:function(){if(false===this._trigger("reload")){return this}this._reload();this._trigger("reloadEnd");return this},items:function(){return this.list.find(this.options.items).not(".jcarousel-clone")},hasNext:function(){var h=this.option("wrap"),g=this.items(),f=g.size()-1;return f>=0&&((h&&h!=="first")||(g.filter(":jcarousel-item-last").index()<f)||(this.tail&&!this.inTail))?true:false},hasPrev:function(){var g=this.option("wrap"),f=this.items();return f.size()>0&&((g&&g!=="last")||(f.filter(":jcarousel-item-first").index()>0)||(this.tail&&this.inTail))?true:false},scroll:function(o,f,t){if(this.animating){return this}if(false===this._trigger("scroll",null,[o,f])){return this}if(c.isFunction(f)){t=f;f=true}var u=this,g=function(i){u._trigger("scrollEnd",null,[i]);if(c.isFunction(t)){t.call(u)}},q=d.parseTarget(o);if(q.relative){var p=this.items(),h=p.size()-1,r=Math.abs(q.target),m,n,v,k;if(q.target>0){var s=p.filter(":jcarousel-item-last").index();if(s>=h&&this.tail){if(!this.inTail){this._scrollTail(f,g)}else{if(this.options.wrap=="both"||this.options.wrap=="last"){this._scroll(0,f,g)}else{this._scroll(h,f,g)}}}else{if(s===h&&(this.options.wrap=="both"||this.options.wrap=="last")){return this._scroll(0,f,g)}else{m=p.filter(":jcarousel-item-first").index();n=m+r;if(this.circular&&n>h){k=h;v=p.get(-1);while(k++<n){v=this.items().eq(0);v.after(v.clone(true).addClass("jcarousel-clone"));this.list.append(v)}this._scroll(v,f,g)}else{this._scroll(Math.min(n,h),f,g)
}}}}else{m=p.filter(":jcarousel-item-first").index();n=m-r;if(this.inTail){this._scroll(Math.max(n+1,0),f,g)}else{if(m===0&&(this.options.wrap=="both"||this.options.wrap=="first")){this._scroll(h,f,g)}else{if(this.circular&&n<0){k=n;v=p.get(0);while(k++<0){v=this.items().eq(-1);v.after(v.clone(true).addClass("jcarousel-clone"));this.list.prepend(v);var j=d.intval(this.list.css(this.lt)),l=this._dimension(v);this.rtl?j+=l:j-=l;this.list.css(this.lt,j+"px")}this._scroll(v,f,g)}else{this._scroll(Math.max(m-r,0),f,g)}}}}}else{this._scroll(q.target,f,g)}return this},_reload:function(){this.vertical=this.options.vertical==null?(""+this.element.attr("class")).toLowerCase().indexOf("jcarousel-vertical")>-1:this.options.vertical;this.rtl=this.options.rtl==null?(""+this.element.attr("dir")).toLowerCase()==="rtl"||this.element.parents("[dir]").filter(function(){return(/rtl/i).test(c(this).attr("dir"))}).size()>0:this.options.rtl;this.lt=this.vertical?"top":"left";var g=this.items(),h=g.filter(":jcarousel-item-first"),f=g.size()-1;if(h.size()===0){h=g.eq(0)}this.circular=false;this.list.css({left:0,top:0});if(h.size()>0){this._prepare(h);this.list.find(".jcarousel-clone").remove();g=this.items();this.circular=this.options.wrap=="circular"&&(g.filter(":jcarousel-item-first").index()>0||g.filter(":jcarousel-item-last").index()<f);this.list.css(this.lt,this._position(h)+"px")}return this},_scroll:function(h,f,j){if(this.animating){return this}if(typeof h!=="object"){h=this.items().eq(h)}if(h.size()===0){j(false);return this}this.inTail=false;this._prepare(h);var i=this._position(h);if(i==d.intval(this.list.css(this.lt))){j(false);return this}var g={};g[this.lt]=i+"px";this._animate(g,f,j);return this},_scrollTail:function(f,i){if(this.animating||!this.tail){return this}var h=this.list.position()[this.lt];this.rtl?h+=this.tail:h-=this.tail;this.inTail=true;var g={};g[this.lt]=h+"px";this._animate(g,f,i);return this},_animate:function(h,g,k){if(this.animating){return this}if(false===this._trigger("animate")){return this}this.animating=true;if(!this.options.animation||g===false){this.list.css(h);this.onAnimationComplete(k)}else{var f=this,j=typeof this.options.animation==="object"?this.options.animation:{duration:this.options.animation},i=j.complete;j.complete=function(){f.onAnimationComplete(k);if(c.isFunction(i)){i.call(this)}};this.list.animate(h,j)}return this},_prepare:function(m){var k=this.items(),j=k.index(m),l=j,f=this._dimension(m),g=this._clipping(),h={first:m,last:m,visible:m,fullyvisible:f<=g?m:c()},n;if(this.options.center){f/=2;g/=2}if(f<g){while(true){n=this.items().eq(++l);if(n.size()===0){if(this.circular){n=this.items().eq(0);n.after(n.clone(true).addClass("jcarousel-clone"));this.list.append(n)}else{break}}f+=this._dimension(n);h.last=n;h.visible=h.visible.add(n);if(f<=g){h.fullyvisible=h.fullyvisible.add(n)}if(f>=g){break}}}if(f<g){l=j;while(true){if(--l<0){break}n=this.items().eq(l);if(n.size()===0){break}f+=this._dimension(n);h.first=n;h.visible=h.visible.add(n);if(f<=g){h.fullyvisible=h.fullyvisible.add(n)}if(f>=g){break}}}this._update(h);this.tail=0;if(this.options.wrap!=="circular"&&this.options.wrap!=="custom"&&h.last.index()===(this.items().size()-1)){var i=this.vertical?"bottom":(this.rtl?"left":"right");f-=d.intval(h.last.css("margin-"+i));if(f>g){this.tail=f-g}}return this},_position:function(g){var f=this.items(),h=f.filter(":jcarousel-item-first"),i=h.position()[this.lt];if(this.rtl&&!this.vertical){i-=this._clipping()-this._dimension(h)}if(this.options.center){i-=(this._clipping()/2)-(this._dimension(h)/2)}if((f.index(g)>f.index(h)||this.inTail)&&this.tail){i=this.rtl?i-this.tail:i+this.tail;this.inTail=true}else{this.inTail=false}return -i},_update:function(k){var h=this,g=this.items(),j=g.filter(":jcarousel-item-first"),i=g.filter(":jcarousel-item-last"),f={visible:g.filter(":jcarousel-item-visible"),fullyvisible:g.filter(":jcarousel-item-fullyvisible")};c.each(["first","last","visible","fullyvisible"],function(m,l){g.data("jcarousel-item-"+l,false);k[l].data("jcarousel-item-"+l,true)});if(k.first.get(0)!==j.get(0)){this._trigger("itemfirstin",k.first);this._trigger("itemfirstout",j)}if(k.last.get(0)!==i.get(0)){this._trigger("itemlastin",k.last);this._trigger("itemlastout",i)}c.each(["visible","fullyvisible"],function(p,o){var m=k[o].filter(function(){return c.inArray(this,f[o])<0}),l=f[o].filter(function(){return c.inArray(this,k[o])<0}),n=j.size()>0?j.index():0;if(g.index(k.first)>=n){l=c().pushStack(l.get().reverse())}else{m=c().pushStack(m.get().reverse())}h._trigger("item"+o+"in",m);h._trigger("item"+o+"out",l)});return this},_clipping:function(){return this.element["inner"+(this.vertical?"Height":"Width")]()},_dimension:function(f){return this.vertical?f.innerHeight()+d.intval(f.css("margin-top"))+d.intval(f.css("margin-bottom"))+d.intval(f.css("border-top-width"))+d.intval(f.css("border-bottom-width")):f.innerWidth()+d.intval(f.css("margin-left"))+d.intval(f.css("margin-right"))+d.intval(f.css("border-left-width"))+d.intval(f.css("border-right-width"))
}});c.expr[":"].jcarousel=function(f){return !!c.data(f,"jcarousel")};c.each(["first","last","visible","fullyvisible"],function(g,f){c.expr[":"]["jcarousel-item-"+f]=function(h){return !!c.data(h,"jcarousel-item-"+f)}})})(jQuery,window);
;(function(b){var a=function(i){var f=this,m=b('<div class="selection"></div>'),l=b('<input type="hidden" name="" value="" />'),j=b('<div class="triangle"></div>'),o=null,k=null,e={onChange:function(){return null},widthOffset:8},c=function(){var p=false;if(i.hasClass("opened")){i.removeClass("opened");o.css("z-index","0")}else{p=true;g();i.addClass("opened");o.css("z-index","999")}o.toggle();if(p){var q;if(q=o.find(".filter")){q.focus()}}},g=function(){b(".combobox .options").hide().css("z-index","0");b(".combobox").removeClass("opened")},h=function(p){if(!p){p=window.event}if(p.stopPropagation){p.stopPropagation()}p.cancelBubble=true;if(p.preventDefault){p.preventDefault()}p.returnValue=false;return false},d=function(q,p){return p.filter(function(){return(this.textContent.toLowerCase().indexOf(q)!==-1)})},n=function(q,p){return p};this.run=function(){o=i.children(".options");o.hide().width(i.width()+e.widthOffset);if(i.find(".selection").length==0){i.prepend(j).prepend(m).append(l)}else{m=i.find(".selection");l=i.find('input[type="hidden"]')}i.find(".triangle").unbind("click");i.find(".triangle").click(function(p){c();this.lazyload();h(p)}.bind(this));m.unbind("click");m.click(function(p){c();this.lazyload();h(p)}.bind(this));b("body").click(function(p){if(i.hasClass("opened")){c()}});o.off("click",".item");o.on("click",".item",function(){b('div[name="'+i.attr("name")+'"]').find(".selection").html(b(this).text().replace(/</g,"&lt;").replace(/>/g,"&gt;"));l.attr("value",b(this).attr("value"));o.find(".item").removeClass("selected");b(this).addClass("selected");c();e.onChange(i.attr("name"),l.attr("value"))});m.html(i.find(".selected").text().replace(/</g,"&lt;").replace(/>/g,"&gt;"));l.attr("name",i.attr("name")).attr("value",i.find(".selected").attr("value"))};this.lazyload=function(){o.find("img.lazyload").each(function(){b(this).attr("src",b(this).attr("data-src"));b(this).removeClass("lazyload")})};this.init=function(p){if(p){b.extend(e,p)}this.run()};this.setupFilter=function(r){var p=o.children(".item[value]").filter(function(){return(b(this).attr("value").length)});this._original_options=p.clone(true);var q=b(document.createElement("input")).attr({type:"text","class":"filter placeholder-onkeydown",title:r}).keyup(this.filterKeyUp.bind(this)).click(function(s){s.preventDefault();s.stopPropagation()});Imgur.getInstance().runPlaceholder(q);o.prepend(q)};this.setFilter=function(p,q){if(!p){p=d}if(!this.filter){this.filter=p;this.setupFilter(q)}else{this.filter=p}};this.filterKeyUp=function(r){var q=b(r.target).val();if(!q.length){var p=this.applyFilter(q,n)}else{var p=this.applyFilter(q)}o.find(".item").remove();o.append(p);this.lazyload()};this.applyFilter=function(q,p){p=p||this.filter;return p(q,this._original_options)}};methods={init:function(c){return this.each(function(){var d=new a(b(this));d.init(c);b(this).data("combobox",d)})},filter:function(c){if(!c){c={}}return this.each(function(){var e=b(this);if(e.data("combobox")){var d=e.data("combobox");d.setFilter(c.filter,c.placeholder)}})}};b.fn.combobox=function(c){if(methods[c]){return methods[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return methods.init.apply(this,arguments)}else{return b.error("Method "+c+" does not exist")}}}}(jQuery));
;(function(){var d={supportsFullScreen:false,isFullScreen:function(){return false},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",prefix:""},c="webkit moz o ms khtml".split(" ");if(typeof document.cancelFullScreen!="undefined"){d.supportsFullScreen=true}else{for(var b=0,a=c.length;b<a;b++){d.prefix=c[b];if(typeof document[d.prefix+"CancelFullScreen"]!="undefined"){d.supportsFullScreen=true;break}}}if(d.supportsFullScreen){d.fullScreenEventName=d.prefix+"fullscreenchange";d.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}};d.requestFullScreen=function(e){return(this.prefix==="")?e.requestFullScreen():e[this.prefix+"RequestFullScreen"]()};d.cancelFullScreen=function(e){return(this.prefix==="")?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()}}if(typeof jQuery!="undefined"){jQuery.fn.requestFullScreen=function(){return this.each(function(){if(d.supportsFullScreen){d.requestFullScreen(this)}})}}window.fullScreenApi=d})();
;(function(g){g.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(a,b){g.fx.step[b]=function(c){if(!c.colorInit){c.start=h(c.elem,b);c.end=e(c.end);c.colorInit=true}c.elem.style[b]="rgb("+[Math.max(Math.min(parseInt((c.pos*(c.end[0]-c.start[0]))+c.start[0]),255),0),Math.max(Math.min(parseInt((c.pos*(c.end[1]-c.start[1]))+c.start[1]),255),0),Math.max(Math.min(parseInt((c.pos*(c.end[2]-c.start[2]))+c.start[2]),255),0)].join(",")+")"}});function e(a){var b;if(a&&a.constructor==Array&&a.length==3){return a}if(b=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(a)){return[parseInt(b[1]),parseInt(b[2]),parseInt(b[3])]}if(b=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(a)){return[parseFloat(b[1])*2.55,parseFloat(b[2])*2.55,parseFloat(b[3])*2.55]}if(b=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(a)){return[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]}if(b=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(a)){return[parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16)]}if(b=/rgba\(0, 0, 0, 0\)/.exec(a)){return f.transparent}return f[g.trim(a).toLowerCase()]}function h(a,c){var b;do{b=g.curCSS(a,c);if(b!=""&&b!="transparent"||g.nodeName(a,"body")){break}c="backgroundColor"}while(a=a.parentNode);return e(b)}var f={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]}})(jQuery);function flashElement(b,a){if(typeof(a)=="undefined"){a=100}$(b).animate({backgroundColor:"#85BF25"},a,function(){$(this).animate({backgroundColor:"#181817"},a)})};
;(function(a){a.extend(a.fn,{validate:function(b){if(!this.length){b&&b.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return}var c=a.data(this[0],"validator");if(c){return c}c=new a.validator(b,this[0]);a.data(this[0],"validator",c);if(c.settings.onsubmit){this.find("input, button").filter(".cancel").click(function(){c.cancelSubmit=true});if(c.settings.submitHandler){this.find("input, button").filter(":submit").click(function(){c.submitButton=this})}this.submit(function(d){if(c.settings.debug){d.preventDefault()}function e(){if(c.settings.submitHandler){if(c.submitButton){var f=a("<input type='hidden'/>").attr("name",c.submitButton.name).val(c.submitButton.value).appendTo(c.currentForm)}c.settings.submitHandler.call(c,c.currentForm);if(c.submitButton){f.remove()}return false}return true}if(c.cancelSubmit){c.cancelSubmit=false;return e()}if(c.form()){if(c.pendingRequest){c.formSubmitted=true;return false}return e()}else{c.focusInvalid();return false}})}return c},valid:function(){if(a(this[0]).is("form")){return this.validate().form()}else{var c=true;var b=a(this[0].form).validate();this.each(function(){c&=b.element(this)});return c}},removeAttrs:function(d){var b={},c=this;a.each(d.split(/\s/),function(e,f){b[f]=c.attr(f);c.removeAttr(f)});return b},rules:function(e,b){var g=this[0];if(e){var d=a.data(g.form,"validator").settings;var i=d.rules;var j=a.validator.staticRules(g);switch(e){case"add":a.extend(j,a.validator.normalizeRule(b));i[g.name]=j;if(b.messages){d.messages[g.name]=a.extend(d.messages[g.name],b.messages)}break;case"remove":if(!b){delete i[g.name];return j}var h={};a.each(b.split(/\s/),function(k,l){h[l]=j[l];delete j[l]});return h}}var f=a.validator.normalizeRules(a.extend({},a.validator.metadataRules(g),a.validator.classRules(g),a.validator.attributeRules(g),a.validator.staticRules(g)),g);if(f.required){var c=f.required;delete f.required;f=a.extend({required:c},f)}return f}});a.extend(a.expr[":"],{blank:function(b){return !a.trim(""+b.value)},filled:function(b){return !!a.trim(""+b.value)},unchecked:function(b){return !b.checked}});a.validator=function(b,c){this.settings=a.extend(true,{},a.validator.defaults,b);this.currentForm=c;this.init()};a.validator.format=function(b,c){if(arguments.length==1){return function(){var d=a.makeArray(arguments);d.unshift(b);return a.validator.format.apply(this,d)}}if(arguments.length>2&&c.constructor!=Array){c=a.makeArray(arguments).slice(1)}if(c.constructor!=Array){c=[c]}a.each(c,function(d,e){b=b.replace(new RegExp("\\{"+d+"\\}","g"),e)});return b};a.extend(a.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:a([]),errorLabelContainer:a([]),onsubmit:true,ignore:[],ignoreTitle:false,onfocusin:function(b){this.lastActive=b;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,b,this.settings.errorClass,this.settings.validClass);this.addWrapper(this.errorsFor(b)).hide()}},onfocusout:function(b){if(!this.checkable(b)&&(b.name in this.submitted||!this.optional(b))){this.element(b)}},onkeyup:function(b){if(b.name in this.submitted||b==this.lastElement){this.element(b)}},onclick:function(b){if(b.name in this.submitted){this.element(b)}else{if(b.parentNode.name in this.submitted){this.element(b.parentNode)}}},highlight:function(d,b,c){if(d.type==="radio"){this.findByName(d.name).addClass(b).removeClass(c)}else{a(d).addClass(b).removeClass(c)}},unhighlight:function(d,b,c){if(d.type==="radio"){this.findByName(d.name).removeClass(b).addClass(c)}else{a(d).removeClass(b).addClass(c)}}},setDefaults:function(b){a.extend(a.validator.defaults,b)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:a.validator.format("Please enter no more than {0} characters."),minlength:a.validator.format("Please enter at least {0} characters."),rangelength:a.validator.format("Please enter a value between {0} and {1} characters long."),range:a.validator.format("Please enter a value between {0} and {1}."),max:a.validator.format("Please enter a value less than or equal to {0}."),min:a.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=a(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||a(this.currentForm);this.containers=a(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;
this.pending={};this.invalid={};this.reset();var b=(this.groups={});a.each(this.settings.groups,function(e,f){a.each(f.split(/\s/),function(h,g){b[g]=e})});var d=this.settings.rules;a.each(d,function(e,f){d[e]=a.validator.normalizeRule(f)});function c(g){var f=a.data(this[0].form,"validator"),e="on"+g.type.replace(/^validate/,"");f.settings[e]&&f.settings[e].call(f,this[0])}a(this.currentForm).validateDelegate(":text, :password, :file, select, textarea","focusin focusout keyup",c).validateDelegate(":radio, :checkbox, select, option","click",c);if(this.settings.invalidHandler){a(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)}},form:function(){this.checkForm();a.extend(this.submitted,this.errorMap);this.invalid=a.extend({},this.errorMap);if(!this.valid()){a(this.currentForm).triggerHandler("invalid-form",[this])}this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var b=0,c=(this.currentElements=this.elements());c[b];b++){this.check(c[b])}return this.valid()},element:function(c){c=this.clean(c);this.lastElement=c;this.prepareElement(c);this.currentElements=a(c);var b=this.check(c);if(b){delete this.invalid[c.name]}else{this.invalid[c.name]=true}if(!this.numberOfInvalids()){this.toHide=this.toHide.add(this.containers)}this.showErrors();return b},showErrors:function(c){if(c){a.extend(this.errorMap,c);this.errorList=[];for(var b in c){this.errorList.push({message:c[b],element:this.findByName(b)[0]})}this.successList=a.grep(this.successList,function(d){return !(d.name in c)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){if(a.fn.resetForm){a(this.currentForm).resetForm()}this.submitted={};this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(d){var c=0;for(var b in d){c++}return c},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()==0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid){try{a(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(b){}}},findLastActive:function(){var b=this.lastActive;return b&&a.grep(this.errorList,function(c){return c.element.name==b.name}).length==1&&b},elements:function(){var c=this,b={};return a(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&c.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in b||!c.objectLength(a(this).rules())){return false}b[this.name]=true;return true})},clean:function(b){return a(b)[0]},errors:function(){return a(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=a([]);this.toHide=a([]);this.currentElements=a([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},prepareElement:function(b){this.reset();this.toHide=this.errorsFor(b)},check:function(c){c=this.clean(c);if(this.checkable(c)){c=this.findByName(c.name).not(this.settings.ignore)[0]}var h=a(c).rules();var d=false;for(var i in h){var g={method:i,parameters:h[i]};try{var b=a.validator.methods[i].call(this,c.value.replace(/\r/g,""),c,g.parameters);if(b=="dependency-mismatch"){d=true;continue}d=false;if(b=="pending"){this.toHide=this.toHide.not(this.errorsFor(c));return}if(!b){this.formatAndAdd(c,g);return false}}catch(f){this.settings.debug&&window.console&&console.log("exception occured when checking element "+c.id+", check the '"+g.method+"' method",f);throw f}}if(d){return}if(this.objectLength(h)){this.successList.push(c)}return true},customMetaMessage:function(b,d){if(!a.metadata){return}var c=this.settings.meta?a(b).metadata()[this.settings.meta]:a(b).metadata();return c&&c.messages&&c.messages[d]},customMessage:function(c,d){var b=this.settings.messages[c];return b&&(b.constructor==String?b:b[d])},findDefined:function(){for(var b=0;b<arguments.length;b++){if(arguments[b]!==undefined){return arguments[b]}}return undefined},defaultMessage:function(b,c){return this.findDefined(this.customMessage(b.name,c),this.customMetaMessage(b,c),!this.settings.ignoreTitle&&b.title||undefined,a.validator.messages[c],"<strong>Warning: No message defined for "+b.name+"</strong>")},formatAndAdd:function(c,e){var d=this.defaultMessage(c,e.method),b=/\$?\{(\d+)\}/g;if(typeof d=="function"){d=d.call(this,e.parameters,c)}else{if(b.test(d)){d=jQuery.format(d.replace(b,"{$1}"),e.parameters)}}this.errorList.push({message:d,element:c});this.errorMap[c.name]=d;this.submitted[c.name]=d},addWrapper:function(b){if(this.settings.wrapper){b=b.add(b.parent(this.settings.wrapper))}return b},defaultShowErrors:function(){for(var c=0;
this.errorList[c];c++){var b=this.errorList[c];this.settings.highlight&&this.settings.highlight.call(this,b.element,this.settings.errorClass,this.settings.validClass);this.showLabel(b.element,b.message)}if(this.errorList.length){this.toShow=this.toShow.add(this.containers)}if(this.settings.success){for(var c=0;this.successList[c];c++){this.showLabel(this.successList[c])}}if(this.settings.unhighlight){for(var c=0,d=this.validElements();d[c];c++){this.settings.unhighlight.call(this,d[c],this.settings.errorClass,this.settings.validClass)}}this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return a(this.errorList).map(function(){return this.element})},showLabel:function(c,d){var b=this.errorsFor(c);if(b.length){b.removeClass().addClass(this.settings.errorClass);b.attr("generated")&&b.html(d)}else{b=a("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(c),generated:true}).addClass(this.settings.errorClass).html(d||"");if(this.settings.wrapper){b=b.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()}if(!this.labelContainer.append(b).length){this.settings.errorPlacement?this.settings.errorPlacement(b,a(c)):b.insertAfter(c)}}if(!d&&this.settings.success){b.text("");typeof this.settings.success=="string"?b.addClass(this.settings.success):this.settings.success(b)}this.toShow=this.toShow.add(b)},errorsFor:function(c){var b=this.idOrName(c);return this.errors().filter(function(){return a(this).attr("for")==b})},idOrName:function(b){return this.groups[b.name]||(this.checkable(b)?b.name:b.id||b.name)},checkable:function(b){return/radio|checkbox/i.test(b.type)},findByName:function(b){var c=this.currentForm;return a(document.getElementsByName(b)).map(function(d,e){return e.form==c&&e.name==b&&e||null})},getLength:function(c,b){switch(b.nodeName.toLowerCase()){case"select":return a("option:selected",b).length;case"input":if(this.checkable(b)){return this.findByName(b.name).filter(":checked").length}}return c.length},depend:function(c,b){return this.dependTypes[typeof c]?this.dependTypes[typeof c](c,b):true},dependTypes:{"boolean":function(c,b){return c},string:function(c,b){return !!a(c,b.form).length},"function":function(c,b){return c(b)}},optional:function(b){return !a.validator.methods.required.call(this,a.trim(b.value),b)&&"dependency-mismatch"},startRequest:function(b){if(!this.pending[b.name]){this.pendingRequest++;this.pending[b.name]=true}},stopRequest:function(b,c){this.pendingRequest--;if(this.pendingRequest<0){this.pendingRequest=0}delete this.pending[b.name];if(c&&this.pendingRequest==0&&this.formSubmitted&&this.form()){a(this.currentForm).submit();this.formSubmitted=false}else{if(!c&&this.pendingRequest==0&&this.formSubmitted){a(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=false}}},previousValue:function(b){return a.data(b,"previousValue")||a.data(b,"previousValue",{old:null,valid:true,message:this.defaultMessage(b,"remote")})}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(b,c){b.constructor==String?this.classRuleSettings[b]=c:a.extend(this.classRuleSettings,b)},classRules:function(c){var d={};var b=a(c).attr("class");b&&a.each(b.split(" "),function(){if(this in a.validator.classRuleSettings){a.extend(d,a.validator.classRuleSettings[this])}});return d},attributeRules:function(c){var e={};var b=a(c);for(var f in a.validator.methods){var d=b.attr(f);if(d){e[f]=d}}if(e.maxlength&&/-1|2147483647|524288/.test(e.maxlength)){delete e.maxlength}return e},metadataRules:function(b){if(!a.metadata){return{}}var c=a.data(b.form,"validator").settings.meta;return c?a(b).metadata()[c]:a(b).metadata()},staticRules:function(c){var d={};var b=a.data(c.form,"validator");if(b.settings.rules){d=a.validator.normalizeRule(b.settings.rules[c.name])||{}}return d},normalizeRules:function(c,b){a.each(c,function(f,e){if(e===false){delete c[f];return}if(e.param||e.depends){var d=true;switch(typeof e.depends){case"string":d=!!a(e.depends,b.form).length;break;case"function":d=e.depends.call(b,b);break}if(d){c[f]=e.param!==undefined?e.param:true}else{delete c[f]}}});a.each(c,function(d,e){c[d]=a.isFunction(e)?e(b):e});a.each(["minlength","maxlength","min","max"],function(){if(c[this]){c[this]=Number(c[this])}});a.each(["rangelength","range"],function(){if(c[this]){c[this]=[Number(c[this][0]),Number(c[this][1])]}});if(a.validator.autoCreateRanges){if(c.min&&c.max){c.range=[c.min,c.max];delete c.min;delete c.max}if(c.minlength&&c.maxlength){c.rangelength=[c.minlength,c.maxlength];delete c.minlength;delete c.maxlength}}if(c.messages){delete c.messages}return c},normalizeRule:function(c){if(typeof c=="string"){var b={};a.each(c.split(/\s/),function(){b[this]=true
});c=b}return c},addMethod:function(b,d,c){a.validator.methods[b]=d;a.validator.messages[b]=c!=undefined?c:a.validator.messages[b];if(d.length<3){a.validator.addClassRules(b,a.validator.normalizeRule(b))}},methods:{required:function(c,b,e){if(!this.depend(e,b)){return"dependency-mismatch"}switch(b.nodeName.toLowerCase()){case"select":var d=a(b).val();return d&&d.length>0;case"input":if(this.checkable(b)){return this.getLength(c,b)>0}default:return a.trim(c).length>0}},remote:function(f,c,g){if(this.optional(c)){return"dependency-mismatch"}var d=this.previousValue(c);if(!this.settings.messages[c.name]){this.settings.messages[c.name]={}}d.originalMessage=this.settings.messages[c.name].remote;this.settings.messages[c.name].remote=d.message;g=typeof g=="string"&&{url:g}||g;if(this.pending[c.name]){return"pending"}if(d.old===f){return d.valid}d.old=f;var b=this;this.startRequest(c);var e={};e[c.name]=f;a.ajax(a.extend(true,{url:g,mode:"abort",port:"validate"+c.name,dataType:"json",data:e,success:function(i){b.settings.messages[c.name].remote=d.originalMessage;var k=i===true;if(k){var h=b.formSubmitted;b.prepareElement(c);b.formSubmitted=h;b.successList.push(c);b.showErrors()}else{var l={};var j=i||b.defaultMessage(c,"remote");l[c.name]=d.message=a.isFunction(j)?j(f):j;b.showErrors(l)}d.valid=k;b.stopRequest(c,k)}},g));return"pending"},minlength:function(c,b,d){return this.optional(b)||this.getLength(a.trim(c),b)>=d},maxlength:function(c,b,d){return this.optional(b)||this.getLength(a.trim(c),b)<=d},rangelength:function(d,b,e){var c=this.getLength(a.trim(d),b);return this.optional(b)||(c>=e[0]&&c<=e[1])},min:function(c,b,d){return this.optional(b)||c>=d},max:function(c,b,d){return this.optional(b)||c<=d},range:function(c,b,d){return this.optional(b)||(c>=d[0]&&c<=d[1])},email:function(c,b){return this.optional(b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(c)},url:function(c,b){return this.optional(b)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(c)},date:function(c,b){return this.optional(b)||!/Invalid|NaN/.test(new Date(c))},dateISO:function(c,b){return this.optional(b)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(c)},number:function(c,b){return this.optional(b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(c)},digits:function(c,b){return this.optional(b)||/^\d+$/.test(c)},creditcard:function(f,c){if(this.optional(c)){return"dependency-mismatch"}if(/[^0-9-]+/.test(f)){return false}var g=0,e=0,b=false;f=f.replace(/\D/g,"");for(var h=f.length-1;h>=0;h--){var d=f.charAt(h);var e=parseInt(d,10);if(b){if((e*=2)>9){e-=9}}g+=e;b=!b}return(g%10)==0},accept:function(c,b,d){d=typeof d=="string"?d.replace(/,/g,"|"):"png|jpe?g|gif";return this.optional(b)||c.match(new RegExp(".("+d+")$","i"))},equalTo:function(c,b,e){var d=a(e).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){a(b).valid()});return c==d.val()}}});a.format=a.validator.format})(jQuery);(function(c){var a={};if(c.ajaxPrefilter){c.ajaxPrefilter(function(f,e,g){var d=f.port;
if(f.mode=="abort"){if(a[d]){a[d].abort()}a[d]=g}})}else{var b=c.ajax;c.ajax=function(e){var f=("mode" in e?e:c.ajaxSettings).mode,d=("port" in e?e:c.ajaxSettings).port;if(f=="abort"){if(a[d]){a[d].abort()}return(a[d]=b.apply(this,arguments))}return b.apply(this,arguments)}}})(jQuery);(function(a){if(!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener){a.each({focus:"focusin",blur:"focusout"},function(c,b){a.event.special[b]={setup:function(){this.addEventListener(c,d,true)},teardown:function(){this.removeEventListener(c,d,true)},handler:function(f){arguments[0]=a.event.fix(f);arguments[0].type=b;return a.event.handle.apply(this,arguments)}};function d(f){f=a.event.fix(f);f.type=b;return a.event.handle.call(this,f)}})}a.extend(a.fn,{validateDelegate:function(d,c,b){return this.bind(c,function(e){var f=a(e.target);if(f.is(d)){return b.apply(f,arguments)}})}})})(jQuery);
;(function(b){var a=function(){var c={},n={years:"datepickerViewYears",moths:"datepickerViewMonths",days:"datepickerViewDays"},k={wrapper:'<div class="datepicker"><div class="datepickerBorderT" /><div class="datepickerBorderB" /><div class="datepickerBorderL" /><div class="datepickerBorderR" /><div class="datepickerBorderTL" /><div class="datepickerBorderTR" /><div class="datepickerBorderBL" /><div class="datepickerBorderBR" /><div class="datepickerContainer"><table cellspacing="0" cellpadding="0"><tbody><tr></tr></tbody></table></div></div>',head:["<td>",'<table cellspacing="0" cellpadding="0">',"<thead>","<tr>",'<th class="datepickerGoPrev"><a href="#"><span><%=prev%></span></a></th>','<th colspan="5" class="datepickerMonth"><a href="#"><span></span></a></th>','<th class="datepickerGoNext"><a href="#"><span><%=next%></span></a></th>',"</tr>",'<tr class="datepickerDoW">',"<th><span><%=day1%></span></th>","<th><span><%=day2%></span></th>","<th><span><%=day3%></span></th>","<th><span><%=day4%></span></th>","<th><span><%=day5%></span></th>","<th><span><%=day6%></span></th>","<th><span><%=day7%></span></th>","</tr>","</thead>","</table></td>"],space:'<td class="datepickerSpace"><div></div></td>',days:['<tbody class="datepickerDays">',"<tr>",'<td class="<%=weeks[0].days[0].classname%>"><a href="#"><span><%=weeks[0].days[0].text%></span></a></td>','<td class="<%=weeks[0].days[1].classname%>"><a href="#"><span><%=weeks[0].days[1].text%></span></a></td>','<td class="<%=weeks[0].days[2].classname%>"><a href="#"><span><%=weeks[0].days[2].text%></span></a></td>','<td class="<%=weeks[0].days[3].classname%>"><a href="#"><span><%=weeks[0].days[3].text%></span></a></td>','<td class="<%=weeks[0].days[4].classname%>"><a href="#"><span><%=weeks[0].days[4].text%></span></a></td>','<td class="<%=weeks[0].days[5].classname%>"><a href="#"><span><%=weeks[0].days[5].text%></span></a></td>','<td class="<%=weeks[0].days[6].classname%>"><a href="#"><span><%=weeks[0].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[1].days[0].classname%>"><a href="#"><span><%=weeks[1].days[0].text%></span></a></td>','<td class="<%=weeks[1].days[1].classname%>"><a href="#"><span><%=weeks[1].days[1].text%></span></a></td>','<td class="<%=weeks[1].days[2].classname%>"><a href="#"><span><%=weeks[1].days[2].text%></span></a></td>','<td class="<%=weeks[1].days[3].classname%>"><a href="#"><span><%=weeks[1].days[3].text%></span></a></td>','<td class="<%=weeks[1].days[4].classname%>"><a href="#"><span><%=weeks[1].days[4].text%></span></a></td>','<td class="<%=weeks[1].days[5].classname%>"><a href="#"><span><%=weeks[1].days[5].text%></span></a></td>','<td class="<%=weeks[1].days[6].classname%>"><a href="#"><span><%=weeks[1].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[2].days[0].classname%>"><a href="#"><span><%=weeks[2].days[0].text%></span></a></td>','<td class="<%=weeks[2].days[1].classname%>"><a href="#"><span><%=weeks[2].days[1].text%></span></a></td>','<td class="<%=weeks[2].days[2].classname%>"><a href="#"><span><%=weeks[2].days[2].text%></span></a></td>','<td class="<%=weeks[2].days[3].classname%>"><a href="#"><span><%=weeks[2].days[3].text%></span></a></td>','<td class="<%=weeks[2].days[4].classname%>"><a href="#"><span><%=weeks[2].days[4].text%></span></a></td>','<td class="<%=weeks[2].days[5].classname%>"><a href="#"><span><%=weeks[2].days[5].text%></span></a></td>','<td class="<%=weeks[2].days[6].classname%>"><a href="#"><span><%=weeks[2].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[3].days[0].classname%>"><a href="#"><span><%=weeks[3].days[0].text%></span></a></td>','<td class="<%=weeks[3].days[1].classname%>"><a href="#"><span><%=weeks[3].days[1].text%></span></a></td>','<td class="<%=weeks[3].days[2].classname%>"><a href="#"><span><%=weeks[3].days[2].text%></span></a></td>','<td class="<%=weeks[3].days[3].classname%>"><a href="#"><span><%=weeks[3].days[3].text%></span></a></td>','<td class="<%=weeks[3].days[4].classname%>"><a href="#"><span><%=weeks[3].days[4].text%></span></a></td>','<td class="<%=weeks[3].days[5].classname%>"><a href="#"><span><%=weeks[3].days[5].text%></span></a></td>','<td class="<%=weeks[3].days[6].classname%>"><a href="#"><span><%=weeks[3].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[4].days[0].classname%>"><a href="#"><span><%=weeks[4].days[0].text%></span></a></td>','<td class="<%=weeks[4].days[1].classname%>"><a href="#"><span><%=weeks[4].days[1].text%></span></a></td>','<td class="<%=weeks[4].days[2].classname%>"><a href="#"><span><%=weeks[4].days[2].text%></span></a></td>','<td class="<%=weeks[4].days[3].classname%>"><a href="#"><span><%=weeks[4].days[3].text%></span></a></td>','<td class="<%=weeks[4].days[4].classname%>"><a href="#"><span><%=weeks[4].days[4].text%></span></a></td>','<td class="<%=weeks[4].days[5].classname%>"><a href="#"><span><%=weeks[4].days[5].text%></span></a></td>','<td class="<%=weeks[4].days[6].classname%>"><a href="#"><span><%=weeks[4].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[5].days[0].classname%>"><a href="#"><span><%=weeks[5].days[0].text%></span></a></td>','<td class="<%=weeks[5].days[1].classname%>"><a href="#"><span><%=weeks[5].days[1].text%></span></a></td>','<td class="<%=weeks[5].days[2].classname%>"><a href="#"><span><%=weeks[5].days[2].text%></span></a></td>','<td class="<%=weeks[5].days[3].classname%>"><a href="#"><span><%=weeks[5].days[3].text%></span></a></td>','<td class="<%=weeks[5].days[4].classname%>"><a href="#"><span><%=weeks[5].days[4].text%></span></a></td>','<td class="<%=weeks[5].days[5].classname%>"><a href="#"><span><%=weeks[5].days[5].text%></span></a></td>','<td class="<%=weeks[5].days[6].classname%>"><a href="#"><span><%=weeks[5].days[6].text%></span></a></td>',"</tr>","</tbody>"],months:['<tbody class="<%=className%>">',"<tr>",'<td colspan="2"><a href="#"><span><%=data[0]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[1]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[2]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[3]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[4]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[5]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[6]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[7]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[8]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[9]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[10]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[11]%></span></a></td>',"</tr>","</tbody>"]},g={flat:false,starts:1,prev:"&#9664;",next:"&#9654;",lastSel:false,mode:"single",view:"days",calendars:1,format:"Y-m-d",position:"bottom",eventName:"click",onRender:function(){return{}
},onChange:function(){return true},onShow:function(){return true},onBeforeShow:function(){return true},onHide:function(){return true},locale:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekMin:"wk"}},p=function(r){var u=b(r).data("datepicker");var y=b(r);var s=Math.floor(u.calendars/2),G,I,z,H,E=0,C,v,t,w,x,A;y.find("td>table tbody").remove();for(var F=0;F<u.calendars;F++){G=new Date(u.current);G.addMonths(-s+F);A=y.find("table").eq(F+1);switch(A[0].className){case"datepickerViewDays":z=q(G,"B, Y");break;case"datepickerViewMonths":z=G.getFullYear();break;case"datepickerViewYears":z=(G.getFullYear()-6)+" - "+(G.getFullYear()+5);break}A.find("thead tr:first th:eq(1) span").text(z);z=G.getFullYear()-6;I={data:[],className:"datepickerYears"};for(var D=0;D<12;D++){I.data.push(z+D)}x=tmpl(k.months.join(""),I);G.setDate(1);I={weeks:[],test:10};H=G.getMonth();var z=(G.getDay()-u.starts)%7;G.addDays(-(z+(z<0?7:0)));C=-1;E=0;while(E<42){t=parseInt(E/7,10);w=E%7;if(!I.weeks[t]){C=G.getWeekNumber();I.weeks[t]={week:C,days:[]}}I.weeks[t].days[w]={text:G.getDate(),classname:[]};if(H!=G.getMonth()){I.weeks[t].days[w].classname.push("datepickerNotInMonth")}if(G.getDay()==0){I.weeks[t].days[w].classname.push("datepickerSunday")}if(G.getDay()==6){I.weeks[t].days[w].classname.push("datepickerSaturday")}var B=u.onRender(G);var J=G.valueOf();if(B.selected||u.date==J||b.inArray(J,u.date)>-1||(u.mode=="range"&&J>=u.date[0]&&J<=u.date[1])){I.weeks[t].days[w].classname.push("datepickerSelected")}if(B.disabled){I.weeks[t].days[w].classname.push("datepickerDisabled")}if(B.className){I.weeks[t].days[w].classname.push(B.className)}I.weeks[t].days[w].classname=I.weeks[t].days[w].classname.join(" ");E++;G.addDays(1)}x=tmpl(k.days.join(""),I)+x;I={data:u.locale.monthsShort,className:"datepickerMonths"};x=tmpl(k.months.join(""),I)+x;A.append(x)}},e=function(s,C){if(s.constructor==Date){return new Date(s)}var w=s.split(/\W+/);var t=C.split(/\W+/),A,u,B,z,v,r=new Date();for(var x=0;x<w.length;x++){switch(t[x]){case"d":case"e":A=parseInt(w[x],10);break;case"m":u=parseInt(w[x],10)-1;break;case"Y":case"y":B=parseInt(w[x],10);B+=B>100?0:(B<29?2000:1900);break;case"H":case"I":case"k":case"l":z=parseInt(w[x],10);break;case"P":case"p":if(/pm/i.test(w[x])&&z<12){z+=12}else{if(/am/i.test(w[x])&&z>=12){z-=12}}break;case"M":v=parseInt(w[x],10);break}}return new Date(B===undefined?r.getFullYear():B,u===undefined?r.getMonth():u,A===undefined?r.getDate():A,z===undefined?r.getHours():z,v===undefined?r.getMinutes():v,0)},q=function(t,F){var u=t.getMonth();var D=t.getDate();var E=t.getFullYear();var G=t.getWeekNumber();var H=t.getDay();var K={};var I=t.getHours();var v=(I>=12);var B=(v)?(I-12):I;var J=t.getDayOfYear();if(B==0){B=12}var z=t.getMinutes();var C=t.getSeconds();var x=F.split(""),r;for(var A=0;A<x.length;A++){r=x[A];switch(x[A]){case"a":r=t.getDayName();break;case"A":r=t.getDayName(true);break;case"b":r=t.getMonthName();break;case"B":r=t.getMonthName(true);break;case"C":r=1+Math.floor(E/100);break;case"d":r=(D<10)?("0"+D):D;break;case"e":r=D;break;case"H":r=(I<10)?("0"+I):I;break;case"I":r=(B<10)?("0"+B):B;break;case"j":r=(J<100)?((J<10)?("00"+J):("0"+J)):J;break;case"k":r=I;break;case"l":r=B;break;case"m":r=(u<9)?("0"+(1+u)):(1+u);break;case"M":r=(z<10)?("0"+z):z;break;case"p":case"P":r=v?"PM":"AM";break;case"s":r=Math.floor(t.getTime()/1000);break;case"S":r=(C<10)?("0"+C):C;break;case"u":r=H+1;break;case"w":r=H;break;case"y":r=(""+E).substr(2,2);break;case"Y":r=E;break}x[A]=r}return x.join("")},f=function(r){if(Date.prototype.tempDate){return}Date.prototype.tempDate=null;Date.prototype.months=r.months;Date.prototype.monthsShort=r.monthsShort;Date.prototype.days=r.days;Date.prototype.daysShort=r.daysShort;Date.prototype.getMonthName=function(s){return this[s?"months":"monthsShort"][this.getMonth()]};Date.prototype.getDayName=function(s){return this[s?"days":"daysShort"][this.getDay()]};Date.prototype.addDays=function(s){this.setDate(this.getDate()+s);this.tempDate=this.getDate()};Date.prototype.addMonths=function(s){if(this.tempDate==null){this.tempDate=this.getDate()}this.setDate(1);this.setMonth(this.getMonth()+s);this.setDate(Math.min(this.tempDate,this.getMaxDays()))};Date.prototype.addYears=function(s){if(this.tempDate==null){this.tempDate=this.getDate()}this.setDate(1);this.setFullYear(this.getFullYear()+s);this.setDate(Math.min(this.tempDate,this.getMaxDays()))};Date.prototype.getMaxDays=function(){var t=new Date(Date.parse(this)),u=28,s;s=t.getMonth();u=28;while(t.getMonth()==s){u++;t.setDate(u)}return u-1};Date.prototype.getFirstDay=function(){var s=new Date(Date.parse(this));s.setDate(1);
return s.getDay()};Date.prototype.getWeekNumber=function(){var s=new Date(this);s.setDate(s.getDate()-(s.getDay()+6)%7+3);var t=s.valueOf();s.setMonth(0);s.setDate(4);return Math.round((t-s.valueOf())/(604800000))+1};Date.prototype.getDayOfYear=function(){var s=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var u=new Date(this.getFullYear(),0,0,0,0,0);var t=s-u;return Math.floor(t/24*60*60*1000)}},i=function(v){var s=b(v).data("datepicker");var x=b("#"+s.id);if(!s.extraHeight){var u=b(v).find("div");s.extraHeight=u.get(0).offsetHeight+u.get(1).offsetHeight;s.extraWidth=u.get(2).offsetWidth+u.get(3).offsetWidth}var w=x.find("table:first").get(0);var t=w.offsetWidth;var r=w.offsetHeight;x.css({width:t+s.extraWidth+"px",height:r+s.extraHeight+"px"}).find("div.datepickerContainer").css({width:t+"px",height:r+"px"})},o=function(y){if(b(y.target).is("span")){y.target=y.target.parentNode}var t=b(y.target);if(t.is("a")){y.target.blur();if(t.hasClass("datepickerDisabled")){return false}var A=b(this).data("datepicker");var x=t.parent();var s=x.parent().parent().parent();var z=b("table",this).index(s.get(0))-1;var w=new Date(A.current);var v=false;var r=false;if(x.is("th")){if(x.hasClass("datepickerWeek")&&A.mode=="range"&&!x.next().hasClass("datepickerDisabled")){var u=parseInt(x.next().text(),10);w.addMonths(z-Math.floor(A.calendars/2));if(x.next().hasClass("datepickerNotInMonth")){w.addMonths(u>15?-1:1)}w.setDate(u);A.date[0]=(w.setHours(0,0,0,0)).valueOf();w.setHours(23,59,59,0);w.addDays(6);A.date[1]=w.valueOf();r=true;v=true;A.lastSel=false}else{if(x.hasClass("datepickerMonth")){w.addMonths(z-Math.floor(A.calendars/2));switch(s.get(0).className){case"datepickerViewDays":s.get(0).className="datepickerViewMonths";t.find("span").text(w.getFullYear());break;case"datepickerViewMonths":s.get(0).className="datepickerViewYears";t.find("span").text((w.getFullYear()-6)+" - "+(w.getFullYear()+5));break;case"datepickerViewYears":s.get(0).className="datepickerViewDays";t.find("span").text(q(w,"B, Y"));break}}else{if(x.parent().parent().is("thead")){switch(s.get(0).className){case"datepickerViewDays":A.current.addMonths(x.hasClass("datepickerGoPrev")?-1:1);break;case"datepickerViewMonths":A.current.addYears(x.hasClass("datepickerGoPrev")?-1:1);break;case"datepickerViewYears":A.current.addYears(x.hasClass("datepickerGoPrev")?-12:12);break}r=true}}}}else{if(x.is("td")&&!x.hasClass("datepickerDisabled")){switch(s.get(0).className){case"datepickerViewMonths":A.current.setMonth(s.find("tbody.datepickerMonths td").index(x));A.current.setFullYear(parseInt(s.find("thead th.datepickerMonth span").text(),10));A.current.addMonths(Math.floor(A.calendars/2)-z);s.get(0).className="datepickerViewDays";break;case"datepickerViewYears":A.current.setFullYear(parseInt(t.text(),10));s.get(0).className="datepickerViewMonths";break;default:var u=parseInt(t.text(),10);w.addMonths(z-Math.floor(A.calendars/2));if(x.hasClass("datepickerNotInMonth")){w.addMonths(u>15?-1:1)}w.setDate(u);switch(A.mode){case"multiple":u=(w.setHours(0,0,0,0)).valueOf();if(b.inArray(u,A.date)>-1){b.each(A.date,function(B,C){if(C==u){A.date.splice(B,1);return false}})}else{A.date.push(u)}break;case"range":if(!A.lastSel){A.date[0]=(w.setHours(0,0,0,0)).valueOf()}u=(w.setHours(23,59,59,0)).valueOf();if(u<A.date[0]){A.date[1]=A.date[0]+86399000;A.date[0]=u-86399000}else{A.date[1]=u}A.lastSel=!A.lastSel;break;default:A.date=w.valueOf();break}break}r=true;v=true}}if(r){p(this)}if(v){A.onChange.apply(this,j(A))}}return false},j=function(r){var s;if(r.mode=="single"){s=new Date(r.date);return[q(s,r.format),s,r.el]}else{s=[[],[],r.el];b.each(r.date,function(u,v){var t=new Date(v);s[0].push(q(t,r.format));s[1].push(t)});return s}},d=function(){var r=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(r?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(r?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(r?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(r?document.documentElement.clientHeight:document.body.clientHeight)}},l=function(t,s,r){if(t==s){return true}if(t.contains){return t.contains(s)}if(t.compareDocumentPosition){return !!(t.compareDocumentPosition(s)&16)}var u=s.parentNode;while(u&&u!=r){if(u==t){return true}u=u.parentNode}return false},m=function(w){var r=b("#"+b(this).data("datepickerId"));if(!r.is(":visible")){var x=r.get(0);p(x);var z=r.data("datepicker");z.onBeforeShow.apply(this,[r.get(0)]);var u=b(this).offset();var y=d();var v=u.top;var s=u.left;var t=b.curCSS(x,"display");r.css({visibility:"hidden",display:"block"});i(x);switch(z.position){case"top":v-=x.offsetHeight;break;case"left":s-=x.offsetWidth;break;case"right":s+=this.offsetWidth;break;case"bottom":v+=this.offsetHeight;break}if(v+x.offsetHeight>y.t+y.h){v=u.top-x.offsetHeight}if(v<y.t){v=u.top+this.offsetHeight+x.offsetHeight}if(s+x.offsetWidth>y.l+y.w){s=u.left-x.offsetWidth
}if(s<y.l){s=u.left+this.offsetWidth}r.css({visibility:"visible",display:"block",top:v+"px",left:s+"px"});if(z.onShow.apply(this,[r.get(0)])!=false){r.show()}b(document).bind("mousedown",{cal:r,trigger:this},h)}return false},h=function(r){if(r.target!=r.data.trigger&&!l(r.data.cal.get(0),r.target,r.data.cal.get(0))){if(r.data.cal.data("datepicker").onHide.apply(this,[r.data.cal.get(0)])!=false){r.data.cal.hide()}b(document).unbind("mousedown",h)}};return{init:function(r){r=b.extend({},g,r||{});f(r.locale);r.calendars=Math.max(1,parseInt(r.calendars,10)||1);r.mode=/single|multiple|range/.test(r.mode)?r.mode:"single";return this.each(function(){if(!b(this).data("datepicker")){r.el=this;if(r.date.constructor==String){r.date=e(r.date,r.format);r.date.setHours(0,0,0,0)}if(r.mode!="single"){if(r.date.constructor!=Array){r.date=[r.date.valueOf()];if(r.mode=="range"){r.date.push(((new Date(r.date[0])).setHours(23,59,59,0)).valueOf())}}else{for(var u=0;u<r.date.length;u++){r.date[u]=(e(r.date[u],r.format).setHours(0,0,0,0)).valueOf()}if(r.mode=="range"){r.date[1]=((new Date(r.date[1])).setHours(23,59,59,0)).valueOf()}}}else{r.date=r.date.valueOf()}if(!r.current){r.current=new Date()}else{r.current=e(r.current,r.format)}r.current.setDate(1);r.current.setHours(0,0,0,0);var w="datepicker_"+parseInt(Math.random()*1000),t;r.id=w;b(this).data("datepickerId",r.id);var v=b(k.wrapper).attr("id",w).bind("click",o).data("datepicker",r);if(r.className){v.addClass(r.className)}var s="";for(var u=0;u<r.calendars;u++){t=r.starts;if(u>0){s+=k.space}s+=tmpl(k.head.join(""),{week:r.locale.weekMin,prev:r.prev,next:r.next,day1:r.locale.daysMin[(t++)%7],day2:r.locale.daysMin[(t++)%7],day3:r.locale.daysMin[(t++)%7],day4:r.locale.daysMin[(t++)%7],day5:r.locale.daysMin[(t++)%7],day6:r.locale.daysMin[(t++)%7],day7:r.locale.daysMin[(t++)%7]})}v.find("tr:first").append(s).find("table").addClass(n[r.view]);p(v.get(0));if(r.flat){v.appendTo(this).show().css("position","relative");i(v.get(0))}else{v.appendTo(document.body);b(this).bind(r.eventName,m)}}})},showPicker:function(){return this.each(function(){if(b(this).data("datepickerId")){m.apply(this)}})},hidePicker:function(){return this.each(function(){if(b(this).data("datepickerId")){b("#"+b(this).data("datepickerId")).hide()}})},setDate:function(r,s){return this.each(function(){if(b(this).data("datepickerId")){var v=b("#"+b(this).data("datepickerId"));var t=v.data("datepicker");t.date=r;if(t.date.constructor==String){t.date=e(t.date,t.format);t.date.setHours(0,0,0,0)}if(t.mode!="single"){if(t.date.constructor!=Array){t.date=[t.date.valueOf()];if(t.mode=="range"){t.date.push(((new Date(t.date[0])).setHours(23,59,59,0)).valueOf())}}else{for(var u=0;u<t.date.length;u++){t.date[u]=(e(t.date[u],t.format).setHours(0,0,0,0)).valueOf()}if(t.mode=="range"){t.date[1]=((new Date(t.date[1])).setHours(23,59,59,0)).valueOf()}}}else{t.date=t.date.valueOf()}if(s){t.current=new Date(t.mode!="single"?t.date[0]:t.date)}p(v.get(0))}})},getDate:function(r){if(this.size()>0){return j(b("#"+b(this).data("datepickerId")).data("datepicker"))[r?0:1]}},clear:function(){return this.each(function(){if(b(this).data("datepickerId")){var s=b("#"+b(this).data("datepickerId"));var r=s.data("datepicker");if(r.mode!="single"){r.date=[];p(s.get(0))}}})},fixLayout:function(){return this.each(function(){if(b(this).data("datepickerId")){var s=b("#"+b(this).data("datepickerId"));var r=s.data("datepicker");if(r.flat){i(s.get(0))}}})}}}();b.fn.extend({DatePicker:a.init,DatePickerHide:a.hidePicker,DatePickerShow:a.showPicker,DatePickerSetDate:a.setDate,DatePickerGetDate:a.getDate,DatePickerClear:a.clear,DatePickerLayout:a.fixLayout})})(jQuery);(function(){var b={};this.tmpl=function a(e,d){var c=!/\W/.test(e)?b[e]=b[e]||a(document.getElementById(e).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return d?c(d):c}})();
;Namespace("Imgur.History");Imgur.History=Class.extend({init:function(a){this._=$.extend({popStates:{}},a);this.onPopState()},onPopState:function(){var a=this;window.onpopstate=function(c){try{a._.popStates[c.state].call(this,c)}catch(b){}}},addPopState:function(b,a){this._.popStates[b]=a},removePopState:function(a){delete this._.popStates[a]},addWindowState:function(b,c,a){if(window.history.replaceState){if(!window.history.state){window.history.replaceState(b,"initial",window.location.href)}window.history.pushState(b,c,a)}}});Class.addSingleton(Imgur.History);
;Namespace("Imgur.InfiniteScroll");Imgur.InfiniteScroll=Class.extend({init:function(a){this._=$.extend(true,{speed:200,height:300,cont:true},a)},levelReached:function(){var c=Math.max(document.body.scrollHeight||document.body.offsetHeight);var a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0;var b=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;if(c==0){return false}else{return c-a-b<this._.height}},stopInfiniteScroll:function(){this._.cont=false},continueInfiniteScroll:function(){this._.cont=true},infiniteScroll:function(a){if(this.levelReached()){if(this._.cont){a.call()}}else{if(this._.cont){this.pollLevel(a)}}},pollLevel:function(a){var b=this;setTimeout(function(){b.infiniteScroll(a)},this._.speed)}});Class.addSingleton(Imgur.InfiniteScroll);
;Namespace("Imgur.Utilities.ColorboxConfirm");Imgur.Utilities.ColorboxConfirm=Class.extend({init:function(a){this._=$.extend(true,{el:{"$confirmation":$(".colorbox-confirm"),"$noConfirm":$(".colorbox-no-confirm"),confirmed:"colorbox-confirmed"}},a);this.setupHandlers()},setupHandlers:function(){this._.el.$confirmation.unbind("click");this._.el.$noConfirm.unbind("click");var a=this;this._.el.$confirmation.click(function(){$("."+a._.el.confirmed).val(true);$.colorbox.close()});this._.el.$noConfirm.click(function(){$.colorbox.close()})},show:function(c,a){var b=this;$.colorbox.init();$.colorbox({href:$(c),open:true,inline:true,top:"15%",transition:"none",scrolling:false,onComplete:function(){b.onComplete(c)},onClosed:function(){b.onClose(c,a)}})},onComplete:function(b){if(window.getSelection){window.getSelection().removeAllRanges()}else{if(document.selection){document.selection.empty()}}var a=$(b).children("."+this._.el.confirmed);if(!a.length){a=$("<input/>",{type:"hidden","class":this._.el.confirmed});$(b).append(a)}a.val(false)},onClose:function(c,a){var b=$(c).children("."+this._.el.confirmed);if(b.val()!=="false"){a.call()}}});Class.addSingleton(Imgur.Utilities.ColorboxConfirm);
;Namespace("Imgur.ShareButtons");Imgur.ShareButtons=Imgur.extend({init:function(a){this._=$.extend({resetUrl:false,shareButtonClass:"addthis_button",addthisTimeout:null},a);this._super(this._);this.bindButtons()},elements:{$shareButtons:$(".social"),$social:$("#social")},getAddthisConfig:function(){return{pubid:"imgur",username:"imgur",ui_click:true,ui_header_color:"#181817",ui_header_background:"#ddddd1",ui_offset_top:"0px",ui_open_windows:true,data_ga_property:"UA-6671908-2",data_ga_tracker:window._gaq,data_track_clickback:false,data_ga_social:true}},initAddthis:function(b){if(typeof window.addthis_config==="undefined"){var a=this;window.addthis_config=this.getAddthisConfig();$.getScript(location.protocol+"//s7.addthis.com/js/300/addthis_widget.js#pubid=imgur&domready=1",function(){a.setupAddthis();if(b){var c=function(d){$(".addthis_button").click()};window.addthis.addEventListener("addthis.ready",c);a._.addthisTimeout=setTimeout(c,400)}},true)}},setShareTitle:function(a){if("addthis" in window){window.addthis.update("share","title",a)}},setUrl:function(a){this._.shareUrl=a;if("addthis" in window){window.addthis.update("share","url",a)}},bindButtons:function(){var a=this;this._.shareUrl=(this._.shareUrl)?this._.shareUrl:this._.protocol+"//"+this._.host+this._.url;this.elements.$social.on("click",".social span",function(b){a._.shareUrl=(a._.shareUrl)?a._.shareUrl:a._.protocol+"//"+a._.host+a._.url;switch($(this).attr("class")){case"twitter_custom":a.shareTwitter();break;case"facebook_custom":a.shareFacebook();break;case"reddit_custom":a.shareReddit();break;case"digg_custom":a.shareDigg();break;case"tumblr_custom":a.shareTumblr();break;case"stumbleupon_custom":a.shareStumbleupon();break;case"st_email_custom":a.logShare("email");break;case"addthis_button st_sharethis_custom":a.initAddthis(true);a.logShare("other");break}});$(".addthis_button").hover(function(){a.initAddthis()})},bindAddthisButton:function(){try{window.addthis.button("."+this._.shareButtonClass)}catch(a){}},setupAddthis:function(){var a=this;try{window.addthis.ost=0;window.addthis.addEventListener("addthis.menu.open",function(c){clearTimeout(a._.addthisTimeout);a.addthisOpen(c)});window.addthis.ready();this.setUrl(this._.shareUrl)}catch(b){setTimeout(function(){a.setupAddthis()},100)}},addthisOpen:function(a){if(!a.data.share){a.data.share={}}a.data.share.url=this._.shareUrl},resetShareUrl:function(){this._.shareUrl=window.location.href;this.setUrl(this._.shareUrl)},logShare:function(a){if(this._.resetUrl){this.resetShareUrl()}if(this._.hash){$.post("http://"+this.settings.host+"/share/share",{hash:this._.hash})}if(a!="email"&&a!="other"){try{var b=this._.shareUrl;_gaq.push(["_trackSocial",a,"share"]);addthis_share.url=b;_ate.share.track(a,0,addthis_share,addthis_config)}catch(c){}}},shareTwitter:function(){this.logShare("twitter");Imgur.StaticUtilities.getInstance().newWindow("http://twitter.com/share?url="+this._.shareUrl+"&via=imgur",550,425)},shareFacebook:function(){this.logShare("facebook");Imgur.StaticUtilities.getInstance().newWindow("http://www.facebook.com/sharer.php?u="+this._.shareUrl,755,425)},shareReddit:function(){this.logShare("reddit");Imgur.StaticUtilities.getInstance().newWindow("http://reddit.com/submit?url="+this._.shareUrl,900,720)},shareDigg:function(){this.logShare("digg");Imgur.StaticUtilities.getInstance().newWindow("http://digg.com/submit?phase=2&url="+this._.shareUrl,1060,655)},shareTumblr:function(){this.logShare("tumblr");var b=$('link[rel="image_src"]').attr("href");if(b){var a="http://www.tumblr.com/share/photo?source="+escape(b)+"&caption="+escape(document.title)+"&click_thru="+escape(this._.shareUrl)}else{var a="http://www.tumblr.com/share/link?url="+escape(this._.shareUrl)+"&name="+escape(document.title)+"&description="+escape($('meta[name="description"]').attr("content"))}Imgur.StaticUtilities.getInstance().newWindow(a,450,430)},shareStumbleupon:function(){this.logShare("stumbleupon");Imgur.StaticUtilities.getInstance().newWindow("http://www.stumbleupon.com/submit?url="+this._.shareUrl,1060,500)}});Class.addSingleton(Imgur.ShareButtons);
;Namespace("Imgur.Caption");Imgur.Caption=Imgur.extend({sid:$("#sid").val(),init:function(a){this._=$.extend({sid:Imgur.getInstance()._.sid,signed:false,baseURL:"/gallery",hash:null,popEventState:"comment",captionLength:140,el:{$captions:$("#captions")},$captions:$("#captions"),$commentCount:$("#comment-count"),$commentExpand:$("#expand-comments"),children:"children",counterClass:".counter",captionBarClass:"caption-bar",loadingClass:".save-caption-loader",errorClass:"caption-error",dataLevel:"data-level",defaultText:"Submit a ",commentName:"comment",showCaptionsClass:"show-captions",hideCaptionsClass:"hide-captions",userCommentsClass:".comment-item",deleteCaption:"Are you sure you want to delete this comment?",isReply:false,mobile:false,reportCaption:"Are you sure you want to report this loser for spam or abuse?",captioningTooFast:function(b){return'<div class="caption-error">You\'re commenting too quickly!  Please wait '+b+" more seconds.</div>"},commentCount:0,captions:{},default_best_score:0.20654329147389},a);this._super(this._);this._.defaultText+=this._.commentName;this._.baseCaption=this.createBaseCaption();if(this._.target){this.setupTargetHandlers()}this._.el.$captions.on("click",".image-link",(function(b){b.preventDefault();$(this).colorbox({maxWidth:"95%",maxHeight:"95%",scalePhotos:true,photo:true})}))},reportCaptionLinkClickHandler:function(a){var b=$(a.target).attr("data");if(confirm(this._.reportCaption)){if(!this._.signed){Imgur.getInstance().signin()}$.ajax({url:this._.baseURL+"/action/report_caption/"+b,type:"POST",data:{sid:this.sid}});if(this._.signed){$(a.target).html("reported").removeClass("report-caption-link").addClass("red").unbind("click")}}},textareaFocusHandler:function(c){var a=$(c.target);var b=a.parent().find(this._.counterClass);b.show();if(a.val()==this._.defaultText){b.html(this._.captionLength);a.val("");a.css({height:"60px",color:"#fff"})}else{a.css({height:"60px",color:"#fff"})}},textareaKeyupHandler:function(c){var a=$(c.target);var b=this._.captionLength-a.val().length;this.updateCounter(a.parent().find(this._.counterClass),b);if(!c.ctrlKey&&!c.altKey&&!c.metaKey){switch(c.keyCode){case 13:case 37:case 39:case 107:case 109:c.stopPropagation()}}return true},updateCounter:function(b,a){var c=$(b);if(a<0){c.addClass("exceeded")}else{if(a<25){c.removeClass("exceeded");c.addClass("warning")}else{c.removeClass("exceeded");c.removeClass("warning")}}c.html(a)},textareaKeydownHandler:function(b){var a=$(b.target);switch(b.keyCode){case 37:case 39:case 107:case 109:b.stopPropagation();break;case 13:b.stopPropagation();b.preventDefault();if($.trim(a.val())){this.submitCaption(b)}break}return true},deleteCaptionLinkClickHandler:function(h){var b=this;var i=$(h.target).attr("data");if(confirm(this._.deleteCaption)){$.ajax({url:this._.baseURL+"/action/delete_caption/"+i,type:"POST",data:{sid:this.sid},success:function(e){if(e=="update-link"){$("#caption-"+i).children(".usertext").children("span").html("[deleted]")}}});if(b._.hash in b._.captions){var f=b._.captions[b._.hash].parent[i];delete b._.captions[b._.hash].set[i];delete b._.captions[b._.hash].parent[i];delete b._.captions[b._.hash].votes[i];if(b.getCaptionChildrenIds(b._.hash,f).length==0){var g=$("#caption-"+f);var c=g.children(".expand");c.remove();g.prepend($('<span class="no-expand left">').html("&middot;"))}}$("#caption-"+i).fadeOut();var d=$("#caption-"+i).parent();var a=d.children("."+this._.children);if(!a.length||!a.children().length){var g=d.parent();d.fadeOut();d.closest(this._.userCommentsClass).fadeOut();if(!g.children().length){g.parent().find(".expand").html("&middot")}}}},spamCaptionLinkClickHandler:function(a){var b=$(a.target).attr("data");if(confirm("are you sure you want to mark this user as spam!?")){$.ajax({url:"/adm_removals/markspammer",type:"POST",data:{sid:this.sid,account_id:b,type:"main"},success:function(c){humanMsg.displayMsg("user has been marked as spam")}})}},createChildrenDiv:function(c){var a=$(c);var b=$("<div/>",{"class":this._.children});a.append(b);return b},insertCaption:function(c,d,g){var b=$(d);var f=b.children("textarea");f.val("").blur();var a=$(c).hide();if(g){var e=$("#caption-"+g).siblings("."+this._.children);e.prepend(a.fadeIn(250));a.attr("data-level",e.data("level"))}else{this._.$captions.prepend(a.fadeIn(250));a.attr("data-level","0")}},setupHandlers:function(){Imgur.ShareThis.getInstance().bindButtons()},addDownvoteLimit:function(){clearTimeout(this._.timeout);$(".caption .arrow.down").unbind("click");$(".caption .arrow.down").attr("title","Downvoting on this image has been disabled for one minute because you made a comment.");$(".caption .arrow.down").tipsy({gravity:"nw",opacity:1})},removeDownvoteLimit:function(){var a=this;$(".caption .arrow").unbind("click");$(".caption .arrow.down").unbind("hover");$(".tipsy").remove();$(".caption .arrow.down").attr("title","dislike");$(".caption .arrow").click(function(b){a.vote(b)})},appendError:function(a,b){a.append(this._.captioningTooFast(b)).fadeIn(250)
},submitSuccess:function(b,c,f){var a=$(c);var e=a.children("textarea");if(Imgur.getInstance()._.signed){if(a.attr("id")!="submit-caption"){a.children("textarea").parent().remove()}else{e.val("").blur()}b.data.caption.relative_depth=1;var d=this.createCaptionDOM(b.data.caption,{});if("replySuccess" in this){this.replySuccess(b.data.caption,d)}else{Imgur.Caption.Reply.getInstance().replySuccess(b.data.caption,d)}}},submitCaption:function(g){var a=$(g.target).parent();var c=a.children("textarea");if(!Imgur.getInstance()._.signed){Imgur.getInstance().signin()}if(this._.isCaptioning){return false}if(c.val().length>this._.captionLength){return false}if(c.val()===this._.defaultText){return false}var b=c.val();b=escape(b).replace(/(\%AD)+\%20/g,"");if(b=="%AD"||!b){return false}this._.isCaptioning=true;a.find(this._.loadingClass).show();var i=this;var d=this.getCaptionParentId(a);var h=d||0;var f=this.createSimulatedCaptionResponse(g,h);var j=true;window.setTimeout(function(){if(j){this.submitSuccess(f,a,d)}}.bind(this),400);$.ajax({url:this._.baseURL+"/action/caption/"+this._.hash,type:"POST",data:{caption:f.data.caption.caption,parent_id:d,parent_author:a.parent().find(".author").attr("data-author"),sid:this.sid},success:function(e){this._.isCaptioning=false;a.find(this._.loadingClass).hide();var k=parseInt(e,10);$("."+this._.errorClass).remove();if(!isNaN(k)&&k>0){j=false;this.appendError(a,e);$("#caption-"+f.data.caption.id).fadeOut(250)}}.bind(this)});return false},createSimulatedCaptionResponse:function(f,d){var b=Imgur.Caption.getInstance();var a=this.createNewCaptionFromEvent.call(b,f,d);var c={data:{caption:a,hash:this._.hash,image_account:null,logged_in:this._.signed,insert:true,caption_votes:{},auth:{id:Imgur.getInstance()._.auth.id}},success:true,status:200};c.data.caption_votes[a.id]="up";return c},createNewCaptionFromEvent:function(j,l){var i=-1;var c=$(j.target).parent();var h=c.children("textarea");var d=Imgur.getInstance()._.auth;var k=Imgur.Gallery;var b=null;if(k){var f=k.getInstance()._.image;if(f){b=f.is_album}}if(this._.hash in this._.captions){var g=this._.captions[this._.hash].set;if(g){var a=Object.keys(g).sort();i=Number(a[a.length-1])}}return{id:i+1,hash:this._.hash,caption:h.val(),author:d.url,author_id:d.id,ups:1,downs:0,points:1,best_score:this._.default_best_score,datetime:(new Date().toISOString().replace("T"," ").replace("Z","")),parent_id:l,deleted:false,on_album:b,album_cover:null}},getCaptionParentId:function(c){var a=$(c);var d=a.children('input[name="parent_id"]').val();if(d){return d}var b=window.location.pathname.split("/");if(!isNaN(b[4])){return b[4]}},showByComment:function(b){var a=$(b);while(a.length){a.show();a=a.children()}},replyClickHandler:function(b){b.preventDefault();if(Imgur.Caption.Reply){var a=new Imgur.Caption.Reply({signed:this._.signed,hash:this._.hash,baseURL:this._.baseURL,timeout:this._.timeout,commentCount:this._.commentCount}).clickHandler(b)}},loadMoreClickHandler:function(b){b.preventDefault();var a=this.getCaptionId($(b.target).parent().siblings(".caption"));this.loadMore(a,true)},updateExpand:function(d){var a=$(d);var c=a.closest(".comment");if(a.html()==="+"){var b=c.children("."+this._.children);b.show();b.children("*:not(.bad-captions)").show();a.html("&ndash;")}else{c.children("."+this._.children).hide();a.html("+")}},expandAll:function(c){var a=$(c);for(a;a.length;a=a.children("."+this._.children).children()){for(var b=0;b<a.length;b++){this.expandOne($(a[b]))}}},expandOne:function(b){var a=$(b);if(!a.hasClass("expand")){a=$(a.children()[0]).children(".expand");if(a.html()==="–"){return}}if(a.hasClass("expand-all")){a.removeClass("expand-all");this.expandAll(a.closest(".comment"))}else{if(a.html()==="–"){return}this.updateExpand(a)}},collapseAll:function(c){var a=$(c);for(a;a.length;a=a.children("."+this._.children).children()){for(var b=0;b<a.length;b++){this.collapseOne(a[b])}}},collapseOne:function(b){var a=$(b);if(!a.hasClass("expand")){a=$(a.children()[0]).children(".expand");if(a.html()==="+"){return}}if(a.hasClass("expand-all")){a.removeClass("expand-all");this.expandAll(a.closest(".comment"))}else{if(a.html()==="+"){return}this.updateExpand(a)}},expandClickHandler:function(a){a.preventDefault();this.expandOne($(a.target))},toggleEditButton:function(a){$(a).children().toggle()},toolbarClickHandler:function(b){b.stopPropagation();b.preventDefault();$("body").find(".combobox").each(function(){if(!$(b.target).hasClass("addthis_button")){$(this).removeClass("opened")}});$(b.target).toggleClass("opened");var a=this;$("body").unbind("click");$("body").click(function(c){$("body").find(".combobox").each(function(){$(this).removeClass("opened")})})},shareCaptionLinkHandler:function(f){var g=$(f.target).attr("data");var d=this._.hash;var c=this._.protocol+"//"+this._.host+this._.baseURL+"/"+d+"/comment/"+g;if(Imgur.InsideNav){var b=Imgur.InsideNav.getInstance()._.responseData[d];var a=this.getCaptionById(d,g);Imgur.ShareButtons.getInstance().setShareTitle(a.author+" comments on '"+b.title+"' - Imgur")
}Imgur.ShareButtons.getInstance().setUrl(c)},getCommentId:function(b){var b=b.split("/");var a=b[(b.length-1)];return(a!=="comment"&&a!==this._.hash)?a:""},isRootComment:function(a,b){if(!(b in this._.captions[a].set)){return false}return(this._.captions[a].set[b].parent_id===0)},showBadCommentsClickHandler:function(c){var a=$(c.target);var b=a.html();if(b.indexOf("show")>=0){b=b.replace("show","hide")}else{b=b.replace("hide","show")}a.html(b)},setupTargetHandlers:function(){var a=this;this._.target.find("#submit-caption-button").bind(function(b){a.submitCaption(b)});this.addSubmitHandlers(this._.target)},getCaptionId:function(d){var a=$(d);if(a.attr("class")=="comment"){return this.getCaptionId(a.children(".caption"))}try{var b=a.attr("id").split("-");return b[1]}catch(c){return""}},addSubmitHandlers:function(c){var b=this;var a=$(c);a.find("textarea").blur(function(d){b.textareaBlurHandler(d)}).focus(function(d){b.textareaFocusHandler(d)}).keyup(function(d){b.textareaKeyupHandler(d)}).keydown(function(d){b.textareaKeydownHandler(d)});a.find('input[type="button"]').click(function(d){if($(d.target).hasClass("submit")){b.submitCaption(d)}})},textareaBlurHandler:function(b){var a=$(b.target);if(!$.browser.msie){if(a.val().trim()===""){this.blurTextarea(a)}a.val(a.val().trim())}else{if(a.val()===""){this.blurTextarea(a)}}},blurTextarea:function(b){var a=$(b);a.parent().find(this._.counterClass).hide();a.val(this._.defaultText);a.css({height:"20px",color:"#888"})},haveCaptionVotes:function(a){return(a in this._.captions&&Object.keys(this._.captions[a].votes).length>0)},haveCaptions:function(a){return(a in this._.captions)},getCaptionDepthById:function(c,d){d=Number(d);if(c in this._.captions&&d in this._.captions[c].set){var a=[];var e=-1;var b=d;while(b!=null&&!(b in a)){a.push(b);b=this._.captions[c].parent[b];e++}return e}},getCaptionById:function(a,b){b=Number(b);if(a in this._.captions&&b in this._.captions[a].set){return this._.captions[a].set[b]}return null},getCaptionPropertyById:function(b,c,a){c=Number(c);if(b in this._.captions&&c in this._.captions[b].set){if(a in this._.captions[b].set[c]){return this._.captions[b].set[c][a]}}return null},getCaptionParentById:function(a,b){b=Number(b);if(a in this._.captions&&b in this._.captions[a].parent){return this._.captions[a].parent[b]}return null},getCaptionChildrenIds:function(c,d){d=Number(d);if(!(c in this._.captions)){return[]}var a=this;var b=[];if(typeof d=="undefined"){d=0}jQuery.each(this._.captions[c].parent,function(f,e){if(d==e||(e==null&&d==0)){b.push(f)}});return b},getCaptionIdsByFilter:function(c,b){if(!(c in this._.captions)){return[]}var a=[];jQuery.each(this._.captions[c].set,function(e,d){if(b(d)){a.push(e)}});return a},mergeCaptions:function(c,b,d){var a=this;if(!(c in a._.captions)){a._.captions[c]={set:{},parent:{},votes:{}}}jQuery.each(b,function(g,f){var h=f.id;var e=f.parent_id;f.points=Number(f.points);a._.captions[c].set[h]=f;a._.captions[c].parent[h]=(e===0?null:e)});jQuery.each(b,function(f,e){var g=a.getCaptionDepthById(e.hash,e.id);b[f].depth=g;a._.captions[c].set[e.id].depth=g});if(d){d()}},mergeCaption:function(b,a){this.mergeCaptions(b,[a])},mergeVotes:function(c,b,d){var a=this;if(b){if(!(c in a._.captions)){a._.captions[c]={set:{},parent:{},votes:{}}}jQuery.each(b,function(f,e){a._.captions[c].votes[e.caption_id]=e});if(d){d()}}},getVoteByCaptionId:function(a,b){if(a in this._.captions&&b in this._.captions[a].votes){return this._.captions[a].votes[b]}return null},createExpander:function(){var a=this;return $("<a>").html("+").attr({"class":"expand left",href:"javascript:;"})},getBadContainer:function(b){if(b.data("bad-container")&&b.data("bad-container").parent()==b){return b.data("bad-container")}else{var a=b.children(".bad-captions");if(a.length==0){a=jQuery(this.insertBadContainer(b))}b.data("bad-container",a);return a}},createBaseCaption:function(){var a=this;var b='<div id="caption-{id}" class="caption" data="{id}"><span class="no-expand left">&middot;</span><div class="arrows"><div title="like" class="arrow up" data="{id}" type="caption"></div><div title="dislike" class="arrow down" data="{id}" type="caption"></div></div><div class="usertext textbox first1"><div class="author" data-author="{author-id}"><a href="/user/{author}">{author}</a>&nbsp;<span class="points-{id}">{points}</span>&nbsp;<span class="points-text-{id}">{points-text}</span> : {datetime} <a href="javascript:;" class="reply">reply</a><div class="caption-toolbar combobox edit-button"><div class="options"><div class="addthis_button item share-caption-link" data="{id}">share</div><div class="item report-caption-link" data="{id}">report</div><div class="item permalink-caption-link" data="{id}">permalink</div></div></div></div><span>{caption}</span></div></div><div class="children" data-level="{children-data-level}" style="display: none;"><div class="bad-captions" style="display: none"><div class="textbox"><a href="javascript:;" class="link">show bad reply (<span class="number">0</span>)</a></div></div></div>';
var c=document.createElement("div");c.setAttribute("class","comment");c.innerHTML=b;return $(c)},createCaptionDOM:function(o,c,f,i){var p=this;var j="\u00a0";var k=Imgur.StaticUtilities.getInstance();var l=this._.baseCaption.clone();var m=moment.utc(o.datetime,"YYYY-MM-DD HH:mm:ss");var b=m.fromNow();if(m.diff(new Date())>0){b="an instant ago"}var h={id:o.id,"author-id":o.author_id,author:o.author,caption:k.linkify(k.htmlEntity(o.caption),true),points:o.points,"points-text":(Math.abs(o.points)==1)?"point":"points",datetime:b,"data-level":o.relative_depth,"children-data-level":o.relative_depth+1};if(c.account_id==o.author_id){var e=document.createDocumentFragment();var a=document.createElement("span");a.appendChild(document.createTextNode("OP"));a.setAttribute("class","green");e.appendChild(a);e.appendChild(document.createTextNode(j));var n=l.find(".author");var g=n.find("span[class^='points']");n[0].insertBefore(e,g[0])}var d=Imgur.getInstance()._;if("auth" in d&&"id" in d.auth){if(o.author_id==d.auth.id){l.find(".options").append('<div class="item delete-caption-link" data="'+o.id+'">delete</div>')}}if(f){l.find(".children").css("display","")}if(i){l.find(".usertext").addClass("contexted")}if(o.parent_id!==null){l.find(".combobox .options .permalink-caption-link").before('<div class="item context-caption-link" data="'+o.id+'">context</div>')}l.html(k.replaceTemplate(l.html(),h));l.attr("data-level",o.relative_depth);return l[0]},setCaptionVoteState:function(c){var d=["up","down"];var g=c.vote;var h=$(document.getElementById("caption-"+c.caption_id)).find(".arrows *");if(g=="veto"){h.removeClass("pushed")}else{var b=d[1-d.indexOf(g)];var a=h.filter(".up");var f=h.filter(".down");var e=h.filter("."+g);var i=h.filter("."+b);if(!e.hasClass("pushed")){e.addClass("pushed")}i.removeClass("pushed")}return true},purgeCaptionData:function(b){var a=this;var c=Object.keys(this._.captions).filter(function(d){return Object.hasOwnProperty.call(a._.captions,d)&&b.indexOf(d)===-1});jQuery.each(c,function(e,d){delete a._.captions[d]})}});Class.addSingleton(Imgur.Caption);
;Namespace("Imgur.InsideNav");Imgur.InsideNav=Imgur.extend({init:function(a){this._=$.extend({ad:{zedo:{},URL:undefined,timeTillRefresh:4000,nextImageLoadRefreshesAd:false,currentTimeout:undefined},pageStates:{no_data:0,no_captions:1,captions_all:2,captions_filtered:3},pageState:0,captionLayout:{sort:null,filter:this.filterCaptionsByAll,expanded:false,expanded_default:false},captionLayoutProperties:{sort:{best:this.sortCaptionsByBest,"new":this.sortCaptionsByNew,top:this.sortCaptionsByTop}},captionFilters:{all:"all",context:"context"},captionWorkParameters:{update_step:750,timer_step:0,work_step:4,paint_factor:1.5,worker:null,timer_update_ref:null},permalinkId:null,context:0,autoBrowse:false,autoBrowseTimeout:null,isHotImage:true,adType:null,captionInstance:undefined,responseData:{},sequence:[],fetchQueue:[],image:{},fetchPageEventCount:0,checkFetchQueueInterval:undefined,sponsoredAd:undefined,sponsoledAdInserted:false,thumbInfo:{prevHash:undefined,nextHash:undefined},navCheckIfNeedMorePagesDisabled:true,currentIndex:undefined,pagesLoaded:{low:undefined,high:undefined},thumbsSpeed:400,fetchInterval:700,elements:{$metadataLink:$('link[rel="image_src"]'),$statsbox:$("#statsbox"),$sponsoredCaption:$("#sponsored-image-caption"),$thumbsCarousel:$("#thumbs-top, #thumbs-bottom"),$thumbsCarouselContainer:$(".thumbs-carousel"),$thumbsCarouselNext:$(".carousel-button.next"),$thumbsCarouselPrev:$(".carousel-button.prev"),$thumbsCarouselTop:$("#thumbs-top"),$thumbsCarouselButtons:$(".carousel-button"),$thumbsCarouselTopContents:$("#thumbs-top ul"),$thumbsCarouselBottom:$("#thumbs-bottom"),$thumbsCarouselBottomContents:$("#thumbs-bottom ul"),$navPrev:$("#navPrev"),$navNext:$("#navNext"),$nicetime:$("#nicetime"),$voteUp:$("#mainUpArrow"),$voteDown:$("#mainDownArrow"),$navThumbs:$("#nav-thumbs"),$image:$("#image"),$underImage:$("#under-image"),$imageTitle:$("#image-title"),$submitDate:$("#stats-submit-date"),$submitSource:$("#stats-submit-source"),$submitSourceReddit:$("#stats-submit-source-reddit"),$views:$("#stats-views"),$bandwidth:$("#stats-bandwidth"),$bandwidthDiv:$("#bandwidth-div"),$embed:$("#stats-embed-codes"),$download:$("#stats-download"),$captions:$("#captions"),$captions_count:$("#comment-count"),$sparkbar:$(".sparkbar"),$infoLeft:$(".info .left"),$reddit:$("#stats-reddit"),$subreddit:$("#subreddit"),$originalSource:$("#original-source .domain"),$commentExpand:$("#expand-comments"),$mgidPanel:$("#MarketGidComposite1958"),$submitCaption:$("#submit-caption"),$adPanel:$(".panel-ad"),adWrapper:".advertisement",$zedo:$("#zedo"),zinkAds:"#zzsliderlayer_box",albumTruncated:"#album-truncated",$favoritedImage:$("#favorite-image"),}},a);this._.thumbInfo.prevHash=this._.elements.$thumbsCarouselTopContents.find("img:eq(0)").attr("hash");this._.thumbInfo.nextHash=this._.elements.$thumbsCarouselBottomContents.find("img:eq(2)").attr("hash");this._.currentPage=parseInt(this._.page);this._.pagesLoaded={low:parseInt(this._.page),high:parseInt(this._.page)};this._.captionLayout.expanded=this.isPermalink()||this.isPermalinkContext();this.bindCommentExpand();this._super(this._)},setHash:function(a){this._.hash=a;this._.captionInstance.setHash(a)},getHash:function(){return this._.hash},hasImage:function(a){a=a||this._.hash;return(a in this._.responseData)},getImage:function(a){a=a||this._.hash;if(this.hasImage(a)){return this._.responseData[a]}},getCurrentImage:function(){if(this._.pageState>0){if(this._.hash in this._.responseData){return this._.responseData[this._.hash]}}return null},checkFetchQueue:function(){if(this._.fetchQueue.length===0){return}var a=this._.fetchQueue.shift();if(a){a()}},generalInit:function(b){this._.captionInstance=Imgur.Caption.getInstance({sid:this._.sid,signed:this._.signed,hash:this._.hash,baseURL:this._.baseURL,defaultText:"Submit a ",commentName:this._.commentName,target:$("#submit-caption"),loadingClass:"#save-caption-loader",isReply:false});this.initThumbsCarousel();this.checkAdTime();this._.checkFetchQueueInterval=window.setInterval(this.checkFetchQueue.bind(this),this._.fetchInterval);this.fetchPage("current",b);this.bindAutoBrowse();this._.ad.zedo.URL=this._.elements.$zedo.attr("src");this.setupCaptionHandlers();this.setupHistoryState();var a=Imgur.Caption.Reply.getInstance();a.setHash(this._.hash);a.setReplyHandler(this.insertCaptionReply);setTimeout(this.forceAdRefresh.bind(this),2000)},saveSponsoredAd:function(a){this._.sponsoredAd=a},insertAdIntoSequence:function(a){this._.responseData[a.hash]=a;this._.sequence.splice(a.position,0,a.hash);this._.currentIndex=this.findImageInSequence(this.getHash());this.fetchImageAndInfo(a.hash);this.updateThumbs("farcurrent",true);this._.sponsoredAdInserted=true},getURL:function(d){if(!("cache" in d)){d.cache=true}var c=(d.cache&&Imgur.Gallery.getInstance()._.using_cache&&this._.parent_gallery._.gallery_type!=="favorites");var a=(c?"hit":"miss");var e=(this._.section==="new"&&"cookie" in $&&$.cookie("hidingviral")?"?hidingviral":"");var b=Imgur.getInstance()._.host;
return({historyState:this._.baseURL+"/"+d.hash,page:this._.baseURL+(this._.section?"/"+this._.section:"")+"/"+this._.sort+"/page/"+d.page+"/"+a+".json"+(this._.searchQuery?("?q="+this._.searchQuery):e),topPage:this._.baseURL+"/"+(this._.section?this._.section:this._.sort)+"/"+this._.window+"/page/"+d.page+"/"+a+".json"+(this._.searchQuery?("?q="+this._.searchQuery):""),image:this._.cdnURL+"/"+d.hash+d.ext,thumb:this._.cdnURL+"/"+d.hash+"b"+d.ext,imageJSON:this._.baseURL+"/"+d.hash+".json",imageAPI2:"http://api.imgur.com/2/image/"+d.hash+".json",imageVotesJSON:this._.baseURL+"/"+d.hash+"/votes.json",captionsJSON:this._.baseURL+"/"+d.hash+"/comment/best/"+a+".json",savePage:this._.baseURL+"/"+this._.sort+"/savepage/"+d.page,albumImages:this._.baseURL+"/"+d.hash+"/album_images/"+a+".json",})[d.type]},fetchImageAndInfo:function(b){var a=this;$.getJSON(this.getURL({type:"imageAPI2",hash:b}),function(d){var c=a._.responseData[b];c.image=new Image();c.image.src=a.getURL({type:"image",hash:b,ext:".jpg"});c.width=d.image.image.width;c.height=d.image.image.height})},fetchImage:function(e,c,a){var d=this._.responseData[e];var b=this;if(!d||(d.image&&(d.caption||d.subreddit))){return}if(d.is_album&&!d.album_images){b.fetchAlbumImages(e,c)}else{if(!d.image){d.image=new Image();d.image.src=this.getURL({type:"image",hash:e,ext:d.ext})}if(c){c(d)}}if(!d.captions&&!d.subreddit&&b._.parent_gallery._.gallery_type!=="favorites"){this.fetchCaptions(e,a)}else{if(a){a()}}},updateCaptionCount:function(a){if(typeof a=="undefined"){a=this._.elements.$captions.find("div.comment").length}this._.elements.$captions_count.text(a+" comment"+((a!=1||a=="-")?"s":""))},insertPermalinkBanner:function(){var b=this;var a=jQuery('<div class="textbox reply-header"><span>you are viewing a single comment</span><p><a class="load-more" href="javascript:;">view the rest of the comments</a></p></div>');if(this._.elements.$captions.children("div span").eq(0).text()!="you are viewing a single comment"){this._.elements.$captions.prepend(a)}},setSpinnerState:function(b){var a=this._.elements.$captions.parent().find("#captions-loader");if(!b){a.remove()}else{if(!a.length){this._.elements.$captions.after($("<img>").attr({id:"captions-loader",src:"http://s.imgur.com/images/small-loader.gif","class":"small-margin-top"}))}}},loadCaptions:function(h,b,c,e,f){if(typeof f=="undefined"||f===null){f=0}var d=this;this._.pageState=this._.pageStates.no_captions;if(this._.captionInstance.haveCaptions(h)){if(c){this.setCaptionFilter(this._.captionFilters.context,c,f,false)}else{this.setCaptionFilter(this._.captionFilters.all,null,null,false)}this.processCaptions(function(){d.setSpinnerState(false);if(b){b()}})}else{var g=(function(){d.loadCaptions(h,b,c,e,f)});var a=(function(){d.processVotes()});this.fetchCaptions(h,g,c,a)}},fetchCaptions:function(f,b,c,e){if(this._.captionInstance.haveCaptions(f)){return}var d=this;var h=this.getURL({type:"captionsJSON",hash:f});var g=this.getURL({type:"imageVotesJSON",hash:f});var a=(function(j){return(function(){if(f!=d._.hash){return}if(j){j()}})});if($.browser.msie){$.support.cors=true}jQuery.ajax(h,{success:(function(j){try{if("data" in j&&"captions" in j.data){d._.captionInstance.mergeCaptions(f,j.data.captions,a(b))}}catch(k){return false}})});if("auth" in Imgur.getInstance()._){jQuery.ajax(g,{success:(function(j){try{if("data" in j&&"votes" in j.data){d._.captionInstance.mergeVotes(f,j.data.votes,a(e))}}catch(k){return false}})})}},scrollToCaptions:function(){var a=$("#under-image > div:first-child").get(0).offsetTop+44;window.scrollTo(0,a)},clearCaptions:function(){window.clearInterval(this._.captionWorkParameters.timer_update_ref);this._.elements.$captions.empty();var a=this.createCaptionBadContainer();this._.elements.$captions.append(a);this.updateCaptionCount("-")},createCaptionBadContainer:function(){return jQuery('<div class="bad-captions" style="display: none"><div class="textbox"><a href="javascript:;" class="link">show bad comments (<span class="number">0</span>)</a></div></div>')},createCaptionProcessor:function(b,g,a,c,f){var h=null,d=[];var e=b._.responseData[g];return(function(){if(g==b._.hash&&a.length&&b._.captionLayout.filter===c){h=new Date();var p=$(document.createDocumentFragment());var n=Math.min(b._.captionWorkParameters.work_step,a.length);for(var k=0;k<n;k++){var j=a.shift();var m=(b.isPermalinkContext()&&j.id==b.getPermalinkCaptionId());var o=b._.captionInstance.createCaptionDOM(j,e,b.getCaptionExpanded(),m);b.insertCaptionDOM(p,j,o,false,b.getCaptionExpanded())}b._.elements.$captions.children(":last").before(p);if(d.length==5){d.shift()}d.push((new Date()-h));var l=0;if(d.length){for(var k=0;k<d.length;k++){l=l+d[k]}l/=d.length;l*=b._.captionWorkParameters.paint_factor;l=Math.max(l,b._.captionWorkParameters.timer_step)}else{l=b._.captionWorkParameters.timer_step}window.setTimeout(b._.captionWorkParameters.worker,l)}else{f.call(b)}})},processCaptions:function(b){var c=this;var g=this._.hash;var e=this._.captionLayout.filter;
this.clearCaptions();if(this.isPermalink()){this.insertPermalinkBanner();this._.elements.$submitCaption.hide()}else{this._.elements.$submitCaption.show()}var a=this._.captionInstance.getCaptionIdsByFilter(g,e).map(function(j){return c._.captionInstance.getCaptionById(g,j)}).sort(this.getCaptionSorter());var f=(function(){if(this.isPermalink()){this._.pageState=this._.pageStates.captions_filtered}else{this._.pageState=this._.pageStates.captions_all}this.updateCaptionCount();this.processVotes();Imgur.ShareButtons.getInstance().bindAddthisButton();$("#content").css("min-height",$("#content").get(0).clientHeight+"px");if(b){b()}});if(a.length){var d=a[0].depth;jQuery.each(a,function(k,j){a[k].relative_depth=j.depth-d});var h=this.createCaptionProcessor(this,g,a,e,function(){window.clearInterval(this._.captionWorkParameters.timer_update_ref);f.call(this)});this._.captionWorkParameters.worker=h;this._.captionWorkParameters.timer_update_ref=window.setInterval(function(){$("#content").css("min-height",$("#content").get(0).clientHeight+"px");c.updateCaptionCount()},this._.captionWorkParameters.update_step);h()}else{f.call(this)}},updateCaptionBadNumber:function(a){a.show();var c=Number(a.children(".comment").length);var b=a.children().first().find("span.number");b.text(c);var d=b.parent().html();if(c==1){d=d.replace("replies ","reply ")}else{d=d.replace("reply ","replies ")}b.parent().html(d)},insertCaptionDOM:function(m,l,c,a,f){if(this._.hash!=l.hash){return false}var e=this.getCaptionSorter();var n=(function(p){var o=$(p);if(a&&o.attr("class")=="comment"){var q=this._.captionInstance.getCaptionById(this._.hash,this._.captionInstance.getCaptionId(p));if(q!=null){return e(q,l)}else{return 0}}else{if(o.attr("class").indexOf("reply-banner")!=-1||o.attr("class").indexOf("textbox")!=-1){return -1}if(o.attr("class").indexOf("bad-captions")!=-1){return 1}return 0}});var h=null;if(l.relative_depth===0){if(l.points<0&&!this.isPermalink()){h=this._.elements.$captions.children(".bad-captions")}else{h=m}}else{h=jQuery(m[0].querySelector("#caption-"+l.parent_id)).parent().children(".children");if(!h.length){h=jQuery("#caption-"+l.parent_id).parent().children(".children")}if(l.relative_depth<=6){if(l.points<0&&!this.isPermalink()){h=h.children(".bad-captions")}}else{if(l.relative_depth==7){if(h.find(".load-more").length==0){h.append('<a href="javascript:;" class="load-more" data="'+l.parent_id+'">load more</a>');h.show()}}return}}if(l.just_inserted){$(c).hide()}if(a){var g=h.children().add($("#caption-"+l.parent_id+" > .children > .comment"));if(g.length){var b=false;for(var d=0,j=g[0];d<g.length;d++,j=g[d]){if(n.call(this,j)>0){j.parentNode.insertBefore(c,j);b=true;break}}if(!b&&h.length){h[0].appendChild(c);b=true}}else{if(h.length){h[0].appendChild(c);b=true}}}else{if(h.length){if(l.points>0&&h.children(".bad-captions").length){h[0].insertBefore(c,h.children(".bad-captions").get(0))}else{h[0].appendChild(c)}b=true}}if(l.just_inserted&&b){$(c).fadeIn(250)}if(l.points<0&&h.length){this.updateCaptionBadNumber(h)}if(l.parent_id!==0){$parent_caption=h.parents(".comment").first().children().first();if($parent_caption.length){$parent_dot=$parent_caption.children("span:first-child");if($parent_dot.length){$parent_dot.remove();var k=(f?"-":"+");$parent_caption.prepend($('<a class="expand left" href="javascript:;">'+k+"</a>"))}}}},isPermalink:function(){if(this._.pageState>this._.pageStates.no_captions){return(this._.permalinkId!==null||this._.pageState==this._.pageStates.captions_filtered)}else{var a=window.location.pathname;return(a.indexOf("comment")!==-1||a.indexOf("caption")!==-1)}},isPermalinkContext:function(){if(!this.isPermalink()){return false}var a=window.location.pathname.split("/");return a[a.length-2]!=="comment"},getPermalinkCaptionId:function(){return this._.permalinkId},setupHistoryState:function(){var a=this;var b=Imgur.History.getInstance();b.addPopState("inside_nav.comment",function(c){a.handlePopStateComment(c)});b.addPopState("inside_nav.image",function(c){a.handlePopStateImage(c)})},handlePopStateComment:function(d){var c=window.location.pathname.split("/");var b=null;if(c.length==3&&c[2].length>=5){b=c[2]}if(c.length>3){if(c[1]==="r"){b=c[(c.length-1)]}else{if(c[1]==="user"){b=c[4]}else{b=c[2]}}}this.setHash(b);if(c.length<4){this.setCaptionFilter(this._.captionFilters.all,null,null,false)}else{var a=c[(c.length-1)];if(Number(a)!=0){this.setCaptionFilter(this._.captionFilters.context,a,0,false)}else{this.setCaptionFilter(this._.captionFilters.all,null,null,false)}}this.scrollToCaptions();this.processCaptions()},handlePopStateImage:function(c){var a=window.location.pathname.split("/");var d=this._.hash;var b=null;if(a.length===3&&a[2].length>=5){b=a[2]}if(a[2]){if(a[1]==="r"){b=a[a.length-1]}else{if(a[1]==="user"){b=a[4]}else{b=a[2]}}}if(b==null&&$.inArray(a[1],this._.responseData)){b=a[1]}if(b==null){return window.location=window.location}this.navToImage({hash:b},true);if(this._.captionLayout.filter!=this.filterCaptionsByAll){this.setCaptionFilter(this._.captionFilters.all,null,null,false);
if(b==d){this.processCaptions()}}},pushWindowState:function(c,b){var a=this._.baseURL+"/"+this._.hash;if(c){a+="/comment/"+c;if(b){a+="/"+b}}Imgur.History.getInstance().addWindowState("inside_nav.comment","Comments on "+window.title,a)},setCaptionSort:function(a){if(typeof a=="function"){this._.captionLayout.sort=a}else{this._.captionLayout.sort=this._.captionLayoutProperties.sort[a]}},getCaptionSorter:function(){var a=[this.sortCaptionsByDepth,this.sortCaptionsByMineJustSubmitted,this._.captionLayout.sort,this.sortCaptionsByIdDesc];return(function(d,c){for(var f=0;f<a.length;f++){var e=a[f](d,c);if(e!=0){return e}}return 0})},sortCaptionsByTop:function(d,c){var f=d.points;var e=c.points;if(f>e){return -1}if(f<e){return 1}return 0},sortCaptionsByBest:function(d,c){var f=d.best_score;var e=c.best_score;if(f>e){return -1}if(f<e){return 1}return 0},sortCaptionsByNew:function(e,d){var c=new Date(e.datetime);var f=new Date(d.datetime);if(c>f){return -1}if(c<f){return 1}return 0},sortCaptionsByDepth:function(d,c){if(d.depth<c.depth){return -1}if(d.depth>c.depth){return 1}return 0},sortCaptionsByMineJustSubmitted:function(d,c){var e=Imgur.InsideNav.getInstance();if("just_inserted" in d&&!("just_inserted" in c)){return -1}if("just_inserted" in c&&!("just_inserted" in d)){return 1}return 0},sortCaptionsById:function(d,c){if(d.id<c.id){return -1}if(d.id>c.id){return 1}return 0},sortCaptionsByIdDesc:function(d,c){if(d.id>c.id){return -1}if(d.id<c.id){return 1}return 0},filterCaptionsByAll:function(a){return true},createCaptionFilterByContext:function(a,b){var d=this._.hash;var k=[];var g=a;for(var e=0;e<b;e++){g=this._.captionInstance.getCaptionPropertyById(d,g,"parent_id");k.push(g)}var h=[];var f=[a];var j=null;while(f.length){j=f.pop();if(!(j in h)){h.push(j);var c=this._.captionInstance.getCaptionChildrenIds(d,j);if(c&&c.length){f=f.concat(c)}}}return(function(l){return(k.indexOf(String(l.id))!==-1||h.indexOf(String(l.id))!==-1)})},setCaptionExpanded:function(b,d,e){var a=this;if(d){this._.captionLayout.expanded_default=b}this._.captionLayout.expanded=b;this._.elements.$commentExpand.text((b?"collapse":"expand")+" all");if(e){var c=(b?this._.captionInstance.expandAll:this._.captionInstance.collapseAll);$("#captions").children(".comment").each(function(f){c.call(a._.captionInstance,this)})}},getCaptionExpanded:function(a){if(a){return this._.captionLayout.expanded_default}else{return this._.captionLayout.expanded}},bindCommentExpand:function(){var a=this;a._.elements.$commentExpand.click(function(b){a.setCaptionExpanded(!a.getCaptionExpanded(),true,true)});$(document).keydown(function(b){if(!b.ctrlKey&&!b.altKey&&!b.metaKey){if(b.keyCode==219){if(!$(b.target).is("input")&&!$(b.target).is("textarea")){a.setCaptionExpanded(!a.getCaptionExpanded(),true,true)}}else{if(b.keyCode==221){if(!$(b.target).is("input")&&!$(b.target).is("textarea")){a.setCaptionExpanded(false,true,true)}}}}})},setCaptionFilter:function(c,d,a,b){if(typeof b=="undefined"){b=true}if(c==this._.captionFilters.all){this._.captionLayout.filter=this.filterCaptionsByAll;this._.pageState=this._.pageStates.captions_all;this._.permalinkId=null;if(!this.getCaptionExpanded(true)){this.setCaptionExpanded(false)}if(b){this.pushWindowState()}}if(c==this._.captionFilters.context){this._.captionLayout.filter=this.createCaptionFilterByContext(d,a);this._.pageState=this._.pageStates.captions_filtered;this._.permalinkId=Number(d);this._.context=a;this.setCaptionExpanded(true);if(b){this.pushWindowState(d,a)}}},processVotes:function(){var a=this;var d=this._.hash;var b=a._.captionLayout.filter;var e=this._.captionInstance.getCaptionIdsByFilter(d,b);if(a._.pageState<a._.pageStates.captions_all){return}if(this._.captionInstance.haveCaptionVotes(d)){var c=e.map(function(f){return a._.captionInstance.getVoteByCaptionId(d,f)}).filter(function(f){return(f!=null)});jQuery.each(c,function(g,f){a._.captionInstance.setCaptionVoteState(f)})}},toggleCaptionChildren:function(d,c){var a=this;if(d==null){var e=a._.captionInstance.getCaptionIdsByFilter(a._.hash,function(f){return f.relative_depth==0});jQuery.each(e,function(f,g){a.toggleCaptionChildren(g,c)})}var b=$("#caption-"+d+" > .expand");if(b.text()==="+"){a._.captionInstance.expandOne(b)}else{a._.captionInstance.collapseOne(b)}if(c){var e=a._.captionInstance.getCaptionChildrenIds(a._.hash,d);jQuery.each(e,function(f,g){a.toggleCaptionChildren(g,c)})}},setupCaptionHandlers:function(){var a=this;this._.elements.$captions.on("click","a.expand",function(b){b.stopPropagation();a.toggleCaptionChildren($(this).parent().attr("data"))});this._.elements.$captions.on("click",".bad-captions > .textbox .link",function(c){var b=$(this).parent().parent().children(".comment");b.toggle();if(b.is(":hidden")){$(this).text($(this).text().replace("hide","show"))}else{$(this).text($(this).text().replace("show","hide"))}});this._.elements.$captions.on("click",".caption .caption-toolbar .permalink-caption-link",(function(b){a.setCaptionFilter(a._.captionFilters.context,$(b.target).attr("data"),0);
a.scrollToCaptions();a.processCaptions()}));this._.elements.$captions.on("click",".caption .caption-toolbar .context-caption-link",(function(b){a.setCaptionFilter(a._.captionFilters.context,$(b.target).attr("data"),1);a.processCaptions()}));this._.elements.$captions.on("click",".caption .caption-toolbar",function(b){a._.captionInstance.toolbarClickHandler(b)});this._.elements.$captions.on("click",".caption .caption-toolbar .share-caption-link",(function(b){a._.captionInstance.shareCaptionLinkHandler(b)}));this._.elements.$captions.on("click",".caption .caption-toolbar .report-caption-link",(function(b){a._.captionInstance.reportCaptionLinkClickHandler(b)}));this._.elements.$captions.on("click",".caption .caption-toolbar .delete-caption-link",(function(b){a._.captionInstance.deleteCaptionLinkClickHandler(b)}));this._.elements.$captions.on("click",".caption .caption-toolbar .spam-caption-link",(function(b){a._.captionInstance.spamCaptionLinkClickHandler(b)}));this._.elements.$captions.on("click",".caption .arrows .arrow",function(b){b.stopImmediatePropagation();a.vote(b)});this._.elements.$captions.on("click",".caption .reply",function(b){b.stopImmediatePropagation();Imgur.Caption.Reply.getInstance().clickHandler(b)});this._.elements.$captions.on("click",".load-more",function(b){if($(b.target).attr("data")){a.setCaptionFilter(a._.captionFilters.context,$(b.target).attr("data"),0,true);a.scrollToCaptions();a.processCaptions()}else{a.setCaptionFilter(a._.captionFilters.all);a.scrollToCaptions();a.processCaptions()}});this._.elements.$captions.on("click",".caption",function(b){if(!$(b.target).is(".image-link")){a.toggleCaptionChildren($(this).attr("data"))}})},insertCaptionReply:function(a,g){var d=Imgur.InsideNav.getInstance();var f=d._.image;var c={id:0,caption_id:a.id,account_id:a.author_id,vote:"up",timestamp:a.datetime};a.just_inserted=true;if(a.parent_id!==0){a.depth=d._.captionInstance.getCaptionDepthById(a.hash,a.parent_id)+1;var b=d._.captionInstance.getCaptionDepthById(a.hash,d._.captionInstance.getCaptionId($("#captions .comment").first()));a.relative_depth=a.depth-b}else{a.depth=a.relative_depth=0}d._.captionInstance.mergeCaption(a.hash,a);d._.captionInstance.mergeVotes(a.hash,[c]);var g=d._.captionInstance.createCaptionDOM(a,f);var e=(a.parent_id===0)?$("#captions"):$("#caption-"+a.parent_id);d.insertCaptionDOM(e,a,g,true);d._.captionInstance.setCaptionVoteState(c);d.updateCaptionCount();if(a.parent_id!==0){d._.captionInstance.expandOne(e.children(".expand"))}},fetchAlbumImages:function(c,d,b){var a=this._.responseData[c];$.getJSON(this.getURL({type:"albumImages",hash:c})+(b?"?all=true":""),function(e){if("success" in e&&e.success){a.album_images=e.data;a.image=true;for(var f=0;f<e.data.count&&f<5;++f){var g=e.data.images[f];var h=new Image();h.src=this.getURL({type:"image",hash:g.hash,ext:g.ext})}}if(d){d(a)}}.bind(this))},fetchPage:function(f,g){var a=this;if(this._.fetchPageEventCount>0){return}var d=(this._.sort=="random"&&this._.pagesLoaded.high==50)?0:this._.pagesLoaded.high+1;var e=(this._.sort=="random"&&this._.pagesLoaded.low==0)?50:this._.pagesLoaded.low-1;var c={prev:e,next:d,current:this._.pagesLoaded.low}[f];if(c<0){return}this._.fetchPageEventCount++;var b=this.getURL({type:((this._.section=="top"||(!this._.section&&this._.sort=="top"))?"topPage":"page"),page:c});$.getJSON(b,function(h){if(!h.success){return}var k=h.data;for(var j=0;j<k.length;j++){k[j].page=c;if(typeof a._.responseData[k[j].hash]==="undefined"){if(f==="prev"){a._.sequence.unshift(k[j].hash)}else{a._.sequence.push(k[j].hash)}}a._.responseData[k[j].hash]=$.extend({},k[j])}a._.currentIndex=a.findImageInSequence(a.getHash());a._.navCheckIfNeedMorePagesDisabled=false;a._.fetchPageEventCount=0;if(a._.sponsoredAd!==undefined){if(!a._.sponsoredAdInserted){a.insertAdIntoSequence(a._.sponsoredAd)}}if(g){g()}});if(f=="prev"&&(this._.sort=="random"||c<this._.pagesLoaded.low)){this._.pagesLoaded.low=c}if(f=="next"&&(c>this._.pagesLoaded.high||this._.sort=="random")){this._.pagesLoaded.high=c}},findImageInSequence:function(c){var a=this._.sequence;for(var b=0;b<a.length;b++){if(a[b]===c){return b}}return -1},setSelectedThumb:function(c){var a=this._;var b=a.elements;if(!c){c=a.sequence[a.currentIndex]}a.elements.$thumbsCarousel.find("img").removeClass("selected");a.elements.$thumbsCarousel.find('img[hash="'+c+'"]').addClass("selected")},isImageWithinThumbs:function(a){return this._.elements.$thumbsCarousel.find('img[hash="'+a+'"]').length},isImageWithinScrollingThumbs:function(d){var b=this._;if(!d){d=b.sequence[b.currentIndex]}if(this.isImageWithinThumbs(d)){return true}var a=this.getNext6Hash(d).concat(this.getPrev6Hash(d));for(var c=0;c<a.length;c++){if(d===a[c]){return true}}return false},updateThumbs:function(b,c){var a=this.getHash();if(!this.isImageWithinThumbs(a)){$(".tipsy").remove();this.slideThumbs(this.isImageWithinScrollingThumbs(a)?b:"far"+b,c,function(){this.setSelectedThumb(a)})}else{this.setSelectedThumb(a)}},blankPage:function(){var a=this._.elements;
Imgur.InfiniteScroll.getInstance().stopInfiniteScroll();a.$image.empty();a.$image.removeClass("zoom");a.$image.css({minHeight:0});a.$imageTitle.empty();a.$infoLeft.empty();a.$sparkbar.empty();a.$sponsoredCaption.empty();$(document).scrollTop(0);$(a.albumTruncated).remove();$(a.albumTruncated).remove();this.clearCaptions();$("#content").css("min-height","0px");this._.pageState=this._.pageStates.no_data;this._.parent_gallery._.vars.scrolledCommentSet=0;this._.parent_gallery._.vars.commentsHTML=null;this.setSpinnerState(true);humanMsg.removeMsg(function(){humanMsg.setup();$("#favoriteMsg").remove()});this._.fetchQueue=[]},pushToFetchQueue:function(f,a,c){var b=this;var d=this._.elements;this._.fetchQueue.push(function(){var h=b,g=d,e=f;b.fetchImage(f,a,c)})},updateVoteResponseData:function(){var a=this;var b=a._.elements;if(b.$voteUp.hasClass("pushed")){a._.responseData[a.getHash()].vote="up"}else{if(b.$voteDown.hasClass("pushed")){a._.responseData[a.getHash()].vote="down"}else{a._.responseData[a.getHash()].vote=null}}this.updatePointsDataResponse()},updatePointsDataResponse:function(){var a=this;var b=parseInt($(".points-"+a.getHash()).text().replace(/,/g,""));a._.responseData[a.getHash()].points=b},setupReportLink:function(){var c=this.getHash();var b=this._.responseData[c];var a=this;if(typeof(Imgur.getInstance()._.auth)!="undefined"&&Imgur.getInstance()._.auth.url==b.account_url&&b.starting_score==0){a._.el.reportImageLink.hide();a._.el.inside.deleteImageLink.show()}else{a._.el.inside.deleteImageLink.hide();a._.el.reportImageLink.show();if($.cookie("r"+this.getHash())==1){a._.el.reportImageLink.addClass("reported");a._.el.reportImageLink.attr("original-title","Image has been reported");a._.el.reportImageLink.unbind("click")}else{this._.el.reportImageLink.removeClass("reported");this._.el.reportImageLink.attr("original-title","Report Image");this._.el.reportImageLink.unbind("click");this._.el.reportImageLink.click(function(){a._.parent_gallery.reportImage()})}}},handleAds:function(){var d=this.getHash();var c=this._.responseData[d];var b=(typeof(c.timestamp)!="undefined"?c.timestamp:c.datetime).split(/[- :]/);var a=new Date();b=new Date(Date.UTC(b[0],b[1]-1,b[2],b[3],b[4],b[5]));a.setUTCMinutes(a.getUTCMinutes()-20);if(!this._.isHotImage&&c.is_hot){this.removeAds();this.showAds()}else{if(this._.section=="new"&&b>a){if(this._.adType!="house"){this.removeAds();this.showHouseAds()}}else{if(this._.section){if($(this._.elements.adWrapper).length==0||this._.adType=="house"){this.removeAds();this.showAds()}}}}},updateSponsoredInfo:function(){var c=this.getHash();var b=this._.elements;var a=this._.responseData[c];Imgur.Gallery.getInstance().setupInsideSponsored();b.$infoLeft.append('<div id="sponsored-by">&nbsp;</div>');b.$statsbox.hide();b.$sponsoredCaption.append('<div class="textbox sponsored-caption"><p>'+a.description+"</p></div>");b.$sponsoredCaption.show()},updateSubmissionInfo:function(){var h=this._;var e=this.getHash();var a=h.elements;var d=h.responseData[e];var j=this;var c=(d.views==0)?'<span title="Views have not yet been calculated">&oslash;</span>':this.numberFormat(d.views);var g=this.numberFormat(d.points,"point").split(" ");a.$infoLeft.append('<span class="points-'+e+'">'+g[0]+'</span> <span class="points-text-'+e+'">'+g[1]+"</span>");a.$statsbox.show();if(d.favorited){if(!a.$favoritedImage.hasClass("favorited")){a.$favoritedImage.addClass("favorited")}}else{a.$favoritedImage.removeClass("favorited")}if(d.subreddit){var b=moment.utc(d.datetime,"YYYY-MM-DD HH:mm:ss").fromNow()}else{if(!d.isAd){var b=moment.utc(((d.is_hot&&d.starting_score)?d.hot_datetime:d.timestamp),"YYYY-MM-DD HH:mm:ss").fromNow()}}if(d.is_hot){a.$bandwidth.parent().show();a.$views.parent().show()}if(d.is_album){a.$bandwidthDiv.hide()}else{a.$bandwidth.html((d.bandwidth=="0.00 KB"?'<span title="Bandwidth has not yet been calculated">&oslash;</span>':d.bandwidth));a.$bandwidthDiv.show()}a.$download.attr("href","/download/"+e+"/"+encodeURIComponent(d.title));if(d.is_album){j.initAlbumLinks();a.$embed.attr("href","/a/"+e+"?gallery");a.$embed.html("View album page")}else{a.$download.unbind("click");a.$embed.unbind("click");a.$embed.attr("href","/"+e+"?tags");a.$embed.html("Get embed codes")}a.$views.html(c);a.$nicetime.text(b);a.$submitDate.text("Submitted "+b);a.$subreddit.text("/r/"+d.subreddit);if(d.in_gallery){a.$reddit.show();if(typeof(Imgur.getInstance()._.auth.url)!="undefined"){a.$reddit.attr("href","/user/"+Imgur.getInstance()._.auth.url+"/favorites/"+d.hash)}else{a.$reddit.attr("href","/gallery/"+d.hash)}a.$reddit.html("View comments in the gallery")}else{if(d.permalink){a.$reddit.show();a.$reddit.attr("href","http://www.reddit.com"+d.permalink);a.$reddit.html("View comments on reddit")}else{a.$reddit.hide()}}if(d.source){a.$originalSource.html('<a href="'+d.source+'">'+Imgur.getInstance().parseUri(d.source).host+"</a>").parent().show()}else{a.$originalSource.parent().hide()}if(d.reddit&&(d.starting_score>0)){a.$submitSourceReddit.html('<a href="http://www.reddit.com'+d.reddit+'">(source)</a>');
a.$submitSourceReddit.show();a.$submitSource.hide()}else{if(d.account_url){a.$submitSource.html('<div class="inline">by&nbsp;</div> <a class="url-truncated" href="/user/'+d.account_url+'">'+d.account_url+"</a>");a.$submitSource.show();a.$submitSourceReddit.hide()}else{a.$submitSource.hide();a.$submitSourceReddit.hide()}}this.clearCaptions();var f=d.ups+d.downs;a.$sparkbar.append(('<div class="title positive __NODOWNS__" title="__UPS__ likes" style="width: __UPPERCENT__%"></div><div class="title negative __NOUPS__" title="__DOWNS__ dislikes" style="width: __DOWNPERCENT__%"></div>').replace(/__NODOWNS__/g,!d.downs?"border-right":"").replace(/__NOUPS__/g,!d.ups?"border-left":"").replace(/__UPS__/g,d.ups).replace(/__DOWNS__/g,d.downs).replace(/__UPPERCENT__/g,100*(d.ups/f)).replace(/__DOWNPERCENT__/g,100*(d.downs/f)));a.$sparkbar.children().tipsy({html:true,gravity:"s",opacity:0.95})},updatePage:function(g){var j=this._;var e=this.getHash();var a=j.elements;var d=j.responseData[e];var n=this;var h=a.$image.width();Imgur.Gallery.getInstance()._.account_url=d.account_url;if(!g){Imgur.History.getInstance().addWindowState("inside_nav.image",d.title,this.getURL({type:"historyState",hash:e}))}this.blankPage();this.setupReportLink();if(d.isAd){}else{this.handleAds()}if(d.page!=this._.currentPage&&this._.sort=="random"){$.post(this.getURL({type:"savePage",page:d.page})).done(function(){n._.currentPage=d.page})}if(d.width>h){var f=h/d.width;a.$image.css({minHeight:(d.height*f)})}else{a.$image.css({minHeight:d.height})}if(!d.is_album){a.$image.addClass("textbox");a.$image.addClass("image")}else{a.$image.removeClass("textbox");a.$image.removeClass("image")}if(d.title!==null){document.title=d.title+" - Imgur";a.$imageTitle.text(d.title).show()}else{document.title=j.galleryTitle+" - Imgur"}if(d.isAd===true){this.updateSponsoredInfo()}else{this.updateSubmissionInfo()}var l=(!d.subreddit&&n._.parent_gallery._.gallery_type!=="favorites");if(!d.image||(l&&!this._.captionInstance.haveCaptions(e))){this.pushToFetchQueue(e,function(p){if(p.is_album===true){n.insertAlbum(a.$image,p)}else{n.insertImage(a.$image,p)}if(l){n.loadCaptions(e)}})}else{if(d.is_album===true){this.insertAlbum(a.$image,d)}else{this.insertImage(a.$image,d)}if(l){this.loadCaptions(e)}}this.checkAdTime();if(d.is_album===true){a.$metadataLink.attr("href",this._.cdnURL+"/"+d.album_cover+d.ext)}else{a.$metadataLink.attr("href",this._.cdnURL+"/"+d.hash+d.ext)}var c="http://"+this._.host+this.getURL({type:"historyState",hash:e});if(d.is_album){c=c.replace("/account/favorites/","/a/")}else{c=c.replace("/account/favorites/","/")}var k=Imgur.ShareButtons.getInstance();if(this._.prev_was_album){k.bindButtons();this._.prev_was_album=false}if(d.is_album){this._.prev_was_album=true}k.setShareTitle(d.title);k.setUrl(c);if(d.vote=="up"){this._.elements.$voteUp.addClass("pushed");this._.elements.$voteDown.removeClass("pushed")}else{if(d.vote=="down"){this._.elements.$voteDown.addClass("pushed");this._.elements.$voteUp.removeClass("pushed")}else{this._.elements.$voteDown.removeClass("pushed");this._.elements.$voteUp.removeClass("pushed")}}this.googleTrackPageview();if(typeof _stippleq!="undefined"){_stippleq.push(["load","31Mn39",{}])}var b=this._.sequence[this.findImageInSequence(e)+1];var o=this._.responseData[b];if(!o){this._.navCheckIfNeedMorePagesDisabled=true;this.fetchPage("next")}else{if(!o.image){this.pushToFetchQueue(b)}}var m=Object.keys(this._.captionInstance._.captions).filter(function(p){return Object.hasOwnProperty.call(n._.captionInstance._.captions,p)&&n.isImageWithinThumbs(p)});this._.captionInstance.purgeCaptionData(m);this._.captionInstance.setHash(e)},insertImage:function(d,b){var a=this._.elements;var c=b.isAd?'<div><div class="sponsored-tag"><a href="http://imgur.com/blog/?p=849" class="title" title="learn more about sponsored images">sponsored</a></div>':"<div>";if(b.width>700){c+="<a href='"+this._.cdnURL+"/"+b.hash+b.ext+"'><img src='"+this._.cdnURL+"/"+b.hash+b.ext+"' alt='' /></a>";a.$image.addClass("zoom");$(".zoom").imageZoom()}else{c+="<img src='"+this._.cdnURL+"/"+b.hash+b.ext+"' alt='' />";a.$image.unbind("click")}c+="</div>";d.append(c)},insertAlbum:function(j,c){if(c.hash!=this.getHash()){return}var h=this._.elements;var d=h.$image.width();var g=c.isAd?'<div class="sponsored-tag"><a href="http://imgur.com/blog/?p=849" class="title" title="learn more about sponsored images">sponsored</a></div>':"";var a=c.album_images.images;for(i in a){if(a[i].title){g+='<h2 class="album-title">'+a[i].title+"</h2>"}if(a[i].width>d){var b=d/a[i].width;var f=(a[i].height*b)}else{var f=a[i].height}g+='<div class="album-image">';if(a[i].width>700){g+='<div class="image textbox zoom" style="min-height: '+f+';"><a href="'+this._.cdnURL+"/"+a[i].hash+a[i].ext+'"><img src="'+this._.cdnURL+"/"+a[i].hash+a[i].ext+'" alt="" /></a></div>'}else{g+='<div class="image textbox" style="min-height: '+f+';"><img src="'+this._.cdnURL+"/"+a[i].hash+a[i].ext+'" alt="" /></div>';h.$image.unbind("click")
}if(a[i].description){g+='<div class="description textbox">'+a[i].description+"</div>"}g+="</div>"}if(c.album_images.count>10&&c.album_images.images.length==10){if(c.album_images.count>50){h.$imageTitle.after('<div id="album-truncated" class="small textbox album-truncated"><a target="_blank" href="http://'+this._.host+"/a/"+c.hash+'?gallery">Viewing the first 10 images of a large album. View all '+c.album_images.count+".</a></div>")}h.$underImage.prepend('<div id="album-truncated" class="small textbox album-truncated"><a target="_blank" href="http://'+this._.host+"/a/"+c.hash+'?gallery">View the entire album, '+c.album_images.count+" images total ("+(c.album_images.count-10)+" remaining).</a></div>");$("#album-truncated a").click(function(){if(c.album_images.count>50){return true}Imgur.Gallery.getInstance().loadFullAlbum();return false})}j.append(g);$(".zoom").imageZoom()},insertCaption:function(e,d,c,b){var a=$(e);if(b){a.append(c)}else{a.html(c)}a.siblings(".caption-error").hide();if(!b){this._.captionInstance.updateCaptionCount()}},initAlbumLinks:function(){var c=this._.elements;var b=this;function a(){c.$download.unbind("click");c.$embed.unbind("click");c.$download.click(function(){Imgur.Album.getInstance()._.id=b.getHash();Imgur.Album.getInstance().downloadAlbum();return false})}if(typeof Imgur.Album=="undefined"){$.getScript("http://s."+b._.host+"/min/album_js?"+Imgur.Gallery.getInstance().getCacheValue(),a)}else{a()}},googleTrackPageview:function(){if(!("_gaq" in window)){_gaq=[];_gaq.push(["_setAccount","UA-6671908-2"])}_gaq.push(["_trackPageview",window.location.pathname]);$('<img src="//pixel.quantserve.com/pixel/p-f8oruOqDFlMeI.gif" border="0" height="1" width="1" alt="Quantcast"/>')},bindGoogleForceRefresh:function(){var a=this;if(this._.elements.$adPanel.length){var b=this._.elements.$adPanel.find("iframe")[0];if(typeof b!="undefined"){b.onload=function(){a.forceAdRefresh()}}}},forceAdRefresh:function(){this._.ad.nextImageLoadRefreshesAd=true},checkAdTime:function(){var c=this._.elements;var b=this;if(this._.ad.nextImageLoadRefreshesAd){var c=b._.elements;if(typeof dfp_adslot!=="undefined"){try{googletag.pubads().refresh([dfp_adslot]);b.bindGoogleForceRefresh()}catch(c){}}if(c.$zedo.length>0){try{c.$zedo[0].contentWindow.location.replace(this._.ad.zedo.URL)}catch(c){}}if(c.$mgidPanel.length>0){try{var a=new Date();c.$mgidPanel.empty();$.getScript("http://jsc.dt07.net/i/m/imgur.com.1958.js?t="+a.getYear()+a.getMonth()+a.getDay()+a.getHours(),false,false)}catch(c){}}this._.ad.nextImageLoadRefreshesAd=false;window.clearTimeout(this._.ad.currentTimeout);this._.ad.currentTimeout=window.setTimeout(function(){b._.ad.nextImageLoadRefreshesAd=true;b._.ad.currentTimeout=undefined},this._.ad.timeTillRefresh)}else{if(!this._.ad.currentTimeout){this._.ad.currentTimeout=window.setTimeout(function(){b._.ad.nextImageLoadRefreshesAd=true;b._.ad.currentTimeout=undefined},this._.ad.timeTillRefresh)}}},removeAds:function(){$(this._.elements.adWrapper).remove();$(this._.elements.zinkAds).addClass("nodisplay")},showAds:function(){this._.adType="normal";if(typeof(Imgur.getInstance()._.auth)!="undefined"&&Imgur.getInstance()._.auth.isPro===true){return}$("#right-content").append('<div class="advertisement">             <div class="panel-ad">                 <div id="div-gpt-ad-1345436847476-0" style="width:300px; height:250px;"></div>            </div>             <div class="ad-text">                 Advertisement: <a href="/register/upgrade">pro users don\'t see ads</a>             </div>         </div>');googletag.cmd.push(function(){googletag.display("div-gpt-ad-1345436847476-0")});$(this._.elements.zinkAds).removeClass("nodisplay")},showHouseAds:function(){this._.adType="house";if(typeof(Imgur.getInstance()._.auth)!="undefined"&&Imgur.getInstance()._.auth.isPro===true){return}$("#right-content").append('<div class="advertisement">             <div class="panel-ad">                 <iframe src="http://optimized-by.rubiconproject.com/a/8526/14505/30299-15.html?'+Math.floor(Math.random()*10000)+'" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" width="300" height="250"></iframe>             </div>             <div class="ad-text">                 Advertisement: <a href="/register/upgrade">pro users don\'t see ads</a>             </div>         </div>')},checkIfNeedsMorePages:function(b){if(this._.navCheckIfNeedMorePagesDisabled){return}var a=b!==undefined?b:this._.currentIndex;if((a+18)>=this._.sequence.length){this.fetchPage("next");this._.navCheckIfNeedMorePagesDisabled=true}if((a-18<0)){this.fetchPage("prev");this._.navCheckIfNeedMorePagesDisabled=true}},checkIfNeedsMorePagesInit:function(){var a=this._.currentIndex;if((a+6)>=this._.sequence.length){this.fetchPage("next")}if((a-6<0)){this.fetchPage("prev")}},getNext6Hash:function(c){if(!c){c=this._.sequence[this._.currentIndex-1]}var a=this.findImageInSequence(c)+1;this.checkIfNeedsMorePages(a);var b=this._.sequence.slice((a+6<this._.sequence.length?a:this._.sequence.length-6),(a+6<this._.sequence.length?a+6:this._.sequence.length));
return b},getCurrent6Hash:function(b){if(!b){b=this._.sequence[this._.currentIndex]}var a=this.findImageInSequence(b);this.checkIfNeedsMorePages(a);return this._.sequence.slice(a,a+6)},getPrev6Hash:function(d,b){var a=d?this.findImageInSequence(d):this._.currentIndex+1;this.checkIfNeedsMorePages(a);var c=this._.sequence.slice((a-6)<0?0:a-6,a);if(b&&c.length<6){return c.length}c=c.concat(this._.sequence.slice(a,(a+6-c.length)));return c},enableAllThumbButtons:function(){this._.elements.$thumbsCarouselNext.removeClass("disabled");this._.elements.$thumbsCarouselPrev.removeClass("disabled")},disableThumbButton:function(a){if(a==="prev"){this._.elements.$thumbsCarouselPrev.addClass("disabled")}if(a==="next"){this._.elements.$thumbsCarouselNext.addClass("disabled")}},isThumbButtonDisabled:function(a){if(a==="prev"){return this._.elements.$thumbsCarouselPrev.hasClass("disabled")}if(a==="next"){return this._.elements.$thumbsCarouselNext.hasClass("disabled")}},slideThumbs:function(c,m,n){var h=this._.elements;var g=n;var o=this;var b=[];var f;switch(c){case"prev":f=this._.thumbInfo.prevHash;case"farprev":if(this.isThumbButtonDisabled("prev")){return}b=this.getPrev6Hash(f);this.enableAllThumbButtons();if(this.getPrev6Hash(f,true)<6){this.disableThumbButton("prev")}break;case"next":if(this.isThumbButtonDisabled("next")){return}f=this._.thumbInfo.nextHash;b=this.getNext6Hash(f);this.enableAllThumbButtons();break;case"current":case"farcurrent":case"farnext":b=this.getCurrent6Hash();this.enableAllThumbButtons();break}if(b.length<=0){return}var k=[];for(var d=0;d<3;d++){k.unshift(b.pop())}var j=[];for(var d=0;d<3;d++){j.unshift(b.pop())}function a(e){var t="";for(var p=0;p<3;p++){var s=o._.responseData[e[p]];var r=e[p]?o.getURL({type:"thumb",hash:(s.is_album===true?s.album_cover:e[p]),ext:".jpg"}):"/images/blank.gif";var q="";if(s.title){q=s.title.replace(/"/g,"&quot;").replace(/&/g,"&amp;").replace(/</g,"").replace(/>/g,"")}if(s){t+='<li><a href="'+o._.baseURL+"/"+e[p]+'" id="thumb-for-'+e[p]+'">'+(s.isAd?'<div class="sponsored-tag-nav-thumb">&nbsp;</div>':"")+'<img class="thumb-title'+(s.isAd?" sponsored":"")+'" src="'+r+'" hash="'+e[p]+'" title="'+((q?q:"")+(s.points!==null&&!s.subreddit?"<p>"+o.numberFormat(s.points,"point")+(o._.section!=="new"?" : "+((s.views==0?"&oslash; views":o.numberFormat(s.views,"view"))):"")+"</p>":(o._.section!=="new"?("<p>"+(s.views==0?"&oslash; views":o.numberFormat(s.views,"view")))+"</p>":"")))+'"/></a></li>'}else{t+='<li><a href="javascript:;"><img class="thumb-title" src="'+r+'"/></a></li>'}}return t}var l="+=0";switch(c){case"current":case"farcurrent":case"farprev":case"farnext":if(!this.isImageWithinThumbs(this.getHash())){h.$thumbsCarouselTopContents.empty();h.$thumbsCarouselBottomContents.empty();h.$thumbsCarouselTopContents.append(a(j));h.$thumbsCarouselBottomContents.append(a(k))}break;case"prev":h.$thumbsCarouselTopContents.prepend(a(j));h.$thumbsCarouselBottomContents.prepend(a(k));h.$thumbsCarousel.jcarousel("scroll","+=3",false);l="-=3";break;case"next":h.$thumbsCarouselTopContents.append(a(j));h.$thumbsCarouselBottomContents.append(a(k));l="+=3";break}this._.thumbInfo.nextHash=k[2];var b=j.concat(k);if(j[0]){this._.thumbInfo.prevHash=j[0]}else{this._.thumbInfo.prevHash=b[0]}h.$thumbsCarousel.jcarousel("scroll",l,!m,function(){var q=o;$(".tipsy").remove();for(var p=0;p<b.length;p++){var e=h.$thumbsCarousel.find("a#thumb-for-"+b[p]);e.unbind("click");e.click(function(){q.navToImage({hash:$(this).find("img").attr("hash")});return false})}if(c=="next"){h.$thumbsCarouselTopContents.find("li:lt("+(h.$thumbsCarouselTopContents.find("li").length-3)+")").remove();h.$thumbsCarouselBottomContents.find("li:lt("+(h.$thumbsCarouselBottomContents.find("li").length-3)+")").remove();h.$thumbsCarousel.jcarousel("reload")}else{if(c=="prev"){h.$thumbsCarouselTopContents.find("li:gt(2)").remove();h.$thumbsCarouselBottomContents.find("li:gt(2)").remove()}}if(n){n.call(o)}});return false},initThumbsCarousel:function(){var b=this._.elements;var a=this;b.$thumbsCarousel.jcarousel({animation:this._.thumbsSpeed});b.$navPrev.removeAttr("href");b.$navNext.removeAttr("href");b.$navPrev.click(function(){a.navToImage({direction:"prev"})});b.$navNext.click(function(){a.navToImage({direction:"next"})});b.$thumbsCarouselNext.click(function(){var c=a;a._.navCheckIfNeedMorePagesDisabled=false;a.slideThumbs.call(a,"next",false,function(){c.setSelectedThumb()})});b.$thumbsCarouselPrev.click(function(){var c=a;a.slideThumbs.call(a,"prev",false,function(){c.setSelectedThumb()})});b.$thumbsCarousel.find("a").each(function(d,c){c=$(c);var e=a;c.click(function(){e.navToImage({hash:c.find("img").attr("hash")});return false})})},hideZoomedImage:function(){if($(".jquery-image-zoom").is(":visible")){$("div.jquery-image-zoom a").click()}$.colorbox.close()},clearPrefetchForImage:function(){var a=this._.responseData[this.getHash()];a.image=undefined;a.captions=undefined},timeoutNextImage:function(){if(this._.autoBrowse&&!this._.autoBrowseTimeout){var b=7000;
var a=this;this._.autoBrowseTimeout=setTimeout(function(){a._.autoBrowseTimeout=null;$("#navNext input").click()},b)}else{if(this._.autoBrowse){window.clearTimeout(this._.autoBrowseTimeout);this._.autoBrowseTimeout=null;this.timeoutNextImage()}}},bindAutoBrowse:function(){var a=this;$(document).keyup(function(b){if(b.ctrlKey&&b.keyCode===120){a._.autoBrowse=!a._.autoBrowse;if(a._.autoBrowse){a.timeoutNextImage();humanMsg.displayMsg("Starting auto browse in 5 seconds!")}else{clearTimeout(a._.autoBrowseTimeout);humanMsg.displayMsg("Done already?")}}return true})},navToImage:function(d,b){if(this._.currentIndex===-1){var c=this._.elements.$thumbsCarouselTopContents.find("img").attr("hash");var a=this.findImageInSequence(c);this._.currentIndex=(a>0)?a-1:0}if(this._.currentIndex==this.findImageInSequence(d.hash)){return}this.hideZoomedImage();if(typeof d.hash!=="undefined"){this.setHash(d.hash);this._.currentIndex=this.findImageInSequence(d.hash);d.direction="current"}else{if(d.direction==="prev"){var e=this._.currentIndex-1<0?0:-1;this._.currentIndex+=e;if(e===0){return}this.setHash(this._.sequence[this._.currentIndex])}else{if(d.direction==="next"){var e=this._.currentIndex+1<this._.sequence.length?1:0;if(e===0){this.checkIfNeedsMorePages();return}else{this._.currentIndex+=e}this.setHash(this._.sequence[this._.currentIndex])}else{return}}}Imgur.Caption.Reply.getInstance().setHash(this.getHash());this.updatePage(b);this.updateThumbs(d.direction,true,undefined);this.checkIfNeedsMorePages();this.timeoutNextImage()}});Class.addSingleton(Imgur.InsideNav);
;Namespace("Imgur.Fullscreen");Imgur.Fullscreen=Class.extend({init:function(a){this._=$.extend({signed:Imgur.getInstance()._.signed,el:{$fullscreenBox:$(".fullscreenBox"),$fullscreenLink:$(".album-fullscreen-link"),$userActionLinks:$(".userActionLinks"),$embed:$("#fullscreenEmbed")}},a);if(window.fullScreenApi&&fullScreenApi.supportsFullScreen&&this._.el.$embed.length){if(this._.signed){this._.el.$fullscreenBox.hide();this._.el.$fullscreenBox=$(".fullscreenAlbumOptions");this._.el.$fullscreenLink=$(".fullscreenAlbumOptions .album-fullscreen-link")}if(this._.el.$fullscreenLink.length){this._.el.$fullscreenLink.unbind("click");this._.el.$fullscreenLink[0].removeEventListener("click",this.viewFullscreen);this._.el.$fullscreenLink[0].addEventListener("click",this.viewFullscreen,true)}if(this._.el.$userActionLinks.hasClass("vertical")){this._.el.$userActionLinks.css({"line-height":"22px",padding:"8px","font-size":"13px"})}this._.el.$embed.attr("src","");this._.el.$fullscreenBox.show()}},viewFullscreen:function(){var a=Imgur.Fullscreen.getInstance();var e=a._.el.$embed;var b=e[0];if(!a._.el.$embed.length){setTimeout(a.viewFullscreen,80)}else{if(!a._.el.$embed.attr("src")||!a._.el.$embed.attr("src").length){a._.el.$embed.attr("src","/a/"+Imgur.Album.getInstance()._.id+"/embed");$(a._.el.$embed[0].contentDocument).ready(a.viewFullscreen);humanMsg.displayMsg("Starting fullscreen mode...");return}}a._.el.$embed.show();window.fullScreenApi.requestFullScreen(b);setTimeout(a.focusOverlayAfterOpen,99);var d=setInterval(function(){a.showOverlayIfOpen(d)},100);var c=setInterval(function(){a.closeOverlayIfExited(c)},100)},focusOverlayAfterOpen:function(){var a=Imgur.Fullscreen.getInstance();if(fullScreenApi.isFullScreen()){a._.el.$embed[0].contentWindow.focus();$(a._.el.$embed[0].contentWindow).keydown(function(b){if(b.which==27){a._.el.$embed.hide()}b.stopPropagation()})}else{window.fullScreenApi.requestFullScreen(a._.el.$embed[0]);setTimeout(a.focusOverlayAfterOpen,200)}},showOverlayIfOpen:function(b){var a=Imgur.Fullscreen.getInstance();if(!a._.el.$embed.is(":visible")){a._.el.$embed.css({display:"block",opacity:"100%"})}else{clearInterval(b)}},closeOverlayIfExited:function(b){var a=Imgur.Fullscreen.getInstance();if(!fullScreenApi.isFullScreen()){if(a._.el.$embed.is(":visible")){a._.el.$embed.css({display:"none"})}else{clearInterval(b)}}}});Class.addSingleton(Imgur.Fullscreen);
;Namespace("Imgur.Caption.Reply");Imgur.Caption.Reply=Imgur.Caption.extend({init:function(a){this._=$.extend({isReply:true,defaultText:"Reply ",replyClass:"create-caption",replyHandler:null},a);this._super(this._)},blurTextarea:function(a){$(a).parent().remove();$(".caption-error").remove()},insertCaption:function(c,e){var a=$(e);var f=a.children("textarea");var b=a.siblings("."+this._.children);if(!b.length){b=this.createChildrenDiv(e.parent())}b.show();var d=a.siblings(".caption").children(".no-expand");if(d.length){this.insertToggle(d.parent());d.remove()}$(c).hide().prependTo(b).fadeIn(250);f.val("").blur();this.setupResponseHandlers($(c))},clickHandler:function(b){var a=$(b.target).closest(".comment");this.expandOne(a);a=a.children(".caption");this.createReply(a).children("textarea").focus();return this},createReplyHtml:function(){var a=$("<div/>",{"class":"create-caption textbox"});a.append($("<textarea/>",{name:this.sid,"class":"caption-textarea"}).html(this._.defaultText));a.append($("<input/>",{type:"hidden",name:"parent_id",value:""}));a.append($("<input/>",{type:"button",name:"save","class":"submit submit-caption-button button-medium",value:"save"}).css("margin-bottom","7px"));a.append($("<span/>",{"class":"counter left"}));a.append($("<div/>",{"class":"save-caption-loader"}));a.append($("<div/>",{"class":"clear"}));return a},insertToggle:function(c){var a=this;var b=$("<a/>",{"class":"expand left",href:"javascript:;"}).html("–").click(function(d){a.expandClickHandler(d)});$(c).prepend(b)},createReply:function(c){var a=$(c);var e=this.createReplyHtml();this._.$captions.find("."+this._.replyClass).remove();e.insertAfter(a);var d=this.getCaptionId(a);e.find('input[name="parent_id"]').val(d);var b=e.width()-99;e.children("textarea").width(b);this.addSubmitHandlers(e);return e},textareaBlurHandler:function(c){var a=$(c.target);var b=this;if(!$.browser.msie){if(a.val().trim()===""){setTimeout(function(){b.blurTextarea(a)},150)}a.val(a.val().trim())}else{if(a.val()===""){setTimeout(function(){b.blurTextarea(a)},150)}}},replySuccess:function(a,b){if(this._.replyHandler){this._.replyHandler(a,b)}},appendError:function(a,b){$(this._.captioningTooFast(b)).insertAfter(a).fadeIn(250)},setReplyHandler:function(a){this._.replyHandler=a},});Class.addSingleton(Imgur.Caption.Reply);
;Namespace("Imgur.Gallery");Imgur.Gallery=Imgur.extend({init:function(a){$.extend(this.settings,a);this._=$.extend({sid:Imgur.getInstance()._.sid,signed:false,cdnURL:Imgur.getInstance()._.cdnUrl,baseURL:null,sort:"hot",section:null,window:"day",page:0,maxPage:0,hash:null,nextHash:null,prevHash:null,showPast:true,commentName:"comment",indexName:"gallery",searchQuery:null,account_url:null,mobile:false,isRandom:false,hasSponsoredAd:false,debugTLDR:false,gallery_type:null,using_cache:true,el:{arrows:$(".arrow"),imageLinks:$(".image-link"),randomButton:$(".random-button"),reportImageLink:$("#report-image"),outside:{noMorePagesID:"#nomore",loaderID:"#imagelist-loader",loadMoreID:"#load-more",content:$("#imagelist"),searchBar:$(".search"),searchForm:$(".search-form"),messagebox:$("#messagebox"),comboboxes:$(".combobox"),toggleViral:$("#showviral"),galleryNewInfo:{id:"#gallery-new-info","$okay":$("#gallery-new-info-okay"),"$no":$("#gallery-new-info-decline")}},inside:{counter:null,image:$(".image"),arrows:$(".image-arrows"),zoom:$(".zoom"),accountBio:$("#account-bio.access"),submitCaptionButton:$(".submit-caption-button"),commentExpand:$("#expand-comments"),comboboxes:$(".combobox"),commentSort:$("#comment-sort"),deleteImageLink:$("#delete-image"),"$comments":$("#captions"),favoriteImageLink:$("#favorite-image"),reCaptionLink:$("#meme-image"),downloadAlbumForm:{id:"#download-album-form",emailInput:$("#download-album-form #email"),form:$("#download-album-form #download-form"),message:$("#message"),save:$("#download-album-form #save"),loader:$("#download-loader")},},user:{notorietyLink:$("#notoriety-link"),notorietyList:$("#notoriety-list"),buttonComments:$(".button.comments"),buttonFavorites:$(".button.likes"),buttonSubmitted:$(".button.submitted"),captions:$("#captions"),favorites:$("#likes"),loader:$("#loader"),pmButton:$("#pm-button"),pmWrapper:$("#pm-wrapper"),pmSubject:$('#pm-wrapper input[type="text"]'),pmBody:$("#pm-wrapper textarea"),pmSendButton:$("#pm-send-button"),pmForm:$("#pm-wrapper form"),pmSent:$("#pm-sent"),updateLevelTable:$("#update-level-table"),"$carousel":$("#thumbs-top")},past:{wrapper:$("#past-wrapper"),previewContent:$("#past-preview"),loader:$("#past-loader"),link:$("#past-link"),slider:$("#slider"),days:$("#days"),ticker:$("#slider-wrapper .ticker"),positiveTickClass:"positive",negativeTickClass:"negative",submitButton:$("#past-submit"),calendar:$("#past-calendar")},colorboxConfirmForm:{id:"#colorbox-confirm",title:$("#colorbox-confirm h1"),message:$("#colorbox-confirm-message"),yes:$("#colorbox-confirm-yes"),no:$("#colorbox-confirm-no"),loader:$("#colorbox-confirm .small-loader")},},vars:{pastPage:0,scrolledPage:0,scrolledImageSet:0,scrolledCommentSet:0,pastTickerTimer:null,captionLength:140,isCaptioning:false,commentsHTML:null},messages:null,parent_gallery:null,},a);this._super(this._);return this._},getCacheValue:function(){var a="";$("script[type*=javascript]").each(function(){if(this.src){var c=this.src.split("?");var b=c[0].split("/").pop().trim();if(b=="gallery_js"){a=c[1];return}}});return a},isNumberKey:function(b){var a=(b.which)?b.which:b.keyCode;if(a>31&&(a<48||a>57)){return false}return true},bindArrowKeys:function(){var a=this;$(document).keydown(function(c){if(!c.ctrlKey&&!c.altKey&&!c.metaKey){if(c.keyCode==37){a.showPrevious();c.preventDefault()}else{if(c.keyCode==39){a.showNext();c.preventDefault()}else{if(c.keyCode==13){if($(c.target).is("input")||$(c.target).is("textarea")){return true}var d=$(".jquery-image-zoom");if(d.length){d.click()}else{var b=$(".image img");if(b.length){b[0].click()}}}else{if(c.keyCode==189||c.keyCode==109||c.keyCode==173){if(!$(c.target).is("input")&&!$(c.target).is("textarea")){$('.arrow.down[type="image"]').click()}}else{if(c.keyCode==187||c.keyCode==107||c.keyCode==61){if(!$(c.target).is("input")&&!$(c.target).is("textarea")){$('.arrow.up[type="image"]').click()}}else{if(c.keyCode==57||c.keyCode==105){if(!$(c.target).is("input")&&!$(c.target).is("textarea")){$("#album-truncated a").click()}}}}}}}return true}return true});if(this._.isRandom){this._.el.randomButton.click(function(){a.showNext();return false})}},remove:function(a){$.post(this._.baseURL+"/action/remove_image/"+a,{remove:true,sid:this._.sid},function(b){$("#remove-"+a).fadeOut()})},ban:function(){$.post("/adm/removals/ban",{account_url:this._.account_url,type:"main",sid:this._.sid},function(a){$("#ban-user").fadeOut()})},spam:function(){$.post("/adm/removals/markspammer",{account_url:this._.account_url,type:"main",sid:this._.sid},function(a){$("#spam-user").fadeOut()})},bindReportImage:function(){var a=this;this._.el.colorboxConfirmForm.no.unbind("click");this._.el.colorboxConfirmForm.yes.unbind("click");this._.el.colorboxConfirmForm.title.html("Report Submission");this._.el.colorboxConfirmForm.message.html(this._.messages.reportImage);$.colorbox.resize();this._.el.colorboxConfirmForm.no.click(function(){$.colorbox.close()});this._.el.colorboxConfirmForm.yes.click(function(){if(!a._.signed){Imgur.getInstance().signin()
}a._.el.colorboxConfirmForm.yes.disable();a._.el.colorboxConfirmForm.loader.show();$.post(a._.baseURL+"/action/report_image/"+a.imgurInsideNav.getHash(),{sid:a._.sid},function(b){a._.el.colorboxConfirmForm.loader.hide();a._.el.colorboxConfirmForm.yes.enable();a._.el.reportImageLink.addClass("reported");a._.el.reportImageLink.attr("original-title","Submission has been reported");a._.el.reportImageLink.unbind("click");if(a._.signed){$.colorbox.close();humanMsg.displayMsg("Submission has been reported");if(typeof callback=="function"){callback(b)}}}).error(function(){a._.el.colorboxConfirmForm.yes.enable();a._.el.colorboxConfirmForm.loader.hide()})})},reportImage:function(){var a=this;$.colorbox.init();$.colorbox({href:a._.el.colorboxConfirmForm.id,open:true,inline:true,top:"15%",transition:"none",scrolling:false,onComplete:function(){a.bindReportImage()}})},bindDeleteImage:function(){var a=this;this._.el.colorboxConfirmForm.no.unbind("click");this._.el.colorboxConfirmForm.yes.unbind("click");this._.el.colorboxConfirmForm.title.html("Remove Submission from Gallery");this._.el.colorboxConfirmForm.message.html(this._.messages.deleteImage);$.colorbox.resize();this._.el.colorboxConfirmForm.no.click(function(){$.colorbox.close()});this._.el.colorboxConfirmForm.yes.click(function(){a._.el.colorboxConfirmForm.yes.disable();a._.el.colorboxConfirmForm.loader.show();$.post(a._.baseURL+"/action/delete_image/"+a._.hash,{sid:a._.sid},function(b){a._.el.colorboxConfirmForm.loader.hide();a._.el.colorboxConfirmForm.yes.enable();if(a._.signed){$.colorbox.close();humanMsg.displayMsg("Submission has been removed");setTimeout(function(){window.location="http://"+a._.host},500)}}).error(function(){a._.el.colorboxConfirmForm.yes.enable();a._.el.colorboxConfirmForm.loader.hide()})})},deleteImage:function(){var a=this;$.colorbox.init();$.colorbox({href:a._.el.colorboxConfirmForm.id,open:true,inline:true,top:"15%",transition:"none",scrolling:false,onComplete:function(){a.bindDeleteImage()}})},favoriteImage:function(){var a=Imgur.Gallery.getInstance();var b=false;if(typeof(Imgur.InsideNav.getInstance()._.responseData[Imgur.InsideNav.getInstance().getHash()])!="undefined"){b=Imgur.InsideNav.getInstance()._.responseData[Imgur.InsideNav.getInstance().getHash()].is_album}Imgur.Favorite.getInstance().favorite(Imgur.InsideNav.getInstance().getHash(),b,function(c){if(c=="favorited"){Imgur.InsideNav.getInstance()._.responseData[Imgur.InsideNav.getInstance().getHash()].favorited=true}else{if(c=="unfavorited"){Imgur.InsideNav.getInstance()._.responseData[Imgur.InsideNav.getInstance().getHash()].favorited=false}}})},reCaption:function(){var a=Imgur.InsideNav.getInstance().getHash();window.location="/memegen/create/"+a},setupOutsideSponsored:function(){var c=tldr.get_image_id();var a=$('<div id="'+c+'" class="post sponsored"><div class="sponsored-tag">sponsored</div></div>');var b=$('<a href="/gallery/'+c+'"><img src="http://i.imgur.com/'+c+'b.png" title="'+tldr.get_title()+'" /></a>');b.find("img").tipsy({gravity:"n",opacity:0.95,offset:-8,html:true});tldr.impression(tldr.IMPRESSION_TYPE.gallery);b.click(function(){tldr.click(tldr.CLICK_TYPE.gallery)});$(".posts").prepend(a.append(b))},setupInsideSponsored:function(){var a=tldr.CLICK_TYPE;var b=tldr.IMPRESSION_TYPE;tldr.impression(b.fullpage);$(".image-arrows .arrow.up").click(function(){tldr.click(a.upvote)});$(".image-arrows .arrow.down").click(function(){tldr.click(a.downvote)});$("#captions .arrow.up").live("click",function(){tldr.click(a.upvote)});$("#captions .arrow.down").live("click",function(){tldr.click(a.downvote)});this._.el.inside.submitCaptionButton.click(function(){tldr.click(a.comment)});$("#caption_textarea").keydown(function(d){var c=$(d.target);if(d.keyCode==13&&$.trim(c.val())){tldr.click(a.comment)}});$(".social li").click(function(){var c=$(this).find("span").attr("class");switch(c){case"twitter_custom":tldr.click(a.twitter_share);break;case"facebook_custom":tldr.click(a.fb_share);break;case"reddit_custom":tldr.click(a.reddit_share);break;case"tumblr_custom":tldr.click(a.tumblr_share);break;case"stumbleupon_custom":tldr.click(a.stumble_share);break;case"st_email_custom":tldr.click(a.email_share);break;case"addthis_button st_sharethis_custom":tldr.click(a.other_share);break}})},insertAd:function(a){var d=Math.floor(Math.random()*1000);var c=$('<div id="bottom-ad" class="advertisement"></div>');var b=$('<div class="panel-ad advertisement"></div>');var f=$('<div class="advertisement ad-text">Advertisement: <a href="/register/upgrade">pro users don\'t see ads</a></div>');var e=$('<iframe src="http://imgur.com/include/rc-iframe.html?cb='+d+'" framespacing="0" frameborder="no" scrolling="no" width="300" height="250" allowtransparency="true"></iframe>');$(b).append(e);$(c).append(b);$(c).append(f);$(c).css("top",a+"px");$("#content").append(c)},initTipsy:function(){$("#imagelist img, .thumbnails img, .thumbs img, .image img, .thumb-title").tipsy({gravity:"n",opacity:0.95,offset:-8,html:true,live:true})
},initZoom:function(){this._.el.inside.zoom.imageZoom()},showPrevious:function(){if(this._.prevHash){window.location=this._.baseURL+"/"+this._.prevHash}},showNext:function(){if(this._.nextHash){window.location=this._.baseURL+"/"+this._.nextHash}},showPastPreview:function(){if(this._.vars.pastPage>this._.vars.maxDays){this._.vars.pastPage=this._.vars.maxDays;this._.el.past.days.val(this._.vars.pastPage)}$(".tipsy").remove();this._.el.past.previewContent.empty();this._.el.past.loader.show();var b=this;var a=(Imgur.getInstance()._.signed?"miss":"hit");$.get(this._.baseURL+"/past/page/"+(this._.showPast?this._.vars.pastPage:this._.vars.pastPage-1)+"/"+a+"?scrolled",function(c){b._.el.past.loader.hide();b._.el.past.previewContent.html(c);b._.el.past.previewContent.find("img").tipsy({gravity:"n",opacity:0.95,offset:-8,html:true})})},pastOnLoad:function(){this.hideAds();if(this._.el.past.previewContent.find("h3").size()==0){this.showPastPreview()}this._.el.past.days.val(this._.vars.pastPage);var a=this;this._.el.past.calendar.DatePicker({format:"m/d/Y",date:"",current:"",starts:1,position:"bottom",onBeforeShow:function(){var b=new Date();b.setUTCHours(0);b.setUTCMinutes(0);b.setUTCSeconds(0);b.setUTCMilliseconds(0);var c=a._.el.past.days.val()*86400000;var e=new Date(b.getTime()-c);var d=(e.getUTCMonth()+1)+"/"+e.getUTCDate()+"/"+e.getUTCFullYear();$(this).DatePickerSetDate(d,true);$(".datepicker").css("z-index",10000)},onHide:function(){$(".datepicker").css("z-index","")},onChange:function(c,e){var b=new Date();var f=new Date(e);b.setUTCHours(0);b.setUTCMinutes(0);b.setUTCSeconds(0);b.setUTCMilliseconds(0);f.setUTCHours(0);f.setUTCMinutes(0);f.setUTCSeconds(0);f.setUTCMilliseconds(0);var d=Math.max(Math.floor((b.getTime()-f.getTime())/86400000),0);d=Math.min(d,a._.maxPage);a._.el.past.days.val(d);a._.vars.pastPage=d;a._.el.past.calendar.DatePickerHide();a._.el.past.slider.slider("value",a._.vars.pastPage);a.showPastPreview()}});$(this._.el.past.slider).slider({value:this._.vars.pastPage,min:(this._.vars.showPast?0:1),max:this._.maxPage,step:1,slide:function(b,c){a._.vars.pastPage=c.value;a._.el.past.days.val(a._.vars.pastPage)},change:function(){a.showPastPreview()}})},pastClickHandler:function(){var a=this;$.colorbox.init();$.colorbox({href:"#"+this._.el.past.wrapper.attr("id"),inline:true,innerWidth:this._.el.past.wrapper.width()+20,innerHeight:this._.el.past.wrapper.height()+20,transition:"none",open:true,onLoad:function(){a.pastOnLoad()},onClosed:function(){a.showAds()}})},pastDaysChangeHandler:function(a){this._.vars.pastPage=parseInt(a.currentTarget.value);this._.el.past.slider.slider("value",this._.vars.pastPage)},pastDaysKeypressHandler:function(a){return this.isNumberKey(a)},pastTickerClickHandler:function(c){clearTimeout(this._.vars.pastTickerTimer);if($(c.target).hasClass(this._.el.past.positiveTickClass)){this._.vars.pastPage=(this._.vars.pastPage+1)<this._.maxPage?this._.vars.pastPage+1:this._.maxPage}else{this._.vars.pastPage=(this._.vars.pastPage-1)>0?this._.vars.pastPage-1:0}this._.el.past.days.val(this._.vars.pastPage);var b=this;var a=function(){b.showPastPreview()};this._.vars.pastTickerTimer=setTimeout(a,400)},pastSubmitClickHandler:function(){$.colorbox.close();window.location=(this._.baseURL+"/hot/viral/page/")+(this._.showPast?this._.vars.pastPage:this._.vars.pastPage-1)},showLoadMore:function(b){var a=this;$(this._.el.outside.loaderID).html(a._.messages.loadMore);$(this._.el.outside.loadMoreID).click(function(c){$(c.target).unbind("click");$(c.target).parent().html('<img src="http://s.imgur.com/images/album_loader.gif" />');a.loadMore(true)})},loadMore:function(d){var b=(Imgur.getInstance()._.signed?"miss":"hit");if(!d&&(this._.vars.scrolledPage)%5==0&&this._.vars.scrolledImageSet==-1){this.showLoadMore();return}if($(this._.el.outside.loaderID).length>0){var a=this;if(a._.section!="hot"){a._.vars.scrolledImageSet=-1;var c=this._.baseURL+(this._.section?"/"+this._.section:"")+"/"+this._.sort+"/"+this._.window+"/page/"+(++this._.vars.scrolledPage)+"/"+b+"?scrolled"+(this._.searchQuery?"&q="+this._.searchQuery:"")}else{var c=this._.baseURL+(this._.section?"/"+this._.section:"")+"/"+this._.sort+"/"+this._.window+"/page/"+(this._.vars.scrolledPage)+"/"+b+"?scrolled&set="+(++this._.vars.scrolledImageSet)+(this._.searchQuery?"&q="+this._.searchQuery:"")}$.ajax({url:c,success:function(j){if($(a._.el.outside.noMorePagesID).length>0){return}if(a._.vars.scrolledImageSet>=1){a._.el.outside.content.find(".posts:last .clear").remove();a._.el.outside.content.find(".posts:last").append(j);a._.el.outside.content.find(".posts:last").append('<div class="clear"></div>')}else{a._.el.outside.content.append(j)}a._.el.outside.content.find("img").tipsy({gravity:"n",opacity:0.95,offset:-15,html:true});Imgur.getInstance().runPlaceholder();var f=$(".arrow");f.unbind("click");f.click(function(i){a.vote(i)});a.initOutsideComboboxes();if($(a._.el.outside.noMorePagesID).length==0){if($(j).find("img").length<56){if(a._.hasSponsoredAd&&a._.vars.scrolledPage===0){a._.el.outside.content.find(".posts:last .empty").remove();
a._.el.outside.content.find(".posts:last .clear").remove();var h=$(j).find("img").length;var e=((h%4)-4)*-1;if(e<4){for(var g=0;g<e;g++){a._.el.outside.content.find(".posts:last").append('<div class="post empty"></div>')}}a._.el.outside.content.find(".posts:last").append('<div class="clear"></div>')}a._.vars.scrolledPage++;a._.vars.scrolledImageSet=-1}$(a._.el.outside.loaderID).remove();Imgur.InfiniteScroll.getInstance().infiniteScroll(function(){a.loadMore()})}else{if(a._.vars.scrolledImageSet>0){$(a._.el.outside.noMorePagesID).remove();a._.vars.scrolledPage++;a._.vars.scrolledImageSet=-1;a.loadMore()}else{$(a._.el.outside.loaderID).remove()}}}})}},editAccountBio:function(){var c=$("#account-bio");var b=$('<textarea id="account-bio">'+jQuery.trim(c.text())+"</textarea>");if(c.text()==this._.messages.defaultAccountBio){b.val("")}var a=this;b.blur(function(d){a.updateAccountBio(d)});c.replaceWith(b);b.autoResize({animate:false});b.focus()},updateAccountBio:function(d){var c=$("#account-bio"),f=$('<div id="account-bio" class="textbox profile access"></div>'),a=jQuery.trim($(d.target).val());var b=this;$.post("/ajax/accountbio",{bio:(a==this._.messages.defaultAccountBio?"":a)},function(e){f.html(e?e:"<i>"+b._.messages.defaultAccountBio+"</i>")});f.text(a?a:this._.messages.defaultAccountBio);f.click(function(){b.editAccountBio()});c.replaceWith(f)},setupUserCaptionClickHandlers:function(){var d=this;var b=$("#captions");var a=(function(f){return $(f.target).closest(".comment[data-hash]").attr("data-hash")});var c=(function(h){var g=a(h);var f=Imgur.Caption.getInstance();f.setHash(g);return f});b.on("click",".caption .caption-toolbar",function(f){c(f).toolbarClickHandler(f)});b.on("click",".caption .context-caption-link",function(g){g.stopImmediatePropagation();var f=a(g);var h=c(g).getCaptionId($(g.target).closest(".caption"));window.location=window.location.protocol+"//"+window.location.host+"/gallery/"+f+"/comment/"+h+"/1"});b.on("click",".caption .permalink-caption-link",function(g){g.stopImmediatePropagation();var f=a(g);var h=c(g).getCaptionId($(g.target).closest(".caption"));window.location=window.location.protocol+"//"+window.location.host+"/gallery/"+f+"/comment/"+h});b.on("click",".caption .delete-caption-link",function(f){f.stopImmediatePropagation();c(f).deleteCaptionLinkClickHandler(f)});b.on("click",".caption .caption-toolbar .share-caption-link",function(f){f.stopImmediatePropagation();c(f).shareCaptionLinkHandler(f)});b.on("click",".caption .reply",function(h){h.stopImmediatePropagation();var g=a(h);var f=new Imgur.Caption.Reply({hash:g,replyHandler:d.userGalleryReplyHandler});f.clickHandler(h)});b.on("click",".caption .arrow",function(g){g.stopImmediatePropagation();var f=Imgur.Gallery.getInstance({baseURL:"/gallery"});f.setHash(a(g));f.vote(g)})},userGalleryReplyHandler:function(b,d){var c=$("#caption-"+b.parent_id).parent().children(".children");var a=$(d);a.find(".arrow.up").addClass("pushed");a.hide().appendTo(c).fadeIn(250)},notorietyLinkClickHandler:function(){if(this._.el.user.notorietyList.is(":hidden")){this._.el.user.notorietyList.slideDown();this._.el.user.notorietyLink.find("a").html("hide list")}else{this._.el.user.notorietyList.slideUp();this._.el.user.notorietyLink.find("a").html("show list")}},userButtonCommentsClickHandler:function(){window.location="/user/"+this._.account_url},userButtonFavoritesClickHandler:function(){window.location="/user/"+this._.account_url+"/favorites"},userButtonSubmittedClickHandler:function(){window.location="/user/"+this._.account_url+"/submitted"},setupUserCaptions:function(){var c=this;var b=Imgur.Caption.getInstance({sid:c._.sid});b._.signed=c._.signed;this.setupUserCaptionClickHandlers();var a=function(){c._.el.user.loader.show();$.get("/user/"+c._.account_url+"/index/"+c._.sort+"/page/"+(++c._.page)+"?scrolling",function(d){if(d){c._.el.user.loader.hide();c._.el.user.captions.append(d);Imgur.InfiniteScroll.getInstance().infiniteScroll(a)}else{c._.el.user.loader.remove()}})};if(this._.el.user.loader.length>0){Imgur.InfiniteScroll.getInstance().infiniteScroll(a)}},setupUserFavorites:function(){var b=this;var a=function(){b._.el.user.loader.show();$.get("/user/"+b._.account_url+"/favorites/page/"+(++b._.page)+"?scrolling",function(c){if(c){b._.el.user.loader.hide();b._.el.user.favorites.append(c);Imgur.InfiniteScroll.getInstance().infiniteScroll(a)}else{b._.el.user.loader.remove()}})};if(this._.el.user.loader.length>0){Imgur.InfiniteScroll.getInstance().infiniteScroll(a)}},setupUserSubmitted:function(){var b=this;var a=function(){b._.el.user.loader.show();$.get("/user/"+b._.account_url+"/submitted/page/"+(++b._.page)+"?scrolling",function(c){if(c){b._.el.user.loader.hide();b._.el.user.favorites.append(c);Imgur.InfiniteScroll.getInstance().infiniteScroll(a)}else{b._.el.user.loader.remove()}})};if(this._.el.user.loader.length>0){Imgur.InfiniteScroll.getInstance().infiniteScroll(a)}},userPmButtonClickHandler:function(){var a=this;if(!this._.signed){return Imgur.getInstance().signin()
}$.colorbox.init();$.colorbox({href:"#"+a._.el.user.pmWrapper.attr("id"),inline:true,innerWidth:a._.el.user.pmWrapper.width()+20,innerHeight:a._.el.user.pmWrapper.height()+20,transition:"none",open:true,onComplete:function(){a._.el.user.pmSubject.showPlaceholder();a._.el.user.pmSubject.focus()}})},userPmSendButton:function(){var c=this;if(c._.el.user.pmBody.val()==""||c._.el.user.pmBody.val()==c._.el.user.pmBody.attr("title")){return}var a=c._.el.user.pmForm.find("input, textarea");for(var d=0;d<a.length;++d){var b=$(a[d]);if(b.val()==b.attr("title")){b.val("")}}$.post("/account/messages",c._.el.user.pmForm.serialize(),function(e){c._.el.user.pmSent.fadeIn(250);setTimeout(function(){$.colorbox.close()},600)})},carouselItemFirstIn:function(a,c,b){if(a.index()==0){b.addClass("disabled")}else{b.removeClass("disabled")}},carouselItemLastIn:function(a,d,b){var c=d.jcarousel("items").length;if(a.index()==c-1){b.addClass("disabled")}else{b.removeClass("disabled")}},userInit:function(){var a=this;this.generalInit();this._.el.inside.accountBio.click(function(){a.editAccountBio()});this._.el.user.notorietyLink.click(function(){a.notorietyLinkClickHandler()});this._.el.user.buttonComments.click(function(){a.userButtonCommentsClickHandler()});this._.el.user.buttonFavorites.click(function(){a.userButtonFavoritesClickHandler()});this._.el.user.buttonSubmitted.click(function(){a.userButtonSubmittedClickHandler()});this._.el.user.pmButton.click(function(){a.userPmButtonClickHandler()});this._.el.user.pmSendButton.click(function(){a.userPmSendButton()});$("#ban-user").click(function(){a.ban()});$("#spam-user").click(function(){a.spam()});if(this._.window==="index"){this.setupUserCaptions()}else{if(this._.window==="submitted"){this.setupUserSubmitted()}else{this.setupUserFavorites()}}this._.el.user.$carousel.jcarousel({animation:300});$(".next").click(function(){a._.el.user.$carousel.jcarousel("scroll","+=3",true)});$(".prev").click(function(){a._.el.user.$carousel.jcarousel("scroll","-=3",true)});a._.el.user.$carousel.find("li").bind("jcarouselitemfirstin",function(b){a.carouselItemFirstIn($(this),a._.el.user.$carousel,$(".prev"))}).bind("jcarouselitemlastin",function(b){a.carouselItemLastIn($(this),a._.el.user.$carousel,$(".next"))})},initShowViralToggle:function(){if($.cookie("hidingviral")){this._.el.outside.toggleViral.removeClass("showing");this._.el.outside.toggleViral.html("<span>hiding viral</span>");this._.el.outside.toggleViral.attr("title","images that are also in the viral section.")}},toggleShowViral:function(){if($.cookie("hidingviral")){$.cookie("hidingviral",null,{path:"/"})}else{$.cookie("hidingviral",true,{expires:30,path:"/"})}window.location=window.location},loadFullAlbum:function(){var a=Imgur.Gallery.getInstance();$("#album-truncated a").remove();$("#album-truncated").html('<img id="album-loader" height="20px" src="http://s.imgur.com/images/loader_bg_18.gif"/>');Imgur.InsideNav.getInstance().fetchAlbumImages(Imgur.InsideNav.getInstance().getHash(),function(c){$("#album-truncated").remove();var b=c.album_images.images;c.album_images.images=c.album_images.images.slice(10);Imgur.InsideNav.getInstance().insertAlbum($("#image"),c);c.album_images.images=b;$("#album-truncated").remove()},true)},outsideInit:function(){var a=this;this._.vars.scrolledPage=this._.vars.pastPage=this._.page;if(!this._.showPast){this._.vars.pastPage+=1}this.generalInit();Imgur.InfiniteScroll.getInstance().infiniteScroll(function(){a.loadMore()});this._.el.arrows.click(function(b){a.vote(b)});this._.el.past.link.click(function(){a.pastClickHandler()});this._.el.past.days.change(function(b){a.pastDaysChangeHandler(b)});this._.el.past.days.keypress(function(b){a.pastDaysKeypressHandler(b)});this._.el.past.ticker.click(function(b){a.pastTickerClickHandler(b)});this._.el.past.submitButton.click(function(){a.pastSubmitClickHandler()});if(this._.section=="new"){this.initShowViralToggle();this._.el.outside.toggleViral.click(function(){a.toggleShowViral()})}this.initOutsideComboboxes();$(document).ready(function(){if(a._.showGalleryNewInfo){$.colorbox({href:a._.el.outside.galleryNewInfo.id,open:true,inline:true,top:"15%",transition:"none",scrolling:false,onComplete:function(){a._.el.outside.galleryNewInfo.$okay.click(function(){$.colorbox.close()});a._.el.outside.galleryNewInfo.$no.click(function(){window.location="http://"+a._.host+"/hot"})}})}})},initOutsideComboboxes:function(){var a=this;$(".combobox").combobox({onChange:function(c,d){switch(c){case"sort":if((d==a._.sort&&!a._.gallery_type)||d==a._.window){return}if(d=="top"){window.location=a._.baseURL+"/top";return}if(a._.gallery_type&&a._.section=="top"){a._.section="new"}var b=(a._.baseURL=="/gallery"?"":a._.baseURL)+(a._.section?"/"+a._.section+"/":"/top/")+d;if(a._.searchQuery){b+="?q="+a._.searchQuery}window.location=b;break;case"section":if(d==a._.section&&!a._.gallery_type){return}if(d=="past"){return a.pastClickHandler()}var b="/"+d;if(a._.sort&&d!="g/memes"){if(a._.sort!="top"&&d!="top"){b+="/"+a._.sort
}}if(a._.searchQuery){b+="?q="+a._.searchQuery}window.location=b;break;case"window":d=$("#window .selected").attr("value");var b=a._.baseURL+"/top/"+d;if(a._.searchQuery){b+="?q="+a._.searchQuery}window.location=b;break}}})},insideInit:function(){this.generalInit();Imgur.getInstance().setHash({hash:this._.hash});if(!this._.comment_id&&!this._.mobile){this._.el.inside.$comments.html('<img class="small-margin-top" src="http://s.imgur.com/images/small-loader.gif"/>')}this._.el.inside.arrows.on("click",".arrow",function(c){b.imgurInsideNav.vote(c)});this.initZoom();this.bindArrowKeys();var b=this;var a=function(){b.checkStipple()};this.timeoutFunc=setTimeout(a,200);this._.parent_gallery=this;this.imgurInsideNav=Imgur.InsideNav.getInstance(this._);b.showPrevious=function(){};b.showNext=function(){};this.imgurInsideNav.generalInit(function(){var c=b;b.imgurInsideNav.setCaptionSort(b._.comment_sort);if(b._.image&&!b.imgurInsideNav._.responseData[b._.image.hash]){b.imgurInsideNav._.responseData[b._.image.hash]=$.extend({},b._.image);b.imgurInsideNav._.sequence.unshift(b._.image.hash)}b.showPrevious=function(){c.imgurInsideNav.navToImage.call(c.imgurInsideNav,{direction:"prev"})};b.showNext=function(){c.imgurInsideNav.navToImage.call(c.imgurInsideNav,{direction:"next"})};b.imgurInsideNav.checkIfNeedsMorePagesInit();if(!b._.mobile&&b._.section!==null){if(b.imgurInsideNav.isPermalink()){if(b._.context){b.imgurInsideNav.loadCaptions(b.imgurInsideNav.getHash(),null,b._.comment_id,null,b._.context)}else{b.imgurInsideNav.loadCaptions(b.imgurInsideNav.getHash(),null,b._.comment_id)}}else{b.imgurInsideNav.loadCaptions(b.imgurInsideNav.getHash())}}if(!b._.mobile&&b.imgurInsideNav.hasImage()&&b.imgurInsideNav.getImage().is_album){b.imgurInsideNav.initAlbumLinks()}$("#album-truncated a").click(function(){if(b._.image.album_images.count>50){return true}Imgur.Gallery.getInstance().loadFullAlbum();return false})});this._.el.reportImageLink.click(function(){b.reportImage()});this._.el.inside.deleteImageLink.click(function(){b.deleteImage()});this._.el.inside.favoriteImageLink.click(function(){b.favoriteImage()});this._.el.inside.reCaptionLink.click(function(){b.reCaption()});if($.cookie("r"+b.imgurInsideNav.getHash())==1){b._.el.reportImageLink.addClass("reported");b._.el.reportImageLink.attr("original-title","Submission has been reported");b._.el.reportImageLink.unbind("click")}$("#ban-user").click(function(){b.ban()});$("#spam-user").click(function(){b.spam()});this._.el.inside.commentSort.combobox({onChange:function(c){switch(c){case"comment-sort":var d=$("#comment-sort .selection").text();$.cookie("GCS",d,{expires:7,path:"/"});b.imgurInsideNav.setCaptionSort(d);b.imgurInsideNav.processCaptions();break}}});$(document).ready(function(){var c=Imgur.ShareButtons.getInstance();var d="http://"+b._.host+b._.baseURL+"/"+b._.hash;if(b._.image&&b._.image.is_album){b.imgurInsideNav._.prev_was_album=true;d=d.replace("/account/favorites/","/a/")}else{d=d.replace("/account/favorites/","/")}c._.shareUrl=d})},initTldr:function(){if(this._.signed&&this._.isPro){return}if(this._.section=="new"){return}var a=this;$.getScript("http://a.thoughtleadr.com/v1/tacos?debug="+this._.debugTLDR,function(){if(typeof tldr==="undefined"){return}if(tldr.ad_available()){if(a._.hash){a.setupInsideSponsored();a.imgurInsideNav.saveSponsoredAd({isAd:true,is_album:false,hash:tldr.get_image_id(),title:tldr.get_title(),position:tldr.get_position(),description:tldr.get_caption(),points:tldr.get_points(),views:tldr.get_page_views(),ext:".jpg"})}else{a._.hasSponsoredAd=true;a.setupOutsideSponsored()}}else{if(a._.hash){a.setupInsideSponsored(tldr.IMPRESSION_TYPE.discovery)}}})},checkStipple:function(){var b=this;if(!this.stippleChecked){this.stippleChecked=1}if(this.stippleChecked<10){if($(".stipple-dot").length){return}this.stippleChecked++;var a=function(){b.checkStipple()};this.timeoutFunc=setTimeout(a,200)}else{if($("#use-cortica").length){$.getScript("http://adserver-static1.iweb.cortica.com/adserver/static/p/10008/inimage_s.js",function(){corticaTimeOut()})}clearTimeout(this.timeoutFunc)}},generalInit:function(){this._.sid=$("#sid").val();this._.messages={submitCaption:"Submit a "+this._.comment_name,deleteCaption:"Are you sure you want to delete this "+this._.comment_name+"?",reportCaption:"Are you sure you want to report this "+this._.comment_name+" for spam or abuse?",defaultAccountBio:"This is your public profile. Write something about yourself!",loadMore:'<div id="load-more">load more images</div>',captioningTooFast:function(c){return"You're "+this._.comment_name+"ing too fast! Please wait "+c+" seconds."},reportImage:"Are you sure you want to report this submission for spam or abuse?",deleteImage:"Are you sure you want to remove this submission from the gallery?"};this.initTipsy();this._.el.imageLinks.colorbox({maxWidth:"95%",maxHeight:"95%",scalePhotos:true,photo:true});var a=this;var b=Imgur.ShareButtons.getInstance();b.bindButtons()},closeMessagebox:function(){var b="messagebox_closed";
$("#messagebox-close").tipsy("hide");var a=this;$.cookie(b,"true",{path:"/",expires:7});this._.el.outside.messagebox.fadeOut(function(){a._.el.outside.messagebox.remove()})}});Class.addSingleton(Imgur.Gallery);
;Namespace("Imgur.Favorite");Imgur.Favorite=Imgur.extend({init:function(a){this._=$.extend({method:null,hash:null,"$favButton":$("#favorite-image"),custom_class:null,confirm:{target:"#colorbox-confirm","$message":$("#colorbox-confirm-message"),"$title":$("#colorbox-confirm-title")},messages:{favorited:'<div class="bg-div"></div><div class="favorited"></div>',unfavorited:'<div class="bg-div"></div><div class="favorited unfavorited"></div>',confirmMsg:function(b){return"Are you sure you want to "+(b?"unfavorite":"favorite")+" this image?"},confirmTitle:function(b){return(b?"Unfavorite":"Favorite")+" this image?"},}},a);this._.method=$.trim(this._.method);this._super(this._);if(!this._.hash){this._.hash=Imgur.InsideNav.getInstance().getHash()}},_init:function(){var a=this;this.showMessage();$(document).keydown(function(b){if(!b.ctrlKey&&!b.altKey&&!b.metaKey&&(b.keyCode==48||b.keyCode==45||b.keyCode==96)){if(!$(b.target).is("input")&&!$(b.target).is("textarea")){a._.$favButton.click()}}})},_init_click_handler:function(){var a=this;a._.$favButton.click(function(){Imgur.Favorite.getInstance().favorite(a._.hash)})},showMessage:function(a){if(typeof(a)=="undefined"){a=this._.method}if(a=="favorited"){this.showFavorited()}else{if(a=="unfavorited"){this.showUnfavorited()}else{if(a=="confirm"){this.showConfirm()}}}},showFavorited:function(){$("#humanMsg").remove();humanMsg.setup("body",null,1,"favoriteMsg");if(this._.customClass){$("#favoriteMsg").addClass(this._.customClass)}humanMsg.displayMsg(this._.messages.favorited,function(){humanMsg.setup();$("#favoriteMsg").remove()})},showUnfavorited:function(){$("#humanMsg").remove();humanMsg.setup("body",null,1,"favoriteMsg");if(this._.customClass){$("#favoriteMsg").addClass(this._.customClass)}humanMsg.displayMsg(this._.messages.unfavorited,function(){humanMsg.setup();$("#favoriteMsg").remove()})},showConfirm:function(){var a=this;a._.confirm.$message.html(a._.messages.confirmMsg(a.isFavorited()));a._.confirm.$title.html(a._.messages.confirmTitle(a.isFavorited()));Imgur.Utilities.ColorboxConfirm.getInstance().show(a._.confirm.target,a.favorite)},favorite:function(d,c,e){var a=Imgur.Favorite.getInstance();if(!Imgur.getInstance()._.signed){Imgur.getInstance().signin(window.location.href.replace(/\/fav$/,""))}if(typeof(d)=="undefined"){d=a._.hash}else{if(typeof(d)=="function"){d=d()}}if(a._.$favButton.hasClass("favorited")){a._.$favButton.removeClass("favorited");a._.method="unfavorited"}else{a._.$favButton.addClass("favorited");a._.method="favorited";a.upvote()}if(Imgur.getInstance()._.signed){a.displayMessage()}var b="/"+d+"/fav.json";if(window.location.href.indexOf("/a/")!==-1||c){b="/a"+b}$.ajax({url:b,type:"POST",data:{ajax:true},success:function(f){a._.method=f.data.fav_method;if(e){e(f.data.fav_method)}},error:function(){if(a._.method=="favorited"){a._.$favButton.removeClass("favorited");a._.method="unfavorited"}else{a._.$favButton.addClass("favorited");a._.method="favorited"}humanMsg.setup();$("#favoriteMsg").remove()}})},displayMessage:function(a){if(typeof humanMsg.remove=="function"){var b=this;humanMsg.removeMsg(function(){humanMsg.setup();$("#favoriteMsg").remove();b.showMessage()})}else{this.showMessage()}},isFavorited:function(){return this._.$favButton.hasClass("favorited")},confirmDeleteAllFavs:function(){var a=this;a._.confirm.$title.html("Remove all favorites?");a._.confirm.$message.html("Are you sure you want to remove all your favorite images? This can not be undone.");Imgur.Utilities.ColorboxConfirm.getInstance().show(a._.confirm.target,a.deleteAllFavorites)},deleteAllFavorites:function(){var a=$("#sid").val();var b=this;if(a){$.ajax({type:"post",url:"/account/favorites/delete_all",data:{sid:a},success:function(){$.cookie("messagebox_closed","true",{path:"/",expires:7});window.location=window.location}})}},upvote:function(){if(!Imgur.getInstance()._.signed){return}if(!$("#mainUpArrow").hasClass("pushed")&&!$("#mainDownArrow").hasClass("pushed")){$("#mainUpArrow").click()}}});Class.addSingleton(Imgur.Favorite);