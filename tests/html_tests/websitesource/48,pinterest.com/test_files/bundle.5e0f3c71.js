function printStackTrace(e){e=e||{guess:!0};var t=e.e||null,n=!!e.guess,i=new printStackTrace.implementation,o=i.run(t);return n?i.guessAnonymousFunctions(o):o}(function(e,t){function n(e){var t=ft[e]={};return Q.each(e.split(tt),function(e,n){t[n]=!0}),t}function i(e,n,i){if(i===t&&1===e.nodeType){var o="data-"+n.replace(gt,"-$1").toLowerCase();if(i=e.getAttribute(o),"string"===typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:mt.test(i)?Q.parseJSON(i):i}catch(r){}Q.data(e,n,i)}else i=t}return i}function o(e){var t;for(t in e)if(("data"!==t||!Q.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function r(){return!1}function s(){return!0}function a(e){return!e||!e.parentNode||11===e.parentNode.nodeType}function l(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function u(e,t,n){if(t=t||0,Q.isFunction(t))return Q.grep(e,function(e,i){var o=!!t.call(e,i,e);return o===n});if(t.nodeType)return Q.grep(e,function(e){return e===t===n});if("string"===typeof t){var i=Q.grep(e,function(e){return 1===e.nodeType});if(Dt.test(t))return Q.filter(t,i,!n);t=Q.filter(t,i)}return Q.grep(e,function(e){return Q.inArray(e,t)>=0===n})}function c(e){var t=Ft.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function d(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function h(e,t){if(1===t.nodeType&&Q.hasData(e)){var n,i,o,r=Q._data(e),s=Q._data(t,r),a=r.events;if(a){delete s.handle,s.events={};for(n in a)for(i=0,o=a[n].length;i<o;i++)Q.event.add(t,n,a[n][i])}s.data&&(s.data=Q.extend({},s.data))}}function p(e,t){var n;1===t.nodeType&&(t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),Q.support.html5Clone&&e.innerHTML&&!Q.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Yt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.selected=e.defaultSelected:"input"===n||"textarea"===n?t.defaultValue=e.defaultValue:"script"===n&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(Q.expando))}function f(e){return"undefined"!==typeof e.getElementsByTagName?e.getElementsByTagName("*"):"undefined"!==typeof e.querySelectorAll?e.querySelectorAll("*"):[]}function m(e){Yt.test(e.type)&&(e.defaultChecked=e.checked)}function g(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),i=t,o=_n.length;o--;)if(t=_n[o]+n,t in e)return t;return i}function v(e,t){return e=t||e,"none"===Q.css(e,"display")||!Q.contains(e.ownerDocument,e)}function _(e,t){for(var n,i,o=[],r=0,s=e.length;r<s;r++)n=e[r],n.style&&(o[r]=Q._data(n,"olddisplay"),t?(o[r]||"none"!==n.style.display||(n.style.display=""),""===n.style.display&&v(n)&&(o[r]=Q._data(n,"olddisplay",T(n.nodeName)))):(i=nn(n,"display"),o[r]||"none"===i||Q._data(n,"olddisplay",i)));for(r=0;r<s;r++)n=e[r],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?o[r]||"":"none"));return e}function C(e,t,n){var i=dn.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function P(e,t,n,i){for(var o=n===(i?"border":"content")?4:"width"===t?1:0,r=0;o<4;o+=2)"margin"===n&&(r+=Q.css(e,n+vn[o],!0)),i?("content"===n&&(r-=parseFloat(nn(e,"padding"+vn[o]))||0),"margin"!==n&&(r-=parseFloat(nn(e,"border"+vn[o]+"Width"))||0)):(r+=parseFloat(nn(e,"padding"+vn[o]))||0,"padding"!==n&&(r+=parseFloat(nn(e,"border"+vn[o]+"Width"))||0));return r}function y(e,t,n){var i="width"===t?e.offsetWidth:e.offsetHeight,o=!0,r=Q.support.boxSizing&&"border-box"===Q.css(e,"boxSizing");if(i<=0||null==i){if(i=nn(e,t),(i<0||null==i)&&(i=e.style[t]),hn.test(i))return i;o=r&&(Q.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+P(e,t,n||(r?"border":"content"),o)+"px"}function T(e){if(fn[e])return fn[e];var t=Q("<"+e+">").appendTo(j.body),n=t.css("display");return t.remove(),("none"===n||""===n)&&(on=j.body.appendChild(on||Q.extend(j.createElement("iframe"),{frameBorder:0,width:0,height:0})),rn&&on.createElement||(rn=(on.contentWindow||on.contentDocument).document,rn.write("<!doctype html><html><body>"),rn.close()),t=rn.body.appendChild(rn.createElement(e)),n=nn(t,"display"),j.body.removeChild(on)),fn[e]=n,n}function S(e,t,n,i){var o;if(Q.isArray(t))Q.each(t,function(t,o){n||yn.test(e)?i(e,o):S(e+"["+("object"===typeof o?t:"")+"]",o,n,i)});else if(n||"object"!==Q.type(t))i(e,t);else for(o in t)S(e+"["+o+"]",t[o],n,i)}function E(e){return function(t,n){"string"!==typeof t&&(n=t,t="*");var i,o,r,s=t.toLowerCase().split(tt),a=0,l=s.length;if(Q.isFunction(n))for(;a<l;a++)i=s[a],r=/^\+/.test(i),r&&(i=i.substr(1)||"*"),o=e[i]=e[i]||[],o[r?"unshift":"push"](n)}}function b(e,n,i,o,r,s){r=r||n.dataTypes[0],s=s||{},s[r]=!0;for(var a,l=e[r],u=0,c=l?l.length:0,d=e===Un;u<c&&(d||!a);u++)a=l[u](n,i,o),"string"===typeof a&&(!d||s[a]?a=t:(n.dataTypes.unshift(a),a=b(e,n,i,o,a,s)));return!d&&a||s["*"]||(a=b(e,n,i,o,"*",s)),a}function w(e,n){var i,o,r=Q.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((r[i]?e:o||(o={}))[i]=n[i]);o&&Q.extend(!0,e,o)}function N(e,n,i){var o,r,s,a,l=e.contents,u=e.dataTypes,c=e.responseFields;for(r in c)r in i&&(n[c[r]]=i[r]);for(;"*"===u[0];)u.shift(),o===t&&(o=e.mimeType||n.getResponseHeader("content-type"));if(o)for(r in l)if(l[r]&&l[r].test(o)){u.unshift(r);break}if(u[0]in i)s=u[0];else{for(r in i){if(!u[0]||e.converters[r+" "+u[0]]){s=r;break}a||(a=r)}s=s||a}return s?(s!==u[0]&&u.unshift(s),i[s]):t}function I(e,t){var n,i,o,r,s=e.dataTypes.slice(),a=s[0],l={},u=0;if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),s[1])for(n in e.converters)l[n.toLowerCase()]=e.converters[n];for(;o=s[++u];)if("*"!==o){if("*"!==a&&a!==o){if(n=l[a+" "+o]||l["* "+o],!n)for(i in l)if(r=i.split(" "),r[1]===o&&(n=l[a+" "+r[0]]||l["* "+r[0]])){n===!0?n=l[i]:l[i]!==!0&&(o=r[0],s.splice(u--,0,o));break}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(c){return{state:"parsererror",error:n?c:"No conversion from "+a+" to "+o}}}a=o}return{state:"success",data:t}}function O(){try{return new e.XMLHttpRequest}catch(t){}}function x(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function M(){return setTimeout(function(){Kn=t},0),Kn=Q.now()}function k(e,t){Q.each(t,function(t,n){for(var i=(ei[t]||[]).concat(ei["*"]),o=0,r=i.length;o<r;o++)if(i[o].call(e,t,n))return})}function R(e,t,n){var i,o=0,r=Zn.length,s=Q.Deferred().always(function(){delete a.elem}),a=function(){for(var t=Kn||M(),n=Math.max(0,l.startTime+l.duration-t),i=1-(n/l.duration||0),o=0,r=l.tweens.length;o<r;o++)l.tweens[o].run(i);return s.notifyWith(e,[l,i,n]),i<1&&r?n:(s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:Q.extend({},t),opts:Q.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Kn||M(),duration:n.duration,tweens:[],createTween:function(t,n){var i=Q.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(i),i},stop:function(t){for(var n=0,i=t?l.tweens.length:0;n<i;n++)l.tweens[n].run(1);return t?s.resolveWith(e,[l,t]):s.rejectWith(e,[l,t]),this}}),u=l.props;for(A(u,l.opts.specialEasing);o<r;o++)if(i=Zn[o].call(l,e,u,l.opts))return i;return k(l,u),Q.isFunction(l.opts.start)&&l.opts.start.call(e,l),Q.fx.timer(Q.extend(a,{anim:l,queue:l.opts.queue,elem:e})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function A(e,t){var n,i,o,r,s;for(n in e)if(i=Q.camelCase(n),o=t[i],r=e[n],Q.isArray(r)&&(o=r[1],r=e[n]=r[0]),n!==i&&(e[i]=r,delete e[n]),s=Q.cssHooks[i],s&&"expand"in s){r=s.expand(r),delete e[i];for(n in r)n in e||(e[n]=r[n],t[n]=o)}else t[i]=o}function B(e,t,n){var i,o,r,s,a,l,u,c,d=this,h=e.style,p={},f=[],m=e.nodeType&&v(e);n.queue||(u=Q._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,c=u.empty.fire,u.empty.fire=function(){u.unqueued||c()}),u.unqueued++,d.always(function(){d.always(function(){u.unqueued--,Q.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],"inline"===Q.css(e,"display")&&"none"===Q.css(e,"float")&&(Q.support.inlineBlockNeedsLayout&&"inline"!==T(e.nodeName)?h.zoom=1:h.display="inline-block")),n.overflow&&(h.overflow="hidden",Q.support.shrinkWrapBlocks||d.done(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]}));for(i in t)if(r=t[i],Xn.exec(r)){if(delete t[i],r===(m?"hide":"show"))continue;f.push(i)}if(s=f.length)for(a=Q._data(e,"fxshow")||Q._data(e,"fxshow",{}),m?Q(e).show():d.done(function(){Q(e).hide()}),d.done(function(){var t;Q.removeData(e,"fxshow",!0);for(t in p)Q.style(e,t,p[t])}),i=0;i<s;i++)o=f[i],l=d.createTween(o,m?a[o]:0),p[o]=a[o]||Q.style(e,o),o in a||(a[o]=l.start,m&&(l.end=l.start,l.start="width"===o||"height"===o?1:0))}function D(e,t,n,i,o){return new D.prototype.init(e,t,n,i,o)}function U(e,t){var n,i={height:e},o=0;for(t=t?1:0;o<4;o+=2-t)n=vn[o],i["margin"+n]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function L(e){return Q.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var F,$,j=e.document,H=e.location,q=e.navigator,V=e.jQuery,G=e.$,W=Array.prototype.push,z=Array.prototype.slice,K=Array.prototype.indexOf,Y=Object.prototype.toString,X=Object.prototype.hasOwnProperty,J=String.prototype.trim,Q=function(e,t){return new Q.fn.init(e,t,F)},Z=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,et=/\S/,tt=/\s+/,nt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,it=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,ot=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rt=/^[\],:{}\s]*$/,st=/(?:^|:|,)(?:\s*\[)+/g,at=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,lt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,ut=/^-ms-/,ct=/-([\da-z])/gi,dt=function(e,t){return(t+"").toUpperCase()},ht=function(){j.addEventListener?(j.removeEventListener("DOMContentLoaded",ht,!1),Q.ready()):"complete"===j.readyState&&(j.detachEvent("onreadystatechange",ht),Q.ready())},pt={};Q.fn=Q.prototype={constructor:Q,init:function(e,n,i){var o,r,s;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if("string"===typeof e){if(o="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:it.exec(e),!o||!o[1]&&n)return!n||n.jquery?(n||i).find(e):this.constructor(n).find(e);if(o[1])return n=n instanceof Q?n[0]:n,s=n&&n.nodeType?n.ownerDocument||n:j,e=Q.parseHTML(o[1],s,!0),ot.test(o[1])&&Q.isPlainObject(n)&&this.attr.call(e,n,!0),Q.merge(this,e);if(r=j.getElementById(o[2]),r&&r.parentNode){if(r.id!==o[2])return i.find(e);this.length=1,this[0]=r}return this.context=j,this.selector=e,this}return Q.isFunction(e)?i.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),Q.makeArray(e,this))},selector:"",jquery:"1.8.1",length:0,size:function(){return this.length},toArray:function(){return z.call(this)},get:function(e){return null==e?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var i=Q.merge(this.constructor(),e);return i.prevObject=this,i.context=this.context,"find"===t?i.selector=this.selector+(this.selector?" ":"")+n:t&&(i.selector=this.selector+"."+t+"("+n+")"),i},each:function(e,t){return Q.each(this,e,t)},ready:function(e){return Q.ready.promise().done(e),this},eq:function(e){return e=+e,-1===e?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(z.apply(this,arguments),"slice",z.call(arguments).join(","))},map:function(e){return this.pushStack(Q.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:W,sort:[].sort,splice:[].splice},Q.fn.init.prototype=Q.fn,Q.extend=Q.fn.extend=function(){var e,n,i,o,r,s,a=arguments[0]||{},l=1,u=arguments.length,c=!1;for("boolean"===typeof a&&(c=a,a=arguments[1]||{},l=2),"object"===typeof a||Q.isFunction(a)||(a={}),u===l&&(a=this,--l);l<u;l++)if(null!=(e=arguments[l]))for(n in e)i=a[n],o=e[n],a!==o&&(c&&o&&(Q.isPlainObject(o)||(r=Q.isArray(o)))?(r?(r=!1,s=i&&Q.isArray(i)?i:[]):s=i&&Q.isPlainObject(i)?i:{},a[n]=Q.extend(c,s,o)):o!==t&&(a[n]=o));return a},Q.extend({noConflict:function(t){return e.$===Q&&(e.$=G),t&&e.jQuery===Q&&(e.jQuery=V),Q},isReady:!1,readyWait:1,holdReady:function(e){e?Q.readyWait++:Q.ready(!0)},ready:function(e){if(e===!0?!--Q.readyWait:!Q.isReady){if(!j.body)return setTimeout(Q.ready,1);Q.isReady=!0,e!==!0&&--Q.readyWait>0||($.resolveWith(j,[Q]),Q.fn.trigger&&Q(j).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===Q.type(e)},isArray:Array.isArray||function(e){return"array"===Q.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":pt[Y.call(e)]||"object"},isPlainObject:function(e){if(!e||"object"!==Q.type(e)||e.nodeType||Q.isWindow(e))return!1;try{if(e.constructor&&!X.call(e,"constructor")&&!X.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var i;for(i in e);return i===t||X.call(e,i)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){var i;return e&&"string"===typeof e?("boolean"===typeof t&&(n=t,t=0),t=t||j,(i=ot.exec(e))?[t.createElement(i[1])]:(i=Q.buildFragment([e],t,n?null:[]),Q.merge([],(i.cacheable?Q.clone(i.fragment):i.fragment).childNodes))):null},parseJSON:function(n){return n&&"string"===typeof n?(n=Q.trim(n),e.JSON&&e.JSON.parse?e.JSON.parse(n):rt.test(n.replace(at,"@").replace(lt,"]").replace(st,""))?Function("return "+n)():(Q.error("Invalid JSON: "+n),t)):null},parseXML:function(n){var i,o;if(!n||"string"!==typeof n)return null;try{e.DOMParser?(o=new DOMParser,i=o.parseFromString(n,"text/xml")):(i=new ActiveXObject("Microsoft.XMLDOM"),i.async="false",i.loadXML(n))}catch(r){i=t}return i&&i.documentElement&&!i.getElementsByTagName("parsererror").length||Q.error("Invalid XML: "+n),i},noop:function(){},globalEval:function(t){t&&et.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(ut,"ms-").replace(ct,dt)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toUpperCase()===t.toUpperCase()},each:function(e,n,i){var o,r=0,s=e.length,a=s===t||Q.isFunction(e);if(i)if(a){for(o in e)if(n.apply(e[o],i)===!1)break}else for(;r<s&&n.apply(e[r++],i)!==!1;);else if(a){for(o in e)if(n.call(e[o],o,e[o])===!1)break}else for(;r<s&&n.call(e[r],r,e[r++])!==!1;);return e},trim:J&&!J.call("﻿ ")?function(e){return null==e?"":J.call(e)}:function(e){return null==e?"":(""+e).replace(nt,"")},makeArray:function(e,t){var n,i=t||[];return null!=e&&(n=Q.type(e),null==e.length||"string"===n||"function"===n||"regexp"===n||Q.isWindow(e)?W.call(i,e):Q.merge(i,e)),i},inArray:function(e,t,n){var i;if(t){if(K)return K.call(t,e,n);for(i=t.length,n=n?n<0?Math.max(0,i+n):n:0;n<i;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var i=n.length,o=e.length,r=0;if("number"===typeof i)for(;r<i;r++)e[o++]=n[r];else for(;n[r]!==t;)e[o++]=n[r++];return e.length=o,e},grep:function(e,t,n){var i,o=[],r=0,s=e.length;for(n=!!n;r<s;r++)i=!!t(e[r],r),n!==i&&o.push(e[r]);return o},map:function(e,n,i){var o,r,s=[],a=0,l=e.length,u=e instanceof Q||l!==t&&"number"===typeof l&&(l>0&&e[0]&&e[l-1]||0===l||Q.isArray(e));if(u)for(;a<l;a++)o=n(e[a],a,i),null!=o&&(s[s.length]=o);else for(r in e)o=n(e[r],r,i),null!=o&&(s[s.length]=o);return s.concat.apply([],s)},guid:1,proxy:function(e,n){var i,o,r;return"string"===typeof n&&(i=e[n],n=e,e=i),Q.isFunction(e)?(o=z.call(arguments,2),r=function(){return e.apply(n,o.concat(z.call(arguments)))},r.guid=e.guid=e.guid||r.guid||Q.guid++,r):t},access:function(e,n,i,o,r,s,a){var l,u=null==i,c=0,d=e.length;if(i&&"object"===typeof i){for(c in i)Q.access(e,n,c,i[c],1,s,o);r=1}else if(o!==t){if(l=a===t&&Q.isFunction(o),u&&(l?(l=n,n=function(e,t,n){return l.call(Q(e),n)}):(n.call(e,o),n=null)),n)for(;c<d;c++)n(e[c],i,l?o.call(e[c],c,n(e[c],i)):o,a);r=1}return r?e:u?n.call(e):d?n(e[0],i):s},now:function(){return(new Date).getTime()}}),Q.ready.promise=function(t){if(!$)if($=Q.Deferred(),"complete"===j.readyState)setTimeout(Q.ready,1);else if(j.addEventListener)j.addEventListener("DOMContentLoaded",ht,!1),e.addEventListener("load",Q.ready,!1);else{j.attachEvent("onreadystatechange",ht),e.attachEvent("onload",Q.ready);var n=!1;try{n=null==e.frameElement&&j.documentElement}catch(i){}n&&n.doScroll&&function o(){if(!Q.isReady){try{n.doScroll("left")}catch(e){return setTimeout(o,50)}Q.ready()}}()}return $.promise(t)},Q.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){pt["[object "+t+"]"]=t.toLowerCase()}),F=Q(j);var ft={};Q.Callbacks=function(e){e="string"===typeof e?ft[e]||n(e):Q.extend({},e);var i,o,r,s,a,l,u=[],c=!e.once&&[],d=function(t){for(i=e.memory&&t,o=!0,l=s||0,s=0,a=u.length,r=!0;u&&l<a;l++)if(u[l].apply(t[0],t[1])===!1&&e.stopOnFalse){i=!1;break}r=!1,u&&(c?c.length&&d(c.shift()):i?u=[]:h.disable())},h={add:function(){if(u){var t=u.length;(function n(t){Q.each(t,function(t,i){var o=Q.type(i);"function"!==o||e.unique&&h.has(i)?i&&i.length&&"string"!==o&&n(i):u.push(i)})})(arguments),r?a=u.length:i&&(s=t,d(i))}return this},remove:function(){return u&&Q.each(arguments,function(e,t){for(var n;(n=Q.inArray(t,u,n))>-1;)u.splice(n,1),r&&(n<=a&&a--,n<=l&&l--)}),this},has:function(e){return Q.inArray(e,u)>-1},empty:function(){return u=[],this},disable:function(){return u=c=i=t,this},disabled:function(){return!u},lock:function(){return c=t,i||h.disable(),this},locked:function(){return!c},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!u||o&&!c||(r?c.push(t):d(t)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!o}};return h},Q.extend({Deferred:function(e){var t=[["resolve","done",Q.Callbacks("once memory"),"resolved"],["reject","fail",Q.Callbacks("once memory"),"rejected"],["notify","progress",Q.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Q.Deferred(function(n){Q.each(t,function(t,i){var r=i[0],s=e[t];o[i[1]](Q.isFunction(s)?function(){var e=s.apply(this,arguments);e&&Q.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[r+"With"](this===o?n:this,[e])}:n[r])}),e=null}).promise()},promise:function(e){return"object"===typeof e?Q.extend(e,i):i}},o={};return i.pipe=i.then,Q.each(t,function(e,r){var s=r[2],a=r[3];i[r[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),o[r[0]]=s.fire,o[r[0]+"With"]=s.fireWith}),i.promise(o),e&&e.call(o,o),o},when:function(e){var t,n,i,o=0,r=z.call(arguments),s=r.length,a=1!==s||e&&Q.isFunction(e.promise)?s:0,l=1===a?e:Q.Deferred(),u=function(e,n,i){return function(o){n[e]=this,i[e]=arguments.length>1?z.call(arguments):o,i===t?l.notifyWith(n,i):--a||l.resolveWith(n,i)}};if(s>1)for(t=Array(s),n=Array(s),i=Array(s);o<s;o++)r[o]&&Q.isFunction(r[o].promise)?r[o].promise().done(u(o,i,r)).fail(l.reject).progress(u(o,n,t)):--a;return a||l.resolveWith(i,r),l.promise()}}),Q.support=function(){var t,n,i,o,r,s,a,l,u,c,d,h=j.createElement("div");if(h.setAttribute("className","t"),h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=h.getElementsByTagName("*"),i=h.getElementsByTagName("a")[0],i.style.cssText="top:1px;float:left;opacity:.5",!n||!n.length||!i)return{};o=j.createElement("select"),r=o.appendChild(j.createElement("option")),s=h.getElementsByTagName("input")[0],t={leadingWhitespace:3===h.firstChild.nodeType,tbody:!h.getElementsByTagName("tbody").length,htmlSerialize:!!h.getElementsByTagName("link").length,style:/top/.test(i.getAttribute("style")),hrefNormalized:"/a"===i.getAttribute("href"),opacity:/^0.5/.test(i.style.opacity),cssFloat:!!i.style.cssFloat,checkOn:"on"===s.value,optSelected:r.selected,getSetAttribute:"t"!==h.className,enctype:!!j.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==j.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===j.compatMode,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},s.checked=!0,t.noCloneChecked=s.cloneNode(!0).checked,o.disabled=!0,t.optDisabled=!r.disabled;try{delete h.test}catch(p){t.deleteExpando=!1}if(!h.addEventListener&&h.attachEvent&&h.fireEvent&&(h.attachEvent("onclick",d=function(){t.noCloneEvent=!1}),h.cloneNode(!0).fireEvent("onclick"),h.detachEvent("onclick",d)),s=j.createElement("input"),s.value="t",s.setAttribute("type","radio"),t.radioValue="t"===s.value,s.setAttribute("checked","checked"),s.setAttribute("name","t"),h.appendChild(s),a=j.createDocumentFragment(),a.appendChild(h.lastChild),t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=s.checked,a.removeChild(s),a.appendChild(h),h.attachEvent)for(u in{submit:!0,change:!0,focusin:!0})l="on"+u,c=l in h,c||(h.setAttribute(l,"return;"),c="function"===typeof h[l]),t[u+"Bubbles"]=c;return Q(function(){var n,i,o,r,s="padding:0;margin:0;border:0;display:block;overflow:hidden;",a=j.getElementsByTagName("body")[0];a&&(n=j.createElement("div"),n.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",a.insertBefore(n,a.firstChild),i=j.createElement("div"),n.appendChild(i),i.innerHTML="<table><tr><td></td><td>t</td></tr></table>",o=i.getElementsByTagName("td"),o[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===o[0].offsetHeight,o[0].style.display="",o[1].style.display="none",t.reliableHiddenOffsets=c&&0===o[0].offsetHeight,i.innerHTML="",i.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===i.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==a.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,r=j.createElement("div"),r.style.cssText=i.style.cssText=s,r.style.marginRight=r.style.width="0",i.style.width="1px",i.appendChild(r),t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),"undefined"!==typeof i.style.zoom&&(i.innerHTML="",i.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===i.offsetWidth,i.style.display="block",i.style.overflow="visible",i.innerHTML="<div></div>",i.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==i.offsetWidth,n.style.zoom=1),a.removeChild(n),n=i=o=r=null)}),a.removeChild(h),n=i=o=r=s=a=h=null,t}();var mt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,gt=/([A-Z])/g;Q.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(Q.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?Q.cache[e[Q.expando]]:e[Q.expando],!!e&&!o(e)},data:function(e,n,i,o){if(Q.acceptData(e)){var r,s,a=Q.expando,l="string"===typeof n,u=e.nodeType,c=u?Q.cache:e,d=u?e[a]:e[a]&&a;if(d&&c[d]&&(o||c[d].data)||!l||i!==t)return d||(u?e[a]=d=Q.deletedIds.pop()||++Q.uuid:d=a),c[d]||(c[d]={},u||(c[d].toJSON=Q.noop)),("object"===typeof n||"function"===typeof n)&&(o?c[d]=Q.extend(c[d],n):c[d].data=Q.extend(c[d].data,n)),r=c[d],o||(r.data||(r.data={}),r=r.data),i!==t&&(r[Q.camelCase(n)]=i),l?(s=r[n],null==s&&(s=r[Q.camelCase(n)])):s=r,s}},removeData:function(e,t,n){if(Q.acceptData(e)){var i,r,s,a=e.nodeType,l=a?Q.cache:e,u=a?e[Q.expando]:Q.expando;if(l[u]){if(t&&(i=n?l[u]:l[u].data)){Q.isArray(t)||(t in i?t=[t]:(t=Q.camelCase(t),t=t in i?[t]:t.split(" ")));for(r=0,s=t.length;r<s;r++)delete i[t[r]];if(!(n?o:Q.isEmptyObject)(i))return}(n||(delete l[u].data,o(l[u])))&&(a?Q.cleanData([e],!0):Q.support.deleteExpando||l!=l.window?delete l[u]:l[u]=null)}}},_data:function(e,t,n){return Q.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&Q.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),Q.fn.extend({data:function(e,n){var o,r,s,a,l,u=this[0],c=0,d=null;if(e===t){if(this.length&&(d=Q.data(u),1===u.nodeType&&!Q._data(u,"parsedAttrs"))){for(s=u.attributes,l=s.length;c<l;c++)a=s[c].name,0===a.indexOf("data-")&&(a=Q.camelCase(a.substring(5)),i(u,a,d[a]));Q._data(u,"parsedAttrs",!0)}return d}return"object"===typeof e?this.each(function(){Q.data(this,e)}):(o=e.split(".",2),o[1]=o[1]?"."+o[1]:"",r=o[1]+"!",Q.access(this,function(n){return n===t?(d=this.triggerHandler("getData"+r,[o[0]]),d===t&&u&&(d=Q.data(u,e),d=i(u,e,d)),d===t&&o[1]?this.data(o[0]):d):(o[1]=n,this.each(function(){var t=Q(this);t.triggerHandler("setData"+r,o),Q.data(this,e,n),t.triggerHandler("changeData"+r,o)}),t)},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){Q.removeData(this,e)})}}),Q.extend({queue:function(e,n,i){var o;return e?(n=(n||"fx")+"queue",o=Q._data(e,n),i&&(!o||Q.isArray(i)?o=Q._data(e,n,Q.makeArray(i)):o.push(i)),o||[]):t},dequeue:function(e,t){t=t||"fx";var n=Q.queue(e,t),i=n.length,o=n.shift(),r=Q._queueHooks(e,t),s=function(){Q.dequeue(e,t)};"inprogress"===o&&(o=n.shift(),i--),o&&("fx"===t&&n.unshift("inprogress"),delete r.stop,o.call(e,s,r)),!i&&r&&r.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Q._data(e,n)||Q._data(e,n,{empty:Q.Callbacks("once memory").add(function(){Q.removeData(e,t+"queue",!0),Q.removeData(e,n,!0)})})}}),Q.fn.extend({queue:function(e,n){var i=2;return"string"!==typeof e&&(n=e,e="fx",i--),arguments.length<i?Q.queue(this[0],e):n===t?this:this.each(function(){var t=Q.queue(this,e,n);Q._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&Q.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Q.dequeue(this,e)})},delay:function(e,t){return e=Q.fx?Q.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var i,o=1,r=Q.Deferred(),s=this,a=this.length,l=function(){--o||r.resolveWith(s,[s])};for("string"!==typeof e&&(n=e,e=t),e=e||"fx";a--;)i=Q._data(s[a],e+"queueHooks"),i&&i.empty&&(o++,i.empty.add(l));return l(),r.promise(n)}});var vt,_t,Ct,Pt=/[\t\r\n]/g,yt=/\r/g,Tt=/^(?:button|input)$/i,St=/^(?:button|input|object|select|textarea)$/i,Et=/^a(?:rea|)$/i,bt=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,wt=Q.support.getSetAttribute;Q.fn.extend({attr:function(e,t){return Q.access(this,Q.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Q.removeAttr(this,e)})},prop:function(e,t){return Q.access(this,Q.prop,e,t,arguments.length>1)},removeProp:function(e){return e=Q.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,i,o,r,s,a;if(Q.isFunction(e))return this.each(function(t){Q(this).addClass(e.call(this,t,this.className))});if(e&&"string"===typeof e)for(t=e.split(tt),n=0,i=this.length;n<i;n++)if(o=this[n],1===o.nodeType)if(o.className||1!==t.length){for(r=" "+o.className+" ",s=0,a=t.length;s<a;s++)~r.indexOf(" "+t[s]+" ")||(r+=t[s]+" ");o.className=Q.trim(r)}else o.className=e;return this},removeClass:function(e){var n,i,o,r,s,a,l;if(Q.isFunction(e))return this.each(function(t){Q(this).removeClass(e.call(this,t,this.className))});if(e&&"string"===typeof e||e===t)for(n=(e||"").split(tt),a=0,l=this.length;a<l;a++)if(o=this[a],1===o.nodeType&&o.className){for(i=(" "+o.className+" ").replace(Pt," "),r=0,s=n.length;r<s;r++)for(;i.indexOf(" "+n[r]+" ")>-1;)i=i.replace(" "+n[r]+" "," ");o.className=e?Q.trim(i):""}return this},toggleClass:function(e,t){var n=typeof e,i="boolean"===typeof t;return Q.isFunction(e)?this.each(function(n){Q(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n)for(var o,r=0,s=Q(this),a=t,l=e.split(tt);o=l[r++];)a=i?a:!s.hasClass(o),s[a?"addClass":"removeClass"](o);else("undefined"===n||"boolean"===n)&&(this.className&&Q._data(this,"__className__",this.className),this.className=this.className||e===!1?"":Q._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;n<i;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(Pt," ").indexOf(t)>-1)return!0;return!1},val:function(e){var n,i,o,r=this[0];{if(arguments.length)return o=Q.isFunction(e),this.each(function(i){var r,s=Q(this);1===this.nodeType&&(r=o?e.call(this,i,s.val()):e,null==r?r="":"number"===typeof r?r+="":Q.isArray(r)&&(r=Q.map(r,function(e){return null==e?"":e+""})),n=Q.valHooks[this.type]||Q.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,r,"value")!==t||(this.value=r))});if(r)return n=Q.valHooks[r.type]||Q.valHooks[r.nodeName.toLowerCase()],n&&"get"in n&&(i=n.get(r,"value"))!==t?i:(i=r.value,"string"===typeof i?i.replace(yt,""):null==i?"":i)}}}),Q.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,i,o,r=e.selectedIndex,s=[],a=e.options,l="select-one"===e.type;if(r<0)return null;for(n=l?r:0,i=l?r+1:a.length;n<i;n++)if(o=a[n],o.selected&&(Q.support.optDisabled?!o.disabled:null===o.getAttribute("disabled"))&&(!o.parentNode.disabled||!Q.nodeName(o.parentNode,"optgroup"))){if(t=Q(o).val(),l)return t;s.push(t)}return l&&!s.length&&a.length?Q(a[r]).val():s},set:function(e,t){var n=Q.makeArray(t);return Q(e).find("option").each(function(){this.selected=Q.inArray(Q(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,i,o){var r,s,a,l=e.nodeType;if(e&&3!==l&&8!==l&&2!==l)return o&&Q.isFunction(Q.fn[n])?Q(e)[n](i):"undefined"===typeof e.getAttribute?Q.prop(e,n,i):(a=1!==l||!Q.isXMLDoc(e),a&&(n=n.toLowerCase(),s=Q.attrHooks[n]||(bt.test(n)?_t:vt)),i!==t?null===i?(Q.removeAttr(e,n),t):s&&"set"in s&&a&&(r=s.set(e,i,n))!==t?r:(e.setAttribute(n,""+i),i):s&&"get"in s&&a&&null!==(r=s.get(e,n))?r:(r=e.getAttribute(n),null===r?t:r))},removeAttr:function(e,t){var n,i,o,r,s=0;if(t&&1===e.nodeType)for(i=t.split(tt);s<i.length;s++)o=i[s],o&&(n=Q.propFix[o]||o,r=bt.test(o),r||Q.attr(e,o,""),e.removeAttribute(wt?o:n),r&&n in e&&(e[n]=!1))},attrHooks:{type:{set:function(e,t){if(Tt.test(e.nodeName)&&e.parentNode)Q.error("type property can't be changed");else if(!Q.support.radioValue&&"radio"===t&&Q.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return vt&&Q.nodeName(e,"button")?vt.get(e,t):t in e?e.value:null},set:function(e,n,i){return vt&&Q.nodeName(e,"button")?vt.set(e,n,i):(e.value=n,t)}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,i){var o,r,s,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return s=1!==a||!Q.isXMLDoc(e),s&&(n=Q.propFix[n]||n,r=Q.propHooks[n]),i!==t?r&&"set"in r&&(o=r.set(e,i,n))!==t?o:e[n]=i:r&&"get"in r&&null!==(o=r.get(e,n))?o:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):St.test(e.nodeName)||Et.test(e.nodeName)&&e.href?0:t}}}}),_t={get:function(e,n){var i,o=Q.prop(e,n);return o===!0||"boolean"!==typeof o&&(i=e.getAttributeNode(n))&&i.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var i;return t===!1?Q.removeAttr(e,n):(i=Q.propFix[n]||n,i in e&&(e[i]=!0),e.setAttribute(n,n.toLowerCase())),n}},wt||(Ct={name:!0,id:!0,coords:!0},vt=Q.valHooks.button={get:function(e,n){var i;return i=e.getAttributeNode(n),i&&(Ct[n]?""!==i.value:i.specified)?i.value:t},set:function(e,t,n){var i=e.getAttributeNode(n);return i||(i=j.createAttribute(n),e.setAttributeNode(i)),i.value=t+""
}},Q.each(["width","height"],function(e,n){Q.attrHooks[n]=Q.extend(Q.attrHooks[n],{set:function(e,i){return""===i?(e.setAttribute(n,"auto"),i):t}})}),Q.attrHooks.contenteditable={get:vt.get,set:function(e,t,n){""===t&&(t="false"),vt.set(e,t,n)}}),Q.support.hrefNormalized||Q.each(["href","src","width","height"],function(e,n){Q.attrHooks[n]=Q.extend(Q.attrHooks[n],{get:function(e){var i=e.getAttribute(n,2);return null===i?t:i}})}),Q.support.style||(Q.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=""+t}}),Q.support.optSelected||(Q.propHooks.selected=Q.extend(Q.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),Q.support.enctype||(Q.propFix.enctype="encoding"),Q.support.checkOn||Q.each(["radio","checkbox"],function(){Q.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),Q.each(["radio","checkbox"],function(){Q.valHooks[this]=Q.extend(Q.valHooks[this],{set:function(e,n){return Q.isArray(n)?e.checked=Q.inArray(Q(e).val(),n)>=0:t}})});var Nt=/^(?:textarea|input|select)$/i,It=/^([^\.]*|)(?:\.(.+)|)$/,Ot=/(?:^|\s)hover(\.\S+|)\b/,xt=/^key/,Mt=/^(?:mouse|contextmenu)|click/,kt=/^(?:focusinfocus|focusoutblur)$/,Rt=function(e){return Q.event.special.hover?e:e.replace(Ot,"mouseenter$1 mouseleave$1")};Q.event={add:function(e,n,i,o,r){var s,a,l,u,c,d,h,p,f,m,g;if(3!==e.nodeType&&8!==e.nodeType&&n&&i&&(s=Q._data(e))){for(i.handler&&(f=i,i=f.handler,r=f.selector),i.guid||(i.guid=Q.guid++),l=s.events,l||(s.events=l={}),a=s.handle,a||(s.handle=a=function(e){return"undefined"===typeof Q||e&&Q.event.triggered===e.type?t:Q.event.dispatch.apply(a.elem,arguments)},a.elem=e),n=Q.trim(Rt(n)).split(" "),u=0;u<n.length;u++)c=It.exec(n[u])||[],d=c[1],h=(c[2]||"").split(".").sort(),g=Q.event.special[d]||{},d=(r?g.delegateType:g.bindType)||d,g=Q.event.special[d]||{},p=Q.extend({type:d,origType:c[1],data:o,handler:i,guid:i.guid,selector:r,namespace:h.join(".")},f),m=l[d],m||(m=l[d]=[],m.delegateCount=0,g.setup&&g.setup.call(e,o,h,a)!==!1||(e.addEventListener?e.addEventListener(d,a,!1):e.attachEvent&&e.attachEvent("on"+d,a))),g.add&&(g.add.call(e,p),p.handler.guid||(p.handler.guid=i.guid)),r?m.splice(m.delegateCount++,0,p):m.push(p),Q.event.global[d]=!0;e=null}},global:{},remove:function(e,t,n,i,o){var r,s,a,l,u,c,d,h,p,f,m,g=Q.hasData(e)&&Q._data(e);if(g&&(h=g.events)){for(t=Q.trim(Rt(t||"")).split(" "),r=0;r<t.length;r++)if(s=It.exec(t[r])||[],a=l=s[1],u=s[2],a){for(p=Q.event.special[a]||{},a=(i?p.delegateType:p.bindType)||a,f=h[a]||[],c=f.length,u=u?RegExp("(^|\\.)"+u.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null,d=0;d<f.length;d++)m=f[d],!o&&l!==m.origType||n&&n.guid!==m.guid||u&&!u.test(m.namespace)||i&&i!==m.selector&&("**"!==i||!m.selector)||(f.splice(d--,1),m.selector&&f.delegateCount--,p.remove&&p.remove.call(e,m));0===f.length&&c!==f.length&&(p.teardown&&p.teardown.call(e,u,g.handle)!==!1||Q.removeEvent(e,a,g.handle),delete h[a])}else for(a in h)Q.event.remove(e,a+t[r],n,i,!0);Q.isEmptyObject(h)&&(delete g.handle,Q.removeData(e,"events",!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,i,o,r){if(!o||3!==o.nodeType&&8!==o.nodeType){var s,a,l,u,c,d,h,p,f,m,g=n.type||n,v=[];if(!kt.test(g+Q.event.triggered)&&(g.indexOf("!")>=0&&(g=g.slice(0,-1),a=!0),g.indexOf(".")>=0&&(v=g.split("."),g=v.shift(),v.sort()),o&&!Q.event.customEvent[g]||Q.event.global[g]))if(n="object"===typeof n?n[Q.expando]?n:new Q.Event(g,n):new Q.Event(g),n.type=g,n.isTrigger=!0,n.exclusive=a,n.namespace=v.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,d=g.indexOf(":")<0?"on"+g:"",o){if(n.result=t,n.target||(n.target=o),i=null!=i?Q.makeArray(i):[],i.unshift(n),h=Q.event.special[g]||{},!h.trigger||h.trigger.apply(o,i)!==!1){if(f=[[o,h.bindType||g]],!r&&!h.noBubble&&!Q.isWindow(o)){for(m=h.delegateType||g,u=kt.test(m+g)?o:o.parentNode,c=o;u;u=u.parentNode)f.push([u,m]),c=u;c===(o.ownerDocument||j)&&f.push([c.defaultView||c.parentWindow||e,m])}for(l=0;l<f.length&&!n.isPropagationStopped();l++)u=f[l][0],n.type=f[l][1],p=(Q._data(u,"events")||{})[n.type]&&Q._data(u,"handle"),p&&p.apply(u,i),p=d&&u[d],p&&Q.acceptData(u)&&p.apply(u,i)===!1&&n.preventDefault();return n.type=g,r||n.isDefaultPrevented()||h._default&&h._default.apply(o.ownerDocument,i)!==!1||"click"===g&&Q.nodeName(o,"a")||!Q.acceptData(o)||d&&o[g]&&("focus"!==g&&"blur"!==g||0!==n.target.offsetWidth)&&!Q.isWindow(o)&&(c=o[d],c&&(o[d]=null),Q.event.triggered=g,o[g](),Q.event.triggered=t,c&&(o[d]=c)),n.result}}else{s=Q.cache;for(l in s)s[l].events&&s[l].events[g]&&Q.event.trigger(n,i,s[l].handle.elem,!0)}}},dispatch:function(n){n=Q.event.fix(n||e.event);var i,o,r,s,a,l,u,c,d,h=(Q._data(this,"events")||{})[n.type]||[],p=h.delegateCount,f=[].slice.call(arguments),m=!n.exclusive&&!n.namespace,g=Q.event.special[n.type]||{},v=[];if(f[0]=n,n.delegateTarget=this,!g.preDispatch||g.preDispatch.call(this,n)!==!1){if(p&&(!n.button||"click"!==n.type))for(r=n.target;r!=this;r=r.parentNode||this)if(r.disabled!==!0||"click"!==n.type){for(a={},u=[],i=0;i<p;i++)c=h[i],d=c.selector,a[d]===t&&(a[d]=Q(d,this).index(r)>=0),a[d]&&u.push(c);u.length&&v.push({elem:r,matches:u})}for(h.length>p&&v.push({elem:this,matches:h.slice(p)}),i=0;i<v.length&&!n.isPropagationStopped();i++)for(l=v[i],n.currentTarget=l.elem,o=0;o<l.matches.length&&!n.isImmediatePropagationStopped();o++)c=l.matches[o],(m||!n.namespace&&!c.namespace||n.namespace_re&&n.namespace_re.test(c.namespace))&&(n.data=c.data,n.handleObj=c,s=((Q.event.special[c.origType]||{}).handle||c.handler).apply(l.elem,f),s!==t&&(n.result=s,s===!1&&(n.preventDefault(),n.stopPropagation())));return g.postDispatch&&g.postDispatch.call(this,n),n.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var i,o,r,s=n.button,a=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||j,o=i.documentElement,r=i.body,e.pageX=n.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[Q.expando])return e;var t,n,i=e,o=Q.event.fixHooks[e.type]||{},r=o.props?this.props.concat(o.props):this.props;for(e=Q.Event(i),t=r.length;t;)n=r[--t],e[n]=i[n];return e.target||(e.target=i.srcElement||j),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,o.filter?o.filter(e,i):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){Q.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,i){var o=Q.extend(new Q.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?Q.event.trigger(o,null,t):Q.event.dispatch.call(t,o),o.isDefaultPrevented()&&n.preventDefault()}},Q.event.handle=Q.event.dispatch,Q.removeEvent=j.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var i="on"+t;e.detachEvent&&("undefined"===typeof e[i]&&(e[i]=null),e.detachEvent(i,n))},Q.Event=function(e,n){return this instanceof Q.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?s:r):this.type=e,n&&Q.extend(this,n),this.timeStamp=e&&e.timeStamp||Q.now(),this[Q.expando]=!0,t):new Q.Event(e,n)},Q.Event.prototype={preventDefault:function(){this.isDefaultPrevented=s;var e=this.originalEvent;e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=s;var e=this.originalEvent;e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=s,this.stopPropagation()},isDefaultPrevented:r,isPropagationStopped:r,isImmediatePropagationStopped:r},Q.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){Q.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,o=e.relatedTarget,r=e.handleObj;return r.selector,(!o||o!==i&&!Q.contains(i,o))&&(e.type=r.origType,n=r.handler.apply(this,arguments),e.type=t),n}}}),Q.support.submitBubbles||(Q.event.special.submit={setup:function(){return Q.nodeName(this,"form")?!1:(Q.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,i=Q.nodeName(n,"input")||Q.nodeName(n,"button")?n.form:t;i&&!Q._data(i,"_submit_attached")&&(Q.event.add(i,"submit._submit",function(e){e._submit_bubble=!0}),Q._data(i,"_submit_attached",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&Q.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return Q.nodeName(this,"form")?!1:(Q.event.remove(this,"._submit"),t)}}),Q.support.changeBubbles||(Q.event.special.change={setup:function(){return Nt.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(Q.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),Q.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),Q.event.simulate("change",this,e,!0)})),!1):(Q.event.add(this,"beforeactivate._change",function(e){var t=e.target;Nt.test(t.nodeName)&&!Q._data(t,"_change_attached")&&(Q.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||Q.event.simulate("change",this.parentNode,e,!0)}),Q._data(t,"_change_attached",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return Q.event.remove(this,"._change"),!Nt.test(this.nodeName)}}),Q.support.focusinBubbles||Q.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,i=function(e){Q.event.simulate(t,e.target,Q.event.fix(e),!0)};Q.event.special[t]={setup:function(){0===n++&&j.addEventListener(e,i,!0)},teardown:function(){0===--n&&j.removeEventListener(e,i,!0)}}}),Q.fn.extend({on:function(e,n,i,o,s){var a,l;if("object"===typeof e){"string"!==typeof n&&(i=i||n,n=t);for(l in e)this.on(l,n,i,e[l],s);return this}if(null==i&&null==o?(o=n,i=n=t):null==o&&("string"===typeof n?(o=i,i=t):(o=i,i=n,n=t)),o===!1)o=r;else if(!o)return this;return 1===s&&(a=o,o=function(e){return Q().off(e),a.apply(this,arguments)},o.guid=a.guid||(a.guid=Q.guid++)),this.each(function(){Q.event.add(this,e,o,i,n)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,n,i){var o,s;if(e&&e.preventDefault&&e.handleObj)return o=e.handleObj,Q(e.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler),this;if("object"===typeof e){for(s in e)this.off(s,n,e[s]);return this}return(n===!1||"function"===typeof n)&&(i=n,n=t),i===!1&&(i=r),this.each(function(){Q.event.remove(this,e,i,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return Q(this.context).on(e,this.selector,t,n),this},die:function(e,t){return Q(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1==arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){Q.event.trigger(e,t,this)})},triggerHandler:function(e,n){return this[0]?Q.event.trigger(e,n,this[0],!0):t},toggle:function(e){var t=arguments,n=e.guid||Q.guid++,i=0,o=function(n){var o=(Q._data(this,"lastToggle"+e.guid)||0)%i;return Q._data(this,"lastToggle"+e.guid,o+1),n.preventDefault(),t[o].apply(this,arguments)||!1};for(o.guid=n;i<t.length;)t[i++].guid=n;return this.click(o)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),Q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Q.fn[t]=function(e,n){return null==n&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},xt.test(t)&&(Q.event.fixHooks[t]=Q.event.keyHooks),Mt.test(t)&&(Q.event.fixHooks[t]=Q.event.mouseHooks)}),function(e,t){function n(e,t,n,i){n=n||[],t=t||I;var o,r,s,a,l=t.nodeType;if(1!==l&&9!==l)return[];if(!e||"string"!==typeof e)return n;if(s=P(t),!s&&!i&&(o=Y.exec(e)))if(a=o[1]){if(9===l){if(r=t.getElementById(a),!r||!r.parentNode)return n;if(r.id===a)return n.push(r),n}else if(t.ownerDocument&&(r=t.ownerDocument.getElementById(a))&&y(t,r)&&r.id===a)return n.push(r),n}else{if(o[2])return k.apply(n,M.call(t.getElementsByTagName(e),0)),n;if((a=o[3])&&at&&t.getElementsByClassName)return k.apply(n,M.call(t.getElementsByClassName(a),0)),n}return f(e,t,n,i,s)}function i(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function o(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function r(e,t,n){if(e===t)return n;for(var i=e.nextSibling;i;){if(i===t)return-1;i=i.nextSibling}return 1}function s(e,t,i,o){var r,s,a,l,u,c,d,h,p,f,m=!i&&t!==I,g=(m?"<s>":"")+e.replace(G,"$1<s>"),v=D[N][g];if(v)return o?0:M.call(v,0);for(u=e,c=[],h=0,p=_.preFilter,f=_.filter;u;){(!r||(s=W.exec(u)))&&(s&&(u=u.slice(s[0].length),a.selector=d),c.push(a=[]),d="",m&&(u=" "+u)),r=!1,(s=z.exec(u))&&(d+=s[0],u=u.slice(s[0].length),r=a.push({part:s.pop().replace(G," "),string:s[0],captures:s}));for(l in f)!(s=nt[l].exec(u))||p[l]&&!(s=p[l](s,t,i))||(d+=s[0],u=u.slice(s[0].length),r=a.push({part:l,string:s.shift(),captures:s}));if(!r)break}return d&&(a.selector=d),o?u.length:u?n.error(e):M.call(D(g,c),0)}function a(e,t,n,i){var o=t.dir,r=x++;return e||(e=function(e){return e===n}),t.first?function(t){for(;t=t[o];)if(1===t.nodeType)return e(t)&&t}:i?function(t){for(;t=t[o];)if(1===t.nodeType&&e(t))return t}:function(t){for(var n,i=r+"."+m,s=i+"."+g;t=t[o];)if(1===t.nodeType){if((n=t[N])===s)return t.sizset;if("string"===typeof n&&0===n.indexOf(i)){if(t.sizset)return t}else{if(t[N]=s,e(t))return t.sizset=!0,t;t.sizset=!1}}}}function l(e,t){return e?function(n){var i=t(n);return i&&e(i===!0?n:i)}:t}function u(e,t,n){for(var i,o,r=0;i=e[r];r++)o=_.relative[i.part]?a(o,_.relative[i.part],t,n):l(o,_.filter[i.part].apply(null,i.captures.concat(t,n)));return o}function c(e){return function(t){for(var n,i=0;n=e[i];i++)if(n(t))return!0;return!1}}function d(e,t,i,o){for(var r=0,s=t.length;r<s;r++)n(e,t[r],i,o)}function h(e,t,i,o,r,s){var a,l=_.setFilters[t.toLowerCase()];return l||n.error(t),(e||!(a=r))&&d(e||"*",o,a=[],r),a.length>0?l(a,i,s):[]}function p(e,i,o,r){for(var s,a,l,u,c,p,f,m,g,v,_,C,P,y=0,T=e.length,S=nt.POS,E=RegExp("^"+S.source+"(?!"+L+")","i"),b=function(){for(var e=1,n=arguments.length-2;e<n;e++)arguments[e]===t&&(g[e]=t)};y<T;y++){for(s=e[y],a="",m=r,l=0,u=s.length;l<u;l++){if(c=s[l],p=c.string,"PSEUDO"===c.part)for(S.exec(""),f=0;g=S.exec(p);)v=!0,_=S.lastIndex=g.index+g[0].length,_>f&&(a+=p.slice(f,g.index),f=_,C=[i],z.test(a)&&(m&&(C=m),m=r),(P=J.test(a))&&(a=a.slice(0,-5).replace(z,"$&*"),f++),g.length>1&&g[0].replace(E,b),m=h(a,g[1],g[2],C,m,P)),a="";v||(a+=p),v=!1}a?z.test(a)?d(a,m||[i],o,r):n(a,i,o,r?r.concat(m):m):k.apply(o,m)}return 1===T?o:n.uniqueSort(o)}function f(e,t,n,i,o){e=e.replace(G,"$1");var r,a,l,u,c,d,h,f,v,C=s(e,t,o),P=t.nodeType;if(nt.POS.test(e))return p(C,t,n,i);if(i)r=M.call(i,0);else if(1===C.length){if((c=M.call(C[0],0)).length>2&&"ID"===(d=c[0]).part&&9===P&&!o&&_.relative[c[1].part]){if(t=_.find.ID(d.captures[0].replace(tt,""),t,o)[0],!t)return n;e=e.slice(c.shift().string.length)}for(f=(C=X.exec(c[0].string))&&!C.index&&t.parentNode||t,h="",u=c.length-1;u>=0&&(d=c[u],v=d.part,h=d.string+h,!_.relative[v]);u--)if(_.order.test(v)){if(r=_.find[v](d.captures[0].replace(tt,""),f,o),null==r)continue;e=e.slice(0,e.length-h.length)+h.replace(nt[v],""),e||k.apply(n,M.call(r,0));break}}if(e)for(a=T(e,t,o),m=a.dirruns++,null==r&&(r=_.find.TAG("*",X.test(e)&&t.parentNode||t)),u=0;l=r[u];u++)g=a.runs++,a(l)&&n.push(l);return n}var m,g,v,_,C,P,y,T,S,E,b=!0,w="undefined",N=("sizcache"+Math.random()).replace(".",""),I=e.document,O=I.documentElement,x=0,M=[].slice,k=[].push,R=function(e,t){return e[N]=t||!0,e},A=function(){var e={},t=[];return R(function(n,i){return t.push(n)>_.cacheLength&&delete e[t.shift()],e[n]=i},e)},B=A(),D=A(),U=A(),L="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",$=F.replace("w","w#"),j="([*^$|!~]?=)",H="\\["+L+"*("+F+")"+L+"*(?:"+j+L+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+$+")|)|)"+L+"*\\]",q=":("+F+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+H+")|[^:]|\\\\.)*|.*))\\)|)",V=":(nth|eq|gt|lt|first|last|even|odd)(?:\\(((?:-\\d)?\\d*)\\)|)(?=[^-]|$)",G=RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),W=RegExp("^"+L+"*,"+L+"*"),z=RegExp("^"+L+"*([\\x20\\t\\r\\n\\f>+~])"+L+"*"),K=RegExp(q),Y=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,X=/[\x20\t\r\n\f]*[+~]/,J=/:not\($/,Z=/h\d/i,et=/input|select|textarea|button/i,tt=/\\(?!\\)/g,nt={ID:RegExp("^#("+F+")"),CLASS:RegExp("^\\.("+F+")"),NAME:RegExp("^\\[name=['\"]?("+F+")['\"]?\\]"),TAG:RegExp("^("+F.replace("w","w*")+")"),ATTR:RegExp("^"+H),PSEUDO:RegExp("^"+q),CHILD:RegExp("^:(only|nth|last|first)-child(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),POS:RegExp(V,"ig"),needsContext:RegExp("^"+L+"*[>+~]|"+V,"i")},it=function(e){var t=I.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}},ot=it(function(e){return e.appendChild(I.createComment("")),!e.getElementsByTagName("*").length}),rt=it(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==w&&"#"===e.firstChild.getAttribute("href")}),st=it(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),at=it(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),lt=it(function(e){e.id=N+0,e.innerHTML="<a name='"+N+"'></a><div name='"+N+"'></div>",O.insertBefore(e,O.firstChild);var t=I.getElementsByName&&I.getElementsByName(N).length===2+I.getElementsByName(N+0).length;return v=!I.getElementById(N),O.removeChild(e),t});try{M.call(O.childNodes,0)[0].nodeType}catch(ut){M=function(e){for(var t,n=[];t=this[e];e++)n.push(t);return n}}n.matches=function(e,t){return n(e,null,null,t)},n.matchesSelector=function(e,t){return n(t,null,null,[e]).length>0},C=n.getText=function(e){var t,n="",i=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"===typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=C(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[i];i++)n+=C(t);return n},P=n.isXML=function P(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},y=n.contains=O.contains?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!!(i&&1===i.nodeType&&n.contains&&n.contains(i))}:O.compareDocumentPosition?function(e,t){return t&&!!(16&e.compareDocumentPosition(t))}:function(e,t){for(;t=t.parentNode;)if(t===e)return!0;return!1},n.attr=function(e,t){var n,i=P(e);return i||(t=t.toLowerCase()),_.attrHandle[t]?_.attrHandle[t](e):st||i?e.getAttribute(t):(n=e.getAttributeNode(t),n?"boolean"===typeof e[t]?e[t]?t:null:n.specified?n.value:null:null)},_=n.selectors={cacheLength:50,createPseudo:R,match:nt,order:RegExp("ID|TAG"+(lt?"|NAME":"")+(at?"|CLASS":"")),attrHandle:rt?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:v?function(e,t,n){if(typeof t.getElementById!==w&&!n){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}}:function(e,n,i){if(typeof n.getElementById!==w&&!i){var o=n.getElementById(e);return o?o.id===e||typeof o.getAttributeNode!==w&&o.getAttributeNode("id").value===e?[o]:t:[]}},TAG:ot?function(e,n){return typeof n.getElementsByTagName!==w?n.getElementsByTagName(e):t}:function(e,t){var n=t.getElementsByTagName(e);if("*"===e){for(var i,o=[],r=0;i=n[r];r++)1===i.nodeType&&o.push(i);return o}return n},NAME:function(e,n){return typeof n.getElementsByName!==w?n.getElementsByName(name):t},CLASS:function(e,n,i){return typeof n.getElementsByClassName===w||i?t:n.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(tt,""),e[3]=(e[4]||e[5]||"").replace(tt,""),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1]?(e[2]||n.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*("even"===e[2]||"odd"===e[2])),e[4]=+(e[6]+e[7]||"odd"===e[2])):e[2]&&n.error(e[0]),e},PSEUDO:function(e,t,n){var i,o;return nt.CHILD.test(e[0])?null:(e[3]?e[2]=e[3]:(i=e[4])&&(K.test(i)&&(o=s(i,t,n,!0))&&(o=i.indexOf(")",i.length-o)-i.length)&&(i=i.slice(0,o),e[0]=e[0].slice(0,o)),e[2]=i),e.slice(0,3))}},filter:{ID:v?function(e){return e=e.replace(tt,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace(tt,""),function(t){var n=typeof t.getAttributeNode!==w&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(tt,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=B[N][e];return t||(t=B(e,RegExp("(^|"+L+")"+e+"("+L+"|$)"))),function(e){return t.test(e.className||typeof e.getAttribute!==w&&e.getAttribute("class")||"")}},ATTR:function(e,t,i){return t?function(o){var r=n.attr(o,e),s=r+"";if(null==r)return"!="===t;switch(t){case"=":return s===i;case"!=":return s!==i;case"^=":return i&&0===s.indexOf(i);case"*=":return i&&s.indexOf(i)>-1;case"$=":return i&&s.substr(s.length-i.length)===i;case"~=":return(" "+s+" ").indexOf(i)>-1;case"|=":return s===i||s.substr(0,i.length+1)===i+"-"}}:function(t){return null!=n.attr(t,e)}},CHILD:function(e,t,n,i){if("nth"===e){var o=x++;return function(e){var t,r,s=0,a=e;if(1===n&&0===i)return!0;if(t=e.parentNode,t&&(t[N]!==o||!e.sizset)){for(a=t.firstChild;a&&(1!==a.nodeType||(a.sizset=++s,a!==e));a=a.nextSibling);t[N]=o}return r=e.sizset-i,0===n?0===r:0===r%n&&r/n>=0}}return function(t){var n=t;switch(e){case"only":case"first":for(;n=n.previousSibling;)if(1===n.nodeType)return!1;if("first"===e)return!0;n=t;case"last":for(;n=n.nextSibling;)if(1===n.nodeType)return!1;return!0}}},PSEUDO:function(e,t,i,o){var r,s=_.pseudos[e]||_.pseudos[e.toLowerCase()];return s||n.error("unsupported pseudo: "+e),s[N]?s(t,i,o):s.length>1?(r=[e,e,"",t],function(e){return s(e,0,r)}):s}},pseudos:{not:R(function(e,t,n){var i=T(e.replace(G,"$1"),t,n);return function(e){return!i(e)}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!_.pseudos.empty(e)},empty:function(e){var t;for(e=e.firstChild;e;){if(e.nodeName>"@"||3===(t=e.nodeType)||4===t)return!1;e=e.nextSibling}return!0},contains:R(function(e){return function(t){return(t.textContent||t.innerText||C(t)).indexOf(e)>-1}}),has:R(function(e){return function(t){return n(e,t).length>0}}),header:function(e){return Z.test(e.nodeName)},text:function(e){var t,n;return"input"===e.nodeName.toLowerCase()&&"text"===(t=e.type)&&(null==(n=e.getAttribute("type"))||n.toLowerCase()===t)},radio:i("radio"),checkbox:i("checkbox"),file:i("file"),password:i("password"),image:i("image"),submit:o("submit"),reset:o("reset"),button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},input:function(e){return et.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&!(!e.type&&!e.href)},active:function(e){return e===e.ownerDocument.activeElement}},setFilters:{first:function(e,t,n){return n?e.slice(1):[e[0]]},last:function(e,t,n){var i=e.pop();return n?e:[i]},even:function(e,t,n){for(var i=[],o=n?1:0,r=e.length;o<r;o+=2)i.push(e[o]);return i},odd:function(e,t,n){for(var i=[],o=n?0:1,r=e.length;o<r;o+=2)i.push(e[o]);return i},lt:function(e,t,n){return n?e.slice(+t):e.slice(0,+t)},gt:function(e,t,n){return n?e.slice(0,+t+1):e.slice(+t+1)},eq:function(e,t,n){var i=e.splice(+t,1);return n?e:i}}},S=O.compareDocumentPosition?function(e,t){return e===t?(E=!0,0):(e.compareDocumentPosition&&t.compareDocumentPosition?4&e.compareDocumentPosition(t):e.compareDocumentPosition)?-1:1}:function(e,t){if(e===t)return E=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,i,o=[],s=[],a=e.parentNode,l=t.parentNode,u=a;if(a===l)return r(e,t);if(!a)return-1;if(!l)return 1;for(;u;)o.unshift(u),u=u.parentNode;for(u=l;u;)s.unshift(u),u=u.parentNode;n=o.length,i=s.length;for(var c=0;c<n&&c<i;c++)if(o[c]!==s[c])return r(o[c],s[c]);return c===n?r(e,s[c],-1):r(o[c],t,1)},[0,0].sort(S),b=!E,n.uniqueSort=function(e){var t,n=1;if(E=b,e.sort(S),E)for(;t=e[n];n++)t===e[n-1]&&e.splice(n--,1);return e},n.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},T=n.compile=function(e,t,n){var i,o,r,a=U[N][e];if(a&&a.context===t)return a;for(i=s(e,t,n),o=0,r=i.length;o<r;o++)i[o]=u(i[o],t,n);return a=U(e,c(i)),a.context=t,a.runs=a.dirruns=0,a},I.querySelectorAll&&function(){var e,t=f,i=/'|\\/g,o=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,r=[],a=[":active"],l=O.matchesSelector||O.mozMatchesSelector||O.webkitMatchesSelector||O.oMatchesSelector||O.msMatchesSelector;it(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||r.push("\\["+L+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||r.push(":checked")}),it(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&r.push("[*^$]="+L+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||r.push(":enabled",":disabled")}),r=r.length&&RegExp(r.join("|")),f=function(e,n,o,a,l){if(!a&&!l&&(!r||!r.test(e)))if(9===n.nodeType)try{return k.apply(o,M.call(n.querySelectorAll(e),0)),o}catch(u){}else if(1===n.nodeType&&"object"!==n.nodeName.toLowerCase()){var c,d,h,p=n.getAttribute("id"),f=p||N,m=X.test(e)&&n.parentNode||n;for(p?f=f.replace(i,"\\$&"):n.setAttribute("id",f),c=s(e,n,l),f="[id='"+f+"']",d=0,h=c.length;d<h;d++)c[d]=f+c[d].selector;try{return k.apply(o,M.call(m.querySelectorAll(c.join(",")),0)),o}catch(u){}finally{p||n.removeAttribute("id")}}return t(e,n,o,a,l)},l&&(it(function(t){e=l.call(t,"div");try{l.call(t,"[test!='']:sizzle"),a.push(nt.PSEUDO.source,nt.POS.source,"!=")}catch(n){}}),a=RegExp(a.join("|")),n.matchesSelector=function(t,i){if(i=i.replace(o,"='$1']"),!P(t)&&!a.test(i)&&(!r||!r.test(i)))try{var s=l.call(t,i);if(s||e||t.document&&11!==t.document.nodeType)return s}catch(u){}return n(i,null,null,[t]).length>0})}(),_.setFilters.nth=_.setFilters.eq,_.filters=_.pseudos,n.attr=Q.attr,Q.find=n,Q.expr=n.selectors,Q.expr[":"]=Q.expr.pseudos,Q.unique=n.uniqueSort,Q.text=n.getText,Q.isXMLDoc=n.isXML,Q.contains=n.contains}(e);var At=/Until$/,Bt=/^(?:parents|prev(?:Until|All))/,Dt=/^.[^:#\[\.,]*$/,Ut=Q.expr.match.needsContext,Lt={children:!0,contents:!0,next:!0,prev:!0};Q.fn.extend({find:function(e){var t,n,i,o,r,s,a=this;if("string"!==typeof e)return Q(e).filter(function(){for(t=0,n=a.length;t<n;t++)if(Q.contains(a[t],this))return!0});for(s=this.pushStack("","find",e),t=0,n=this.length;t<n;t++)if(i=s.length,Q.find(e,this[t],s),t>0)for(o=i;o<s.length;o++)for(r=0;r<i;r++)if(s[r]===s[o]){s.splice(o--,1);break}return s},has:function(e){var t,n=Q(e,this),i=n.length;return this.filter(function(){for(t=0;t<i;t++)if(Q.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(u(this,e,!1),"not",e)},filter:function(e){return this.pushStack(u(this,e,!0),"filter",e)},is:function(e){return!!e&&("string"===typeof e?Ut.test(e)?Q(e,this.context).index(this[0])>=0:Q.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){for(var n,i=0,o=this.length,r=[],s=Ut.test(e)||"string"!==typeof e?Q(e,t||this.context):0;i<o;i++)for(n=this[i];n&&n.ownerDocument&&n!==t&&11!==n.nodeType;){if(s?s.index(n)>-1:Q.find.matchesSelector(n,e)){r.push(n);break}n=n.parentNode}return r=r.length>1?Q.unique(r):r,this.pushStack(r,"closest",e)},index:function(e){return e?"string"===typeof e?Q.inArray(this[0],Q(e)):Q.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n="string"===typeof e?Q(e,t):Q.makeArray(e&&e.nodeType?[e]:e),i=Q.merge(this.get(),n);return this.pushStack(a(n[0])||a(i[0])?i:Q.unique(i))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Q.fn.andSelf=Q.fn.addBack,Q.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Q.dir(e,"parentNode")},parentsUntil:function(e,t,n){return Q.dir(e,"parentNode",n)},next:function(e){return l(e,"nextSibling")},prev:function(e){return l(e,"previousSibling")},nextAll:function(e){return Q.dir(e,"nextSibling")},prevAll:function(e){return Q.dir(e,"previousSibling")},nextUntil:function(e,t,n){return Q.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return Q.dir(e,"previousSibling",n)},siblings:function(e){return Q.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Q.sibling(e.firstChild)},contents:function(e){return Q.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:Q.merge([],e.childNodes)}},function(e,t){Q.fn[e]=function(n,i){var o=Q.map(this,t,n);return At.test(e)||(i=n),i&&"string"===typeof i&&(o=Q.filter(i,o)),o=this.length>1&&!Lt[e]?Q.unique(o):o,this.length>1&&Bt.test(e)&&(o=o.reverse()),this.pushStack(o,e,z.call(arguments).join(","))}}),Q.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),1===t.length?Q.find.matchesSelector(t[0],e)?[t[0]]:[]:Q.find.matches(e,t)},dir:function(e,n,i){for(var o=[],r=e[n];r&&9!==r.nodeType&&(i===t||1!==r.nodeType||!Q(r).is(i));)1===r.nodeType&&o.push(r),r=r[n];return o},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var Ft="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",$t=/ jQuery\d+="(?:null|\d+)"/g,jt=/^\s+/,Ht=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,qt=/<([\w:]+)/,Vt=/<tbody/i,Gt=/<|&#?\w+;/,Wt=/<(?:script|style|link)/i,zt=/<(?:script|object|embed|option|style)/i,Kt=RegExp("<(?:"+Ft+")[\\s/>]","i"),Yt=/^(?:checkbox|radio)$/,Xt=/checked\s*(?:[^=]|=\s*.checked.)/i,Jt=/\/(java|ecma)script/i,Qt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Zt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},en=c(j),tn=en.appendChild(j.createElement("div"));
Zt.optgroup=Zt.option,Zt.tbody=Zt.tfoot=Zt.colgroup=Zt.caption=Zt.thead,Zt.th=Zt.td,Q.support.htmlSerialize||(Zt._default=[1,"X<div>","</div>"]),Q.fn.extend({text:function(e){return Q.access(this,function(e){return e===t?Q.text(this):this.empty().append((this[0]&&this[0].ownerDocument||j).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(Q.isFunction(e))return this.each(function(t){Q(this).wrapAll(e.call(this,t))});if(this[0]){var t=Q(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return Q.isFunction(e)?this.each(function(t){Q(this).wrapInner(e.call(this,t))}):this.each(function(){var t=Q(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=Q.isFunction(e);return this.each(function(n){Q(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){Q.nodeName(this,"body")||Q(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!a(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=Q.clean(arguments);return this.pushStack(Q.merge(e,this),"before",this.selector)}},after:function(){if(!a(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=Q.clean(arguments);return this.pushStack(Q.merge(this,e),"after",this.selector)}},remove:function(e,t){for(var n,i=0;null!=(n=this[i]);i++)(!e||Q.filter(e,[n]).length)&&(t||1!==n.nodeType||(Q.cleanData(n.getElementsByTagName("*")),Q.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)for(1===e.nodeType&&Q.cleanData(e.getElementsByTagName("*"));e.firstChild;)e.removeChild(e.firstChild);return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return Q.clone(this,e,t)})},html:function(e){return Q.access(this,function(e){var n=this[0]||{},i=0,o=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace($t,""):t;if("string"===typeof e&&!Wt.test(e)&&(Q.support.htmlSerialize||!Kt.test(e))&&(Q.support.leadingWhitespace||!jt.test(e))&&!Zt[(qt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Ht,"<$1></$2>");try{for(;i<o;i++)n=this[i]||{},1===n.nodeType&&(Q.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(r){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return a(this[0])?this.length?this.pushStack(Q(Q.isFunction(e)?e():e),"replaceWith",e):this:Q.isFunction(e)?this.each(function(t){var n=Q(this),i=n.html();n.replaceWith(e.call(this,t,i))}):("string"!==typeof e&&(e=Q(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;Q(this).remove(),t?Q(t).before(e):Q(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,i){e=[].concat.apply([],e);var o,r,s,a,l=0,u=e[0],c=[],h=this.length;if(!Q.support.checkClone&&h>1&&"string"===typeof u&&Xt.test(u))return this.each(function(){Q(this).domManip(e,n,i)});if(Q.isFunction(u))return this.each(function(o){var r=Q(this);e[0]=u.call(this,o,n?r.html():t),r.domManip(e,n,i)});if(this[0]){if(o=Q.buildFragment(e,this,c),s=o.fragment,r=s.firstChild,1===s.childNodes.length&&(s=r),r)for(n=n&&Q.nodeName(r,"tr"),a=o.cacheable||h-1;l<h;l++)i.call(n&&Q.nodeName(this[l],"table")?d(this[l],"tbody"):this[l],l===a?s:Q.clone(s,!0,!0));s=r=null,c.length&&Q.each(c,function(e,t){t.src?Q.ajax?Q.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):Q.error("no ajax"):Q.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Qt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),Q.buildFragment=function(e,n,i){var o,r,s,a=e[0];return n=n||j,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,!(1===e.length&&"string"===typeof a&&a.length<512&&n===j&&"<"===a.charAt(0))||zt.test(a)||!Q.support.checkClone&&Xt.test(a)||!Q.support.html5Clone&&Kt.test(a)||(r=!0,o=Q.fragments[a],s=o!==t),o||(o=n.createDocumentFragment(),Q.clean(e,n,o,i),r&&(Q.fragments[a]=s&&o)),{fragment:o,cacheable:r}},Q.fragments={},Q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Q.fn[e]=function(n){var i,o=0,r=[],s=Q(n),a=s.length,l=1===this.length&&this[0].parentNode;if((null==l||l&&11===l.nodeType&&1===l.childNodes.length)&&1===a)return s[t](this[0]),this;for(;o<a;o++)i=(o>0?this.clone(!0):this).get(),Q(s[o])[t](i),r=r.concat(i);return this.pushStack(r,e,s.selector)}}),Q.extend({clone:function(e,t,n){var i,o,r,s;if(Q.support.html5Clone||Q.isXMLDoc(e)||!Kt.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(tn.innerHTML=e.outerHTML,tn.removeChild(s=tn.firstChild)),(!Q.support.noCloneEvent||!Q.support.noCloneChecked)&&(1===e.nodeType||11===e.nodeType)&&!Q.isXMLDoc(e))for(p(e,s),i=f(e),o=f(s),r=0;i[r];++r)o[r]&&p(i[r],o[r]);if(t&&(h(e,s),n))for(i=f(e),o=f(s),r=0;i[r];++r)h(i[r],o[r]);return i=o=null,s},clean:function(e,n,i,o){var r,s,a,l,u,d,h,p,f,g,v,_=n===j&&en,C=[];for(n&&"undefined"!==typeof n.createDocumentFragment||(n=j),r=0;null!=(a=e[r]);r++)if("number"===typeof a&&(a+=""),a){if("string"===typeof a)if(Gt.test(a)){for(_=_||c(n),h=n.createElement("div"),_.appendChild(h),a=a.replace(Ht,"<$1></$2>"),l=(qt.exec(a)||["",""])[1].toLowerCase(),u=Zt[l]||Zt._default,d=u[0],h.innerHTML=u[1]+a+u[2];d--;)h=h.lastChild;if(!Q.support.tbody)for(p=Vt.test(a),f="table"!==l||p?"<table>"!==u[1]||p?[]:h.childNodes:h.firstChild&&h.firstChild.childNodes,s=f.length-1;s>=0;--s)Q.nodeName(f[s],"tbody")&&!f[s].childNodes.length&&f[s].parentNode.removeChild(f[s]);!Q.support.leadingWhitespace&&jt.test(a)&&h.insertBefore(n.createTextNode(jt.exec(a)[0]),h.firstChild),a=h.childNodes,h.parentNode.removeChild(h)}else a=n.createTextNode(a);a.nodeType?C.push(a):Q.merge(C,a)}if(h&&(a=h=_=null),!Q.support.appendChecked)for(r=0;null!=(a=C[r]);r++)Q.nodeName(a,"input")?m(a):"undefined"!==typeof a.getElementsByTagName&&Q.grep(a.getElementsByTagName("input"),m);if(i)for(g=function(e){return!e.type||Jt.test(e.type)?o?o.push(e.parentNode?e.parentNode.removeChild(e):e):i.appendChild(e):t},r=0;null!=(a=C[r]);r++)Q.nodeName(a,"script")&&g(a)||(i.appendChild(a),"undefined"!==typeof a.getElementsByTagName&&(v=Q.grep(Q.merge([],a.getElementsByTagName("script")),g),C.splice.apply(C,[r+1,0].concat(v)),r+=v.length));return C},cleanData:function(e,t){for(var n,i,o,r,s=0,a=Q.expando,l=Q.cache,u=Q.support.deleteExpando,c=Q.event.special;null!=(o=e[s]);s++)if((t||Q.acceptData(o))&&(i=o[a],n=i&&l[i])){if(n.events)for(r in n.events)c[r]?Q.event.remove(o,r):Q.removeEvent(o,r,n.handle);l[i]&&(delete l[i],u?delete o[a]:o.removeAttribute?o.removeAttribute(a):o[a]=null,Q.deletedIds.push(i))}}}),function(){var e,t;Q.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=Q.uaMatch(q.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),Q.browser=t,Q.sub=function(){function e(t,n){return new e.fn.init(t,n)}Q.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(n,i){return i&&i instanceof Q&&!(i instanceof e)&&(i=e(i)),Q.fn.init.call(this,n,i,t)},e.fn.init.prototype=e.fn;var t=e(j);return e}}();var nn,on,rn,sn=/alpha\([^)]*\)/i,an=/opacity=([^)]*)/,ln=/^(top|right|bottom|left)$/,un=/^(none|table(?!-c[ea]).+)/,cn=/^margin/,dn=RegExp("^("+Z+")(.*)$","i"),hn=RegExp("^("+Z+")(?!px)[a-z%]+$","i"),pn=RegExp("^([-+])=("+Z+")","i"),fn={},mn={position:"absolute",visibility:"hidden",display:"block"},gn={letterSpacing:0,fontWeight:400},vn=["Top","Right","Bottom","Left"],_n=["Webkit","O","Moz","ms"],Cn=Q.fn.toggle;Q.fn.extend({css:function(e,n){return Q.access(this,function(e,n,i){return i!==t?Q.style(e,n,i):Q.css(e,n)},e,n,arguments.length>1)},show:function(){return _(this,!0)},hide:function(){return _(this)},toggle:function(e,t){var n="boolean"===typeof e;return Q.isFunction(e)&&Q.isFunction(t)?Cn.apply(this,arguments):this.each(function(){(n?e:v(this))?Q(this).show():Q(this).hide()})}}),Q.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=nn(e,"opacity");return""===n?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":Q.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,i,o){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,s,a,l=Q.camelCase(n),u=e.style;if(n=Q.cssProps[l]||(Q.cssProps[l]=g(u,l)),a=Q.cssHooks[n]||Q.cssHooks[l],i===t)return a&&"get"in a&&(r=a.get(e,!1,o))!==t?r:u[n];if(s=typeof i,"string"===s&&(r=pn.exec(i))&&(i=(r[1]+1)*r[2]+parseFloat(Q.css(e,n)),s="number"),!(null==i||"number"===s&&isNaN(i))&&("number"!==s||Q.cssNumber[l]||(i+="px"),!a||!("set"in a)||(i=a.set(e,i,o))!==t))try{u[n]=i}catch(c){}}},css:function(e,n,i,o){var r,s,a,l=Q.camelCase(n);return n=Q.cssProps[l]||(Q.cssProps[l]=g(e.style,l)),a=Q.cssHooks[n]||Q.cssHooks[l],a&&"get"in a&&(r=a.get(e,!0,o)),r===t&&(r=nn(e,n)),"normal"===r&&n in gn&&(r=gn[n]),i||o!==t?(s=parseFloat(r),i||Q.isNumeric(s)?s||0:r):r},swap:function(e,t,n){var i,o,r={};for(o in t)r[o]=e.style[o],e.style[o]=t[o];i=n.call(e);for(o in t)e.style[o]=r[o];return i}}),e.getComputedStyle?nn=function(t,n){var i,o,r,s,a=e.getComputedStyle(t,null),l=t.style;return a&&(i=a[n],""!==i||Q.contains(t.ownerDocument,t)||(i=Q.style(t,n)),hn.test(i)&&cn.test(n)&&(o=l.width,r=l.minWidth,s=l.maxWidth,l.minWidth=l.maxWidth=l.width=i,i=a.width,l.width=o,l.minWidth=r,l.maxWidth=s)),i}:j.documentElement.currentStyle&&(nn=function(e,t){var n,i,o=e.currentStyle&&e.currentStyle[t],r=e.style;return null==o&&r&&r[t]&&(o=r[t]),hn.test(o)&&!ln.test(t)&&(n=r.left,i=e.runtimeStyle&&e.runtimeStyle.left,i&&(e.runtimeStyle.left=e.currentStyle.left),r.left="fontSize"===t?"1em":o,o=r.pixelLeft+"px",r.left=n,i&&(e.runtimeStyle.left=i)),""===o?"auto":o}),Q.each(["height","width"],function(e,n){Q.cssHooks[n]={get:function(e,i,o){return i?0===e.offsetWidth&&un.test(nn(e,"display"))?Q.swap(e,mn,function(){return y(e,n,o)}):y(e,n,o):t},set:function(e,t,i){return C(e,t,i?P(e,n,i,Q.support.boxSizing&&"border-box"===Q.css(e,"boxSizing")):0)}}}),Q.support.opacity||(Q.cssHooks.opacity={get:function(e,t){return an.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,i=e.currentStyle,o=Q.isNumeric(t)?"alpha(opacity="+100*t+")":"",r=i&&i.filter||n.filter||"";n.zoom=1,t>=1&&""===Q.trim(r.replace(sn,""))&&n.removeAttribute&&(n.removeAttribute("filter"),i&&!i.filter)||(n.filter=sn.test(r)?r.replace(sn,o):r+" "+o)}}),Q(function(){Q.support.reliableMarginRight||(Q.cssHooks.marginRight={get:function(e,n){return Q.swap(e,{display:"inline-block"},function(){return n?nn(e,"marginRight"):t})}}),!Q.support.pixelPosition&&Q.fn.position&&Q.each(["top","left"],function(e,t){Q.cssHooks[t]={get:function(e,n){if(n){var i=nn(e,t);return hn.test(i)?Q(e).position()[t]+"px":i}}}})}),Q.expr&&Q.expr.filters&&(Q.expr.filters.hidden=function(e){return 0===e.offsetWidth&&0===e.offsetHeight||!Q.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||nn(e,"display"))},Q.expr.filters.visible=function(e){return!Q.expr.filters.hidden(e)}),Q.each({margin:"",padding:"",border:"Width"},function(e,t){Q.cssHooks[e+t]={expand:function(n){var i,o="string"===typeof n?n.split(" "):[n],r={};for(i=0;i<4;i++)r[e+vn[i]+t]=o[i]||o[i-2]||o[0];return r}},cn.test(e)||(Q.cssHooks[e+t].set=C)});var Pn=/%20/g,yn=/\[\]$/,Tn=/\r?\n/g,Sn=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,En=/^(?:select|textarea)/i;Q.fn.extend({serialize:function(){return Q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?Q.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||En.test(this.nodeName)||Sn.test(this.type))}).map(function(e,t){var n=Q(this).val();return null==n?null:Q.isArray(n)?Q.map(n,function(e){return{name:t.name,value:e.replace(Tn,"\r\n")}}):{name:t.name,value:n.replace(Tn,"\r\n")}}).get()}}),Q.param=function(e,n){var i,o=[],r=function(e,t){t=Q.isFunction(t)?t():null==t?"":t,o[o.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=Q.ajaxSettings&&Q.ajaxSettings.traditional),Q.isArray(e)||e.jquery&&!Q.isPlainObject(e))Q.each(e,function(){r(this.name,this.value)});else for(i in e)S(i,e[i],n,r);return o.join("&").replace(Pn,"+")};var bn,wn,Nn=/#.*$/,In=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,On=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,xn=/^(?:GET|HEAD)$/,Mn=/^\/\//,kn=/\?/,Rn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,An=/([?&])_=[^&]*/,Bn=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Dn=Q.fn.load,Un={},Ln={},Fn=["*/"]+["*"];try{bn=H.href}catch($n){bn=j.createElement("a"),bn.href="",bn=bn.href}wn=Bn.exec(bn.toLowerCase())||[],Q.fn.load=function(e,n,i){if("string"!==typeof e&&Dn)return Dn.apply(this,arguments);if(!this.length)return this;var o,r,s,a=this,l=e.indexOf(" ");return l>=0&&(o=e.slice(l,e.length),e=e.slice(0,l)),Q.isFunction(n)?(i=n,n=t):n&&"object"===typeof n&&(r="POST"),Q.ajax({url:e,type:r,dataType:"html",data:n,complete:function(e,t){i&&a.each(i,s||[e.responseText,t,e])}}).done(function(e){s=arguments,a.html(o?Q("<div>").append(e.replace(Rn,"")).find(o):e)}),this},Q.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){Q.fn[t]=function(e){return this.on(t,e)}}),Q.each(["get","post"],function(e,n){Q[n]=function(e,i,o,r){return Q.isFunction(i)&&(r=r||o,o=i,i=t),Q.ajax({type:n,url:e,data:i,success:o,dataType:r})}}),Q.extend({getScript:function(e,n){return Q.get(e,t,n,"script")},getJSON:function(e,t,n){return Q.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?w(e,Q.ajaxSettings):(t=e,e=Q.ajaxSettings),w(e,t),e},ajaxSettings:{url:bn,isLocal:On.test(wn[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Fn},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":Q.parseJSON,"text xml":Q.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:E(Un),ajaxTransport:E(Ln),ajax:function(e,n){function i(e,n,i,s){var u,d,_,C,y,S=n;2!==P&&(P=2,l&&clearTimeout(l),a=t,r=s||"",T.readyState=e>0?4:0,i&&(C=N(h,T,i)),e>=200&&e<300||304===e?(h.ifModified&&(y=T.getResponseHeader("Last-Modified"),y&&(Q.lastModified[o]=y),y=T.getResponseHeader("Etag"),y&&(Q.etag[o]=y)),304===e?(S="notmodified",u=!0):(u=I(h,C),S=u.state,d=u.data,_=u.error,u=!_)):(_=S,(!S||e)&&(S="error",e<0&&(e=0))),T.status=e,T.statusText=""+(n||S),u?m.resolveWith(p,[d,S,T]):m.rejectWith(p,[T,S,_]),T.statusCode(v),v=t,c&&f.trigger("ajax"+(u?"Success":"Error"),[T,h,u?d:_]),g.fireWith(p,[T,S]),c&&(f.trigger("ajaxComplete",[T,h]),--Q.active||Q.event.trigger("ajaxStop")))}"object"===typeof e&&(n=e,e=t),n=n||{};var o,r,s,a,l,u,c,d,h=Q.ajaxSetup({},n),p=h.context||h,f=p!==h&&(p.nodeType||p instanceof Q)?Q(p):Q.event,m=Q.Deferred(),g=Q.Callbacks("once memory"),v=h.statusCode||{},_={},C={},P=0,y="canceled",T={readyState:0,setRequestHeader:function(e,t){if(!P){var n=e.toLowerCase();e=C[n]=C[n]||e,_[e]=t}return this},getAllResponseHeaders:function(){return 2===P?r:null},getResponseHeader:function(e){var n;if(2===P){if(!s)for(s={};n=In.exec(r);)s[n[1].toLowerCase()]=n[2];n=s[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return P||(h.mimeType=e),this},abort:function(e){return e=e||y,a&&a.abort(e),i(0,e),this}};if(m.promise(T),T.success=T.done,T.error=T.fail,T.complete=g.add,T.statusCode=function(e){if(e){var t;if(P<2)for(t in e)v[t]=[v[t],e[t]];else t=e[T.status],T.always(t)}return this},h.url=((e||h.url)+"").replace(Nn,"").replace(Mn,wn[1]+"//"),h.dataTypes=Q.trim(h.dataType||"*").toLowerCase().split(tt),null==h.crossDomain&&(u=Bn.exec(h.url.toLowerCase()),h.crossDomain=!(!u||u[1]==wn[1]&&u[2]==wn[2]&&(u[3]||("http:"===u[1]?80:443))==(wn[3]||("http:"===wn[1]?80:443)))),h.data&&h.processData&&"string"!==typeof h.data&&(h.data=Q.param(h.data,h.traditional)),b(Un,h,n,T),2===P)return T;if(c=h.global,h.type=h.type.toUpperCase(),h.hasContent=!xn.test(h.type),c&&0===Q.active++&&Q.event.trigger("ajaxStart"),!h.hasContent&&(h.data&&(h.url+=(kn.test(h.url)?"&":"?")+h.data,delete h.data),o=h.url,h.cache===!1)){var S=Q.now(),E=h.url.replace(An,"$1_="+S);h.url=E+(E===h.url?(kn.test(h.url)?"&":"?")+"_="+S:"")}(h.data&&h.hasContent&&h.contentType!==!1||n.contentType)&&T.setRequestHeader("Content-Type",h.contentType),h.ifModified&&(o=o||h.url,Q.lastModified[o]&&T.setRequestHeader("If-Modified-Since",Q.lastModified[o]),Q.etag[o]&&T.setRequestHeader("If-None-Match",Q.etag[o])),T.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+Fn+"; q=0.01":""):h.accepts["*"]);for(d in h.headers)T.setRequestHeader(d,h.headers[d]);if(h.beforeSend&&(h.beforeSend.call(p,T,h)===!1||2===P))return T.abort();y="abort";for(d in{success:1,error:1,complete:1})T[d](h[d]);if(a=b(Ln,h,n,T)){T.readyState=1,c&&f.trigger("ajaxSend",[T,h]),h.async&&h.timeout>0&&(l=setTimeout(function(){T.abort("timeout")},h.timeout));try{P=1,a.send(_,i)}catch(w){if(!(P<2))throw w;i(-1,w)}}else i(-1,"No Transport");return T},active:0,lastModified:{},etag:{}});var jn=[],Hn=/\?/,qn=/(=)\?(?=&|$)|\?\?/,Vn=Q.now();Q.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=jn.pop()||Q.expando+"_"+Vn++;return this[e]=!0,e}}),Q.ajaxPrefilter("json jsonp",function(n,i,o){var r,s,a,l=n.data,u=n.url,c=n.jsonp!==!1,d=c&&qn.test(u),h=c&&!d&&"string"===typeof l&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&qn.test(l);return"jsonp"===n.dataTypes[0]||d||h?(r=n.jsonpCallback=Q.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,s=e[r],d?n.url=u.replace(qn,"$1"+r):h?n.data=l.replace(qn,"$1"+r):c&&(n.url+=(Hn.test(u)?"&":"?")+n.jsonp+"="+r),n.converters["script json"]=function(){return a||Q.error(r+" was not called"),a[0]},n.dataTypes[0]="json",e[r]=function(){a=arguments},o.always(function(){e[r]=s,n[r]&&(n.jsonpCallback=i.jsonpCallback,jn.push(r)),a&&Q.isFunction(s)&&s(a[0]),a=s=t}),"script"):t}),Q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return Q.globalEval(e),e}}}),Q.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),Q.ajaxTransport("script",function(e){if(e.crossDomain){var n,i=j.head||j.getElementsByTagName("head")[0]||j.documentElement;return{send:function(o,r){n=j.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,o){(o||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,i&&n.parentNode&&i.removeChild(n),n=t,o||r(200,"success"))},i.insertBefore(n,i.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var Gn,Wn=e.ActiveXObject?function(){for(var e in Gn)Gn[e](0,1)}:!1,zn=0;Q.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&O()||x()}:O,function(e){Q.extend(Q.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(Q.ajaxSettings.xhr()),Q.support.ajax&&Q.ajaxTransport(function(n){if(!n.crossDomain||Q.support.cors){var i;return{send:function(o,r){var s,a,l=n.xhr();if(n.username?l.open(n.type,n.url,n.async,n.username,n.password):l.open(n.type,n.url,n.async),n.xhrFields)for(a in n.xhrFields)l[a]=n.xhrFields[a];n.mimeType&&l.overrideMimeType&&l.overrideMimeType(n.mimeType),n.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest");try{for(a in o)l.setRequestHeader(a,o[a])}catch(u){}l.send(n.hasContent&&n.data||null),i=function(e,o){var a,u,c,d,h;try{if(i&&(o||4===l.readyState))if(i=t,s&&(l.onreadystatechange=Q.noop,Wn&&delete Gn[s]),o)4!==l.readyState&&l.abort();else{a=l.status,c=l.getAllResponseHeaders(),d={},h=l.responseXML,h&&h.documentElement&&(d.xml=h);try{d.text=l.responseText}catch(e){}try{u=l.statusText}catch(p){u=""}a||!n.isLocal||n.crossDomain?1223===a&&(a=204):a=d.text?200:404}}catch(f){o||r(-1,f)}d&&r(a,u,d,c)},n.async?4===l.readyState?setTimeout(i,0):(s=++zn,Wn&&(Gn||(Gn={},Q(e).unload(Wn)),Gn[s]=i),l.onreadystatechange=i):i()},abort:function(){i&&i(0,1)}}}});var Kn,Yn,Xn=/^(?:toggle|show|hide)$/,Jn=RegExp("^(?:([-+])=|)("+Z+")([a-z%]*)$","i"),Qn=/queueHooks$/,Zn=[B],ei={"*":[function(e,t){var n,i,o,r=this.createTween(e,t),s=Jn.exec(t),a=r.cur(),l=+a||0,u=1;if(s){if(n=+s[2],i=s[3]||(Q.cssNumber[e]?"":"px"),"px"!==i&&l){l=Q.css(r.elem,e,!0)||n||1;do o=u=u||".5",l/=u,Q.style(r.elem,e,l+i),u=r.cur()/a;while(1!==u&&u!==o)}r.unit=i,r.start=l,r.end=s[1]?l+(s[1]+1)*n:n}return r}]};Q.Animation=Q.extend(R,{tweener:function(e,t){Q.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,i=0,o=e.length;i<o;i++)n=e[i],ei[n]=ei[n]||[],ei[n].unshift(t)},prefilter:function(e,t){t?Zn.unshift(e):Zn.push(e)}}),Q.Tween=D,D.prototype={constructor:D,init:function(e,t,n,i,o,r){this.elem=e,this.prop=n,this.easing=o||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=r||(Q.cssNumber[n]?"":"px")},cur:function(){var e=D.propHooks[this.prop];return e&&e.get?e.get(this):D.propHooks._default.get(this)},run:function(e){var t,n=D.propHooks[this.prop];return this.pos=t=this.options.duration?Q.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):D.propHooks._default.set(this),this}},D.prototype.init.prototype=D.prototype,D.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=Q.css(e.elem,e.prop,!1,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){Q.fx.step[e.prop]?Q.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[Q.cssProps[e.prop]]||Q.cssHooks[e.prop])?Q.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},D.propHooks.scrollTop=D.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Q.each(["toggle","show","hide"],function(e,t){var n=Q.fn[t];Q.fn[t]=function(i,o,r){return null==i||"boolean"===typeof i||!e&&Q.isFunction(i)&&Q.isFunction(o)?n.apply(this,arguments):this.animate(U(t,!0),i,o,r)}}),Q.fn.extend({fadeTo:function(e,t,n,i){return this.filter(v).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var o=Q.isEmptyObject(e),r=Q.speed(t,n,i),s=function(){var t=R(this,Q.extend({},e),r);o&&t.stop(!0)};return o||r.queue===!1?this.each(s):this.queue(r.queue,s)},stop:function(e,n,i){var o=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!==typeof e&&(i=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",r=Q.timers,s=Q._data(this);if(n)s[n]&&s[n].stop&&o(s[n]);else for(n in s)s[n]&&s[n].stop&&Qn.test(n)&&o(s[n]);for(n=r.length;n--;)r[n].elem!==this||null!=e&&r[n].queue!==e||(r[n].anim.stop(i),t=!1,r.splice(n,1));(t||!i)&&Q.dequeue(this,e)})}}),Q.each({slideDown:U("show"),slideUp:U("hide"),slideToggle:U("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Q.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),Q.speed=function(e,t,n){var i=e&&"object"===typeof e?Q.extend({},e):{complete:n||!n&&t||Q.isFunction(e)&&e,duration:e,easing:n&&t||t&&!Q.isFunction(t)&&t};return i.duration=Q.fx.off?0:"number"===typeof i.duration?i.duration:i.duration in Q.fx.speeds?Q.fx.speeds[i.duration]:Q.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){Q.isFunction(i.old)&&i.old.call(this),i.queue&&Q.dequeue(this,i.queue)},i},Q.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Q.timers=[],Q.fx=D.prototype.init,Q.fx.tick=function(){for(var e,t=Q.timers,n=0;n<t.length;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||Q.fx.stop()},Q.fx.timer=function(e){e()&&Q.timers.push(e)&&!Yn&&(Yn=setInterval(Q.fx.tick,Q.fx.interval))},Q.fx.interval=13,Q.fx.stop=function(){clearInterval(Yn),Yn=null},Q.fx.speeds={slow:600,fast:200,_default:400},Q.fx.step={},Q.expr&&Q.expr.filters&&(Q.expr.filters.animated=function(e){return Q.grep(Q.timers,function(t){return e===t.elem}).length});var ti=/^(?:body|html)$/i;Q.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){Q.offset.setOffset(this,e,t)});var n,i,o,r,s,a,l,u,c,d,h=this[0],p=h&&h.ownerDocument;if(p)return(o=p.body)===h?Q.offset.bodyOffset(h):(i=p.documentElement,Q.contains(i,h)?(n=h.getBoundingClientRect(),r=L(p),s=i.clientTop||o.clientTop||0,a=i.clientLeft||o.clientLeft||0,l=r.pageYOffset||i.scrollTop,u=r.pageXOffset||i.scrollLeft,c=n.top+l-s,d=n.left+u-a,{top:c,left:d}):{top:0,left:0})},Q.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return Q.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(Q.css(e,"marginTop"))||0,n+=parseFloat(Q.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var i=Q.css(e,"position");"static"===i&&(e.style.position="relative");var o,r,s=Q(e),a=s.offset(),l=Q.css(e,"top"),u=Q.css(e,"left"),c=("absolute"===i||"fixed"===i)&&Q.inArray("auto",[l,u])>-1,d={},h={};c?(h=s.position(),o=h.top,r=h.left):(o=parseFloat(l)||0,r=parseFloat(u)||0),Q.isFunction(t)&&(t=t.call(e,n,a)),null!=t.top&&(d.top=t.top-a.top+o),null!=t.left&&(d.left=t.left-a.left+r),"using"in t?t.using.call(e,d):s.css(d)}},Q.fn.extend({position:function(){if(this[0]){var e=this[0],t=this.offsetParent(),n=this.offset(),i=ti.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(Q.css(e,"marginTop"))||0,n.left-=parseFloat(Q.css(e,"marginLeft"))||0,i.top+=parseFloat(Q.css(t[0],"borderTopWidth"))||0,i.left+=parseFloat(Q.css(t[0],"borderLeftWidth"))||0,{top:n.top-i.top,left:n.left-i.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||j.body;e&&!ti.test(e.nodeName)&&"static"===Q.css(e,"position");)e=e.offsetParent;return e||j.body})}}),Q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var i=/Y/.test(n);Q.fn[e]=function(o){return Q.access(this,function(e,o,r){var s=L(e);return r===t?s?n in s?s[n]:s.document.documentElement[o]:e[o]:(s?s.scrollTo(i?Q(s).scrollLeft():r,i?r:Q(s).scrollTop()):e[o]=r,t)},e,o,arguments.length,null)}}),Q.each({Height:"height",Width:"width"},function(e,n){Q.each({padding:"inner"+e,content:n,"":"outer"+e},function(i,o){Q.fn[o]=function(o,r){var s=arguments.length&&(i||"boolean"!==typeof o),a=i||(o===!0||r===!0?"margin":"border");return Q.access(this,function(n,i,o){var r;return Q.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(r=n.documentElement,Math.max(n.body["scroll"+e],r["scroll"+e],n.body["offset"+e],r["offset"+e],r["client"+e])):o===t?Q.css(n,i,o,a):Q.style(n,i,o,a)},n,s?o:t,s,null)}})}),e.jQuery=e.$=Q,"function"===typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return Q})})(window),function(){var e=this,t=e._,n={},i=Array.prototype,o=Object.prototype,r=Function.prototype,s=i.push,a=i.slice,l=i.concat,u=o.toString,c=o.hasOwnProperty,d=i.forEach,h=i.map,p=i.reduce,f=i.reduceRight,m=i.filter,g=i.every,v=i.some,_=i.indexOf,C=i.lastIndexOf,P=Array.isArray,y=Object.keys,T=r.bind,S=function(e){return e instanceof S?e:this instanceof S?(this._wrapped=e,void 0):new S(e)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=S),exports._=S):e._=S,S.VERSION="1.4.3";var E=S.each=S.forEach=function(e,t,i){if(null!=e)if(d&&e.forEach===d)e.forEach(t,i);else if(e.length===+e.length){for(var o=0,r=e.length;o<r;o++)if(t.call(i,e[o],o,e)===n)return}else for(var s in e)if(S.has(e,s)&&t.call(i,e[s],s,e)===n)return};S.map=S.collect=function(e,t,n){var i=[];return null==e?i:h&&e.map===h?e.map(t,n):(E(e,function(e,o,r){i[i.length]=t.call(n,e,o,r)}),i)};var b="Reduce of empty array with no initial value";S.reduce=S.foldl=S.inject=function(e,t,n,i){var o=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return i&&(t=S.bind(t,i)),o?e.reduce(t,n):e.reduce(t);if(E(e,function(e,r,s){o?n=t.call(i,n,e,r,s):(n=e,o=!0)}),!o)throw new TypeError(b);return n},S.reduceRight=S.foldr=function(e,t,n,i){var o=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return i&&(t=S.bind(t,i)),o?e.reduceRight(t,n):e.reduceRight(t);var r=e.length;if(r!==+r){var s=S.keys(e);r=s.length}if(E(e,function(a,l,u){l=s?s[--r]:--r,o?n=t.call(i,n,e[l],l,u):(n=e[l],o=!0)}),!o)throw new TypeError(b);return n},S.find=S.detect=function(e,t,n){var i;return w(e,function(e,o,r){return t.call(n,e,o,r)?(i=e,!0):void 0}),i},S.filter=S.select=function(e,t,n){var i=[];return null==e?i:m&&e.filter===m?e.filter(t,n):(E(e,function(e,o,r){t.call(n,e,o,r)&&(i[i.length]=e)}),i)},S.reject=function(e,t,n){return S.filter(e,function(e,i,o){return!t.call(n,e,i,o)},n)},S.every=S.all=function(e,t,i){t||(t=S.identity);var o=!0;return null==e?o:g&&e.every===g?e.every(t,i):(E(e,function(e,r,s){return(o=o&&t.call(i,e,r,s))?void 0:n}),!!o)};var w=S.some=S.any=function(e,t,i){t||(t=S.identity);var o=!1;return null==e?o:v&&e.some===v?e.some(t,i):(E(e,function(e,r,s){return o||(o=t.call(i,e,r,s))?n:void 0}),!!o)};S.contains=S.include=function(e,t){return null==e?!1:_&&e.indexOf===_?-1!=e.indexOf(t):w(e,function(e){return e===t})},S.invoke=function(e,t){var n=a.call(arguments,2);return S.map(e,function(e){return(S.isFunction(t)?t:e[t]).apply(e,n)})},S.pluck=function(e,t){return S.map(e,function(e){return e[t]})},S.where=function(e,t){return S.isEmpty(t)?[]:S.filter(e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},S.max=function(e,t,n){if(!t&&S.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&S.isEmpty(e))return-1/0;var i={computed:-1/0,value:-1/0};return E(e,function(e,o,r){var s=t?t.call(n,e,o,r):e;s>=i.computed&&(i={value:e,computed:s})}),i.value},S.min=function(e,t,n){if(!t&&S.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&S.isEmpty(e))return 1/0;var i={computed:1/0,value:1/0};return E(e,function(e,o,r){var s=t?t.call(n,e,o,r):e;s<i.computed&&(i={value:e,computed:s})}),i.value},S.shuffle=function(e){var t,n=0,i=[];return E(e,function(e){t=S.random(n++),i[n-1]=i[t],i[t]=e}),i};var N=function(e){return S.isFunction(e)?e:function(t){return t[e]}};S.sortBy=function(e,t,n){var i=N(t);return S.pluck(S.map(e,function(e,t,o){return{value:e,index:t,criteria:i.call(n,e,t,o)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return e.index<t.index?-1:1}),"value")};var I=function(e,t,n,i){var o={},r=N(t||S.identity);return E(e,function(t,s){var a=r.call(n,t,s,e);i(o,a,t)}),o};S.groupBy=function(e,t,n){return I(e,t,n,function(e,t,n){(S.has(e,t)?e[t]:e[t]=[]).push(n)})},S.countBy=function(e,t,n){return I(e,t,n,function(e,t){S.has(e,t)||(e[t]=0),e[t]++})},S.sortedIndex=function(e,t,n,i){n=null==n?S.identity:N(n);for(var o=n.call(i,t),r=0,s=e.length;r<s;){var a=r+s>>>1;
n.call(i,e[a])<o?r=a+1:s=a}return r},S.toArray=function(e){return e?S.isArray(e)?a.call(e):e.length===+e.length?S.map(e,S.identity):S.values(e):[]},S.size=function(e){return null==e?0:e.length===+e.length?e.length:S.keys(e).length},S.first=S.head=S.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:a.call(e,0,t)},S.initial=function(e,t,n){return a.call(e,0,e.length-(null==t||n?1:t))},S.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:a.call(e,Math.max(e.length-t,0))},S.rest=S.tail=S.drop=function(e,t,n){return a.call(e,null==t||n?1:t)},S.compact=function(e){return S.filter(e,S.identity)};var O=function(e,t,n){return E(e,function(e){S.isArray(e)?t?s.apply(n,e):O(e,t,n):n.push(e)}),n};S.flatten=function(e,t){return O(e,t,[])},S.without=function(e){return S.difference(e,a.call(arguments,1))},S.uniq=S.unique=function(e,t,n,i){S.isFunction(t)&&(i=n,n=t,t=!1);var o=n?S.map(e,n,i):e,r=[],s=[];return E(o,function(n,i){(t?i&&s[s.length-1]===n:S.contains(s,n))||(s.push(n),r.push(e[i]))}),r},S.union=function(){return S.uniq(l.apply(i,arguments))},S.intersection=function(e){var t=a.call(arguments,1);return S.filter(S.uniq(e),function(e){return S.every(t,function(t){return S.indexOf(t,e)>=0})})},S.difference=function(e){var t=l.apply(i,a.call(arguments,1));return S.filter(e,function(e){return!S.contains(t,e)})},S.zip=function(){for(var e=a.call(arguments),t=S.max(S.pluck(e,"length")),n=Array(t),i=0;i<t;i++)n[i]=S.pluck(e,""+i);return n},S.object=function(e,t){if(null==e)return{};for(var n={},i=0,o=e.length;i<o;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},S.indexOf=function(e,t,n){if(null==e)return-1;var i=0,o=e.length;if(n){if("number"!=typeof n)return i=S.sortedIndex(e,t),e[i]===t?i:-1;i=n<0?Math.max(0,o+n):n}if(_&&e.indexOf===_)return e.indexOf(t,n);for(;i<o;i++)if(e[i]===t)return i;return-1},S.lastIndexOf=function(e,t,n){if(null==e)return-1;var i=null!=n;if(C&&e.lastIndexOf===C)return i?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var o=i?n:e.length;o--;)if(e[o]===t)return o;return-1},S.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((t-e)/n),0),o=0,r=Array(i);o<i;)r[o++]=e,e+=n;return r};var x=function(){};S.bind=function(e,t){var n,i;if(e.bind===T&&T)return T.apply(e,a.call(arguments,1));if(!S.isFunction(e))throw new TypeError;return n=a.call(arguments,2),i=function(){if(!(this instanceof i))return e.apply(t,n.concat(a.call(arguments)));x.prototype=e.prototype;var o=new x;x.prototype=null;var r=e.apply(o,n.concat(a.call(arguments)));return Object(r)===r?r:o}},S.bindAll=function(e){var t=a.call(arguments,1);return 0==t.length&&(t=S.functions(e)),E(t,function(t){e[t]=S.bind(e[t],e)}),e},S.memoize=function(e,t){var n={};return t||(t=S.identity),function(){var i=t.apply(this,arguments);return S.has(n,i)?n[i]:n[i]=e.apply(this,arguments)}},S.delay=function(e,t){var n=a.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},S.defer=function(e){return S.delay.apply(S,[e,1].concat(a.call(arguments,1)))},S.throttle=function(e,t){var n,i,o,r,s=0,a=function(){s=new Date,o=null,r=e.apply(n,i)};return function(){var l=new Date,u=t-(l-s);return n=this,i=arguments,u<=0?(clearTimeout(o),o=null,s=l,r=e.apply(n,i)):o||(o=setTimeout(a,u)),r}},S.debounce=function(e,t,n){var i,o;return function(){var r=this,s=arguments,a=function(){i=null,n||(o=e.apply(r,s))},l=n&&!i;return clearTimeout(i),i=setTimeout(a,t),l&&(o=e.apply(r,s)),o}},S.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},S.wrap=function(e,t){return function(){var n=[e];return s.apply(n,arguments),t.apply(this,n)}},S.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},S.after=function(e,t){return e<=0?t():function(){return--e<1?t.apply(this,arguments):void 0}},S.keys=y||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)S.has(e,n)&&(t[t.length]=n);return t},S.values=function(e){var t=[];for(var n in e)S.has(e,n)&&t.push(e[n]);return t},S.pairs=function(e){var t=[];for(var n in e)S.has(e,n)&&t.push([n,e[n]]);return t},S.invert=function(e){var t={};for(var n in e)S.has(e,n)&&(t[e[n]]=n);return t},S.functions=S.methods=function(e){var t=[];for(var n in e)S.isFunction(e[n])&&t.push(n);return t.sort()},S.extend=function(e){return E(a.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},S.pick=function(e){var t={},n=l.apply(i,a.call(arguments,1));return E(n,function(n){n in e&&(t[n]=e[n])}),t},S.omit=function(e){var t={},n=l.apply(i,a.call(arguments,1));for(var o in e)S.contains(n,o)||(t[o]=e[o]);return t},S.defaults=function(e){return E(a.call(arguments,1),function(t){if(t)for(var n in t)null==e[n]&&(e[n]=t[n])}),e},S.clone=function(e){return S.isObject(e)?S.isArray(e)?e.slice():S.extend({},e):e},S.tap=function(e,t){return t(e),e};var M=function(e,t,n,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof S&&(e=e._wrapped),t instanceof S&&(t=t._wrapped);var o=u.call(e);if(o!=u.call(t))return!1;switch(o){case"[object String]":return e==t+"";case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var r=n.length;r--;)if(n[r]==e)return i[r]==t;n.push(e),i.push(t);var s=0,a=!0;if("[object Array]"==o){if(s=e.length,a=s==t.length)for(;s--&&(a=M(e[s],t[s],n,i)););}else{var l=e.constructor,c=t.constructor;if(l!==c&&!(S.isFunction(l)&&l instanceof l&&S.isFunction(c)&&c instanceof c))return!1;for(var d in e)if(S.has(e,d)&&(s++,!(a=S.has(t,d)&&M(e[d],t[d],n,i))))break;if(a){for(d in t)if(S.has(t,d)&&!s--)break;a=!s}}return n.pop(),i.pop(),a};S.isEqual=function(e,t){return M(e,t,[],[])},S.isEmpty=function(e){if(null==e)return!0;if(S.isArray(e)||S.isString(e))return 0===e.length;for(var t in e)if(S.has(e,t))return!1;return!0},S.isElement=function(e){return!(!e||1!==e.nodeType)},S.isArray=P||function(e){return"[object Array]"==u.call(e)},S.isObject=function(e){return e===Object(e)},E(["Arguments","Function","String","Number","Date","RegExp"],function(e){S["is"+e]=function(t){return u.call(t)=="[object "+e+"]"}}),S.isArguments(arguments)||(S.isArguments=function(e){return!(!e||!S.has(e,"callee"))}),S.isFunction=function(e){return"function"===typeof e},S.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},S.isNaN=function(e){return S.isNumber(e)&&e!=+e},S.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==u.call(e)},S.isNull=function(e){return null===e},S.isUndefined=function(e){return void 0===e},S.has=function(e,t){return c.call(e,t)},S.noConflict=function(){return e._=t,this},S.identity=function(e){return e},S.times=function(e,t,n){for(var i=Array(e),o=0;o<e;o++)i[o]=t.call(n,o);return i},S.random=function(e,t){return null==t&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var k={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};k.unescape=S.invert(k.escape);var R={escape:RegExp("["+S.keys(k.escape).join("")+"]","g"),unescape:RegExp("("+S.keys(k.unescape).join("|")+")","g")};S.each(["escape","unescape"],function(e){S[e]=function(t){return null==t?"":(""+t).replace(R[e],function(t){return k[e][t]})}}),S.result=function(e,t){if(null==e)return null;var n=e[t];return S.isFunction(n)?n.call(e):n},S.mixin=function(e){E(S.functions(e),function(t){var n=S[t]=e[t];S.prototype[t]=function(){var e=[this._wrapped];return s.apply(e,arguments),L.call(this,n.apply(S,e))}})};var A=0;S.uniqueId=function(e){var t=""+ ++A;return e?e+t:t},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var B=/(.)^/,D={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},U=/\\|'|\r|\n|\t|\u2028|\u2029/g;S.template=function(e,t,n){n=S.defaults({},n,S.templateSettings);var i=RegExp([(n.escape||B).source,(n.interpolate||B).source,(n.evaluate||B).source].join("|")+"|$","g"),o=0,r="__p+='";e.replace(i,function(t,n,i,s,a){return r+=e.slice(o,a).replace(U,function(e){return"\\"+D[e]}),n&&(r+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(r+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),s&&(r+="';\n"+s+"\n__p+='"),o=a+t.length,t}),r+="';\n",n.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var s=Function(n.variable||"obj","_",r)}catch(a){throw a.source=r,a}if(t)return s(t,S);var l=function(e){return s.call(this,e,S)};return l.source="function("+(n.variable||"obj")+"){\n"+r+"}",l},S.chain=function(e){return S(e).chain()};var L=function(e){return this._chain?S(e).chain():e};S.mixin(S),E(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=i[e];S.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],L.call(this,n)}}),E(["concat","join","slice"],function(e){var t=i[e];S.prototype[e]=function(){return L.call(this,t.apply(this._wrapped,arguments))}}),S.extend(S.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(){var e,t=this,n=t.Backbone,i=[],o=i.push,r=i.slice,s=i.splice;e="undefined"!==typeof exports?exports:t.Backbone={},e.VERSION="0.9.10";var a=t._;a||"undefined"===typeof require||(a=require("underscore")),e.$=t.jQuery||t.Zepto||t.ender,e.noConflict=function(){return t.Backbone=n,this},e.emulateHTTP=!1,e.emulateJSON=!1;var l=/\s+/,u=function(e,t,n,i){if(!n)return!0;if("object"===typeof n)for(var o in n)e[t].apply(e,[o,n[o]].concat(i));else{if(!l.test(n))return!0;for(var r=n.split(l),s=0,a=r.length;s<a;s++)e[t].apply(e,[r[s]].concat(i))}},c=function(e,t){var n,i=-1,o=e.length;switch(t.length){case 0:for(;++i<o;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<o;)(n=e[i]).callback.call(n.ctx,t[0]);return;case 2:for(;++i<o;)(n=e[i]).callback.call(n.ctx,t[0],t[1]);return;case 3:for(;++i<o;)(n=e[i]).callback.call(n.ctx,t[0],t[1],t[2]);return;default:for(;++i<o;)(n=e[i]).callback.apply(n.ctx,t)}},d=e.Events={on:function(e,t,n){if(!u(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var i=this._events[e]||(this._events[e]=[]);return i.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!u(this,"once",e,[t,n])||!t)return this;var i=this,o=a.once(function(){i.off(e,o),t.apply(this,arguments)});return o._callback=t,this.on(e,o,n),this},off:function(e,t,n){var i,o,r,s,l,c,d,h;if(!this._events||!u(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;for(s=e?[e]:a.keys(this._events),l=0,c=s.length;l<c;l++)if(e=s[l],i=this._events[e]){if(r=[],t||n)for(d=0,h=i.length;d<h;d++)o=i[d],(t&&t!==o.callback&&t!==o.callback._callback||n&&n!==o.context)&&r.push(o);this._events[e]=r}return this},trigger:function(e){if(!this._events)return this;var t=r.call(arguments,1);if(!u(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&c(n,t),i&&c(i,arguments),this},listenTo:function(e,t,n){var i=this._listeners||(this._listeners={}),o=e._listenerId||(e._listenerId=a.uniqueId("l"));return i[o]=e,e.on(t,"object"===typeof t?this:n,this),this},stopListening:function(e,t,n){var i=this._listeners;if(i){if(e)e.off(t,"object"===typeof t?this:n,this),t||n||delete i[e._listenerId];else{"object"===typeof t&&(n=this);for(var o in i)i[o].off(t,n,this);this._listeners={}}return this}}};d.bind=d.on,d.unbind=d.off,a.extend(e,d);var h=e.Model=function(e,t){var n,i=e||{};this.cid=a.uniqueId("c"),this.attributes={},t&&t.collection&&(this.collection=t.collection),t&&t.parse&&(i=this.parse(i,t)||{}),(n=a.result(this,"defaults"))&&(i=a.defaults({},i,n)),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};a.extend(h.prototype,d,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(){return a.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return a.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var i,o,r,s,l,u,c,d;if(null==e)return this;if("object"===typeof e?(o=e,n=t):(o={})[e]=t,n||(n={}),!this._validate(o,n))return!1;r=n.unset,l=n.silent,s=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=a.clone(this.attributes),this.changed={}),d=this.attributes,c=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(i in o)t=o[i],a.isEqual(d[i],t)||s.push(i),a.isEqual(c[i],t)?delete this.changed[i]:this.changed[i]=t,r?delete d[i]:d[i]=t;if(!l){s.length&&(this._pending=!0);for(var h=0,p=s.length;h<p;h++)this.trigger("change:"+s[h],this,d[s[h]],n)}if(u)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,a.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,a.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!a.isEmpty(this.changed):a.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?a.clone(this.changed):!1;var t,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var o in e)a.isEqual(i[o],t=e[o])||((n||(n={}))[o]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return a.clone(this._previousAttributes)},fetch:function(e){e=e?a.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success;return e.success=function(e,n,i){return e.set(e.parse(n,i),i)?(t&&t(e,n,i),void 0):!1},this.sync("read",this,e)},save:function(e,t,n){var i,o,r,s,l=this.attributes;return null==e||"object"===typeof e?(i=e,n=t):(i={})[e]=t,!i||n&&n.wait||this.set(i,n)?(n=a.extend({validate:!0},n),this._validate(i,n)?(i&&n.wait&&(this.attributes=a.extend({},l,i)),void 0===n.parse&&(n.parse=!0),o=n.success,n.success=function(e,t,n){e.attributes=l;var r=e.parse(t,n);return n.wait&&(r=a.extend(i||{},r)),a.isObject(r)&&!e.set(r,n)?!1:(o&&o(e,t,n),void 0)},r=this.isNew()?"create":n.patch?"patch":"update","patch"===r&&(n.attrs=i),s=this.sync(r,this,n),i&&n.wait&&(this.attributes=l),s):!1):!1},destroy:function(e){e=e?a.clone(e):{};var t=this,n=e.success,i=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(e,t,o){(o.wait||e.isNew())&&i(),n&&n(e,t,o)},this.isNew())return e.success(this,null,e),!1;var o=this.sync("delete",this,e);return e.wait||i(),o},url:function(){var e=a.result(this,"urlRoot")||a.result(this.collection,"url")||M();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return!this.validate||!this.validate(this.attributes,e)},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=a.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,t||{}),!1):!0}});var p=e.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this.models=[],this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,a.extend({silent:!0},t))};a.extend(p.prototype,d,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){e=a.isArray(e)?e.slice():[e],t||(t={});var n,i,r,l,u,c,d,h,p,f;for(d=[],h=t.at,p=this.comparator&&null==h&&0!=t.sort,f=a.isString(this.comparator)?this.comparator:null,n=0,i=e.length;n<i;n++)(r=this._prepareModel(l=e[n],t))?(u=this.get(r))?t.merge&&(u.set(l===r?r.attributes:l,t),p&&!c&&u.hasChanged(f)&&(c=!0)):(d.push(r),r.on("all",this._onModelEvent,this),this._byId[r.cid]=r,null!=r.id&&(this._byId[r.id]=r)):this.trigger("invalid",this,l,t);if(d.length&&(p&&(c=!0),this.length+=d.length,null!=h?s.apply(this.models,[h,0].concat(d)):o.apply(this.models,d)),c&&this.sort({silent:!0}),t.silent)return this;for(n=0,i=d.length;n<i;n++)(r=d[n]).trigger("add",r,this,t);return c&&this.trigger("sort",this,t),this},remove:function(e,t){e=a.isArray(e)?e.slice():[e],t||(t={});var n,i,o,r;for(n=0,i=e.length;n<i;n++)r=this.get(e[n]),r&&(delete this._byId[r.id],delete this._byId[r.cid],o=this.indexOf(r),this.models.splice(o,1),this.length--,t.silent||(t.index=o,r.trigger("remove",r,this,t)),this._removeReference(r));return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,a.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,a.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return null==e?void 0:(this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[e.id||e.cid||e[this._idAttr]||e])},at:function(e){return this.models[e]},where:function(e){return a.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){if(!this.comparator)throw Error("Cannot sort a set without a comparator");return e||(e={}),a.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(a.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return a.invoke(this.models,"get",e)},update:function(e,t){t=a.extend({add:!0,merge:!0,remove:!0},t),t.parse&&(e=this.parse(e,t));var n,i,o,r,s=[],l=[],u={};if(a.isArray(e)||(e=e?[e]:[]),t.add&&!t.remove)return this.add(e,t);for(i=0,o=e.length;i<o;i++)n=e[i],r=this.get(n),t.remove&&r&&(u[r.cid]=!0),(t.add&&!r||t.merge&&r)&&s.push(n);if(t.remove)for(i=0,o=this.models.length;i<o;i++)n=this.models[i],u[n.cid]||l.push(n);return l.length&&this.remove(l,t),s.length&&this.add(s,t),this},reset:function(e,t){t||(t={}),t.parse&&(e=this.parse(e,t));for(var n=0,i=this.models.length;n<i;n++)this._removeReference(this.models[n]);return t.previousModels=this.models.slice(),this._reset(),e&&this.add(e,a.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?a.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success;return e.success=function(e,n,i){var o=i.update?"update":"reset";e[o](n,i),t&&t(e,n,i)},this.sync("read",this,e)},create:function(e,t){if(t=t?a.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,i=t.success;return t.success=function(e,t,o){o.wait&&n.add(e,o),i&&i(e,t,o)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models.length=0,this._byId={}},_prepareModel:function(e,t){if(e instanceof h)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:!1},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))},sortedIndex:function(e,t,n){t||(t=this.comparator);var i=a.isFunction(t)?t:function(e){return e.get(t)};return a.sortedIndex(this.models,e,i,n)}});var f=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];a.each(f,function(e){p.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.models),a[e].apply(a,t)}});var m=["groupBy","countBy","sortBy"];a.each(m,function(e){p.prototype[e]=function(t,n){var i=a.isFunction(t)?t:function(e){return e.get(t)};return a[e](this.models,i,n)}});var g=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},v=/\((.*?)\)/g,_=/(\(\?)?:\w+/g,C=/\*\w+/g,P=/[\-{}\[\]+?.,\\\^$|#\s]/g;a.extend(g.prototype,d,{initialize:function(){},route:function(t,n,i){return a.isRegExp(t)||(t=this._routeToRegExp(t)),i||(i=this[n]),e.history.route(t,a.bind(function(o){var r=this._extractParameters(t,o);i&&i.apply(this,r),this.trigger.apply(this,["route:"+n].concat(r)),this.trigger("route",n,r),e.history.trigger("route",this,n,r)},this)),this},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes)for(var e,t=a.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(P,"\\$&").replace(v,"(?:$1)?").replace(_,function(e,t){return t?e:"([^/]+)"}).replace(C,"(.*?)"),RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var y=e.History=function(){this.handlers=[],a.bindAll(this,"checkUrl"),"undefined"!==typeof window&&(this.location=window.location,this.history=window.history)},T=/^[#\/]|\s+$/g,S=/^\/+|\/+$/g,E=/msie [\w.]+/,b=/\/$/;y.started=!1,a.extend(y.prototype,d,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(b,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(T,"")},start:function(t){if(y.started)throw Error("Backbone.history has already been started");y.started=!0,this.options=a.extend({},{root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),i=document.documentMode,o=E.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(S,"/"),o&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(n)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var r=this.location,s=r.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&s&&r.hash&&(this.fragment=this.getHash().replace(T,""),this.history.replaceState({},document.title,this.root+this.fragment+r.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),y.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=a.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0});return n},navigate:function(e,t){if(!y.started)return!1;if(t&&t!==!0||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),e.history=new y;var w=e.View=function(e){this.cid=a.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},N=/^(\S+)\s*(.*)$/,I=["model","collection","el","id","attributes","className","tagName","events"];a.extend(w.prototype,d,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(e||(e=a.result(this,"events"))){this.undelegateEvents();for(var t in e){var n=e[t];if(a.isFunction(n)||(n=this[e[t]]),!n)throw Error('Method "'+e[t]+'" does not exist');var i=t.match(N),o=i[1],r=i[2];n=a.bind(n,this),o+=".delegateEvents"+this.cid,""===r?this.$el.on(o,n):this.$el.on(o,r,n)}}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=a.extend({},a.result(this,"options"),e)),a.extend(this,a.pick(e,I)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(a.result(this,"el"),!1);else{var t=a.extend({},a.result(this,"attributes"));this.id&&(t.id=a.result(this,"id")),this.className&&(t["class"]=a.result(this,"className"));var n=e.$("<"+a.result(this,"tagName")+">").attr(t);this.setElement(n,!1)}}});var O={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.sync=function(t,n,i){var o=O[t];a.defaults(i||(i={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var r={type:o,dataType:"json"};if(i.url||(r.url=a.result(n,"url")||M()),null!=i.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(r.contentType="application/json",r.data=JSON.stringify(i.attrs||n.toJSON(i))),i.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),i.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){r.type="POST",i.emulateJSON&&(r.data._method=o);var s=i.beforeSend;i.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",o),s?s.apply(this,arguments):void 0}}"GET"===r.type||i.emulateJSON||(r.processData=!1);var l=i.success;i.success=function(e){l&&l(n,e,i),n.trigger("sync",n,e,i)};var u=i.error;i.error=function(e){u&&u(n,e,i),n.trigger("error",n,e,i)};var c=i.xhr=e.ajax(a.extend(r,i));return n.trigger("request",n,c,i),c},e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var x=function(e,t){var n,i=this;n=e&&a.has(e,"constructor")?e.constructor:function(){return i.apply(this,arguments)},a.extend(n,i,t);var o=function(){this.constructor=n};return o.prototype=i.prototype,n.prototype=new o,e&&a.extend(n.prototype,e),n.__super__=i.prototype,n};h.extend=p.extend=g.extend=w.extend=y.extend=x;var M=function(){throw Error('A "url" property or function must be specified')}}.call(this),function(){var e={};(function(){function t(e,n,i){var o=function(){};o.prototype=e.prototype;var r=new o,s=/xyz/.test(function(){})?/\bparent\b/:/.*/;i=i||{};for(var a in i){var l=i[a],u=r[a];r[a]="function"==typeof u&&"function"==typeof l&&s.test(l)?function(e,t){return function(){var n=this.parent;this.parent=t;var i=e.apply(this,arguments);return this.parent=n,i}}(l,u):l}r.typename=n;var c=function(){r.init&&r.init.apply(this,arguments)};return c.prototype=r,c.prototype.constructor=c,c.extend=function(e,n){return"object"==typeof e&&(n=e,e="anonymous"),t(c,e,n)},c}e.object=t(Object,"Object",{})})(),function(){var t=Array.prototype,n=Object.prototype,i={"&":"&amp;",'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;"},o=function(e){return i[e]},r=e.lib={};r.withPrettyErrors=function(e,t,n){try{return n()}catch(i){if(i.Update||(i=new r.TemplateError(i)),i.Update(e),!t){var o=i;i=Error(o.message),i.name=o.name}throw i}},r.TemplateError=function(e,t,n){var i=this;return e instanceof Error?(i=e,e=e.name+": "+e.message):Error.captureStackTrace&&Error.captureStackTrace(i),i.name="Template render error",i.message=e,i.lineno=t,i.colno=n,i.firstUpdate=!0,i.Update=function(e){var t="("+(e||"unknown path")+")";return this.firstUpdate&&(this.lineno&&this.colno?t+=" [Line "+this.lineno+", Column "+this.colno+"]":this.lineno&&(t+=" [Line "+this.lineno+"]")),t+="\n ",this.firstUpdate&&(t+=" "),this.message=t+(this.message||""),this.firstUpdate=!1,this},i},r.TemplateError.prototype=Error.prototype,r.escape=function(e){return e.replace(/[&"'<>]/g,o)},r.isFunction=function(e){return"[object Function]"==n.toString.call(e)},r.isArray=Array.isArray||function(e){return"[object Array]"==n.toString.call(e)},r.isString=function(e){return"[object String]"==n.toString.call(e)},r.isObject=function(e){return e===Object(e)},r.groupBy=function(e,t){for(var n={},i=r.isFunction(t)?t:function(e){return e[t]},o=0;o<e.length;o++){var s=e[o],a=i(s,o);(n[a]||(n[a]=[])).push(s)}return n},r.toArray=function(e){return Array.prototype.slice.call(e)},r.indexOf=function(e,t){if(null==e)throw new TypeError;var n=Object(e),i=n.length>>>0;if(0===i)return-1;var o=0;if(arguments.length>2&&(o=Number(arguments[2]),o!=o?o=0:0!=o&&1/0!=o&&o!=-1/0&&(o=(o>0||-1)*Math.floor(Math.abs(o)))),o>=i)return-1;for(var r=o>=0?o:Math.max(i-Math.abs(o),0);r<i;r++)if(r in n&&n[r]===t)return r;return-1},r.without=function(e){var t=[];if(!e)return t;for(var n=-1,i=e.length,o=r.toArray(arguments).slice(1);++n<i;)-1===o.indexOf(e[n])&&t.push(e[n]);return t},r.extend=function(e,t){for(var n in t)e[n]=t[n];return e},r.repeat=function(e,t){for(var n="",i=0;i<t;i++)n+=e;return n},r.each=function(e,n,i){if(null!=e)if(t.each&&e.each==t.each)e.forEach(n,i);else if(e.length===+e.length)for(var o=0,r=e.length;o<r;o++)n.call(i,e[o],o,e)},r.map=function(e,n){var i=[];if(null==e)return i;if(t.map&&e.map===t.map)return e.map(n);for(var o=0;o<e.length;o++)i[i.length]=n(e[o],o);return e.length===+e.length&&(i.length=e.length),i}}(),function(){function t(e,t,n){return function(){var r,s=o(arguments),a=i(arguments);if(s>e.length){r=Array.prototype.slice.call(arguments,0,e.length);for(var l=Array.prototype.slice.call(arguments,r.length,s),u=0;u<l.length;u++)u<t.length&&(a[t[u]]=l[u]);r.push(a)}else if(s<e.length){r=Array.prototype.slice.call(arguments,0,s);for(var u=s;u<e.length;u++){var c=e[u];r.push(a[c]),delete a[c]}r.push(a)}else r=arguments;return n.apply(this,r)}}function n(e){return e.__keywords=!0,e}function i(e){var t=e.length;if(t){var n=e[t-1];if(n&&n.hasOwnProperty("__keywords"))return n}return{}}function o(e){var t=e.length;if(0===t)return 0;var n=e[t-1];return n&&n.hasOwnProperty("__keywords")?t-1:t}function r(e){if("string"!=typeof e)return e;this.toString=function(){return e},this.length=e.length;for(var t=["charAt","charCodeAt","concat","contains","endsWith","fromCharCode","indexOf","lastIndexOf","length","localeCompare","match","quote","replace","search","slice","split","startsWith","substr","substring","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase","trim","trimLeft","trimRight"],n=0;n<t.length;n++)this[t[n]]=a(e[t[n]])}function s(e,t){return e instanceof r?new r(t):""+t}function a(e){return function(){var t=e.apply(this,arguments);return"string"==typeof t?new r(t):t}}function l(e,t){return e=void 0!==e&&null!==e?e:"",t&&"string"===typeof e&&(e=p.escape(e)),e}function u(e,t){return e=e||{},"function"===typeof e[t]?function(){return e[t].apply(e,arguments)
}:e[t]}function c(e,t,n){if(!e)throw Error("Unable to call `"+t+"`, which is undefined or falsey");if("function"!==typeof e)throw Error("Unable to call `"+t+"`, which is not a function");return e.apply(this,n)}function d(e,t,n){var i=e.lookup(n);return void 0!==i&&null!==i?i:t.lookup(n)}function h(e,t,n){throw e.lineno?e:new p.TemplateError(e,t,n)}var p=e.lib,f=e.object,m=f.extend({init:function(e){this.variables={},this.parent=e},set:function(e,t){for(var n=e.split("."),i=this.variables,o=0;o<n.length-1;o++){var r=n[o];i[r]||(i[r]={}),i=i[r]}i[n[n.length-1]]=t},get:function(e){var t=this.variables[e];return void 0!==t&&null!==t?t:null},lookup:function(e){var t=this.parent,n=this.variables[e];return void 0!==n&&null!==n?n:t&&t.lookup(e)},push:function(){return new m(this)},pop:function(){return this.parent}});e.runtime={Frame:m,makeMacro:t,makeKeywordArgs:n,numArgs:o,suppressValue:l,memberLookup:u,contextOrFrameLookup:d,callWrap:c,handleError:h,isArray:p.isArray,SafeString:r,copySafeness:s}}(),function(){var t=e.lib,n=e.runtime,i={abs:function(e){return Math.abs(e)},batch:function(e,t,n){for(var i=[],o=[],r=0;r<e.length;r++)0===r%t&&o.length&&(i.push(o),o=[]),o.push(e[r]);if(o.length){if(n)for(var r=o.length;r<t;r++)o.push(n);i.push(o)}return i},capitalize:function(e){var t=e.toLowerCase();return n.copySafeness(e,t.charAt(0).toUpperCase()+t.slice(1))},center:function(e,i){if(i=i||80,e.length>=i)return e;var o=i-e.length,r=t.repeat(" ",o/2-o%2),s=t.repeat(" ",o/2);return n.copySafeness(e,r+e+s)},"default":function(e,t){return e?e:t},dictsort:function(e,n,i){if(!t.isObject(e))throw new t.TemplateError("dictsort filter: val must be an object");var o=[];for(var r in e)o.push([r,e[r]]);var s;if(void 0===i||"key"===i)s=0;else{if("value"!==i)throw new t.TemplateError("dictsort filter: You can only sort by either key or value");s=1}return o.sort(function(e,i){var o=e[s],r=i[s];return n||(t.isString(o)&&(o=o.toUpperCase()),t.isString(r)&&(r=r.toUpperCase())),o>r?1:o==r?0:-1}),o},escape:function(e){return"string"==typeof e||e instanceof n.SafeString?t.escape(e):e},safe:function(e){return new n.SafeString(e)},first:function(e){return e[0]},groupby:function(e,n){return t.groupBy(e,n)},indent:function(e,i,o){i=i||4;for(var r="",s=e.split("\n"),a=t.repeat(" ",i),l=0;l<s.length;l++)r+=0!=l||o?a+s[l]+"\n":s[l]+"\n";return n.copySafeness(e,r)},join:function(e,n,i){return n=n||"",i&&(e=t.map(e,function(e){return e[i]})),e.join(n)},last:function(e){return e[e.length-1]},length:function(e){return e.length},list:function(e){if(t.isString(e))return e.split("");if(t.isObject(e)){var n=[];if(Object.keys)n=Object.keys(e);else for(var i in e)n.push(i);return t.map(n,function(t){return{key:t,value:e[t]}})}throw new t.TemplateError("list filter: type not iterable")},lower:function(e){return e.toLowerCase()},random:function(e){var t=Math.floor(Math.random()*e.length);return t==e.length&&t--,e[t]},replace:function(e,t,i,o){var r=e,s=r,a=1;for(r=r.replace(t,i);s!=r&&!(a>=o);)s=r,r=r.replace(t,i),a++;return n.copySafeness(e,r)},reverse:function(e){var o;return o=t.isString(e)?i.list(e):t.map(e,function(e){return e}),o.reverse(),t.isString(e)?n.copySafeness(e,o.join("")):o},round:function(e,t,n){t=t||0;var i,o=Math.pow(10,t);return i="ceil"==n?Math.ceil:"floor"==n?Math.floor:Math.round,i(e*o)/o},slice:function(e,t,n){for(var i=Math.floor(e.length/t),o=e.length%t,r=0,s=[],a=0;a<t;a++){var l=r+a*i;a<o&&r++;var u=r+(a+1)*i,c=e.slice(l,u);n&&a>=o&&c.push(n),s.push(c)}return s},sort:function(e,n,i,o){return e=t.map(e,function(e){return e}),e.sort(function(e,r){var s,a;return o?(s=e[o],a=r[o]):(s=e,a=r),!i&&t.isString(s)&&t.isString(a)&&(s=s.toLowerCase(),a=a.toLowerCase()),s<a?n?1:-1:s>a?n?-1:1:0}),e},string:function(e){return n.copySafeness(e,e)},title:function(e){for(var t=e.split(" "),o=0;o<t.length;o++)t[o]=i.capitalize(t[o]);return n.copySafeness(e,t.join(" "))},trim:function(e){return n.copySafeness(e,e.replace(/^\s*|\s*$/g,""))},truncate:function(e,t,i,o){var r=e;if(t=t||255,e.length<=t)return e;if(i)e=e.substring(0,t);else{var s=e.lastIndexOf(" ",t);-1===s&&(s=t),e=e.substring(0,s)}return e+=void 0!==o&&null!==o?o:"...",n.copySafeness(r,e)},upper:function(e){return e.toUpperCase()},wordcount:function(e){return e.match(/\w+/g).length},"float":function(e,t){var n=parseFloat(e);return isNaN(n)?t:n},"int":function(e,t){var n=parseInt(e,10);return isNaN(n)?t:n}};i.d=i["default"],i.e=i.escape,e.filters=i}(),function(){function t(e){var t=-1,n=null;return{reset:function(){t=-1,n=null},next:function(){return t++,t>=e.length&&(t=0),n=e[t]}}}function n(e){e=e||",";var t=!0;return function(){var n=t?"":e;return t=!1,n}}var i={range:function(e,t,n){t?n||(n=1):(t=e,e=0,n=1);for(var i=[],o=e;o<t;o+=n)i.push(o);return i},cycler:function(){return t(Array.prototype.slice.call(arguments))},joiner:function(e){return n(e)}};e.globals=i}(),function(){var t=e.lib,n=e.object,i=e.lexer,o=e.compiler,r=e.filters,s=e.loaders,a=e.runtime,l=e.globals,u=a.Frame,c=n.extend({init:function(e,n){n=n||{},this.dev=!!n.dev,this.autoesc=!!n.autoescape,this.loaders=e?t.isArray(e)?e:[e]:s.FileSystemLoader?[new s.FileSystemLoader]:[new s.HttpLoader("/views")],n.tags&&i.setTags(n.tags),this.filters=r,this.cache={},this.extensions={},this.extensionsList=[]},addExtension:function(e,t){t._name=e,this.extensions[e]=t,this.extensionsList.push(t)},getExtension:function(e){return this.extensions[e]},addFilter:function(e,t){this.filters[e]=t},getFilter:function(e){if(!this.filters[e])throw Error("filter not found: "+e);return this.filters[e]},getTemplate:function(e,t){e&&e.raw&&(e=e.raw);var n=null,i=this.cache[e];if("string"!==typeof e)throw Error("template names must be a string: "+e);if(!i||!i.isUpToDate()){for(var o=0;o<this.loaders.length&&!(n=this.loaders[o].getSource(e));o++);if(!n)throw Error("template not found: "+e);this.cache[e]=new h(n.src,this,n.path,n.upToDate,t)}return this.cache[e]},registerPrecompiled:function(e){for(var t in e)this.cache[t]=new h({type:"code",obj:e[t]},this,t,function(){return!0},!0)},express:function(n){var i=this;if(n.render)n.render=function(e,n,o){var r={};t.isFunction(n)&&(o=n,n={}),r=t.extend(r,this.locals),n._locals&&(r=t.extend(r,n._locals)),r=t.extend(r,n);var s=i.render(e,r);o(null,s)};else{var o=e.http,r=o.ServerResponse.prototype;r._render=function(e,n,o){var r=this.app,s={};this._locals&&(s=t.extend(s,this._locals)),n&&(s=t.extend(s,n),n.locals&&(s=t.extend(s,n.locals))),s=t.extend(s,r._locals);var a=i.render(e,s);o?o(null,a):this.send(a)}}},render:function(e,t){return this.getTemplate(e).render(t)}}),d=n.extend({init:function(e,t){this.ctx=e,this.blocks={},this.exported=[];for(var n in t)this.addBlock(n,t[n])},lookup:function(e){return e in l&&!(e in this.ctx)?l[e]:this.ctx[e]},setVariable:function(e,t){this.ctx[e]=t},getVariables:function(){return this.ctx},addBlock:function(e,t){this.blocks[e]=this.blocks[e]||[],this.blocks[e].push(t)},getBlock:function(e){if(!this.blocks[e])throw Error('unknown block "'+e+'"');return this.blocks[e][0]},getSuper:function(e,n,i,o,r){var s=t.indexOf(this.blocks[n]||[],i),a=this.blocks[n][s+1],l=this;return function(){if(-1==s||!a)throw Error('no super block available for "'+n+'"');return a(e,l,o,r)}},addExport:function(e){this.exported.push(e)},getExported:function(){for(var e={},t=0;t<this.exported.length;t++){var n=this.exported[t];e[n]=this.ctx[n]}return e}}),h=n.extend({init:function(e,n,i,o,r){if(this.env=n||new c,t.isObject(e))switch(e.type){case"code":this.tmplProps=e.obj;break;case"string":this.tmplStr=e.obj}else{if(!t.isString(e))throw Error("src must be a string or an object describing the source");this.tmplStr=e}if(this.path=i,this.upToDate=o||function(){return!1},r){var s=this;t.withPrettyErrors(this.path,this.env.dev,function(){s._compile()})}else this.compiled=!1},render:function(e,n){var i=this,o=function(){i.compiled||i._compile();var t=new d(e||{},i.blocks);return i.rootRenderFunc(i.env,t,n||new u,a)};return t.withPrettyErrors(this.path,this.env.dev,o)},isUpToDate:function(){return this.upToDate()},getExported:function(){this.compiled||this._compile();var e=new d({},this.blocks);return this.rootRenderFunc(this.env,e,new u,a),e.getExported()},_compile:function(){var e;if(this.tmplProps)e=this.tmplProps;else{var t=o.compile(this.tmplStr,this.env.extensionsList,this.path),n=Function(t);e=n()}this.blocks=this._getBlocks(e),this.rootRenderFunc=e.root,this.compiled=!0},_getBlocks:function(e){var t={};for(var n in e)"b_"==n.slice(0,2)&&(t[n.slice(2)]=e[n]);return t}});e.environment={Environment:c,Template:h}}();var t,n=e.environment,i=e.compiler,o=e.parser,r=e.lexer,s=e.runtime,a=e.loaders;t={},t.Environment=n.Environment,t.Template=n.Template,a&&(a.FileSystemLoader?t.FileSystemLoader=a.FileSystemLoader:t.HttpLoader=a.HttpLoader),t.compiler=i,t.parser=o,t.lexer=r,t.runtime=s,t.require=function(t){return e[t]},"function"===typeof define&&define.amd?define(function(){return t}):window.nunjucks=t}();var requirejs,require,define;(function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1&&(!e[n]||!t(e[n],n,e));n-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function eachProp(e,t){var n;for(n in e)if(e.hasOwnProperty(n)&&t(e[n],n))break}function mixin(e,t,n,i){return t&&eachProp(t,function(t,o){(n||!hasProp(e,o))&&(i&&"string"!==typeof t?(e[o]||(e[o]={}),mixin(e[o],t,n,i)):e[o]=t)}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeContextModuleFunc(e,t,n){return function(){var i,o=aps.call(arguments,0);return n&&isFunction(i=o[o.length-1])&&(i.__requireJsBuild=!0),o.push(t),e.apply(null,o)}}function addRequireMethods(e,t,n){each([["toUrl"],["undef"],["defined","requireDefined"],["specified","requireSpecified"]],function(i){var o=i[1]||i[0];e[i[0]]=t?makeContextModuleFunc(t[o],n):function(){var e=contexts[defContextName];return e[o].apply(e,arguments)}})}function makeError(e,t,n,i){var o=Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return o.requireType=e,o.requireModules=i,n&&(o.originalError=n),o}function newContext(e){function t(e){var t,n;for(t=0;e[t];t+=1)if(n=e[t],"."===n)e.splice(t,1),t-=1;else if(".."===n){if(1===t&&(".."===e[2]||".."===e[0]))break;t>0&&(e.splice(t-1,2),t-=2)}}function n(e,n,i){var o,r,s,a,l,u,c,d,h,p,f,m=n&&n.split("/"),g=m,v=E.map,_=v&&v["*"];if(e&&"."===e.charAt(0)&&(n?(g=E.pkgs[n]?m=[n]:m.slice(0,m.length-1),e=g.concat(e.split("/")),t(e),r=E.pkgs[o=e[0]],e=e.join("/"),r&&e===o+"/"+r.main&&(e=o)):0===e.indexOf("./")&&(e=e.substring(2))),i&&(m||_)&&v){for(a=e.split("/"),l=a.length;l>0;l-=1){if(c=a.slice(0,l).join("/"),m)for(u=m.length;u>0;u-=1)if(s=v[m.slice(0,u).join("/")],s&&(s=s[c])){d=s,h=l;break}if(d)break;!p&&_&&_[c]&&(p=_[c],f=l)}!d&&p&&(d=p,h=f),d&&(a.splice(0,h,d),e=a.join("/"))}return e}function i(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===y.contextName?(t.parentNode.removeChild(t),!0):void 0})}function o(e){var t=E.paths[e];return t&&isArray(t)&&t.length>1?(i(e),t.shift(),y.undef(e),y.require([e]),!0):void 0}function r(e,t,i,o){var r,s,a,l=e?e.indexOf("!"):-1,u=null,c=t?t.name:null,d=e,h=!0,p="";return e||(h=!1,e="_@r"+(x+=1)),-1!==l&&(u=e.substring(0,l),e=e.substring(l+1,e.length)),u&&(u=n(u,c,o),s=I[u]),e&&(u?p=s&&s.normalize?s.normalize(e,function(e){return n(e,c,o)}):n(e,c,o):(p=n(e,c,o),r=y.nameToUrl(p))),a=!u||s||i?"":"_unnormalized"+(M+=1),{prefix:u,name:p,parentMap:t,unnormalized:!!a,url:r,originalName:d,isDefine:h,id:(u?u+"!"+p:p)+a}}function s(e){var t=e.id,n=b[t];return n||(n=b[t]=new y.Module(e)),n}function a(e,t,n){var i=e.id,o=b[i];!hasProp(I,i)||o&&!o.defineEmitComplete?s(e).on(t,n):"defined"===t&&n(I[i])}function l(e,t){var n=e.requireModules,i=!1;t?t(e):(each(n,function(t){var n=b[t];n&&(n.error=e,n.events.error&&(i=!0,n.emit("error",e)))}),i||req.onError(e))}function u(){globalDefQueue.length&&(apsp.apply(N,[N.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function c(e,t,n){var i=e&&e.map,o=makeContextModuleFunc(n||y.require,i,t);return addRequireMethods(o,y,i),o.isBrowser=isBrowser,o}function d(e){delete b[e],each(k,function(t,n){return t.map.id===e?(k.splice(n,1),t.defined||(y.waitCount-=1),!0):void 0})}function h(e,t,n){var i,o=e.map.id,r=e.depMaps;if(e.inited)return t[o]?e:(t[o]=!0,each(r,function(e){var o=e.id,r=b[o];if(r&&!n[o]&&r.inited&&r.enabled)return i=h(r,t,n)}),n[o]=!0,i)}function p(e,t,n){var i=e.map.id,o=e.depMaps;if(e.inited&&e.map.isDefine)return t[i]?I[i]:(t[i]=e,each(o,function(o){var r,s=o.id,a=b[s];if(!T[s]&&a){if(!a.inited||!a.enabled)return n[i]=!0,void 0;r=p(a,t,n),n[s]||e.defineDepById(s,r)}}),e.check(!0),I[i])}function f(e){e.check()}function m(){var e,t,n,r,s=1e3*E.waitSeconds,a=s&&y.startTime+s<(new Date).getTime(),u=[],c=!1,d=!0;if(!C){if(C=!0,eachProp(b,function(n){if(e=n.map,t=e.id,n.enabled&&!n.error)if(!n.inited&&a)o(t)?(r=!0,c=!0):(u.push(t),i(t));else if(!n.inited&&n.fetched&&e.isDefine&&(c=!0,!e.prefix))return d=!1}),a&&u.length)return n=makeError("timeout","Load timeout for modules: "+u,null,u),n.contextName=y.contextName,l(n);d&&(each(k,function(e){if(!e.defined){var t=h(e,{},{}),n={};t&&(p(t,n,{}),eachProp(n,f))}}),eachProp(b,f)),a&&!r||!c||!isBrowser&&!isWebWorker||S||(S=setTimeout(function(){S=0,m()},50)),C=!1}}function g(e){s(r(e[0],null,!0)).init(e[1],e[2])}function v(e,t,n,i){e.detachEvent&&!isOpera?i&&e.detachEvent(i,t):e.removeEventListener(n,t,!1)}function _(e){var t=e.currentTarget||e.srcElement;return v(t,y.onScriptLoad,"load","onreadystatechange"),v(t,y.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}var C,P,y,T,S,E={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{}},b={},w={},N=[],I={},O={},x=1,M=1,k=[];return T={require:function(e){return c(e)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports=I[e.map.id]={}:void 0},module:function(e){return e.module={id:e.map.id,uri:e.map.url,config:function(){return E.config&&E.config[e.map.id]||{}},exports:I[e.map.id]}}},P=function(e){this.events=w[e.id]||{},this.map=e,this.shim=E.shim[e.id],this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},P.prototype={init:function(e,t,n,i){i=i||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.depMaps.rjsSkipMap=e.rjsSkipMap,this.errback=n,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDepById:function(e,t){var n;return each(this.depMaps,function(t,i){return t.id===e?(n=i,!0):void 0}),this.defineDep(n,t)},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,y.startTime=(new Date).getTime();var e=this.map;return this.shim?(c(this,!0)(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})),void 0):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;O[e]||(O[e]=!0,y.load(this.map.id,e))},check:function(e){if(this.enabled&&!this.enabling){var t,n,i=this.map.id,o=this.depExports,r=this.exports,s=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(s)){if(this.events.error)try{r=y.execCb(i,s,o,r)}catch(a){t=a}else r=y.execCb(i,s,o,r);if(this.map.isDefine&&(n=this.module,n&&void 0!==n.exports&&n.exports!==this.exports?r=n.exports:void 0===r&&this.usingExports&&(r=this.exports)),t)return t.requireMap=this.map,t.requireModules=[this.map.id],t.requireType="define",l(this.error=t)}else r=s;this.exports=r,this.map.isDefine&&!this.ignore&&(I[i]=r,req.onResourceLoad&&req.onResourceLoad(y,this.map,this.depMaps)),delete b[i],this.defined=!0,y.waitCount-=1,0===y.waitCount&&(k=[])}this.defining=!1,e||this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,i=r(e.prefix,null,!1,!0);a(i,"defined",bind(this,function(i){var o,u,h,p=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null;return this.map.unnormalized?(i.normalize&&(p=i.normalize(p,function(e){return n(e,f,!0)})||""),u=r(e.prefix+"!"+p,this.map.parentMap,!1,!0),a(u,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),h=b[u.id],h&&(this.events.error&&h.on("error",bind(this,function(e){this.emit("error",e)})),h.enable()),void 0):(o=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),o.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(b,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&d(e.map.id)}),l(e)}),o.fromText=function(e,t){var n=useInteractive;n&&(useInteractive=!1),s(r(e)),req.exec(t),n&&(useInteractive=!0),y.completeLoad(e)},i.load(e.name,c(e.parentMap,!0,function(e,t,n){return e.rjsSkipMap=!0,y.require(e,t,n)}),o,E),void 0)})),y.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){this.enabled=!0,this.waitPushed||(k.push(this),y.waitCount+=1,this.waitPushed=!0),this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,i,o;if("string"===typeof e){if(e=r(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.depMaps.rjsSkipMap),this.depMaps[t]=e,o=T[e.id])return this.depExports[t]=o(this),void 0;this.depCount+=1,a(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&a(e,"error",this.errback)}n=e.id,i=b[n],T[n]||!i||i.enabled||y.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=b[e.id];t&&!t.enabled&&y.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},y={config:E,contextName:e,registry:b,defined:I,urlFetched:O,waitCount:0,defQueue:N,Module:P,makeModuleMap:r,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=E.pkgs,n=E.shim,i=E.paths,o=E.map;mixin(E,e,!0),E.paths=mixin(i,e.paths,!0),e.map&&(E.map=mixin(o||{},e.map,!0,!0)),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),e.exports&&!e.exports.__buildReady&&(e.exports=y.makeShimExports(e.exports)),n[t]=e}),E.shim=n),e.packages&&(each(e.packages,function(e){var n;e="string"===typeof e?{name:e}:e,n=e.location,t[e.name]={name:e.name,location:n||e.name,main:(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),E.pkgs=t),eachProp(b,function(e,t){e.inited||e.map.unnormalized||(e.map=r(t))}),(e.deps||e.callback)&&y.require(e.deps||[],e.callback)},makeShimExports:function(e){var t;return"string"===typeof e?(t=function(){return getGlobal(e)},t.exports=e,t):function(){return e.apply(global,arguments)}},requireDefined:function(e,t){return hasProp(I,r(e,t,!1,!0).id)},requireSpecified:function(e,t){return e=r(e,t,!1,!0).id,hasProp(I,e)||hasProp(b,e)},require:function(t,n,i,o){var a,c,d,h,p;if("string"===typeof t)return isFunction(n)?l(makeError("requireargs","Invalid require call"),i):req.get?req.get(y,t,n):(a=t,o=n,d=r(a,o,!1,!0),c=d.id,hasProp(I,c)?I[c]:l(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+e)));for(i&&!isFunction(i)&&(o=i,i=void 0),n&&!isFunction(n)&&(o=n,n=void 0),u();N.length;){if(p=N.shift(),null===p[0])return l(makeError("mismatch","Mismatched anonymous define() module: "+p[p.length-1]));g(p)}return h=s(r(null,o)),h.init(t,n,i,{enabled:!0}),m(),y.require},undef:function(e){u();var t=r(e,null,!0),n=b[e];delete I[e],delete O[t.url],delete w[e],n&&(n.events.defined&&(w[e]=n.events),d(e))},enable:function(e){var t=b[e.id];t&&s(e).enable()},completeLoad:function(e){var t,n,i,r=E.shim[e]||{},s=r.exports&&r.exports.exports;for(u();N.length;){if(n=N.shift(),null===n[0]){if(n[0]=e,t)break;t=!0}else n[0]===e&&(t=!0);g(n)}if(i=b[e],!t&&!I[e]&&i&&!i.inited){if(!(!E.enforceDefine||s&&getGlobal(s)))return o(e)?void 0:l(makeError("nodefine","No define call for "+e,null,[e]));g([e,r.deps||[],r.exports])}m()},toUrl:function(e,t){var i=e.lastIndexOf("."),o=null;return-1!==i&&(o=e.substring(i,e.length),e=e.substring(0,i)),y.nameToUrl(n(e,t&&t.id,!0),o)},nameToUrl:function(e,t){var n,i,o,r,s,a,l,u,c;if(req.jsExtRegExp.test(e))u=e+(t||"");else{for(n=E.paths,i=E.pkgs,s=e.split("/"),a=s.length;a>0;a-=1){if(l=s.slice(0,a).join("/"),o=i[l],c=n[l]){isArray(c)&&(c=c[0]),s.splice(0,a,c);break}if(o){r=e===o.name?o.location+"/"+o.main:o.location,s.splice(0,a,r);break}}u=s.join("/"),u+=t||(/\?/.test(u)?"":".js"),u=("/"===u.charAt(0)||u.match(/^[\w\+\.\-]+:/)?"":E.baseUrl)+u}return E.urlArgs?u+((-1===u.indexOf("?")?"?":"&")+E.urlArgs):u},load:function(e,t){req.load(y,e,t)},execCb:function(e,t,n,i){return t.apply(i,n)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=_(e);y.completeLoad(t.id)}},onScriptError:function(e){var t=_(e);return o(t.id)?void 0:l(makeError("scripterror","Script error",e,[t.id]))}}}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.0.6",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,aps=ap.slice,apsp=ap.splice,isBrowser=!("undefined"===typeof window||!navigator||!document),isWebWorker=!isBrowser&&"undefined"!==typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!==typeof opera&&"[object Opera]"===""+opera,contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"===typeof define){if("undefined"!==typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"===typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,n,i){var o,r,s=defContextName;return isArray(e)||"string"===typeof e||(r=e,isArray(t)?(e=t,t=n,n=i):e=[]),r&&r.context&&(s=r.context),o=contexts[s],o||(o=contexts[s]=req.s.newContext(s)),r&&o.configure(r),o.require(e,t,n)},req.config=function(e){return req(e)},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),addRequireMethods(req),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=function(e){throw e},req.load=function(e,t,n){var i,o=e&&e.config||{};return isBrowser?(i=o.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),i.type=o.scriptType||"text/javascript",i.charset="utf-8",i.async=!0,i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),!i.attachEvent||i.attachEvent.toString&&(""+i.attachEvent).indexOf("[native code")<0||isOpera?(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)),i.src=n,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i):(isWebWorker&&(importScripts(n),e.completeLoad(t)),void 0)},isBrowser&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),dataMain=e.getAttribute("data-main"),dataMain?(cfg.baseUrl||(src=dataMain.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath,dataMain=mainScript),dataMain=dataMain.replace(jsSuffixRegExp,""),cfg.deps=cfg.deps?cfg.deps.concat(dataMain):[dataMain],!0):void 0}),define=function(e,t,n){var i,o;"string"!==typeof e&&(n=t,t=e,e=null),isArray(t)||(n=t,t=[]),!t.length&&isFunction(n)&&n.length&&((""+n).replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t)),useInteractive&&(i=currentlyAddingScript||getInteractiveScript(),i&&(e||(e=i.getAttribute("data-requiremodule")),o=contexts[i.getAttribute("data-requirecontext")])),(o?o.defQueue:globalDefQueue).push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}})(this),"undefined"!==typeof module&&module.exports&&(module.exports=printStackTrace),printStackTrace.implementation=function(){},printStackTrace.implementation.prototype={run:function(e,t){return e=e||this.createException(),t=t||this.mode(e),"other"===t?this.other(arguments.callee):this[t](e)},createException:function(){try{this.undef()}catch(e){return e}},mode:function(e){return e.arguments&&e.stack?"chrome":e.stack&&e.sourceURL?"safari":e.stack&&e.number?"ie":"string"===typeof e.message&&"undefined"!==typeof window&&window.opera?e.stacktrace?e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?"opera9":e.stack?e.stacktrace.indexOf("called from line")<0?"opera10b":"opera11":"opera10a":"opera9":e.stack?"firefox":"other"},instrumentFunction:function(e,t,n){e=e||window;var i=e[t];e[t]=function(){return n.call(this,printStackTrace().slice(4)),e[t]._instrumented.apply(this,arguments)},e[t]._instrumented=i},deinstrumentFunction:function(e,t){e[t].constructor===Function&&e[t]._instrumented&&e[t]._instrumented.constructor===Function&&(e[t]=e[t]._instrumented)},chrome:function(e){var t=(e.stack+"\n").replace(/^\S[^\(]+?[\n$]/gm,"").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}()@$1$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}()@$1").split("\n");return t.pop(),t},safari:function(e){return e.stack.replace(/\[native code\]\n/m,"").replace(/^(?=\w+Error\:).*$\n/m,"").replace(/^@/gm,"{anonymous}()@").split("\n")},ie:function(e){var t=/^.*at (\w+) \(([^\)]+)\)$/gm;return e.stack.replace(/at Anonymous function /gm,"{anonymous}()@").replace(/^(?=\w+Error\:).*$\n/m,"").replace(t,"$1@$2").split("\n")},firefox:function(e){return e.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^[\(@]/gm,"{anonymous}()@").split("\n")},opera11:function(e){for(var t="{anonymous}",n=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/,i=e.stacktrace.split("\n"),o=[],r=0,s=i.length;r<s;r+=2){var a=n.exec(i[r]);if(a){var l=a[4]+":"+a[1]+":"+a[2],u=a[3]||"global code";u=u.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,t),o.push(u+"@"+l+" -- "+i[r+1].replace(/^\s+/,""))}}return o},opera10b:function(e){for(var t=/^(.*)@(.+):(\d+)$/,n=e.stacktrace.split("\n"),i=[],o=0,r=n.length;o<r;o++){var s=t.exec(n[o]);if(s){var a=s[1]?s[1]+"()":"global code";i.push(a+"@"+s[2]+":"+s[3])}}return i},opera10a:function(e){for(var t="{anonymous}",n=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,i=e.stacktrace.split("\n"),o=[],r=0,s=i.length;r<s;r+=2){var a=n.exec(i[r]);if(a){var l=a[3]||t;o.push(l+"()@"+a[2]+":"+a[1]+" -- "+i[r+1].replace(/^\s+/,""))}}return o},opera9:function(e){for(var t="{anonymous}",n=/Line (\d+).*script (?:in )?(\S+)/i,i=e.message.split("\n"),o=[],r=2,s=i.length;r<s;r+=2){var a=n.exec(i[r]);a&&o.push(t+"()@"+a[2]+":"+a[1]+" -- "+i[r+1].replace(/^\s+/,""))}return o},other:function(e){for(var t,n,i="{anonymous}",o=/function\s*([\w\-$]+)?\s*\(/i,r=[],s=10;e&&e.arguments&&r.length<s;)t=o.test(""+e)?RegExp.$1||i:i,n=Array.prototype.slice.call(e.arguments||[]),r[r.length]=t+"("+this.stringifyArguments(n)+")",e=e.caller;return r},stringifyArguments:function(e){for(var t=[],n=Array.prototype.slice,i=0;i<e.length;++i){var o=e[i];void 0===o?t[i]="undefined":null===o?t[i]="null":o.constructor&&(o.constructor===Array?t[i]=o.length<3?"["+this.stringifyArguments(o)+"]":"["+this.stringifyArguments(n.call(o,0,1))+"..."+this.stringifyArguments(n.call(o,-1))+"]":o.constructor===Object?t[i]="#object":o.constructor===Function?t[i]="#function":o.constructor===String?t[i]='"'+o+'"':o.constructor===Number&&(t[i]=o))}return t.join(",")},sourceCache:{},ajax:function(e){var t=this.createXMLHTTPObject();if(t)try{return t.open("GET",e,!1),t.send(null),t.responseText}catch(n){}return""},createXMLHTTPObject:function(){for(var e,t=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],n=0;n<t.length;n++)try{return e=t[n](),this.createXMLHTTPObject=t[n],e}catch(i){}},isSameDomain:function(e){return"undefined"!==typeof location&&-1!==e.indexOf(location.hostname)},getSource:function(e){return e in this.sourceCache||(this.sourceCache[e]=this.ajax(e).split("\n")),this.sourceCache[e]},guessAnonymousFunctions:function(e){for(var t=0;t<e.length;++t){var n=/\{anonymous\}\(.*\)@(.*)/,i=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,o=e[t],r=n.exec(o);if(r){var s=i.exec(r[1]);if(s){var a=s[1],l=s[2],u=s[3]||0;if(a&&this.isSameDomain(a)&&l){var c=this.guessAnonymousFunction(a,l,u);e[t]=o.replace("{anonymous}",c)}}}}return e},guessAnonymousFunction:function(e,t){var n;try{n=this.findFunctionName(this.getSource(e),t)}catch(i){n="getSource failed with url: "+e+", exception: "+(""+i)}return n},findFunctionName:function(e,t){for(var n,i,o,r=/function\s+([^(]*?)\s*\(([^)]*)\)/,s=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/,a=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/,l="",u=Math.min(t,20),c=0;c<u;++c)if(n=e[t-c-1],o=n.indexOf("//"),o>=0&&(n=n.substr(0,o)),n){if(l=n+l,i=s.exec(l),i&&i[1])return i[1];if(i=r.exec(l),i&&i[1])return i[1];if(i=a.exec(l),i&&i[1])return i[1]}return"(?)"}},"object"!==typeof JSON&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"===typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,o,r,s,a=gap,l=t[e];switch(l&&"object"===typeof l&&"function"===typeof l.toJSON&&(l=l.toJSON(e)),"function"===typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?l+"":"null";case"boolean":case"null":return l+"";case"object":if(!l)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,n=0;n<r;n+=1)s[n]=str(n,l)||"null";return o=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]",gap=a,o}if(rep&&"object"===typeof rep)for(r=rep.length,n=0;n<r;n+=1)"string"===typeof rep[n]&&(i=rep[n],o=str(i,l),o&&s.push(quote(i)+(gap?": ":":")+o));else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(o=str(i,l),o&&s.push(quote(i)+(gap?": ":":")+o));return o=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}",gap=a,o}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()
});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!==typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var i;if(gap="",indent="","number"===typeof n)for(i=0;i<n;i+=1)indent+=" ";else"string"===typeof n&&(indent=n);if(rep=t,t&&"function"!==typeof t&&("object"!==typeof t||"number"!==typeof t.length))throw Error("JSON.stringify");return str("",{"":e})}),"function"!==typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,i,o=e[t];if(o&&"object"===typeof o)for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i=walk(o,n),void 0!==i?o[n]=i:delete o[n]);return reviver.call(e,t,o)}var j;if(text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"===typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),window.Modernizr=function(e,t,n){function i(e){p.cssText=e}function o(e,t){return typeof e===t}var r,s,a,l="2.6.2",u={},c=t.documentElement,d="modernizr",h=t.createElement(d),p=h.style,f=({}.toString,{}),m=[],g=m.slice,v=function(e,n,i,o){var r,s,a,l,u=t.createElement("div"),h=t.body,p=h||t.createElement("body");if(parseInt(i,10))for(;i--;)a=t.createElement("div"),a.id=o?o[i]:d+(i+1),u.appendChild(a);return r=["&#173;",'<style id="s',d,'">',e,"</style>"].join(""),u.id=d,(h?u:p).innerHTML+=r,p.appendChild(u),h||(p.style.background="",p.style.overflow="hidden",l=c.style.overflow,c.style.overflow="hidden",c.appendChild(p)),s=n(u,e),h?u.parentNode.removeChild(u):(p.parentNode.removeChild(p),c.style.overflow=l),!!s},_=function(t){var n=e.matchMedia||e.msMatchMedia;if(n)return n(t).matches;var i;return v("@media "+t+" { #"+d+" { position: absolute; } }",function(t){i="absolute"==(e.getComputedStyle?getComputedStyle(t,null):t.currentStyle).position}),i},C={}.hasOwnProperty;a=o(C,"undefined")||o(C.call,"undefined")?function(e,t){return t in e&&o(e.constructor.prototype[t],"undefined")}:function(e,t){return C.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var n=g.call(arguments,1),i=function(){if(this instanceof i){var o=function(){};o.prototype=t.prototype;var r=new o,s=t.apply(r,n.concat(g.call(arguments)));return Object(s)===s?s:r}return t.apply(e,n.concat(g.call(arguments)))};return i});for(var P in f)a(f,P)&&(s=P.toLowerCase(),u[s]=f[P](),m.push((u[s]?"":"no-")+s));return u.addTest=function(e,t){if("object"==typeof e)for(var i in e)a(e,i)&&u.addTest(i,e[i]);else{if(e=e.toLowerCase(),u[e]!==n)return u;t="function"==typeof t?t():t,"undefined"!=typeof enableClasses&&enableClasses&&(c.className+=" "+(t?"":"no-")+e),u[e]=t}return u},i(""),h=r=null,u._version=l,u.mq=_,u.testStyles=v,u}(this,this.document);var qq=qq||{},qq=function(e){"use strict";return{hide:function(){return e.style.display="none",this},attach:function(t,n){return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n),function(){qq(e).detach(t,n)}},detach:function(t,n){return e.removeEventListener?e.removeEventListener(t,n,!1):e.attachEvent&&e.detachEvent("on"+t,n),this},contains:function(t){return e==t?!0:e.contains?e.contains(t):!!(8&t.compareDocumentPosition(e))},insertBefore:function(t){return t.parentNode.insertBefore(e,t),this},remove:function(){return e.parentNode.removeChild(e),this},css:function(t){return null!=t.opacity&&"string"!=typeof e.style.opacity&&"undefined"!=typeof e.filters&&(t.filter="alpha(opacity="+Math.round(100*t.opacity)+")"),qq.extend(e.style,t),this},hasClass:function(t){var n=RegExp("(^| )"+t+"( |$)");return n.test(e.className)},addClass:function(t){return qq(e).hasClass(t)||(e.className+=" "+t),this},removeClass:function(t){var n=RegExp("(^| )"+t+"( |$)");return e.className=e.className.replace(n," ").replace(/^\s+|\s+$/g,""),this},getByClass:function(t){if(e.querySelectorAll)return e.querySelectorAll("."+t);for(var n=[],i=e.getElementsByTagName("*"),o=i.length,r=0;r<o;r++)qq(i[r]).hasClass(t)&&n.push(i[r]);return n},children:function(){for(var t=[],n=e.firstChild;n;)1==n.nodeType&&t.push(n),n=n.nextSibling;return t},setText:function(t){return e.innerText=t,e.textContent=t,this},clearText:function(){return qq(e).setText("")}}};qq.log=function(e,t){window.console&&(t&&"info"!==t?window.console[t]?window.console[t](e):window.console.log("<"+t+"> "+e):window.console.log(e))},qq.isObject=function(e){"use strict";return null!==e&&e&&"object"===typeof e&&e.constructor===Object},qq.extend=function(e,t,n){"use strict";var i;for(i in t)t.hasOwnProperty(i)&&(n&&qq.isObject(t[i])?(void 0===e[i]&&(e[i]={}),qq.extend(e[i],t[i],!0)):e[i]=t[i])},qq.indexOf=function(e,t,n){if(e.indexOf)return e.indexOf(t,n);n=n||0;var i=e.length;for(n<0&&(n+=i);n<i;n++)if(n in e&&e[n]===t)return n;return-1},qq.getUniqueId=function(){var e=0;return function(){return e++}}(),qq.ie=function(){return-1!=navigator.userAgent.indexOf("MSIE")},qq.ie10=function(){return-1!=navigator.userAgent.indexOf("MSIE 10")},qq.safari=function(){return void 0!=navigator.vendor&&-1!=navigator.vendor.indexOf("Apple")},qq.chrome=function(){return void 0!=navigator.vendor&&-1!=navigator.vendor.indexOf("Google")},qq.firefox=function(){return-1!=navigator.userAgent.indexOf("Mozilla")&&void 0!=navigator.vendor&&""==navigator.vendor},qq.windows=function(){return"Win32"==navigator.platform},qq.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},qq.toElement=function(){var e=document.createElement("div");return function(t){e.innerHTML=t;var n=e.firstChild;return e.removeChild(n),n}}(),qq.obj2url=function(e,t,n){var i=[],o="&",r=function(e,n){var o=t?/\[\]$/.test(t)?t:t+"["+n+"]":n;"undefined"!=o&&"undefined"!=n&&i.push("object"===typeof e?qq.obj2url(e,o,!0):"[object Function]"===Object.prototype.toString.call(e)?encodeURIComponent(o)+"="+encodeURIComponent(e()):encodeURIComponent(o)+"="+encodeURIComponent(e))};if(!n&&t)o=/\?/.test(t)?/\?$/.test(t)?"":"&":"?",i.push(t),i.push(qq.obj2url(e));else if("[object Array]"===Object.prototype.toString.call(e)&&"undefined"!=typeof e)for(var s=0,a=e.length;s<a;++s)r(e[s],s);else if("undefined"!=typeof e&&null!==e&&"object"===typeof e)for(var s in e)r(e[s],s);else i.push(encodeURIComponent(t)+"="+encodeURIComponent(e));return t?i.join(o):i.join(o).replace(/^&/,"").replace(/%20/g,"+")},qq.DisposeSupport={_disposers:[],dispose:function(){for(var e;e=this._disposers.shift();)e()},addDisposer:function(e){this._disposers.push(e)},_attach:function(){this.addDisposer(qq(arguments[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))}},qq.UploadButton=function(e){this._options={element:null,multiple:!1,acceptFiles:null,name:"file",onChange:function(){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"},qq.extend(this._options,e),qq.extend(this,qq.DisposeSupport),this._element=this._options.element,qq(this._element).css({position:"relative",overflow:"hidden",direction:"ltr"}),this._input=this._createInput()},qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){this._input.parentNode&&qq(this._input).remove(),qq(this._element).removeClass(this._options.focusClass),this._input=this._createInput()},_createInput:function(){var e=document.createElement("input");this._options.multiple&&e.setAttribute("multiple","multiple"),this._options.acceptFiles&&e.setAttribute("accept",this._options.acceptFiles),e.setAttribute("type","file"),e.setAttribute("name",this._options.name),qq(e).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),this._element.appendChild(e);var t=this;return this._attach(e,"change",function(){t._options.onChange(e)}),this._attach(e,"mouseover",function(){qq(t._element).addClass(t._options.hoverClass)}),this._attach(e,"mouseout",function(){qq(t._element).removeClass(t._options.hoverClass)}),this._attach(e,"focus",function(){qq(t._element).addClass(t._options.focusClass)}),this._attach(e,"blur",function(){qq(t._element).removeClass(t._options.focusClass)}),window.attachEvent&&e.setAttribute("tabIndex","-1"),e}},qq.FineUploaderBasic=function(e){this._options={debug:!1,button:null,multiple:!0,maxConnections:3,disableCancelForFormUploads:!1,autoUpload:!0,request:{endpoint:"/server/upload",params:{},customHeaders:{},forceMultipart:!1,inputName:"qqfile"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,stopOnFirstInvalidFile:!0},callbacks:{onSubmit:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onProgress:function(){},onError:function(){},onAutoRetry:function(){},onManualRetry:function(){},onValidate:function(){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},retry:{enableAuto:!1,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"}},qq.extend(this._options,e,!0),this._wrapCallbacks(),qq.extend(this,qq.DisposeSupport),this._filesInProgress=0,this._storedFileIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._handler=this._createUploadHandler(),this._options.button&&(this._button=this._createUploadButton(this._options.button)),this._preventLeaveInProgress()},qq.FineUploaderBasic.prototype={log:function(e,t){!this._options.debug||t&&"info"!==t?t&&"info"!==t&&qq.log("[FineUploader] "+e,t):qq.log("[FineUploader] "+e)},setParams:function(e){this._options.request.params=e},getInProgress:function(){return this._filesInProgress},uploadStoredFiles:function(){"use strict";for(;this._storedFileIds.length;)this._filesInProgress++,this._handler.upload(this._storedFileIds.shift(),this._options.request.params)},clearStoredFiles:function(){this._storedFileIds=[]},retry:function(e){return this._onBeforeManualRetry(e)?(this._handler.retry(e),!0):!1},cancel:function(e){this._handler.cancel(e)},reset:function(){this.log("Resetting uploader..."),this._handler.reset(),this._filesInProgress=0,this._storedFileIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._button.reset()},_createUploadButton:function(e){var t=this,n=new qq.UploadButton({element:e,multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),acceptFiles:this._options.validation.acceptFiles,onChange:function(e){t._onInputChange(e)}});return this.addDisposer(function(){n.dispose()}),n},_createUploadHandler:function(){var e,t=this;e=qq.UploadHandlerXhr.isSupported()?"UploadHandlerXhr":"UploadHandlerForm";var n=new qq[e]({debug:this._options.debug,endpoint:this._options.request.endpoint,forceMultipart:this._options.request.forceMultipart,maxConnections:this._options.maxConnections,customHeaders:this._options.request.customHeaders,inputName:this._options.request.inputName,demoMode:this._options.demoMode,log:this.log,onProgress:function(e,n,i,o){t._onProgress(e,n,i,o),t._options.callbacks.onProgress(e,n,i,o)},onComplete:function(e,n,i,o){t._onComplete(e,n,i,o),t._options.callbacks.onComplete(e,n,i)},onCancel:function(e,n){t._onCancel(e,n),t._options.callbacks.onCancel(e,n)},onUpload:function(e,n,i){t._onUpload(e,n,i),t._options.callbacks.onUpload(e,n,i)},onAutoRetry:function(e,n,i,o){return t._preventRetries[e]=i[t._options.retry.preventRetryResponseProperty],t._shouldAutoRetry(e,n,i)?(t._maybeParseAndSendUploadError(e,n,i,o),t._options.callbacks.onAutoRetry(e,n,t._autoRetries[e]+1),t._onBeforeAutoRetry(e,n),t._retryTimeouts[e]=setTimeout(function(){t._onAutoRetry(e,n,i)},1e3*t._options.retry.autoAttemptDelay),!0):!1}});return n},_preventLeaveInProgress:function(){var e=this;this._attach(window,"beforeunload",function(t){if(e._filesInProgress){var t=t||window.event;return t.returnValue=e._options.messages.onLeave,e._options.messages.onLeave}})},_onSubmit:function(){this._options.autoUpload&&this._filesInProgress++},_onProgress:function(){},_onComplete:function(e,t,n,i){this._filesInProgress--,this._maybeParseAndSendUploadError(e,t,n,i)},_onCancel:function(e){clearTimeout(this._retryTimeouts[e]);var t=qq.indexOf(this._storedFileIds,e);this._options.autoUpload||t<0?this._filesInProgress--:this._options.autoUpload||this._storedFileIds.splice(t,1)},_onUpload:function(){},_onInputChange:function(e){this._handler instanceof qq.UploadHandlerXhr?this._uploadFileList(e.files):this._validateFile(e)&&this._uploadFile(e),this._button.reset()},_onBeforeAutoRetry:function(e,t){this.log("Waiting "+this._options.retry.autoAttemptDelay+" seconds before retrying "+t+"...")},_onAutoRetry:function(e,t){this.log("Retrying "+t+"..."),this._autoRetries[e]++,this._handler.retry(e)},_shouldAutoRetry:function(e){return!this._preventRetries[e]&&this._options.retry.enableAuto?(void 0===this._autoRetries[e]&&(this._autoRetries[e]=0),this._autoRetries[e]<this._options.retry.maxAutoAttempts):!1},_onBeforeManualRetry:function(e){if(this._preventRetries[e])return this.log("Retries are forbidden for id "+e,"warn"),!1;if(this._handler.isValid(e)){var t=this._handler.getName(e);return this._options.callbacks.onManualRetry(e,t)===!1?!1:(this.log("Retrying upload for '"+t+"' (id: "+e+")..."),this._filesInProgress++,!0)}return this.log("'"+e+"' is not a valid file ID","error"),!1},_maybeParseAndSendUploadError:function(e,t,n,i){if(!n.success)if(i&&200!==i.status&&!n.error)this._options.callbacks.onError(e,t,"XHR returned response code "+i.status);else{var o=n.error?n.error:"Upload failure reason unknown";this._options.callbacks.onError(e,t,o)}},_uploadFileList:function(e){var t,n,i;if(t=this._getValidationDescriptors(e),t.length>1&&(i=this._options.callbacks.onValidate(t)===!1),!i)if(e.length>0){for(n=0;n<e.length;n++)if(this._validateFile(e[n]))this._uploadFile(e[n]);else if(this._options.validation.stopOnFirstInvalidFile)return}else this._error("noFilesError","")},_uploadFile:function(e){var t=this._handler.add(e),n=this._handler.getName(t);this._options.callbacks.onSubmit(t,n)!==!1&&(this._onSubmit(t,n),this._options.autoUpload?this._handler.upload(t,this._options.request.params):this._storeFileForLater(t))},_storeFileForLater:function(e){this._storedFileIds.push(e)},_validateFile:function(e){var t,n,i;return t=this._getValidationDescriptor(e),n=t.name,i=t.size,this._options.callbacks.onValidate([t])===!1?!1:this._isAllowedExtension(n)?0===i?(this._error("emptyError",n),!1):i&&this._options.validation.sizeLimit&&i>this._options.validation.sizeLimit?(this._error("sizeError",n),!1):i&&i<this._options.validation.minSizeLimit?(this._error("minSizeError",n),!1):!0:(this._error("typeError",n),!1)},_error:function(e,t){function n(e,t){i=i.replace(e,t)}var i=this._options.messages[e],o=this._options.validation.allowedExtensions.join(", ");return n("{file}",this._formatFileName(t)),n("{extensions}",o),n("{sizeLimit}",this._formatSize(this._options.validation.sizeLimit)),n("{minSizeLimit}",this._formatSize(this._options.validation.minSizeLimit)),this._options.callbacks.onError(null,t,i),i},_formatFileName:function(e){return e.length>33&&(e=e.slice(0,19)+"..."+e.slice(-13)),e},_isAllowedExtension:function(e){var t=-1!==e.indexOf(".")?e.replace(/.*[.]/,"").toLowerCase():"",n=this._options.validation.allowedExtensions;if(!n.length)return!0;for(var i=0;i<n.length;i++)if(n[i].toLowerCase()==t)return!0;return!1},_formatSize:function(e){var t=-1;do e/=1024,t++;while(e>99);return Math.max(e,.1).toFixed(1)+["kB","MB","GB","TB","PB","EB"][t]},_wrapCallbacks:function(){var e,t;e=this,t=function(t,n,i){try{return n.apply(e,i)}catch(o){e.log("Caught exception in '"+t+"' callback - "+o,"error")}};for(var n in this._options.callbacks)(function(){var i=e._options.callbacks[n];e._options.callbacks[n]=function(){return t(n,i,arguments)}})()},_parseFileName:function(e){var t;return t=e.value?e.value.replace(/.*(\/|\\)/,""):null!==e.fileName&&void 0!==e.fileName?e.fileName:e.name},_parseFileSize:function(e){var t;return e.value||(t=null!==e.fileSize&&void 0!==e.fileSize?e.fileSize:e.size),t},_getValidationDescriptor:function(e){var t,n,i;return i={},t=this._parseFileName(e),n=this._parseFileSize(e),i.name=t,n&&(i.size=n),i},_getValidationDescriptors:function(e){var t,n;for(n=[],t=0;t<e.length;t++)n.push(e[t]);return n}},qq.FineUploader=function(e){qq.FineUploaderBasic.apply(this,arguments),qq.extend(this._options,{element:null,listElement:null,dragAndDrop:{extraDropzones:[],hideDropzones:!0,disableDefaultDropzone:!1},text:{uploadButton:"Upload a file",cancelButton:"Cancel",retryButton:"Retry",failUpload:"Upload failed",dragZone:"Drop files here to upload",formatProgress:"{percent}% of {total_size}",waitingForResponse:"Processing..."},template:'<div class="qq-uploader">'+(this._options.dragAndDrop&&this._options.dragAndDrop.disableDefaultDropzone?"":'<div class="qq-upload-drop-area"><span>{dragZoneText}</span></div>')+(this._options.button?"":'<div class="qq-upload-button"><div>{uploadButtonText}</div></div>')+(this._options.listElement?"":'<ul class="qq-upload-list"></ul>')+"</div>",fileTemplate:'<li><div class="qq-progress-bar"></div><span class="qq-upload-spinner"></span><span class="qq-upload-finished"></span><span class="qq-upload-file"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">{cancelButtonText}</a><a class="qq-upload-retry" href="#">{retryButtonText}</a><span class="qq-upload-status-text">{statusText}</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",dropDisabled:"qq-upload-drop-area-disabled",list:"qq-upload-list",progressBar:"qq-progress-bar",file:"qq-upload-file",spinner:"qq-upload-spinner",finished:"qq-upload-finished",retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",size:"qq-upload-size",cancel:"qq-upload-cancel",retry:"qq-upload-retry",statusText:"qq-upload-status-text",success:"qq-upload-success",fail:"qq-upload-fail",successIcon:null,failIcon:null},failedUploadTextDisplay:{mode:"default",maxChars:50,responseProperty:"error",enableTooltip:!0},messages:{tooManyFilesError:"You may only drop one file"},retry:{showAutoRetryNote:!0,autoRetryNote:"Retrying {retryNum}/{maxAuto}...",showButton:!1},showMessage:function(e){alert(e)}},!0),qq.extend(this._options,e,!0),this._wrapCallbacks(),this._options.template=this._options.template.replace(/\{dragZoneText\}/g,this._options.text.dragZone),this._options.template=this._options.template.replace(/\{uploadButtonText\}/g,this._options.text.uploadButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{cancelButtonText\}/g,this._options.text.cancelButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{retryButtonText\}/g,this._options.text.retryButton),this._options.fileTemplate=this._options.fileTemplate.replace(/\{statusText\}/g,""),this._element=this._options.element,this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._classes=this._options.classes,this._button||(this._button=this._createUploadButton(this._find(this._element,"button"))),this._bindCancelAndRetryEvents(),this._setupDragDrop()},qq.extend(qq.FineUploader.prototype,qq.FineUploaderBasic.prototype),qq.extend(qq.FineUploader.prototype,{clearStoredFiles:function(){qq.FineUploaderBasic.prototype.clearStoredFiles.apply(this,arguments),this._listElement.innerHTML=""},addExtraDropzone:function(e){this._setupExtraDropzone(e)},removeExtraDropzone:function(e){var t=this._options.dragAndDrop.extraDropzones;for(var n in t)if(t[n]===e)return this._options.dragAndDrop.extraDropzones.splice(n,1)},getItemByFileId:function(e){for(var t=this._listElement.firstChild;t;){if(t.qqFileId==e)return t;t=t.nextSibling}},reset:function(){qq.FineUploaderBasic.prototype.reset.apply(this,arguments),this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._options.button||(this._button=this._createUploadButton(this._find(this._element,"button"))),this._bindCancelAndRetryEvents(),this._setupDragDrop()},_leaving_document_out:function(e){return(qq.chrome()||qq.safari()&&qq.windows())&&0==e.clientX&&0==e.clientY||qq.firefox()&&!e.relatedTarget},_storeFileForLater:function(e){qq.FineUploaderBasic.prototype._storeFileForLater.apply(this,arguments);var t=this.getItemByFileId(e);qq(this._find(t,"spinner")).hide()},_find:function(e,t){var n=qq(e).getByClass(this._options.classes[t])[0];if(!n)throw Error("element not found "+t);return n},_setupExtraDropzone:function(e){this._options.dragAndDrop.extraDropzones.push(e),this._setupDropzone(e)},_setupDropzone:function(e){var t=this,n=new qq.UploadDropZone({element:e,onEnter:function(n){qq(e).addClass(t._classes.dropActive),n.stopPropagation()},onLeave:function(){},onLeaveNotDescendants:function(){qq(e).removeClass(t._classes.dropActive)},onDrop:function(n){t._options.dragAndDrop.hideDropzones&&qq(e).hide(),qq(e).removeClass(t._classes.dropActive),n.dataTransfer.files.length>1&&!t._options.multiple?t._error("tooManyFilesError",""):t._uploadFileList(n.dataTransfer.files)}});this.addDisposer(function(){n.dispose()}),this._options.dragAndDrop.hideDropzones&&qq(e).hide()},_setupDragDrop:function(){var e,t;e=this,this._options.dragAndDrop.disableDefaultDropzone||(t=this._find(this._element,"drop"),this._options.dragAndDrop.extraDropzones.push(t));var n,i=this._options.dragAndDrop.extraDropzones;for(n=0;n<i.length;n++)this._setupDropzone(i[n]);this._options.dragAndDrop.disableDefaultDropzone||qq.ie()&&!qq.ie10()||this._attach(document,"dragenter",function(){if(!qq(t).hasClass(e._classes.dropDisabled))for(t.style.display="block",n=0;n<i.length;n++)i[n].style.display="block"}),this._attach(document,"dragleave",function(t){if(e._options.dragAndDrop.hideDropzones&&qq.FineUploader.prototype._leaving_document_out(t))for(n=0;n<i.length;n++)qq(i[n]).hide()}),qq(document).attach("drop",function(t){if(e._options.dragAndDrop.hideDropzones)for(n=0;n<i.length;n++)qq(i[n]).hide();t.preventDefault()})},_onSubmit:function(e,t){qq.FineUploaderBasic.prototype._onSubmit.apply(this,arguments),this._addToList(e,t)},_onProgress:function(e,t,n,i){qq.FineUploaderBasic.prototype._onProgress.apply(this,arguments);var o,r,s,a,l,u;o=this.getItemByFileId(e),r=this._find(o,"progressBar"),a=Math.round(100*(n/i)),n===i?(l=this._find(o,"cancel"),qq(l).hide(),qq(r).hide(),qq(this._find(o,"statusText")).setText(this._options.text.waitingForResponse),s=this._formatSize(i)):(s=this._formatProgress(n,i),qq(r).css({display:"block"})),qq(r).css({width:a+"%"}),u=this._find(o,"size"),qq(u).css({display:"inline"}),qq(u).setText(s)},_onComplete:function(e,t,n){qq.FineUploaderBasic.prototype._onComplete.apply(this,arguments);var i=this.getItemByFileId(e);qq(this._find(i,"statusText")).clearText(),qq(i).removeClass(this._classes.retrying),qq(this._find(i,"progressBar")).hide(),(!this._options.disableCancelForFormUploads||qq.UploadHandlerXhr.isSupported())&&qq(this._find(i,"cancel")).hide(),qq(this._find(i,"spinner")).hide(),n.success?(qq(i).addClass(this._classes.success),this._classes.successIcon&&(this._find(i,"finished").style.display="inline-block",qq(i).addClass(this._classes.successIcon))):(qq(i).addClass(this._classes.fail),this._classes.failIcon&&(this._find(i,"finished").style.display="inline-block",qq(i).addClass(this._classes.failIcon)),this._options.retry.showButton&&!this._preventRetries[e]&&qq(i).addClass(this._classes.retryable),this._controlFailureTextDisplay(i,n))},_onUpload:function(e){qq.FineUploaderBasic.prototype._onUpload.apply(this,arguments);var t=this.getItemByFileId(e);this._showSpinner(t)},_onBeforeAutoRetry:function(e){var t,n,i,o,r,s;qq.FineUploaderBasic.prototype._onBeforeAutoRetry.apply(this,arguments),t=this.getItemByFileId(e),n=this._find(t,"progressBar"),this._showCancelLink(t),n.style.width=0,qq(n).hide(),this._options.retry.showAutoRetryNote&&(i=this._find(t,"statusText"),o=this._autoRetries[e]+1,r=this._options.retry.maxAutoAttempts,s=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,o),s=s.replace(/\{maxAuto\}/g,r),qq(i).setText(s),1===o&&qq(t).addClass(this._classes.retrying))},_onBeforeManualRetry:function(e){if(qq.FineUploaderBasic.prototype._onBeforeManualRetry.apply(this,arguments)){var t=this.getItemByFileId(e);return this._find(t,"progressBar").style.width=0,qq(t).removeClass(this._classes.fail),this._showSpinner(t),this._showCancelLink(t),!0}return!1},_addToList:function(e,t){var n=qq.toElement(this._options.fileTemplate);if(this._options.disableCancelForFormUploads&&!qq.UploadHandlerXhr.isSupported()){var i=this._find(n,"cancel");qq(i).remove()}n.qqFileId=e;var o=this._find(n,"file");qq(o).setText(this._formatFileName(t)),qq(this._find(n,"size")).hide(),this._options.multiple||this._clearList(),this._listElement.appendChild(n)},_clearList:function(){this._listElement.innerHTML="",this.clearStoredFiles()},_bindCancelAndRetryEvents:function(){var e=this,t=this._listElement;this._attach(t,"click",function(t){t=t||window.event;var n=t.target||t.srcElement;if(qq(n).hasClass(e._classes.cancel)||qq(n).hasClass(e._classes.retry)){qq.preventDefault(t);for(var i=n.parentNode;void 0==i.qqFileId;)i=n=n.parentNode;qq(n).hasClass(e._classes.cancel)?(e.cancel(i.qqFileId),qq(i).remove()):(qq(i).removeClass(e._classes.retryable),e.retry(i.qqFileId))}})},_formatProgress:function(e,t){function n(e,t){i=i.replace(e,t)}var i=this._options.text.formatProgress;return n("{percent}",Math.round(100*(e/t))),n("{total_size}",this._formatSize(t)),i},_controlFailureTextDisplay:function(e,t){var n,i,o,r,s;n=this._options.failedUploadTextDisplay.mode,i=this._options.failedUploadTextDisplay.maxChars,o=this._options.failedUploadTextDisplay.responseProperty,"custom"===n?(r=t[o],r?r.length>i&&(s=r.substring(0,i)+"..."):(r=this._options.text.failUpload,this.log("'"+o+"' is not a valid property on the server response.","warn")),qq(this._find(e,"statusText")).setText(s||r),this._options.failedUploadTextDisplay.enableTooltip&&this._showTooltip(e,r)):"default"===n?qq(this._find(e,"statusText")).setText(this._options.text.failUpload):"none"!==n&&this.log("failedUploadTextDisplay.mode value of '"+n+"' is not valid","warn")},_showTooltip:function(e,t){e.title=t},_showSpinner:function(e){var t=this._find(e,"spinner");t.style.display="inline-block"},_showCancelLink:function(e){if(!this._options.disableCancelForFormUploads||qq.UploadHandlerXhr.isSupported()){var t=this._find(e,"cancel");t.style.display="inline"}},_error:function(){var e=qq.FineUploaderBasic.prototype._error.apply(this,arguments);this._options.showMessage(e)}}),qq.UploadDropZone=function(e){this._options={element:null,onEnter:function(){},onLeave:function(){},onLeaveNotDescendants:function(){},onDrop:function(){}},qq.extend(this._options,e),qq.extend(this,qq.DisposeSupport),this._element=this._options.element,this._disableDropOutside(),this._attachEvents()},qq.UploadDropZone.prototype={_dragover_should_be_canceled:function(){return qq.safari()||qq.firefox()&&qq.windows()},_disableDropOutside:function(){qq.UploadDropZone.dropOutsideDisabled||(this._dragover_should_be_canceled?qq(document).attach("dragover",function(e){e.preventDefault()}):qq(document).attach("dragover",function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="none",e.preventDefault())}),qq.UploadDropZone.dropOutsideDisabled=!0)},_attachEvents:function(){var e=this;e._attach(e._element,"dragover",function(t){if(e._isValidFileDrag(t)){var n=qq.ie()?null:t.dataTransfer.effectAllowed;t.dataTransfer.dropEffect="move"==n||"linkMove"==n?"move":"copy",t.stopPropagation(),t.preventDefault()}}),e._attach(e._element,"dragenter",function(t){e._isValidFileDrag(t)&&e._options.onEnter(t)}),e._attach(e._element,"dragleave",function(t){if(e._isValidFileDrag(t)){e._options.onLeave(t);var n=document.elementFromPoint(t.clientX,t.clientY);qq(this).contains(n)||e._options.onLeaveNotDescendants(t)}}),e._attach(e._element,"drop",function(t){e._isValidFileDrag(t)&&(t.preventDefault(),e._options.onDrop(t))})},_isValidFileDrag:function(e){if(qq.ie()&&!qq.ie10())return!1;var t=e.dataTransfer,n=qq.safari(),i=qq.ie10()?!0:"none"!=t.effectAllowed;return t&&i&&(t.files||!n&&t.types.contains&&t.types.contains("Files"))}},qq.UploadHandlerAbstract=function(e){this._options={debug:!1,endpoint:"/upload.php",maxConnections:999,log:function(){},onProgress:function(){},onComplete:function(){},onCancel:function(){},onUpload:function(){},onAutoRetry:function(){}},qq.extend(this._options,e),this._queue=[],this._params=[],this.log=this._options.log},qq.UploadHandlerAbstract.prototype={add:function(){},upload:function(e,t){var n=this._queue.push(e),i={};qq.extend(i,t),this._params[e]=i,n<=this._options.maxConnections&&this._upload(e,this._params[e])},retry:function(e){var t=qq.indexOf(this._queue,e);t>=0?this._upload(e,this._params[e]):this.upload(e,this._params[e])},cancel:function(e){this.log("Cancelling "+e),this._cancel(e),this._dequeue(e)},cancelAll:function(){for(var e=0;e<this._queue.length;e++)this._cancel(this._queue[e]);this._queue=[]},getName:function(){},getSize:function(){},getQueue:function(){return this._queue},reset:function(){this.log("Resetting upload handler"),this._queue=[],this._params=[]},_upload:function(){},_cancel:function(){},_dequeue:function(e){var t=qq.indexOf(this._queue,e);this._queue.splice(t,1);var n=this._options.maxConnections;if(this._queue.length>=n&&t<n){var i=this._queue[n-1];this._upload(i,this._params[i])}},isValid:function(){}},qq.UploadHandlerForm=function(){qq.UploadHandlerAbstract.apply(this,arguments),this._inputs={},this._detach_load_events={}},qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerForm.prototype,{add:function(e){e.setAttribute("name",this._options.inputName);var t="qq-upload-handler-iframe"+qq.getUniqueId();return this._inputs[t]=e,e.parentNode&&qq(e).remove(),t},getName:function(e){return this._inputs[e].value.replace(/.*(\/|\\)/,"")},isValid:function(e){return void 0!==this._inputs[e]},reset:function(){qq.UploadHandlerAbstract.prototype.reset.apply(this,arguments),this._inputs={},this._detach_load_events={}},_cancel:function(e){this._options.onCancel(e,this.getName(e)),delete this._inputs[e],delete this._detach_load_events[e];var t=document.getElementById(e);t&&(t.setAttribute("src","javascript:false;"),qq(t).remove())},_upload:function(e,t){this._options.onUpload(e,this.getName(e),!1);var n=this._inputs[e];if(!n)throw Error("file with passed id was not added, or already uploaded or cancelled");var i=this.getName(e);t[this._options.inputName]=i;var o=this._createIframe(e),r=this._createForm(o,t);r.appendChild(n);var s=this;return this._attachLoadEvent(o,function(){s.log("iframe loaded");var t=s._getIframeContentJSON(o);setTimeout(function(){s._detach_load_events[e](),delete s._detach_load_events[e],qq(o).remove()},1),(t.success||!s._options.onAutoRetry(e,i,t))&&(s._options.onComplete(e,i,t),s._dequeue(e))}),this.log("Sending upload request for "+e),r.submit(),qq(r).remove(),e},_attachLoadEvent:function(e,t){var n=this;this._detach_load_events[e.id]=qq(e).attach("load",function(){if(n.log("Received response for "+e.id),e.parentNode){try{if(e.contentDocument&&e.contentDocument.body&&"false"==e.contentDocument.body.innerHTML)return
}catch(i){n.log("Error when attempting to access iframe during handling of upload response ("+i+")","error")}t()}})},_getIframeContentJSON:function(iframe){try{var doc=iframe.contentDocument?iframe.contentDocument:iframe.contentWindow.document,response,innerHTML=doc.body.innerHTML;this.log("converting iframe's innerHTML to JSON"),this.log("innerHTML = "+innerHTML),innerHTML&&innerHTML.match(/^<pre/i)&&(innerHTML=doc.body.firstChild.firstChild.nodeValue),response=eval("("+innerHTML+")")}catch(error){this.log("Error when attempting to parse form upload response ("+error+")","error"),response={success:!1}}return response},_createIframe:function(e){var t=qq.toElement('<iframe src="javascript:false;" name="'+e+'" />');return t.setAttribute("id",e),t.style.display="none",document.body.appendChild(t),t},_createForm:function(e,t){var n=this._options.demoMode?"GET":"POST",i=qq.toElement('<form method="'+n+'" enctype="multipart/form-data"></form>'),o=qq.obj2url(t,this._options.endpoint);return i.setAttribute("action",o),i.setAttribute("target",e.name),i.style.display="none",document.body.appendChild(i),i}}),qq.UploadHandlerXhr=function(){qq.UploadHandlerAbstract.apply(this,arguments),this._files=[],this._xhrs=[],this._loaded=[]},qq.UploadHandlerXhr.isSupported=function(){var e=document.createElement("input");return e.type="file","multiple"in e&&"undefined"!=typeof File&&"undefined"!=typeof FormData&&"undefined"!=typeof(new XMLHttpRequest).upload},qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerXhr.prototype,{add:function(e){if(!(e instanceof File))throw Error("Passed obj in not a File (in qq.UploadHandlerXhr)");return this._files.push(e)-1},getName:function(e){var t=this._files[e];return null!==t.fileName&&void 0!==t.fileName?t.fileName:t.name},getSize:function(e){var t=this._files[e];return null!=t.fileSize?t.fileSize:t.size},getLoaded:function(e){return this._loaded[e]||0},isValid:function(e){return void 0!==this._files[e]},reset:function(){qq.UploadHandlerAbstract.prototype.reset.apply(this,arguments),this._files=[],this._xhrs=[],this._loaded=[]},_upload:function(e,t){this._options.onUpload(e,this.getName(e),!0);var n=this._files[e],i=this.getName(e);this.getSize(e),this._loaded[e]=0;var o=this._xhrs[e]=new XMLHttpRequest,r=this;o.upload.onprogress=function(t){t.lengthComputable&&(r._loaded[e]=t.loaded,r._options.onProgress(e,i,t.loaded,t.total))},o.onreadystatechange=function(){4==o.readyState&&r._onComplete(e,o)},t=t||{},t[this._options.inputName]=i;var s=qq.obj2url(t,this._options.endpoint),a=this._options.demoMode?"GET":"POST";if(o.open(a,s,!0),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("X-File-Name",encodeURIComponent(i)),o.setRequestHeader("Cache-Control","no-cache"),this._options.forceMultipart){var l=new FormData;l.append(this._options.inputName,n),n=l}else o.setRequestHeader("Content-Type","application/octet-stream"),o.setRequestHeader("X-Mime-Type",n.type);for(key in this._options.customHeaders)o.setRequestHeader(key,this._options.customHeaders[key]);this.log("Sending upload request for "+e),o.send(n)},_onComplete:function(id,xhr){"use strict";if(this._files[id]){var name=this.getName(id),size=this.getSize(id),response;this._options.onProgress(id,name,size,size),this.log("xhr - server response received for "+id),this.log("responseText = "+xhr.responseText);try{response="function"===typeof JSON.parse?JSON.parse(xhr.responseText):eval("("+xhr.responseText+")")}catch(error){this.log("Error when attempting to parse xhr response text ("+error+")","error"),response={}}(200===xhr.status&&response.success||!this._options.onAutoRetry(id,name,response,xhr))&&(this._options.onComplete(id,name,response,xhr),this._xhrs[id]=null,this._dequeue(id))}},_cancel:function(e){this._options.onCancel(e,this.getName(e)),this._files[e]=null,this._xhrs[e]&&(this._xhrs[e].abort(),this._xhrs[e]=null)}}),function(){var e=qq.UploadHandlerForm.prototype._createForm;qq.UploadHandlerForm.prototype._createForm=function(){var t=e.apply(this,arguments),n=$('<input type="hidden" name="csrfmiddlewaretoken" value="'+P.getCSRFToken()+'">');return t.appendChild(n.get(0)),t}}(),function(){(function(e){return e(window.jQuery)})(function(e){var t,n,i,o,r,s;return r=function(){function t(e){this.$inputor=e}return t.prototype.css_attr=["overflowY","height","width","paddingTop","paddingLeft","paddingRight","paddingBottom","marginTop","marginLeft","marginRight","marginBottom","fontFamily","borderStyle","borderWidth","wordWrap","fontSize","lineHeight","overflowX","text-align"],t.prototype.copy_inputor_css=function(){var t,n=this;return t={position:"absolute",left:-9999,top:0,zIndex:-2e4,"white-space":"pre-wrap"},e.each(this.css_attr,function(e,i){return t[i]=n.$inputor.css(i)}),t},t.prototype.create=function(t){return this.$mirror=e("<div></div>"),this.$mirror.css(this.copy_inputor_css()),this.$mirror.html(t),this.$inputor.after(this.$mirror),this},t.prototype.get_flag_rect=function(){var e,t,n;return e=this.$mirror.find("span#flag"),t=e.position(),n={left:t.left,top:t.top,bottom:e.height()+t.top},this.$mirror.remove(),n},t}(),o={DOWN:40,UP:38,ESC:27,TAB:9,ENTER:13},n={data_refactor:function(t){return e.isArray(t)?e.map(t,function(t){return e.isPlainObject(t)||(t={name:t}),t}):t},matcher:function(e,t){var n,i,o;return o=RegExp(e+"([A-Za-z0-9_+-]*)$|"+e+"([^\\x00-\\xff]*)$","gi"),n=o.exec(t),i=null,n&&(i=n[2]?n[2]:n[1]),i},filter:function(t,n,i){return e.map(n,function(n){var o;return o=e.isPlainObject(n)?n[i]:n,o.toLowerCase().indexOf(t)>=0?n:void 0})},remote_filter:function(t,n,i){return e.ajax(n,{data:t,success:function(e){return i(e)}})},sorter:function(e,t,n){var i,o,r,s,a;if(!e)return t.sort(function(e,t){return e[n].toLowerCase()>t[n].toLowerCase()});for(o=[],s=0,a=t.length;s<a;s++)i=t[s],r=i[n],i.order=r.toLowerCase().indexOf(e),o.push(i);return o.sort(function(e,t){return e.order-t.order})},tpl_eval:function(e,t){var n;try{return n=e.replace(/\$\{([^\}]*)\}/g,function(e,n){return t[n]})}catch(i){return""}},highlighter:function(e,t){return t?e.replace(RegExp(">\\s*(\\w*)("+t.replace("+","\\+")+")(\\w*)\\s*<","ig"),function(e,t,n,i){return"> "+t+"<strong>"+n+"</strong>"+i+" <"}):e},selector:function(e){return e.length>0?this.replace_str(e.data("value")||""):void 0}},t=function(){function t(t){this.settings={},this.common_settings={},this.pos=0,this.flags=null,this.current_flag=null,this.query=null,this.$inputor=e(t),this.mirror=new r(this.$inputor),this.common_settings=e.extend({},e.fn.atwho["default"]),this.view=new s(this,this.$el),this.listen()}return t.prototype.listen=function(){var e=this;return this.$inputor.on("keyup.atwho",function(t){return e.on_keyup(t)}).on("keydown.atwho",function(t){return e.on_keydown(t)}).on("scroll.atwho",function(){return e.view.hide()}).on("blur.atwho",function(){return e.view.hide(e.get_opt("display_timeout"))})},t.prototype.reg=function(t,n){var i,o;return i={},i=e.isPlainObject(t)?this.common_settings=e.extend({},this.common_settings,t):this.settings[t]=this.settings[t]?e.extend({},this.settings[t],n):e.extend({},n),o=i.data,i.data=this.callbacks("data_refactor").call(this,o),this},t.prototype.trigger=function(e,t){return t||(t=[]),t.push(this),this.$inputor.trigger(""+e+".atwho",t)},t.prototype.data=function(){return this.get_opt("data")},t.prototype.callbacks=function(e){var t;return(t=this.get_opt("callbacks",{})[e])||(t=this.common_settings.callbacks[e]),t},t.prototype.get_opt=function(e,t){var n;try{return this.current_flag&&(n=this.settings[this.current_flag][e]),void 0===n&&(n=this.common_settings[e]),n=void 0===n?t:n}catch(i){return n=void 0===t?null:t}},t.prototype.rect=function(){var t,n,i,o,r,s,a,l,u,c;return t=this.$inputor,document.selection?(n=document.selection.createRange(),u=n.boundingLeft+t.scrollLeft(),c=n.boundingTop+e(window).scrollTop()+t.scrollTop(),o=c+n.boundingHeight,{top:c-2,left:u-2,bottom:o-2}):(r=function(e){return e.replace(/</g,"&lt").replace(/>/g,"&gt").replace(/`/g,"&#96").replace(/"/g,"&quot").replace(/\r\n|\r|\n/g,"<br />")},l=t.val().slice(0,this.pos-1),s="<span>"+r(l)+"</span>",s+="<span id='flag'>?</span>",a=t.offset(),i=this.mirror.create(s).get_flag_rect(),u=a.left+i.left-t.scrollLeft(),c=a.top-t.scrollTop(),o=c+i.bottom,c+=i.top,{top:c,left:u,bottom:o+2})},t.prototype.catch_query=function(){var t,n,i,o,r,s,a=this;return n=this.$inputor.val(),t=this.$inputor.caretPos(),s=n.slice(0,t),o=null,e.each(this.settings,function(e){return o=a.callbacks("matcher").call(a,e,s),null!=o?(a.current_flag=e,!1):void 0}),"string"===typeof o&&o.length<=20?(r=t-o.length,i=r+o.length,this.pos=r,o={text:o.toLowerCase(),head_pos:r,end_pos:i},this.trigger("matched",[this.current_flag,o.text])):this.view.hide(),this.query=o},t.prototype.replace_str=function(e){var t,n,i,o,r;return t=this.$inputor,i=t.val(),n=this.get_opt("display_flag")?0:this.current_flag.length,o=i.slice(0,(this.query.head_pos||0)-n),r=""+o+e+" "+i.slice(this.query.end_pos||0),t.val(r),t.caretPos(o.length+e.length+1),t.change()},t.prototype.on_keyup=function(t){switch(t.keyCode){case o.ESC:t.preventDefault(),this.view.hide();break;case o.DOWN:case o.UP:e.noop();break;default:this.look_up()}return t.stopPropagation()},t.prototype.on_keydown=function(t){if(this.view.visible()){switch(t.keyCode){case o.ESC:t.preventDefault(),this.view.hide();break;case o.UP:t.preventDefault(),this.view.prev();break;case o.DOWN:t.preventDefault(),this.view.next();break;case o.TAB:case o.ENTER:if(!this.view.visible())return;t.preventDefault(),this.view.choose();break;default:e.noop()}return t.stopPropagation()}},t.prototype.render_view=function(e){var t;return t=this.get_opt("search_key"),e=this.callbacks("sorter").call(this,this.query.text,e,t),e=e.splice(0,this.get_opt("limit")),this.view.render(e)},t.prototype.remote_call=function(t,n){var i,o;return i={q:n.text,limit:this.get_opt("limit")},o=function(e){return this.reg(this.current_flag,{data:e}),this.render_view(this.data())},o=e.proxy(o,this),this.callbacks("remote_filter").call(this,i,t,o)},t.prototype.look_up=function(){var t,n,i;return(n=this.catch_query())?(t=this.data(),i=this.get_opt("search_key"),"string"===typeof t?this.remote_call(t,n):(t=this.callbacks("filter").call(this,n.text,t,i))?this.render_view(t):this.view.hide(),e.noop()):!1},t}(),s=function(){function t(t){this.controller=t,this.id=this.controller.get_opt("view_id","at-view"),this.timeout_id=null,this.$el=e("#"+this.id),this.create_view()}return t.prototype.create_view=function(){var t,n,i=this;if(!this.exist())return n="<div id='"+this.id+"' class='at-view'><ul id='"+this.id+"-ul'></ul></div>",e("body").append(n),this.$el=e("#"+this.id),t=this.$el.find("ul"),t.on("mouseenter.view","li",function(n){return t.find(".cur").removeClass("cur"),e(n.currentTarget).addClass("cur")}).on("click",function(e){return e.stopPropagation(),e.preventDefault(),i.$el.data("_view").choose()})},t.prototype.exist=function(){return e("#"+this.id).length>0},t.prototype.visible=function(){return this.$el.is(":visible")},t.prototype.choose=function(){var e;return e=this.$el.find(".cur"),this.controller.callbacks("selector").call(this.controller,e),this.controller.trigger("choose",[e]),this.hide()},t.prototype.reposition=function(){var t,n;return n=this.controller.rect(),n.bottom+this.$el.height()-e(window).scrollTop()>e(window).height()&&(n.bottom=n.top-this.$el.height()),t={left:n.left,top:n.bottom},this.$el.offset(t),this.controller.trigger("reposition",[t])},t.prototype.next=function(){var t,n;return t=this.$el.find(".cur").removeClass("cur"),n=t.next(),n.length||(n=e(this.$el.find("li")[0])),n.addClass("cur")},t.prototype.prev=function(){var e,t;return e=this.$el.find(".cur").removeClass("cur"),t=e.prev(),t.length||(t=this.$el.find("li").last()),t.addClass("cur")},t.prototype.show=function(){return this.visible()||this.$el.show(),this.reposition()},t.prototype.hide=function(e){var t,n=this;return isNaN(e)?this.visible()?this.$el.hide():void 0:(t=function(){return n.hide()},clearTimeout(this.timeout_id),this.timeout_id=setTimeout(t,e))},t.prototype.clear=function(){return this.$el.find("ul").empty()},t.prototype.render=function(t){var n,o,r=this;return e.isArray(t)?t.length<=0?(this.hide(),!0):(this.clear(),this.$el.data("_view",this),n=this.$el.find("ul"),o=this.controller.get_opt("tpl",i),e.each(t,function(t,i){var s,a;return a=r.controller.callbacks("tpl_eval").call(r.controller,o,i),s=e(r.controller.callbacks("highlighter").call(r.controller,a,r.controller.query.text)),s.data("info",i),n.append(s)}),this.show(),n.find("li:eq(0)").addClass("cur")):!1},t}(),i="<li data-value='${name}'>${name}</li>",e.fn.atwho=function(n,i){return this.filter("textarea, input").each(function(){var o,r;return o=e(this),r=o.data("atwho"),r||o.data("atwho",r=new t(this)),r.reg(n,i)})},e.fn.atwho.Controller=t,e.fn.atwho.View=s,e.fn.atwho.Mirror=r,e.fn.atwho["default"]={data:null,search_key:"name",callbacks:n,limit:5,display_flag:!0,display_timeout:300,tpl:i}})}.call(this),function(){(function(e){return e(window.jQuery)})(function(e){var t,n;return t=function(e){var t,n,i,o,r,s,a,l;return document.selection?(s=document.selection.createRange(),r=0,s&&s.parentElement()===e&&(o=e.value.replace(/\r\n/g,"\n"),i=o.length,l=e.createTextRange(),l.moveToBookmark(s.getBookmark()),n=e.createTextRange(),n.collapse(!1),l.compareEndPoints("StartToEnd",n)>-1?a=t=i:(a=-l.moveStart("character",-i),t=-l.moveEnd("character",-i)))):a=e.selectionStart,a},n=function(e,t){var n;return document.selection?(n=e.createTextRange(),n.move("character",t),n.select()):e.setSelectionRange(t,t)},e.fn.caretPos=function(e){var i;return i=this[0],i.focus(),e?n(i,e):t(i)}})}.call(this),function(e,t){function n(t,n){var o,r,s,a=t.nodeName.toLowerCase();return"area"===a?(o=t.parentNode,r=o.name,t.href&&r&&"map"===o.nodeName.toLowerCase()?(s=e("img[usemap=#"+r+"]")[0],!!s&&i(s)):!1):(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"===a?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var o=0,r=/^ui-id-\d+$/;e.ui=e.ui||{},e.ui.version||(e.extend(e.ui,{version:"1.10.1",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return"number"===typeof t?this.each(function(){var i=this;setTimeout(function(){e(i).focus(),n&&n.call(i)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var i,o,r=e(this[0]);r.length&&r[0]!==document;){if(i=r.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(o=parseInt(r.css("zIndex"),10),!isNaN(o)&&0!==o))return o;r=r.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++o)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),o=isNaN(i);return(o||i>=0)&&n(t,!o)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,i){function o(t,n,i,o){return e.each(r,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),o&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var r="Width"===i?["Left","Right"]:["Top","Bottom"],s=i.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(n){return n===t?a["inner"+i].call(this):this.each(function(){e(this).css(s,o(this,n)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!==typeof t?a["outer"+i].call(this,t):this.each(function(){e(this).css(s,o(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,i){var o,r=e.ui[t].prototype;for(o in i)r.plugins[o]=r.plugins[o]||[],r.plugins[o].push([n,i[o]])},call:function(e,t,n){var i,o=e.plugins[t];if(o&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(i=0;i<o.length;i++)e.options[o[i][0]]&&o[i][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",o=!1;return t[i]>0?!0:(t[i]=1,o=t[i]>0,t[i]=0,o)}}))}(jQuery),function(e,t){var n=0,i=Array.prototype.slice,o=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(r){}o(t)},e.widget=function(n,i,o){var r,s,a,l,u={},c=n.split(".")[0];n=n.split(".")[1],r=c+"-"+n,o||(o=i,i=e.Widget),e.expr[":"][r.toLowerCase()]=function(t){return!!e.data(t,r)},e[c]=e[c]||{},s=e[c][n],a=e[c][n]=function(e,n){return this._createWidget?(arguments.length&&this._createWidget(e,n),t):new a(e,n)},e.extend(a,s,{version:o.version,_proto:e.extend({},o),_childConstructors:[]}),l=new i,l.options=e.widget.extend({},l.options),e.each(o,function(n,o){return e.isFunction(o)?(u[n]=function(){var e=function(){return i.prototype[n].apply(this,arguments)},t=function(e){return i.prototype[n].apply(this,e)};return function(){var n,i=this._super,r=this._superApply;return this._super=e,this._superApply=t,n=o.apply(this,arguments),this._super=i,this._superApply=r,n}}(),t):(u[n]=o,t)}),a.prototype=e.widget.extend(l,{widgetEventPrefix:s?l.widgetEventPrefix:n},u,{constructor:a,namespace:c,widgetName:n,widgetFullName:r}),s?(e.each(s._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,a,n._proto)}),delete s._childConstructors):i._childConstructors.push(a),e.widget.bridge(n,a)},e.widget.extend=function(n){for(var o,r,s=i.call(arguments,1),a=0,l=s.length;a<l;a++)for(o in s[a])r=s[a][o],s[a].hasOwnProperty(o)&&r!==t&&(n[o]=e.isPlainObject(r)?e.isPlainObject(n[o])?e.widget.extend({},n[o],r):e.widget.extend({},r):r);return n},e.widget.bridge=function(n,o){var r=o.prototype.widgetFullName||n;e.fn[n]=function(s){var a="string"===typeof s,l=i.call(arguments,1),u=this;return s=!a&&l.length?e.widget.extend.apply(null,[s].concat(l)):s,a?this.each(function(){var i,o=e.data(this,r);return o?e.isFunction(o[s])&&"_"!==s.charAt(0)?(i=o[s].apply(o,l),i!==o&&i!==t?(u=i&&i.jquery?u.pushStack(i.get()):i,!1):t):e.error("no such method '"+s+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+s+"'")}):this.each(function(){var t=e.data(this,r);t?t.option(s||{})._init():e.data(this,r,new o(s,this))}),u}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var o,r,s,a=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"===typeof n)if(a={},o=n.split("."),n=o.shift(),o.length){for(r=a[n]=e.widget.extend({},this.options[n]),s=0;s<o.length-1;s++)r[o[s]]=r[o[s]]||{},r=r[o[s]];if(n=o.pop(),i===t)return r[n]===t?null:r[n];r[n]=i}else{if(i===t)return this.options[n]===t?null:this.options[n];a[n]=i}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(n,i,o){var r,s=this;"boolean"!==typeof n&&(o=i,i=n,n=!1),o?(i=r=e(i),this.bindings=this.bindings.add(i)):(o=i,i=this.element,r=this.widget()),e.each(o,function(o,a){function l(){return n||s.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"===typeof a?s[a]:a).apply(s,arguments):t}"string"!==typeof a&&(l.guid=a.guid=a.guid||l.guid||e.guid++);var u=o.match(/^(\w+)\s*(.*)$/),c=u[1]+s.eventNamespace,d=u[2];d?r.delegate(d,c,l):i.bind(c,l)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"===typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var o,r,s=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],r=n.originalEvent)for(o in r)o in n||(n[o]=r[o]);return this.element.trigger(n,i),!(e.isFunction(s)&&s.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,o,r){"string"===typeof o&&(o={effect:o});var s,a=o?o===!0||"number"===typeof o?n:o.effect||n:t;o=o||{},"number"===typeof o&&(o={duration:o}),s=!e.isEmptyObject(o),o.complete=r,o.delay&&i.delay(o.delay),s&&e.effects&&e.effects.effect[a]?i[t](o):a!==t&&i[a]?i[a](o.duration,o.easing,r):i.queue(function(n){e(this)[t](),r&&r.call(i[0]),n()})}})}(jQuery),function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.10.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){return!0===e.data(n.target,t.widgetName+".preventClickEvent")?(e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):undefined}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!t){this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var i=this,o=1===n.which,r="string"===typeof this.options.cancel&&n.target.nodeName?e(n.target).closest(this.options.cancel).length:!1;return o&&!r&&this._mouseCapture(n)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=this._mouseStart(n)!==!1,!this._mouseStarted)?(n.preventDefault(),!0):(!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e){function t(e,t,n){return e>t&&e<t+n}e.widget("ui.sortable",e.ui.mouse,{version:"1.10.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,n){"disabled"===t?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){var i=null,o=!1,r=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,r.widgetName+"-item")===r?(i=e(this),!1):undefined}),e.data(t.target,r.widgetName+"-item")===r&&(i=e(t.target)),i?!this.options.handle||n||(e(this.options.handle,i).find("*").addBack().each(function(){this===t.target&&(o=!0)}),o)?(this.currentItem=i,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,n,i){var o,r=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,r.cursorAt&&this._adjustOffsetFromHelper(r.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),r.containment&&this._setContainment(),r.cursor&&(e("body").css("cursor")&&(this._storedCursor=e("body").css("cursor")),e("body").css("cursor",r.cursor)),r.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",r.opacity)),r.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",r.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(o=this.containers.length-1;o>=0;o--)this.containers[o]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var n,i,o,r,s=this.options,a=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<s.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+s.scrollSpeed:t.pageY-this.overflowOffset.top<s.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-s.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<s.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+s.scrollSpeed:t.pageX-this.overflowOffset.left<s.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-s.scrollSpeed)):(t.pageY-e(document).scrollTop()<s.scrollSensitivity?a=e(document).scrollTop(e(document).scrollTop()-s.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<s.scrollSensitivity&&(a=e(document).scrollTop(e(document).scrollTop()+s.scrollSpeed)),t.pageX-e(document).scrollLeft()<s.scrollSensitivity?a=e(document).scrollLeft(e(document).scrollLeft()-s.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<s.scrollSensitivity&&(a=e(document).scrollLeft(e(document).scrollLeft()+s.scrollSpeed))),a!==!1&&e.ui.ddmanager&&!s.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),n=this.items.length-1;n>=0;n--)if(i=this.items[n],o=i.item[0],r=this._intersectsWithPointer(i),r&&i.instance===this.currentContainer&&o!==this.currentItem[0]&&this.placeholder[1===r?"next":"prev"]()[0]!==o&&!e.contains(this.placeholder[0],o)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],o):!0)){if(this.direction=1===r?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;
this._rearrange(t,i),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var i=this,o=this.placeholder.offset();this.reverting=!0,e(this.helper).animate({left:o.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft),top:o.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){i._clear(t)})}else this._clear(t,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);n&&i.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!i.length&&t.key&&i.push(t.key+"="),i.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},n.each(function(){i.push(e(t.item||this).attr(t.attribute||"id")||"")}),i},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,i=this.positionAbs.top,o=i+this.helperProportions.height,r=e.left,s=r+e.width,a=e.top,l=a+e.height,u=this.offset.click.top,c=this.offset.click.left,d=i+u>a&&i+u<l&&t+c>r&&t+c<s;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?d:r<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<s&&a<i+this.helperProportions.height/2&&o-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var n="x"===this.options.axis||t(this.positionAbs.top+this.offset.click.top,e.top,e.height),i="y"===this.options.axis||t(this.positionAbs.left+this.offset.click.left,e.left,e.width),o=n&&i,r=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return o?this.floating?s&&"right"===s||"down"===r?2:1:r&&("down"===r?2:1):!1},_intersectsWithSides:function(e){var n=t(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=t(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),o=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return this.floating&&r?"right"===r&&i||"left"===r&&!i:o&&("down"===o&&n||"up"===o&&!n)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n,i,o,r,s=[],a=[],l=this._connectWith();if(l&&t)for(n=l.length-1;n>=0;n--)for(o=e(l[n]),i=o.length-1;i>=0;i--)r=e.data(o[i],this.widgetFullName),r&&r!==this&&!r.options.disabled&&a.push([e.isFunction(r.options.items)?r.options.items.call(r.element):e(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r]);for(a.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=a.length-1;n>=0;n--)a[n][0].each(function(){s.push(this)});return e(s)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;n<t.length;n++)if(t[n]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n,i,o,r,s,a,l,u,c=this.items,d=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],h=this._connectWith();if(h&&this.ready)for(n=h.length-1;n>=0;n--)for(o=e(h[n]),i=o.length-1;i>=0;i--)r=e.data(o[i],this.widgetFullName),r&&r!==this&&!r.options.disabled&&(d.push([e.isFunction(r.options.items)?r.options.items.call(r.element[0],t,{item:this.currentItem}):e(r.options.items,r.element),r]),this.containers.push(r));for(n=d.length-1;n>=0;n--)for(s=d[n][1],a=d[n][0],i=0,u=a.length;i<u;i++)l=e(a[i]),l.data(this.widgetName+"-item",s),c.push({item:l,instance:s,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var n,i,o,r;for(n=this.items.length-1;n>=0;n--)i=this.items[n],i.instance!==this.currentContainer&&this.currentContainer&&i.item[0]!==this.currentItem[0]||(o=this.options.toleranceElement?e(this.options.toleranceElement,i.item):i.item,t||(i.width=o.outerWidth(),i.height=o.outerHeight()),r=o.offset(),i.left=r.left,i.top=r.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)r=this.containers[n].element.offset(),this.containers[n].containerCache.left=r.left,this.containers[n].containerCache.top=r.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var n,i=t.options;i.placeholder&&i.placeholder.constructor!==String||(n=i.placeholder,i.placeholder={element:function(){var i=e(document.createElement(t.currentItem[0].nodeName)).addClass(n||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return n||(i.style.visibility="hidden"),i},update:function(e,o){(!n||i.forcePlaceholderSize)&&(o.height()||o.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),o.width()||o.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(i.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),i.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var n,i,o,r,s,a,l,u,c,d=null,h=null;for(n=this.containers.length-1;n>=0;n--)if(!e.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(d&&e.contains(this.containers[n].element[0],d.element[0]))continue;d=this.containers[n],h=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",t,this._uiHash(this)),this.containers[n].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[h]._trigger("over",t,this._uiHash(this)),this.containers[h].containerCache.over=1;else{for(o=1e4,r=null,s=this.containers[h].floating?"left":"top",a=this.containers[h].floating?"width":"height",l=this.positionAbs[s]+this.offset.click[s],i=this.items.length-1;i>=0;i--)e.contains(this.containers[h].element[0],this.items[i].item[0])&&this.items[i].item[0]!==this.currentItem[0]&&(u=this.items[i].item.offset()[s],c=!1,Math.abs(u-l)>Math.abs(u+this.items[i][a]-l)&&(c=!0,u+=this.items[i][a]),Math.abs(u-l)<o&&(o=Math.abs(u-l),r=this.items[i],this.direction=c?"up":"down"));if(!r&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[h],r?this._rearrange(t,r,null,!0):this._rearrange(t,null,this.containers[h].element,!0),this._trigger("change",t,this._uiHash()),this.containers[h]._trigger("change",t,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[h]._trigger("over",t,this._uiHash(this)),this.containers[h].containerCache.over=1}},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):"clone"===n.helper?this.currentItem.clone():this.currentItem;return i.parents("body").length||e("parent"!==n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!i[0].style.width||n.forceHelperSize)&&i.width(this.currentItem.width()),(!i[0].style.height||n.forceHelperSize)&&i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(t){"string"===typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,o=this.options;"parent"===o.containment&&(o.containment=this.helper[0].parentNode),("document"===o.containment||"window"===o.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===o.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===o.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||(t=e(o.containment)[0],n=e(o.containment).offset(),i="hidden"!==e(t).css("overflow"),this.containment=[n.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,n.left+(i?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(i?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"===t?1:-1,o="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(o[0].tagName);return{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():r?0:o.scrollTop())*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():r?0:o.scrollLeft())*i}},_generatePosition:function(t){var n,i,o=this.options,r=t.pageX,s=t.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(r=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(s=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(r=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(s=this.containment[3]+this.offset.click.top)),o.grid&&(n=this.originalPageY+Math.round((s-this.originalPageY)/o.grid[1])*o.grid[1],s=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-o.grid[1]:n+o.grid[1]:n,i=this.originalPageX+Math.round((r-this.originalPageX)/o.grid[0])*o.grid[0],r=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-o.grid[0]:i+o.grid[0]:i)),{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}},_rearrange:function(e,t,n,i){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var o=this.counter;this._delay(function(){o===this.counter&&this.refreshPositions(!i)})},_clear:function(t,n){this.reverting=!1;var i,o=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)("auto"===this._storedCSS[i]||"static"===this._storedCSS[i])&&(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!n&&o.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||n||o.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(n||(o.push(function(e){this._trigger("remove",e,this._uiHash())}),o.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),o.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)n||o.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over&&(o.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over=0);if(this._storedCursor&&e("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!n){for(this._trigger("beforeStop",t,this._uiHash()),i=0;i<o.length;i++)o[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}if(n||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!n){for(i=0;i<o.length;i++)o[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})}(jQuery),Cookie={get:function(e){return tmp=document.cookie.match(RegExp(e+"=.+?($|;)","g")),tmp&&tmp[0]?unescape(tmp[0].substring(e.length+1,tmp[0].length).replace(";",""))||null:null},set:function(e,t,n,i,o){return cookie=[e+"="+escape(t),"path="+(i&&""!=i?i:"/")],n=Cookie.hoursToExpireDate(n),n&&cookie.push("expires="+n),o&&cookie.push("secure"),document.cookie=cookie.join("; ")},unset:function(e,t){t=t&&"string"==typeof t?t:"",Cookie.get(e)&&Cookie.set(e,"",-100,t)},hoursToExpireDate:function(e){return isNaN(parseInt(e))?"":(now=new Date,now.setTime(now.getTime()+1e3*60*60*parseInt(e)),now.toGMTString())},test:function(){return Cookie.set("b49f729efde9b2578ea9f00563d06e57","true"),"true"==Cookie.get("b49f729efde9b2578ea9f00563d06e57")?(Cookie.unset("b49f729efde9b2578ea9f00563d06e57"),!0):!1},dump:function(){"undefined"!=typeof console&&console.log(document.cookie.split(";"))}},function(e){e.color={},e.color.make=function(t,n,i,o){var r={};return r.r=t||0,r.g=n||0,r.b=i||0,r.a=null!=o?o:1,r.add=function(e,t){for(var n=0;n<e.length;++n)r[e.charAt(n)]+=t;return r.normalize()},r.scale=function(e,t){for(var n=0;n<e.length;++n)r[e.charAt(n)]*=t;return r.normalize()},r.toString=function(){return r.a>=1?"rgb("+[r.r,r.g,r.b].join(",")+")":"rgba("+[r.r,r.g,r.b,r.a].join(",")+")"},r.normalize=function(){function e(e,t,n){return t<e?e:t>n?n:t}return r.r=e(0,parseInt(r.r),255),r.g=e(0,parseInt(r.g),255),r.b=e(0,parseInt(r.b),255),r.a=e(0,r.a,1),r},r.clone=function(){return e.color.make(r.r,r.b,r.g,r.a)},r.normalize()},e.color.extract=function(t,n){var i;do{if(i=t.css(n).toLowerCase(),""!=i&&"transparent"!=i)break;t=t.parent()}while(!e.nodeName(t.get(0),"body"));return"rgba(0, 0, 0, 0)"==i&&(i="transparent"),e.color.parse(i)},e.color.parse=function(n){var i,o=e.color.make;if(i=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(n))return o(parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10));if(i=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return o(parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3],10),parseFloat(i[4]));if(i=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(n))return o(2.55*parseFloat(i[1]),2.55*parseFloat(i[2]),2.55*parseFloat(i[3]));if(i=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return o(2.55*parseFloat(i[1]),2.55*parseFloat(i[2]),2.55*parseFloat(i[3]),parseFloat(i[4]));if(i=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(n))return o(parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16));if(i=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(n))return o(parseInt(i[1]+i[1],16),parseInt(i[2]+i[2],16),parseInt(i[3]+i[3],16));var r=e.trim(n).toLowerCase();return"transparent"==r?o(255,255,255,0):(i=t[r]||[0,0,0],o(i[0],i[1],i[2]))};var t={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function(e){function t(t,o,r,s){function a(e,t){t=[Pt].concat(t);for(var n=0;n<e.length;++n)e[n].apply(this,t)}function l(){for(var t=0;t<s.length;++t){var n=s[t];n.init(Pt),n.options&&e.extend(!0,st,n.options)}}function u(t){var n;for(e.extend(!0,st,t),null==st.xaxis.color&&(st.xaxis.color=st.grid.color),null==st.yaxis.color&&(st.yaxis.color=st.grid.color),null==st.xaxis.tickColor&&(st.xaxis.tickColor=st.grid.tickColor),null==st.yaxis.tickColor&&(st.yaxis.tickColor=st.grid.tickColor),null==st.grid.borderColor&&(st.grid.borderColor=st.grid.color),null==st.grid.tickColor&&(st.grid.tickColor=""+e.color.parse(st.grid.color).scale("a",.22)),n=0;n<Math.max(1,st.xaxes.length);++n)st.xaxes[n]=e.extend(!0,{},st.xaxis,st.xaxes[n]);for(n=0;n<Math.max(1,st.yaxes.length);++n)st.yaxes[n]=e.extend(!0,{},st.yaxis,st.yaxes[n]);for(st.xaxis.noTicks&&null==st.xaxis.ticks&&(st.xaxis.ticks=st.xaxis.noTicks),st.yaxis.noTicks&&null==st.yaxis.ticks&&(st.yaxis.ticks=st.yaxis.noTicks),st.x2axis&&(st.xaxes[1]=e.extend(!0,{},st.xaxis,st.x2axis),st.xaxes[1].position="top"),st.y2axis&&(st.yaxes[1]=e.extend(!0,{},st.yaxis,st.y2axis),st.yaxes[1].position="right"),st.grid.coloredAreas&&(st.grid.markings=st.grid.coloredAreas),st.grid.coloredAreasColor&&(st.grid.markingsColor=st.grid.coloredAreasColor),st.lines&&e.extend(!0,st.series.lines,st.lines),st.points&&e.extend(!0,st.series.points,st.points),st.bars&&e.extend(!0,st.series.bars,st.bars),null!=st.shadowSize&&(st.series.shadowSize=st.shadowSize),n=0;n<st.xaxes.length;++n)g(ht,n+1).options=st.xaxes[n];for(n=0;n<st.yaxes.length;++n)g(pt,n+1).options=st.yaxes[n];for(var i in Ct)st.hooks[i]&&st.hooks[i].length&&(Ct[i]=Ct[i].concat(st.hooks[i]));a(Ct.processOptions,[st])}function c(e){rt=d(e),v(),_()}function d(t){for(var n=[],i=0;i<t.length;++i){var o=e.extend(!0,{},st.series);null!=t[i].data?(o.data=t[i].data,delete t[i].data,e.extend(!0,o,t[i]),t[i].data=o.data):o.data=t[i],n.push(o)}return n}function h(e,t){var n=e[t+"axis"];return"object"==typeof n&&(n=n.n),"number"!=typeof n&&(n=1),n}function p(){return e.grep(ht.concat(pt),function(e){return e})}function f(e){var t,n,i={};for(t=0;t<ht.length;++t)n=ht[t],n&&n.used&&(i["x"+n.n]=n.c2p(e.left));for(t=0;t<pt.length;++t)n=pt[t],n&&n.used&&(i["y"+n.n]=n.c2p(e.top));return void 0!==i.x1&&(i.x=i.x1),void 0!==i.y1&&(i.y=i.y1),i}function m(e){var t,n,i,o={};for(t=0;t<ht.length;++t)if(n=ht[t],n&&n.used&&(i="x"+n.n,null==e[i]&&1==n.n&&(i="x"),null!=e[i])){o.left=n.p2c(e[i]);break}for(t=0;t<pt.length;++t)if(n=pt[t],n&&n.used&&(i="y"+n.n,null==e[i]&&1==n.n&&(i="y"),null!=e[i])){o.top=n.p2c(e[i]);break}return o}function g(t,n){return t[n-1]||(t[n-1]={n:n,direction:t==ht?"x":"y",options:e.extend(!0,{},t==ht?st.xaxis:st.yaxis)}),t[n-1]}function v(){var t,n=rt.length,i=[],o=[];for(t=0;t<rt.length;++t){var r=rt[t].color;null!=r&&(--n,"number"==typeof r?o.push(r):i.push(e.color.parse(rt[t].color)))}for(t=0;t<o.length;++t)n=Math.max(n,o[t]+1);var s=[],a=0;for(t=0;s.length<n;){var l;l=st.colors.length==t?e.color.make(100,100,100):e.color.parse(st.colors[t]);var u=1==a%2?-1:1;l.scale("rgb",1+.2*u*Math.ceil(a/2)),s.push(l),++t,t>=st.colors.length&&(t=0,++a)}var c,d=0;for(t=0;t<rt.length;++t){if(c=rt[t],null==c.color?(c.color=""+s[d],++d):"number"==typeof c.color&&(c.color=""+s[c.color]),null==c.lines.show){var p,f=!0;for(p in c)if(c[p]&&c[p].show){f=!1;break}f&&(c.lines.show=!0)}c.xaxis=g(ht,h(c,"x")),c.yaxis=g(pt,h(c,"y"))}}function _(){function t(e,t,n){t<e.datamin&&t!=-g&&(e.datamin=t),n>e.datamax&&n!=g&&(e.datamax=n)}var n,i,o,r,s,l,u,c,d,h,f=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,g=Number.MAX_VALUE;for(e.each(p(),function(e,t){t.datamin=f,t.datamax=m,t.used=!1}),n=0;n<rt.length;++n)s=rt[n],s.datapoints={points:[]},a(Ct.processRawData,[s,s.data,s.datapoints]);for(n=0;n<rt.length;++n){s=rt[n];var v=s.data,_=s.datapoints.format;if(_||(_=[],_.push({x:!0,number:!0,required:!0}),_.push({y:!0,number:!0,required:!0}),(s.bars.show||s.lines.show&&s.lines.fill)&&(_.push({y:!0,number:!0,required:!1,defaultValue:0}),s.bars.horizontal&&(delete _[_.length-1].y,_[_.length-1].x=!0)),s.datapoints.format=_),null==s.datapoints.pointsize)for(s.datapoints.pointsize=_.length,u=s.datapoints.pointsize,l=s.datapoints.points,insertSteps=s.lines.show&&s.lines.steps,s.xaxis.used=s.yaxis.used=!0,i=o=0;i<v.length;++i,o+=u){h=v[i];var C=null==h;if(!C)for(r=0;r<u;++r)c=h[r],d=_[r],d&&(d.number&&null!=c&&(c=+c,isNaN(c)?c=null:1/0==c?c=g:c==-1/0&&(c=-g)),null==c&&(d.required&&(C=!0),null!=d.defaultValue&&(c=d.defaultValue))),l[o+r]=c;if(C)for(r=0;r<u;++r)c=l[o+r],null!=c&&(d=_[r],d.x&&t(s.xaxis,c,c),d.y&&t(s.yaxis,c,c)),l[o+r]=null;else if(insertSteps&&o>0&&null!=l[o-u]&&l[o-u]!=l[o]&&l[o-u+1]!=l[o+1]){for(r=0;r<u;++r)l[o+u+r]=l[o+r];l[o+1]=l[o-u+1],o+=u}}}for(n=0;n<rt.length;++n)s=rt[n],a(Ct.processDatapoints,[s,s.datapoints]);for(n=0;n<rt.length;++n){s=rt[n],l=s.datapoints.points,u=s.datapoints.pointsize;var P=f,y=f,T=m,S=m;for(i=0;i<l.length;i+=u)if(null!=l[i])for(r=0;r<u;++r)c=l[i+r],d=_[r],d&&c!=g&&c!=-g&&(d.x&&(c<P&&(P=c),c>T&&(T=c)),d.y&&(c<y&&(y=c),c>S&&(S=c)));if(s.bars.show){var E="left"==s.bars.align?0:-s.bars.barWidth/2;s.bars.horizontal?(y+=E,S+=E+s.bars.barWidth):(P+=E,T+=E+s.bars.barWidth)}t(s.xaxis,P,T),t(s.yaxis,y,S)}e.each(p(),function(e,t){t.datamin==f&&(t.datamin=null),t.datamax==m&&(t.datamax=null)})}function C(n,i){var o=document.createElement("canvas");return o.className=i,o.width=mt,o.height=gt,n||e(o).css({position:"absolute",left:0,top:0}),e(o).appendTo(t),o.getContext||(o=window.G_vmlCanvasManager.initElement(o)),o.getContext("2d").save(),o}function P(){if(mt=t.width(),gt=t.height(),mt<=0||gt<=0)throw"Invalid dimensions for plot, width = "+mt+", height = "+gt}function y(e){e.width!=mt&&(e.width=mt),e.height!=gt&&(e.height=gt);var t=e.getContext("2d");t.restore(),t.save()}function T(){var n,i=t.children("canvas.base"),o=t.children("canvas.overlay");0==i.length||0==o?(t.html(""),t.css({padding:0}),"static"==t.css("position")&&t.css("position","relative"),P(),at=C(!0,"base"),lt=C(!1,"overlay"),n=!1):(at=i.get(0),lt=o.get(0),n=!0),ct=at.getContext("2d"),dt=lt.getContext("2d"),ut=e([lt,at]),n&&(t.data("plot").shutdown(),Pt.resize(),dt.clearRect(0,0,mt,gt),ut.unbind(),t.children().not([at,lt]).remove()),t.data("plot",Pt)}function S(){st.grid.hoverable&&(ut.mousemove(z),ut.mouseleave(K)),st.grid.clickable&&ut.click(Y),a(Ct.bindEvents,[ut])}function E(){Tt&&clearTimeout(Tt),ut.unbind("mousemove",z),ut.unbind("mouseleave",K),ut.unbind("click",Y),a(Ct.shutdown,[ut])}function b(e){function t(e){return e}var n,i,o=e.options.transform||t,r=e.options.inverseTransform;"x"==e.direction?(n=e.scale=vt/Math.abs(o(e.max)-o(e.min)),i=Math.min(o(e.max),o(e.min))):(n=e.scale=_t/Math.abs(o(e.max)-o(e.min)),n=-n,i=Math.max(o(e.max),o(e.min))),e.p2c=o==t?function(e){return(e-i)*n}:function(e){return(o(e)-i)*n},e.c2p=r?function(e){return r(i+e/n)}:function(e){return i+e/n}}function w(n){function i(i,o){return e('<div style="position:absolute;top:-10000px;'+o+'font-size:smaller">'+'<div class="'+n.direction+"Axis "+n.direction+n.n+'Axis">'+i.join("")+"</div></div>").appendTo(t)}var o,r,s,a=n.options,l=n.ticks||[],u=[],c=a.labelWidth,d=a.labelHeight;if("x"==n.direction){if(null==c&&(c=Math.floor(mt/(l.length>0?l.length:1))),null==d){for(u=[],o=0;o<l.length;++o)r=l[o].label,r&&u.push('<div class="tickLabel" style="float:left;width:'+c+'px">'+r+"</div>");u.length>0&&(u.push('<div style="clear:left"></div>'),s=i(u,"width:10000px;"),d=s.height(),s.remove())}}else if(null==c||null==d){for(o=0;o<l.length;++o)r=l[o].label,r&&u.push('<div class="tickLabel">'+r+"</div>");u.length>0&&(s=i(u,""),null==c&&(c=s.children().width()),null==d&&(d=s.find("div.tickLabel").height()),s.remove())}null==c&&(c=0),null==d&&(d=0),n.labelWidth=c,n.labelHeight=d}function N(t){var n=t.labelWidth,i=t.labelHeight,o=t.options.position,r=t.options.tickLength,s=st.grid.axisMargin,a=st.grid.labelMargin,l="x"==t.direction?ht:pt,u=e.grep(l,function(e){return e&&e.options.position==o&&e.reserveSpace});e.inArray(t,u)==u.length-1&&(s=0),null==r&&(r="full");var c=e.grep(l,function(e){return e&&e.reserveSpace}),d=0==e.inArray(t,c);d||"full"!=r||(r=5),isNaN(+r)||(a+=+r),"x"==t.direction?(i+=a,"bottom"==o?(ft.bottom+=i-30,t.box={top:gt-ft.bottom,height:i}):t.box={top:ft.top+s,height:i}):(n+=a,"left"==o?t.box={left:ft.left+s,width:n}:(ft.right+=n+s,t.box={left:mt-ft.right,width:n})),t.position=o,t.tickLength=r,t.box.padding=a,t.innermost=d}function I(e){"x"==e.direction?(e.box.left=ft.left,e.box.width=vt):(e.box.top=ft.top,e.box.height=_t)}function O(){var t,n=p();if(e.each(n,function(e,t){t.show=t.options.show,null==t.show&&(t.show=t.used),t.reserveSpace=t.show||t.options.reserveSpace,x(t)}),allocatedAxes=e.grep(n,function(e){return e.reserveSpace}),ft.left=ft.right=ft.top=ft.bottom=0,st.grid.show){for(e.each(allocatedAxes,function(e,t){M(t),k(t),R(t,t.ticks),w(t)}),t=allocatedAxes.length-1;t>=0;--t)N(allocatedAxes[t]);var i=st.grid.minBorderMargin;if(null==i)for(i=0,t=0;t<rt.length;++t)i=Math.max(i,rt[t].points.radius+rt[t].points.lineWidth/2);for(var o in ft)ft[o]+=st.grid.borderWidth,ft[o]=Math.max(i,ft[o])}vt=mt-ft.left-ft.right,_t=gt-ft.bottom-ft.top,e.each(n,function(e,t){b(t)}),st.grid.show&&(e.each(allocatedAxes,function(e,t){I(t)}),L()),G()}function x(e){var t=e.options,n=+(null!=t.min?t.min:e.datamin),i=+(null!=t.max?t.max:e.datamax),o=i-n;if(0==o){var r=0==i?1:.01;null==t.min&&(n-=r),(null==t.max||null!=t.min)&&(i+=r)}else{var s=t.autoscaleMargin;null!=s&&(null==t.min&&(n-=o*s,n<0&&null!=e.datamin&&e.datamin>=0&&(n=0)),null==t.max&&(i+=o*s,i>0&&null!=e.datamax&&e.datamax<=0&&(i=0)))}e.min=n,e.max=i}function M(t){var i,o=t.options;i="number"==typeof o.ticks&&o.ticks>0?o.ticks:.3*Math.sqrt("x"==t.direction?mt:gt);var r,s,a,l,u,c,d,h=(t.max-t.min)/i;if("time"==o.mode){var p={second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,year:1e3*525949.2*60},f=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]],m=0;null!=o.minTickSize&&(m="number"==typeof o.tickSize?o.tickSize:o.minTickSize[0]*p[o.minTickSize[1]]);for(var u=0;u<f.length-1&&!(h<(f[u][0]*p[f[u][1]]+f[u+1][0]*p[f[u+1][1]])/2&&f[u][0]*p[f[u][1]]>=m);++u);r=f[u][0],a=f[u][1],"year"==a&&(c=Math.pow(10,Math.floor(Math.log(h/p.year)/Math.LN10)),d=h/p.year/c,r=d<1.5?1:d<3?2:d<7.5?5:10,r*=c),t.tickSize=o.tickSize||[r,a],s=function(e){var t=[],i=e.tickSize[0],o=e.tickSize[1],r=new Date(e.min),s=i*p[o];
"second"==o&&r.setUTCSeconds(n(r.getUTCSeconds(),i)),"minute"==o&&r.setUTCMinutes(n(r.getUTCMinutes(),i)),"hour"==o&&r.setUTCHours(n(r.getUTCHours(),i)),"month"==o&&r.setUTCMonth(n(r.getUTCMonth(),i)),"year"==o&&r.setUTCFullYear(n(r.getUTCFullYear(),i)),r.setUTCMilliseconds(0),s>=p.minute&&r.setUTCSeconds(0),s>=p.hour&&r.setUTCMinutes(0),s>=p.day&&r.setUTCHours(0),s>=4*p.day&&r.setUTCDate(1),s>=p.year&&r.setUTCMonth(0);var a,l=0,u=Number.NaN;do if(a=u,u=r.getTime(),t.push(u),"month"==o)if(i<1){r.setUTCDate(1);var c=r.getTime();r.setUTCMonth(r.getUTCMonth()+1);var d=r.getTime();r.setTime(u+l*p.hour+(d-c)*i),l=r.getUTCHours(),r.setUTCHours(0)}else r.setUTCMonth(r.getUTCMonth()+i);else"year"==o?r.setUTCFullYear(r.getUTCFullYear()+i):r.setTime(u+s);while(u<e.max&&u!=a);return t},l=function(t,n){var i=new Date(t);if(null!=o.timeformat)return e.plot.formatDate(i,o.timeformat,o.monthNames);var r=n.tickSize[0]*p[n.tickSize[1]],s=n.max-n.min,a=o.twelveHourClock?" %p":"";return fmt=r<p.minute?"%h:%M:%S"+a:r<p.day?s<2*p.day?"%h:%M"+a:"%b %d %h:%M"+a:r<p.month?"%b %d":r<p.year?s<p.year?"%b":"%b %y":"%y",e.plot.formatDate(i,fmt,o.monthNames)}}else{var g=o.tickDecimals,v=-Math.floor(Math.log(h)/Math.LN10);null!=g&&v>g&&(v=g),c=Math.pow(10,-v),d=h/c,d<1.5?r=1:d<3?(r=2,d>2.25&&(null==g||v+1<=g)&&(r=2.5,++v)):r=d<7.5?5:10,r*=c,null!=o.minTickSize&&r<o.minTickSize&&(r=o.minTickSize),t.tickDecimals=Math.max(0,null!=g?g:v),t.tickSize=o.tickSize||r,s=function(e){var t,i=[],o=n(e.min,e.tickSize),r=0,s=Number.NaN;do t=s,s=o+r*e.tickSize,i.push(s),++r;while(s<e.max&&s!=t);return i},l=function(e,t){return e.toFixed(t.tickDecimals)}}if(null!=o.alignTicksWithAxis){var _=("x"==t.direction?ht:pt)[o.alignTicksWithAxis-1];if(_&&_.used&&_!=t){var C=s(t);if(C.length>0&&(null==o.min&&(t.min=Math.min(t.min,C[0])),null==o.max&&C.length>1&&(t.max=Math.max(t.max,C[C.length-1]))),s=function(e){var t,n,i=[];for(n=0;n<_.ticks.length;++n)t=(_.ticks[n].v-_.min)/(_.max-_.min),t=e.min+t*(e.max-e.min),i.push(t);return i},"time"!=t.mode&&null==o.tickDecimals){var P=Math.max(0,-Math.floor(Math.log(h)/Math.LN10)+1),y=s(t);y.length>1&&/\..*0$/.test((y[1]-y[0]).toFixed(P))||(t.tickDecimals=P)}}}t.tickGenerator=s,t.tickFormatter=e.isFunction(o.tickFormatter)?function(e,t){return""+o.tickFormatter(e,t)}:l}function k(t){var n=t.options.ticks,i=[];null==n||"number"==typeof n&&n>0?i=t.tickGenerator(t):n&&(i=e.isFunction(n)?n({min:t.min,max:t.max}):n);var o,r;for(t.ticks=[],o=0;o<i.length;++o){var s=null,a=i[o];"object"==typeof a?(r=+a[0],a.length>1&&(s=a[1])):r=+a,null==s&&(s=t.tickFormatter(r,t)),isNaN(r)||t.ticks.push({v:r,label:s})}}function R(e,t){e.options.autoscaleMargin&&t.length>0&&(null==e.options.min&&(e.min=Math.min(e.min,t[0].v)),null==e.options.max&&t.length>1&&(e.max=Math.max(e.max,t[t.length-1].v)))}function A(){ct.clearRect(0,0,mt,gt);var e=st.grid;e.show&&e.backgroundColor&&D(),e.show&&!e.aboveData&&U();for(var t=0;t<rt.length;++t)a(Ct.drawSeries,[ct,rt[t]]),F(rt[t]);a(Ct.draw,[ct]),e.show&&e.aboveData&&U()}function B(e,t){var n,o,r,s,a=p();for(i=0;i<a.length;++i)if(n=a[i],n.direction==t&&(s=t+n.n+"axis",e[s]||1!=n.n||(s=t+"axis"),e[s])){o=e[s].from,r=e[s].to;break}if(e[s]||(n="x"==t?ht[0]:pt[0],o=e[t+"1"],r=e[t+"2"]),null!=o&&null!=r&&o>r){var l=o;o=r,r=l}return{from:o,to:r,axis:n}}function D(){ct.save(),ct.translate(ft.left,ft.top),ct.fillStyle=ot(st.grid.backgroundColor,_t,0,"rgba(255, 255, 255, 0)"),ct.fillRect(0,0,vt,_t),ct.restore()}function U(){var t;ct.save(),ct.translate(ft.left,ft.top);var n=st.grid.markings;if(n){if(e.isFunction(n)){var i=Pt.getAxes();i.xmin=i.xaxis.min,i.xmax=i.xaxis.max,i.ymin=i.yaxis.min,i.ymax=i.yaxis.max,n=n(i)}for(t=0;t<n.length;++t){var o=n[t],r=B(o,"x"),s=B(o,"y");null==r.from&&(r.from=r.axis.min),null==r.to&&(r.to=r.axis.max),null==s.from&&(s.from=s.axis.min),null==s.to&&(s.to=s.axis.max),r.to<r.axis.min||r.from>r.axis.max||s.to<s.axis.min||s.from>s.axis.max||(r.from=Math.max(r.from,r.axis.min),r.to=Math.min(r.to,r.axis.max),s.from=Math.max(s.from,s.axis.min),s.to=Math.min(s.to,s.axis.max),(r.from!=r.to||s.from!=s.to)&&(r.from=r.axis.p2c(r.from),r.to=r.axis.p2c(r.to),s.from=s.axis.p2c(s.from),s.to=s.axis.p2c(s.to),r.from==r.to||s.from==s.to?(ct.beginPath(),ct.strokeStyle=o.color||st.grid.markingsColor,ct.lineWidth=o.lineWidth||st.grid.markingsLineWidth,ct.moveTo(r.from,s.from),ct.lineTo(r.to,s.to),ct.stroke()):(ct.fillStyle=o.color||st.grid.markingsColor,ct.fillRect(r.from,s.to,r.to-r.from,s.from-s.to))))}}for(var i=p(),a=st.grid.borderWidth,l=0;l<i.length;++l){var u,c,d,h,f=i[l],m=f.box,g=f.tickLength;if(f.show&&0!=f.ticks.length){for(ct.strokeStyle=f.options.tickColor||""+e.color.parse(f.options.color).scale("a",.22),ct.lineWidth=1,"x"==f.direction?(u=0,c="full"==g?"top"==f.position?0:_t:m.top-ft.top+("top"==f.position?m.height:0)):(c=0,u="full"==g?"left"==f.position?0:vt:m.left-ft.left+("left"==f.position?m.width:0)),f.innermost||(ct.beginPath(),d=h=0,"x"==f.direction?d=vt:h=_t,1==ct.lineWidth&&(u=Math.floor(u)+.5,c=Math.floor(c)+.5),ct.moveTo(u,c),ct.lineTo(u+d,c+h),ct.stroke()),ct.beginPath(),t=0;t<f.ticks.length;++t){var v=f.ticks[t].v;if(d=h=0,!(v<f.min||v>f.max||"full"==g&&a>0&&(v==f.min||v==f.max))){if("x"==f.direction)u=f.p2c(v),h="full"==g?-_t:g,"top"==f.position&&(h=-h);else{if(c=f.p2c(v),c<10)continue;d="full"==g?-vt:g,"left"==f.position&&(d=-d)}1==ct.lineWidth&&("x"==f.direction?u=Math.floor(u)+.5:c=Math.floor(c)+.5),ct.moveTo(u,c),ct.lineTo(u+d,c+h)}}ct.stroke()}}a&&(ct.lineWidth=a,ct.strokeStyle=st.grid.borderColor,ct.strokeRect(-a/2,-a/2,vt+a,_t+a)),ct.restore()}function L(){t.find(".tickLabels").remove();for(var e=['<div class="tickLabels" style="font-size:smaller">'],n=p(),i=0;i<n.length;++i){var o=n[i],r=o.box;if(o.show){e.push('<div class="'+o.direction+"Axis "+o.direction+o.n+'Axis" style="color:'+o.options.color+'">');for(var s=0;s<o.ticks.length;++s){var a=o.ticks[s];if(!(!a.label||a.v<o.min||a.v>o.max)){var l,u={};if("x"==o.direction)l="center",u.left=Math.round(ft.left+o.p2c(a.v)-o.labelWidth/2),"bottom"==o.position?u.top=r.top+r.padding-45:u.bottom=gt-(r.top+r.height-r.padding);else{if(u.top=Math.round(ft.top+o.p2c(a.v)-o.labelHeight/2),u.top<15)continue;"left"==o.position?(u.right=mt-(r.left+r.width-r.padding)-10,l="right"):(u.left=r.left+r.padding,l="left")}u.width=o.labelWidth;var c=["position:absolute","text-align:"+l];for(var d in u)c.push(d+":"+u[d]+"px");e.push('<div class="tickLabel" style="'+c.join(";")+'">'+a.label+"</div>")}}e.push("</div>")}}e.push("</div>"),t.append(e.join(""))}function F(e){e.lines.show&&$(e),e.bars.show&&q(e),e.points.show&&j(e)}function $(e){function t(e,t,n,i,o){var r=e.points,s=e.pointsize,a=null,l=null;ct.beginPath();for(var u=s;u<r.length;u+=s){var c=r[u-s],d=r[u-s+1],h=r[u],p=r[u+1];if(null!=c&&null!=h){if(d<=p&&d<o.min){if(p<o.min)continue;c=(o.min-d)/(p-d)*(h-c)+c,d=o.min}else if(p<=d&&p<o.min){if(d<o.min)continue;h=(o.min-d)/(p-d)*(h-c)+c,p=o.min}if(d>=p&&d>o.max){if(p>o.max)continue;c=(o.max-d)/(p-d)*(h-c)+c,d=o.max}else if(p>=d&&p>o.max){if(d>o.max)continue;h=(o.max-d)/(p-d)*(h-c)+c,p=o.max}if(c<=h&&c<i.min){if(h<i.min)continue;d=(i.min-c)/(h-c)*(p-d)+d,c=i.min}else if(h<=c&&h<i.min){if(c<i.min)continue;p=(i.min-c)/(h-c)*(p-d)+d,h=i.min}if(c>=h&&c>i.max){if(h>i.max)continue;d=(i.max-c)/(h-c)*(p-d)+d,c=i.max}else if(h>=c&&h>i.max){if(c>i.max)continue;p=(i.max-c)/(h-c)*(p-d)+d,h=i.max}(c!=a||d!=l)&&ct.moveTo(i.p2c(c)+t,o.p2c(d)+n),a=h,l=p,ct.lineTo(i.p2c(h)+t,o.p2c(p)+n)}}ct.stroke()}function n(e,t,n){for(var i=e.points,o=e.pointsize,r=Math.min(Math.max(0,n.min),n.max),s=0,a=!1,l=1,u=0,c=0;;){if(o>0&&s>i.length+o)break;s+=o;var d=i[s-o],h=i[s-o+l],p=i[s],f=i[s+l];if(a){if(o>0&&null!=d&&null==p){c=s,o=-o,l=2;continue}if(o<0&&s==u+o){ct.fill(),a=!1,o=-o,l=1,s=u=c+o;continue}}if(null!=d&&null!=p){if(d<=p&&d<t.min){if(p<t.min)continue;h=(t.min-d)/(p-d)*(f-h)+h,d=t.min}else if(p<=d&&p<t.min){if(d<t.min)continue;f=(t.min-d)/(p-d)*(f-h)+h,p=t.min}if(d>=p&&d>t.max){if(p>t.max)continue;h=(t.max-d)/(p-d)*(f-h)+h,d=t.max}else if(p>=d&&p>t.max){if(d>t.max)continue;f=(t.max-d)/(p-d)*(f-h)+h,p=t.max}if(a||(ct.beginPath(),ct.moveTo(t.p2c(d),n.p2c(r)),a=!0),h>=n.max&&f>=n.max)ct.lineTo(t.p2c(d),n.p2c(n.max)),ct.lineTo(t.p2c(p),n.p2c(n.max));else if(h<=n.min&&f<=n.min)ct.lineTo(t.p2c(d),n.p2c(n.min)),ct.lineTo(t.p2c(p),n.p2c(n.min));else{var m=d,g=p;h<=f&&h<n.min&&f>=n.min?(d=(n.min-h)/(f-h)*(p-d)+d,h=n.min):f<=h&&f<n.min&&h>=n.min&&(p=(n.min-h)/(f-h)*(p-d)+d,f=n.min),h>=f&&h>n.max&&f<=n.max?(d=(n.max-h)/(f-h)*(p-d)+d,h=n.max):f>=h&&f>n.max&&h<=n.max&&(p=(n.max-h)/(f-h)*(p-d)+d,f=n.max),d!=m&&ct.lineTo(t.p2c(m),n.p2c(h)),ct.lineTo(t.p2c(d),n.p2c(h)),ct.lineTo(t.p2c(p),n.p2c(f)),p!=g&&(ct.lineTo(t.p2c(p),n.p2c(f)),ct.lineTo(t.p2c(g),n.p2c(f)))}}}}ct.save(),ct.translate(ft.left,ft.top),ct.lineJoin="round";var i=e.lines.lineWidth,o=e.shadowSize;if(i>0&&o>0){ct.lineWidth=o,ct.strokeStyle="rgba(0,0,0,0.1)";var r=Math.PI/18;t(e.datapoints,Math.sin(r)*(i/2+o/2),Math.cos(r)*(i/2+o/2),e.xaxis,e.yaxis),ct.lineWidth=o/2,t(e.datapoints,Math.sin(r)*(i/2+o/4),Math.cos(r)*(i/2+o/4),e.xaxis,e.yaxis)}ct.lineWidth=i,ct.strokeStyle=e.color;var s=V(e.lines,e.color,0,_t);s&&(ct.fillStyle=s,n(e.datapoints,e.xaxis,e.yaxis)),i>0&&t(e.datapoints,0,0,e.xaxis,e.yaxis),ct.restore()}function j(e){function t(e,t,n,i,o,r,s,a){for(var l=e.points,u=e.pointsize,c=0;c<l.length;c+=u){var d=l[c],h=l[c+1];null==d||d<r.min||d>r.max||h<s.min||h>s.max||(ct.strokeStyle="rgb(249, 249, 249)",ct.beginPath(),d=r.p2c(d),h=s.p2c(h)+i,"circle"==a?ct.arc(d,h,t,0,o?Math.PI:2*Math.PI,!1):a(ct,d,h,t,o),ct.closePath(),n&&(ct.fillStyle=n,ct.fill()),ct.stroke())}}ct.save(),ct.translate(ft.left,ft.top);var n=e.points.lineWidth,i=e.shadowSize,o=e.points.radius,r=e.points.symbol;if(n>0&&i>0){var s=i/2;ct.lineWidth=s,ct.strokeStyle="rgba(0,0,0,0.1)",t(e.datapoints,o,null,s+s/2,!0,e.xaxis,e.yaxis,r),ct.strokeStyle="rgba(0,0,0,0.2)",t(e.datapoints,o,null,s/2,!0,e.xaxis,e.yaxis,r)}ct.lineWidth=n,ct.strokeStyle=e.color,t(e.datapoints,o,V(e.points,e.color),0,!1,e.xaxis,e.yaxis,r),ct.restore()}function H(e,t,n,i,o,r,s,a,l,u,c,d){var h,p,f,m,g,v,_,C,P;c?(C=v=_=!0,g=!1,h=n,p=e,m=t+i,f=t+o,p<h&&(P=p,p=h,h=P,g=!0,v=!1)):(g=v=_=!0,C=!1,h=e+i,p=e+o,f=n,m=t,m<f&&(P=m,m=f,f=P,C=!0,_=!1)),p<a.min||h>a.max||m<l.min||f>l.max||(h<a.min&&(h=a.min,g=!1),p>a.max&&(p=a.max,v=!1),f<l.min&&(f=l.min,C=!1),m>l.max&&(m=l.max,_=!1),h=a.p2c(h),f=l.p2c(f),p=a.p2c(p),m=l.p2c(m),s&&(u.beginPath(),u.moveTo(h,f),u.lineTo(h,m),u.lineTo(p,m),u.lineTo(p,f),u.fillStyle=s(f,m),u.fill()),d>0&&(g||v||_||C)&&(u.beginPath(),u.moveTo(h,f+r),g?u.lineTo(h,m+r):u.moveTo(h,m+r),_?u.lineTo(p,m+r):u.moveTo(p,m+r),v?u.lineTo(p,f+r):u.moveTo(p,f+r),C?u.lineTo(h,f+r):u.moveTo(h,f+r),u.stroke()))}function q(e){function t(t,n,i,o,r,s,a){for(var l=t.points,u=t.pointsize,c=0;c<l.length;c+=u)null!=l[c]&&H(l[c],l[c+1],l[c+2],n,i,o,r,s,a,ct,e.bars.horizontal,e.bars.lineWidth)}ct.save(),ct.translate(ft.left,ft.top),ct.lineWidth=e.bars.lineWidth,ct.strokeStyle=e.color;var n="left"==e.bars.align?0:-e.bars.barWidth/2,i=e.bars.fill?function(t,n){return V(e.bars,e.color,t,n)}:null;t(e.datapoints,n,n+e.bars.barWidth,0,i,e.xaxis,e.yaxis),ct.restore()}function V(t,n,i,o){var r=t.fill;if(!r)return null;if(t.fillColor)return ot(t.fillColor,i,o,n);var s=e.color.parse(n);return s.a="number"==typeof r?r:.4,s.normalize(),""+s}function G(){if(t.find(".legend").remove(),st.legend.show){for(var n,i,o=[],r=!1,s=st.legend.labelFormatter,a=0;a<rt.length;++a)n=rt[a],i=n.label,i&&(0==a%st.legend.noColumns&&(r&&o.push("</tr>"),o.push("<tr>"),r=!0),s&&(i=s(i,n)),o.push('<td class="legendColorBox" data-index="'+a+'"><div data-index="'+a+'" style="border:1px solid '+st.legend.labelBoxBorderColor+';padding:1px"><div data-index="'+a+'" style="background:'+n.color+";border:5px solid "+n.color+'">&#x2713;</div></div></td>'+'<td class="legendLabel" data-index="'+a+'" style="color:'+n.color+'">'+i+"</td>"));if(r&&o.push("</tr>"),0!=o.length){var l='<table style="font-size:smaller;color:'+st.grid.color+'">'+o.join("")+"</table>";if(null!=st.legend.container)e(st.legend.container).html(l);else{var u="",c=st.legend.position,d=st.legend.margin;null==d[0]&&(d=[d,d]),"n"==c.charAt(0)?u+="top:"+(d[1]+ft.top)+"px;":"s"==c.charAt(0)&&(u+="bottom:"+(d[1]+ft.bottom)+"px;"),"e"==c.charAt(1)?u+="right:0px;":"w"==c.charAt(1)&&(u+="left:"+(d[0]+ft.left)+"px;");var h=e('<div class="legend">'+l.replace('style="','style="position:absolute;'+u+";")+"</div>").appendTo(t);if(0!=st.legend.backgroundOpacity){var p=st.legend.backgroundColor;null==p&&(p=st.grid.backgroundColor,p=p&&"string"==typeof p?e.color.parse(p):e.color.extract(h,"background-color"),p.a=1,p=""+p);var f=h.children();e('<div style="position:absolute;width:'+f.width()+"px;height:"+f.height()+"px;"+u+"background-color:"+p+';"> </div>').prependTo(h).css("opacity",st.legend.backgroundOpacity)}}}}}function W(e,t,n){var i,o,r=st.grid.mouseActiveRadius,s=r*r+1,a=null;for(i=rt.length-1;i>=0;--i)if(n(rt[i])){var l=rt[i],u=l.xaxis,c=l.yaxis,d=l.datapoints.points,h=l.datapoints.pointsize,p=u.c2p(e),f=c.c2p(t),m=r/u.scale,g=r/c.scale;if(u.options.inverseTransform&&(m=Number.MAX_VALUE),c.options.inverseTransform&&(g=Number.MAX_VALUE),l.lines.show||l.points.show)for(o=0;o<d.length;o+=h){var v=d[o],_=d[o+1];if(null!=v&&!(v-p>m||v-p<-m||_-f>g||_-f<-g)){var C=Math.abs(u.p2c(v)-e),P=Math.abs(c.p2c(_)-t),y=C*C+P*P;y<s&&(s=y,a=[i,o/h])}}if(l.bars.show&&!a){var T="left"==l.bars.align?0:-l.bars.barWidth/2,S=T+l.bars.barWidth;for(o=0;o<d.length;o+=h){var v=d[o],_=d[o+1],E=d[o+2];null!=v&&(rt[i].bars.horizontal?p<=Math.max(E,v)&&p>=Math.min(E,v)&&f>=_+T&&f<=_+S:p>=v+T&&p<=v+S&&f>=Math.min(E,_)&&f<=Math.max(E,_))&&(a=[i,o/h])}}}return a?(i=a[0],o=a[1],h=rt[i].datapoints.pointsize,{datapoint:rt[i].datapoints.points.slice(o*h,(o+1)*h),dataIndex:o,series:rt[i],seriesIndex:i}):null}function z(e){st.grid.hoverable&&X("plothover",e,function(e){return 0!=e.hoverable})}function K(e){st.grid.hoverable&&X("plothover",e,function(){return!1})}function Y(e){X("plotclick",e,function(e){return 0!=e.clickable})}function X(e,n,i){var o=ut.offset(),r=n.pageX-o.left-ft.left,s=n.pageY-o.top-ft.top,a=f({left:r,top:s});a.pageX=n.pageX,a.pageY=n.pageY;var l=W(r,s,i);if(l&&(l.pageX=parseInt(l.series.xaxis.p2c(l.datapoint[0])+o.left+ft.left),l.pageY=parseInt(l.series.yaxis.p2c(l.datapoint[1])+o.top+ft.top)),st.grid.autoHighlight){for(var u=0;u<yt.length;++u){var c=yt[u];c.auto!=e||l&&c.series==l.series&&c.point[0]==l.datapoint[0]&&c.point[1]==l.datapoint[1]||et(c.series,c.point)}l&&Z(l.series,l.datapoint,e)}t.trigger(e,[a,l])}function J(){Tt||(Tt=setTimeout(Q,30))}function Q(){Tt=null,dt.save(),dt.clearRect(0,0,mt,gt),dt.translate(ft.left,ft.top);var e,t;for(e=0;e<yt.length;++e)t=yt[e],t.series.bars.show?it(t.series,t.point):nt(t.series,t.point);dt.restore(),a(Ct.drawOverlay,[dt])}function Z(e,t,n){if("number"==typeof e&&(e=rt[e]),"number"==typeof t){var i=e.datapoints.pointsize;t=e.datapoints.points.slice(i*t,i*(t+1))}var o=tt(e,t);-1==o?(yt.push({series:e,point:t,auto:n}),J()):n||(yt[o].auto=!1)}function et(e,t){null==e&&null==t&&(yt=[],J()),"number"==typeof e&&(e=rt[e]),"number"==typeof t&&(t=e.data[t]);var n=tt(e,t);-1!=n&&(yt.splice(n,1),J())}function tt(e,t){for(var n=0;n<yt.length;++n){var i=yt[n];if(i.series==e&&i.point[0]==t[0]&&i.point[1]==t[1])return n}return-1}function nt(t,n){var i=n[0],o=n[1],r=t.xaxis,s=t.yaxis;if(!(i<r.min||i>r.max||o<s.min||o>s.max)){var a=t.points.radius+t.points.lineWidth/2;dt.lineWidth=a,dt.strokeStyle=""+e.color.parse(t.color).scale("a",.5);var l=1.5*a,i=r.p2c(i),o=s.p2c(o);dt.beginPath(),"circle"==t.points.symbol?dt.arc(i,o,l,0,2*Math.PI,!1):t.points.symbol(dt,i,o,l,!1),dt.closePath(),dt.stroke()}}function it(t,n){dt.lineWidth=t.bars.lineWidth,dt.strokeStyle=""+e.color.parse(t.color).scale("a",.5);var i=""+e.color.parse(t.color).scale("a",.5),o="left"==t.bars.align?0:-t.bars.barWidth/2;H(n[0],n[1],n[2]||0,o,o+t.bars.barWidth,0,function(){return i},t.xaxis,t.yaxis,dt,t.bars.horizontal,t.bars.lineWidth)}function ot(t,n,i,o){if("string"==typeof t)return t;for(var r=ct.createLinearGradient(0,i,0,n),s=0,a=t.colors.length;s<a;++s){var l=t.colors[s];if("string"!=typeof l){var u=e.color.parse(o);null!=l.brightness&&(u=u.scale("rgb",l.brightness)),null!=l.opacity&&(u.a*=l.opacity),l=""+u}r.addColorStop(s/(a-1),l)}return r}var rt=[],st={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85},xaxis:{show:null,position:"bottom",mode:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null,monthNames:null,timeformat:null,twelveHourClock:!1},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1},shadowSize:3},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},hooks:{}},at=null,lt=null,ut=null,ct=null,dt=null,ht=[],pt=[],ft={left:0,right:0,top:0,bottom:0},mt=0,gt=0,vt=0,_t=0,Ct={processOptions:[],processRawData:[],processDatapoints:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},Pt=this;Pt.setData=c,Pt.setupGrid=O,Pt.draw=A,Pt.getPlaceholder=function(){return t},Pt.getCanvas=function(){return at},Pt.getPlotOffset=function(){return ft},Pt.width=function(){return vt},Pt.height=function(){return _t},Pt.offset=function(){var e=ut.offset();return e.left+=ft.left,e.top+=ft.top,e},Pt.getData=function(){return rt},Pt.getAxes=function(){var t={};return e.each(ht.concat(pt),function(e,n){n&&(t[n.direction+(1!=n.n?n.n:"")+"axis"]=n)}),t},Pt.getXAxes=function(){return ht},Pt.getYAxes=function(){return pt},Pt.c2p=f,Pt.p2c=m,Pt.getOptions=function(){return st},Pt.highlight=Z,Pt.unhighlight=et,Pt.triggerRedrawOverlay=J,Pt.pointOffset=function(e){return{left:parseInt(ht[h(e,"x")-1].p2c(+e.x)+ft.left),top:parseInt(pt[h(e,"y")-1].p2c(+e.y)+ft.top)}},Pt.shutdown=E,Pt.resize=function(){P(),y(at),y(lt)},Pt.hooks=Ct,l(Pt),u(r),T(),c(o),O(),A(),S();var yt=[],Tt=null}function n(e,t){return t*Math.floor(e/t)}e.plot=function(n,i,o){var r=new t(e(n),i,o,e.plot.plugins);return r},e.plot.version="0.7",e.plot.plugins=[],e.plot.formatDate=function(e,t,n){var i=function(e){return e=""+e,1==e.length?"0"+e:e},o=[],r=!1,s=!1,a=e.getUTCHours(),l=a<12;null==n&&(n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),-1!=t.search(/%p|%P/)&&(a>12?a-=12:0==a&&(a=12));for(var u=0;u<t.length;++u){var c=t.charAt(u);if(r){switch(c){case"h":c=""+a;break;case"H":c=i(a);break;case"M":c=i(e.getUTCMinutes());break;case"S":c=i(e.getUTCSeconds());break;case"d":c=""+e.getUTCDate();break;case"m":c=""+(e.getUTCMonth()+1);break;case"y":c=""+e.getUTCFullYear();break;case"b":c=""+n[e.getUTCMonth()];break;case"p":c=l?"am":"pm";break;case"P":c=l?"AM":"PM";break;case"0":c="",s=!0}c&&s&&(c=i(c),s=!1),o.push(c),s||(r=!1)}else"%"==c?r=!0:o.push(c)}return o.join("")}}(jQuery),function(e){var t=function(){var t={years:"datepickerViewYears",months:"datepickerViewMonths",days:"datepickerViewDays"},n={wrapper:'<div class="datepicker"><div class="datepickerBorderT" /><div class="datepickerBorderB" /><div class="datepickerBorderL" /><div class="datepickerBorderR" /><div class="datepickerBorderTL" /><div class="datepickerBorderTR" /><div class="datepickerBorderBL" /><div class="datepickerBorderBR" /><div class="datepickerContainer"><table cellspacing="0" cellpadding="0"><tbody><tr></tr></tbody></table></div></div>',head:["<td>",'<table cellspacing="0" cellpadding="0">',"<thead>","<tr>",'<th class="datepickerGoPrev"><a href="#"><span><%=prev%></span></a></th>','<th colspan="5" class="datepickerMonth"><a href="#"><span></span></a></th>','<th class="datepickerGoNext"><a href="#"><span><%=next%></span></a></th>',"</tr>",'<tr class="datepickerDoW">',"<th><span><%=day1%></span></th>","<th><span><%=day2%></span></th>","<th><span><%=day3%></span></th>","<th><span><%=day4%></span></th>","<th><span><%=day5%></span></th>","<th><span><%=day6%></span></th>","<th><span><%=day7%></span></th>","</tr>","</thead>","</table></td>"],space:'<td class="datepickerSpace"><div></div></td>',days:['<tbody class="datepickerDays">',"<tr>",'<td class="<%=weeks[0].days[0].classname%>"><a href="#"><span><%=weeks[0].days[0].text%></span></a></td>','<td class="<%=weeks[0].days[1].classname%>"><a href="#"><span><%=weeks[0].days[1].text%></span></a></td>','<td class="<%=weeks[0].days[2].classname%>"><a href="#"><span><%=weeks[0].days[2].text%></span></a></td>','<td class="<%=weeks[0].days[3].classname%>"><a href="#"><span><%=weeks[0].days[3].text%></span></a></td>','<td class="<%=weeks[0].days[4].classname%>"><a href="#"><span><%=weeks[0].days[4].text%></span></a></td>','<td class="<%=weeks[0].days[5].classname%>"><a href="#"><span><%=weeks[0].days[5].text%></span></a></td>','<td class="<%=weeks[0].days[6].classname%>"><a href="#"><span><%=weeks[0].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[1].days[0].classname%>"><a href="#"><span><%=weeks[1].days[0].text%></span></a></td>','<td class="<%=weeks[1].days[1].classname%>"><a href="#"><span><%=weeks[1].days[1].text%></span></a></td>','<td class="<%=weeks[1].days[2].classname%>"><a href="#"><span><%=weeks[1].days[2].text%></span></a></td>','<td class="<%=weeks[1].days[3].classname%>"><a href="#"><span><%=weeks[1].days[3].text%></span></a></td>','<td class="<%=weeks[1].days[4].classname%>"><a href="#"><span><%=weeks[1].days[4].text%></span></a></td>','<td class="<%=weeks[1].days[5].classname%>"><a href="#"><span><%=weeks[1].days[5].text%></span></a></td>','<td class="<%=weeks[1].days[6].classname%>"><a href="#"><span><%=weeks[1].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[2].days[0].classname%>"><a href="#"><span><%=weeks[2].days[0].text%></span></a></td>','<td class="<%=weeks[2].days[1].classname%>"><a href="#"><span><%=weeks[2].days[1].text%></span></a></td>','<td class="<%=weeks[2].days[2].classname%>"><a href="#"><span><%=weeks[2].days[2].text%></span></a></td>','<td class="<%=weeks[2].days[3].classname%>"><a href="#"><span><%=weeks[2].days[3].text%></span></a></td>','<td class="<%=weeks[2].days[4].classname%>"><a href="#"><span><%=weeks[2].days[4].text%></span></a></td>','<td class="<%=weeks[2].days[5].classname%>"><a href="#"><span><%=weeks[2].days[5].text%></span></a></td>','<td class="<%=weeks[2].days[6].classname%>"><a href="#"><span><%=weeks[2].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[3].days[0].classname%>"><a href="#"><span><%=weeks[3].days[0].text%></span></a></td>','<td class="<%=weeks[3].days[1].classname%>"><a href="#"><span><%=weeks[3].days[1].text%></span></a></td>','<td class="<%=weeks[3].days[2].classname%>"><a href="#"><span><%=weeks[3].days[2].text%></span></a></td>','<td class="<%=weeks[3].days[3].classname%>"><a href="#"><span><%=weeks[3].days[3].text%></span></a></td>','<td class="<%=weeks[3].days[4].classname%>"><a href="#"><span><%=weeks[3].days[4].text%></span></a></td>','<td class="<%=weeks[3].days[5].classname%>"><a href="#"><span><%=weeks[3].days[5].text%></span></a></td>','<td class="<%=weeks[3].days[6].classname%>"><a href="#"><span><%=weeks[3].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[4].days[0].classname%>"><a href="#"><span><%=weeks[4].days[0].text%></span></a></td>','<td class="<%=weeks[4].days[1].classname%>"><a href="#"><span><%=weeks[4].days[1].text%></span></a></td>','<td class="<%=weeks[4].days[2].classname%>"><a href="#"><span><%=weeks[4].days[2].text%></span></a></td>','<td class="<%=weeks[4].days[3].classname%>"><a href="#"><span><%=weeks[4].days[3].text%></span></a></td>','<td class="<%=weeks[4].days[4].classname%>"><a href="#"><span><%=weeks[4].days[4].text%></span></a></td>','<td class="<%=weeks[4].days[5].classname%>"><a href="#"><span><%=weeks[4].days[5].text%></span></a></td>','<td class="<%=weeks[4].days[6].classname%>"><a href="#"><span><%=weeks[4].days[6].text%></span></a></td>',"</tr>","<tr>",'<td class="<%=weeks[5].days[0].classname%>"><a href="#"><span><%=weeks[5].days[0].text%></span></a></td>','<td class="<%=weeks[5].days[1].classname%>"><a href="#"><span><%=weeks[5].days[1].text%></span></a></td>','<td class="<%=weeks[5].days[2].classname%>"><a href="#"><span><%=weeks[5].days[2].text%></span></a></td>','<td class="<%=weeks[5].days[3].classname%>"><a href="#"><span><%=weeks[5].days[3].text%></span></a></td>','<td class="<%=weeks[5].days[4].classname%>"><a href="#"><span><%=weeks[5].days[4].text%></span></a></td>','<td class="<%=weeks[5].days[5].classname%>"><a href="#"><span><%=weeks[5].days[5].text%></span></a></td>','<td class="<%=weeks[5].days[6].classname%>"><a href="#"><span><%=weeks[5].days[6].text%></span></a></td>',"</tr>","</tbody>"],months:['<tbody class="<%=className%>">',"<tr>",'<td colspan="2"><a href="#"><span><%=data[0]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[1]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[2]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[3]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[4]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[5]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[6]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[7]%></span></a></td>',"</tr>","<tr>",'<td colspan="2"><a href="#"><span><%=data[8]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[9]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[10]%></span></a></td>','<td colspan="2"><a href="#"><span><%=data[11]%></span></a></td>',"</tr>","</tbody>"]},i={flat:!1,starts:1,prev:"&#9664;",next:"&#9654;",lastSel:!1,mode:"single",view:"days",calendars:1,format:"Y-m-d",position:"bottom",eventName:"click",onRender:function(){return{}},onChange:function(){return!0},onShow:function(){return!0},onBeforeShow:function(){return!0},onHide:function(){return!0},showWeeks:!1,locale:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekMin:"wk"}},o=function(t){var i,o,r,a,l,u,c,d,h,p=e(t).data("datepicker"),f=e(t),m=Math.floor(p.calendars/2),g=0;f.find("td>table tbody").remove();for(var v=0;v<p.calendars;v++){switch(i=new Date(p.current),i.addMonths(-m+v),h=f.find("table").eq(v+1),h[0].className){case"datepickerViewDays":r=s(i,"B, Y");break;case"datepickerViewMonths":r=i.getFullYear();break;case"datepickerViewYears":r=i.getFullYear()-6+" - "+(i.getFullYear()+5)}h.find("thead tr:first th:eq(1) span").text(r),r=i.getFullYear()-6,o={data:[],className:"datepickerYears"};for(var _=0;_<12;_++)o.data.push(r+_);d=tmpl(n.months.join(""),o),i.setDate(1),o={weeks:[],test:10},a=i.getMonth();var r=(i.getDay()-p.starts)%7;for(i.addDays(-(r+(r<0?7:0))),l=-1,g=0;g<42;){u=parseInt(g/7,10),c=g%7,o.weeks[u]||(l=i.getWeekNumber(),o.weeks[u]={week:l,days:[]}),o.weeks[u].days[c]={text:i.getDate(),classname:[]},a!=i.getMonth()&&o.weeks[u].days[c].classname.push("datepickerNotInMonth"),0==i.getDay()&&o.weeks[u].days[c].classname.push("datepickerSunday"),6==i.getDay()&&o.weeks[u].days[c].classname.push("datepickerSaturday");var C=p.onRender(i),P=i.valueOf();(C.selected||p.date==P||e.inArray(P,p.date)>-1||"range"==p.mode&&P>=p.date[0]&&P<=p.date[1])&&o.weeks[u].days[c].classname.push("datepickerSelected"),C.disabled&&o.weeks[u].days[c].classname.push("datepickerDisabled"),C.className&&o.weeks[u].days[c].classname.push(C.className),o.weeks[u].days[c].classname=o.weeks[u].days[c].classname.join(" "),g++,i.addDays(1)}d=tmpl(n.days.join(""),o)+d,o={data:p.locale.monthsShort,className:"datepickerMonths"},d=tmpl(n.months.join(""),o)+d,h.append(d)}},r=function(e,t){if(e.constructor==Date)return new Date(e);for(var n,i,o,r,s,a=e.split(/\W+/),l=t.split(/\W+/),u=new Date,c=0;c<a.length;c++)switch(l[c]){case"d":case"e":n=parseInt(a[c],10);break;case"m":i=parseInt(a[c],10)-1;break;case"Y":case"y":o=parseInt(a[c],10),o+=o>100?0:o<29?2e3:1900;break;case"H":case"I":case"k":case"l":r=parseInt(a[c],10);break;case"P":case"p":/pm/i.test(a[c])&&r<12?r+=12:/am/i.test(a[c])&&r>=12&&(r-=12);break;case"M":s=parseInt(a[c],10)}return new Date(void 0===o?u.getFullYear():o,void 0===i?u.getMonth():i,void 0===n?u.getDate():n,void 0===r?u.getHours():r,void 0===s?u.getMinutes():s,0)},s=function(e,t){var n=e.getMonth(),i=e.getDate(),o=e.getFullYear();e.getWeekNumber();var r=e.getDay(),s=e.getHours(),a=s>=12,l=a?s-12:s,u=e.getDayOfYear();0==l&&(l=12);for(var c,d=e.getMinutes(),h=e.getSeconds(),p=t.split(""),f=0;f<p.length;f++){switch(c=p[f],p[f]){case"a":c=e.getDayName();break;case"A":c=e.getDayName(!0);break;case"b":c=e.getMonthName();break;case"B":c=e.getMonthName(!0);break;case"C":c=1+Math.floor(o/100);break;case"d":c=i<10?"0"+i:i;break;case"e":c=i;break;case"H":c=s<10?"0"+s:s;break;case"I":c=l<10?"0"+l:l;break;case"j":c=u<100?u<10?"00"+u:"0"+u:u;break;case"k":c=s;break;case"l":c=l;break;case"m":c=n<9?"0"+(1+n):1+n;break;case"M":c=d<10?"0"+d:d;break;case"p":case"P":c=a?"PM":"AM";break;case"s":c=Math.floor(e.getTime()/1e3);break;case"S":c=h<10?"0"+h:h;break;case"u":c=r+1;break;case"w":c=r;break;case"y":c=(""+o).substr(2,2);break;case"Y":c=o}p[f]=c}return p.join("")},a=function(e){Date.prototype.tempDate||(Date.prototype.tempDate=null,Date.prototype.months=e.months,Date.prototype.monthsShort=e.monthsShort,Date.prototype.days=e.days,Date.prototype.daysShort=e.daysShort,Date.prototype.getMonthName=function(e){return this[e?"months":"monthsShort"][this.getUTCMonth()]},Date.prototype.getDayName=function(e){return this[e?"days":"daysShort"][this.getUTCDay()]},Date.prototype.addDays=function(e){this.setDate(this.getDate()+e),this.tempDate=this.getDate()},Date.prototype.addMonths=function(e){null==this.tempDate&&(this.tempDate=this.getDate()),this.setDate(1),this.setMonth(this.getMonth()+e),this.setDate(Math.min(this.tempDate,this.getMaxDays()))},Date.prototype.addYears=function(e){null==this.tempDate&&(this.tempDate=this.getDate()),this.setDate(1),this.setFullYear(this.getFullYear()+e),this.setDate(Math.min(this.tempDate,this.getMaxDays()))},Date.prototype.getMaxDays=function(){var e,t=new Date(Date.parse(this)),n=28;for(e=t.getMonth(),n=28;t.getMonth()==e;)n++,t.setDate(n);return n-1},Date.prototype.getFirstDay=function(){var e=new Date(Date.parse(this));return e.setDate(1),e.getDay()},Date.prototype.getWeekNumber=function(){var e=new Date(this);e.setDate(e.getDate()-(e.getDay()+6)%7+3);var t=e.valueOf();return e.setMonth(0),e.setDate(4),Math.round((t-e.valueOf())/6048e5)+1},Date.prototype.getDayOfYear=function(){var e=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0),t=new Date(this.getFullYear(),0,0,0,0,0),n=e-t;return Math.floor(1e3*60*60*(n/24))})},l=function(t){var n=e(t).data("datepicker"),i=e("#"+n.id);if(!n.extraHeight){var o=e(t).find("div");n.extraHeight=o.get(0).offsetHeight+o.get(1).offsetHeight,n.extraWidth=o.get(2).offsetWidth+o.get(3).offsetWidth}var r=i.find("table:first").get(0),s=r.offsetWidth,a=r.offsetHeight;i.css({width:s+n.extraWidth+"px",height:a+n.extraHeight+"px"}).find("div.datepickerContainer").css({width:s+"px",height:a+"px"})
},u=function(t){e(t.target).is("span")&&(t.target=t.target.parentNode);var n=e(t.target);if(n.is("a")){if(t.target.blur(),n.hasClass("datepickerDisabled"))return!1;var i=e(this).data("datepicker"),r=n.parent(),s=r.parent().parent().parent(),a=e("table",this).index(s.get(0))-1,l=new Date(i.current),u=!1,d=!1;if(r.is("th"))if(r.hasClass("datepickerWeek")&&"range"==i.mode&&!r.next().hasClass("datepickerDisabled")){var h=parseInt(r.next().text(),10);l.addMonths(a-Math.floor(i.calendars/2)),r.next().hasClass("datepickerNotInMonth")&&l.addMonths(h>15?-1:1),l.setDate(h),i.date[0]=l.setHours(0,0,0,0).valueOf(),l.setHours(23,59,59,0),l.addDays(6),i.date[1]=l.valueOf(),d=!0,u=!0,i.lastSel=!1}else{if(r.hasClass("datepickerMonth"))return!1;if(r.parent().parent().is("thead")){var p=new Date(i.current);switch(s.get(0).className){case"datepickerViewDays":p.addMonths(r.hasClass("datepickerGoPrev")?-1:1);break;case"datepickerViewMonths":p.addYears(r.hasClass("datepickerGoPrev")?-1:1);break;case"datepickerViewYears":p.addYears(r.hasClass("datepickerGoPrev")?-12:12)}i.onRender(p).disabled!==!0&&(i.current=p),d=!0}}else if(r.is("td")&&!r.hasClass("datepickerDisabled")){switch(s.get(0).className){case"datepickerViewMonths":i.current.setMonth(s.find("tbody.datepickerMonths td").index(r)),i.current.setFullYear(parseInt(s.find("thead th.datepickerMonth span").text(),10)),i.current.addMonths(Math.floor(i.calendars/2)-a),s.get(0).className="datepickerViewDays";break;case"datepickerViewYears":i.current.setFullYear(parseInt(n.text(),10)),s.get(0).className="datepickerViewMonths";break;default:var h=parseInt(n.text(),10);switch(l.addMonths(a-Math.floor(i.calendars/2)),r.hasClass("datepickerNotInMonth")&&l.addMonths(h>15?-1:1),l.setDate(h),i.mode){case"multiple":h=l.setHours(0,0,0,0).valueOf(),e.inArray(h,i.date)>-1?e.each(i.date,function(e,t){return t==h?(i.date.splice(e,1),!1):void 0}):i.date.push(h);break;case"range":i.lastSel||(i.date[0]=l.setHours(0,0,0,0).valueOf()),h=l.setHours(23,59,59,0).valueOf(),h<i.date[0]?(i.date[1]=i.date[0]+86399e3,i.date[0]=h-86399e3):i.date[1]=h,i.lastSel=!i.lastSel;break;default:i.date=l.valueOf()}}d=!0,u=!0}d&&o(this),u&&i.onChange.apply(this,c(i))}return!1},c=function(t){var n;return"single"==t.mode?(n=new Date(t.date),[s(n,t.format),n,t.el]):(n=[[],[],t.el],e.each(t.date,function(e,i){var o=new Date(i);n[0].push(s(o,t.format)),n[1].push(o)}),n)},d=function(){var e="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(e?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(e?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(e?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(e?document.documentElement.clientHeight:document.body.clientHeight)}},h=function(e,t,n){if(e==t)return!0;if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return!!(16&e.compareDocumentPosition(t));for(var i=t.parentNode;i&&i!=n;){if(i==e)return!0;i=i.parentNode}return!1},p=function(){var t=e("#"+e(this).data("datepickerId"));if(!t.is(":visible")){var n=t.get(0);o(n);var i=t.data("datepicker");i.onBeforeShow.apply(this,[t.get(0)]);var r=e(this).offset(),s=d(),a=r.top,u=r.left;switch(e.curCSS(n,"display"),t.css({visibility:"hidden",display:"block"}),l(n),i.position){case"top":a-=n.offsetHeight;break;case"left":u-=n.offsetWidth;break;case"right":u+=this.offsetWidth;break;case"bottom":a+=this.offsetHeight}a+n.offsetHeight>s.t+s.h&&(a=r.top-n.offsetHeight),a<s.t&&(a=r.top+this.offsetHeight+n.offsetHeight),u+n.offsetWidth>s.l+s.w&&(u=r.left-n.offsetWidth),u<s.l&&(u=r.left+this.offsetWidth),t.css({visibility:"visible",display:"block",top:a+"px",left:u+"px"}),0!=i.onShow.apply(this,[t.get(0)])&&t.show(),e(document).bind("mousedown",{cal:t,trigger:this},f)}return!1},f=function(t){t.target==t.data.trigger||h(t.data.cal.get(0),t.target,t.data.cal.get(0))||(0!=t.data.cal.data("datepicker").onHide.apply(this,[t.data.cal.get(0)])&&t.data.cal.hide(),e(document).unbind("mousedown",f))};return{init:function(s){return s=e.extend({},i,s||{}),a(s.locale),s.calendars=Math.max(1,parseInt(s.calendars,10)||1),s.mode=/single|multiple|range/.test(s.mode)?s.mode:"single",this.each(function(){if(!e(this).data("datepicker")){if(s.el=this,s.date.constructor==String&&(s.date=r(s.date,s.format),s.date.setHours(0,0,0,0)),"single"!=s.mode)if(s.date.constructor!=Array)s.date=[s.date.valueOf()],"range"==s.mode&&s.date.push(new Date(s.date[0]).setHours(23,59,59,0).valueOf());else{for(var i=0;i<s.date.length;i++)s.date[i]=r(s.date[i],s.format).setHours(0,0,0,0).valueOf();"range"==s.mode&&(s.date[1]=new Date(s.date[1]).setHours(23,59,59,0).valueOf())}else s.date=s.date.valueOf();s.current=s.current?r(s.current,s.format):new Date,s.current.setDate(1),s.current.setHours(0,0,0,0);var a,c="datepicker_"+parseInt(1e3*Math.random());s.id=c,e(this).data("datepickerId",s.id);var d=e(n.wrapper).attr("id",c).bind("click",u).data("datepicker",s);s.className&&d.addClass(s.className);for(var h="",i=0;i<s.calendars;i++)a=s.starts,i>0&&(h+=n.space),h+=tmpl(n.head.join(""),{week:s.locale.weekMin,prev:s.prev,next:s.next,day1:s.locale.daysMin[a++%7],day2:s.locale.daysMin[a++%7],day3:s.locale.daysMin[a++%7],day4:s.locale.daysMin[a++%7],day5:s.locale.daysMin[a++%7],day6:s.locale.daysMin[a++%7],day7:s.locale.daysMin[a++%7]});d.find("tr:first").append(h).find("table").addClass(t[s.view]),o(d.get(0)),s.flat?(d.appendTo(this).show().css("position","relative"),l(d.get(0))):(d.appendTo(document.body),e(this).bind(s.eventName,p))}})},showPicker:function(){return this.each(function(){e(this).data("datepickerId")&&p.apply(this)})},hidePicker:function(){return this.each(function(){e(this).data("datepickerId")&&e("#"+e(this).data("datepickerId")).hide()})},setDate:function(t,n){return this.each(function(){if(e(this).data("datepickerId")){var i=e("#"+e(this).data("datepickerId")),s=i.data("datepicker");if(s.date=t,s.date.constructor==String&&(s.date=r(s.date,s.format),s.date.setHours(0,0,0,0)),"single"!=s.mode)if(s.date.constructor!=Array)s.date=[s.date.valueOf()],"range"==s.mode&&s.date.push(new Date(s.date[0]).setHours(23,59,59,0).valueOf());else{for(var a=0;a<s.date.length;a++)s.date[a]=r(s.date[a],s.format).setHours(0,0,0,0).valueOf();"range"==s.mode&&(s.date[1]=new Date(s.date[1]).setHours(23,59,59,0).valueOf())}else s.date=s.date.valueOf();n&&(s.current=new Date("single"!=s.mode?s.date[0]:s.date)),o(i.get(0))}})},getDate:function(t){return this.size()>0?c(e("#"+e(this).data("datepickerId")).data("datepicker"))[t?0:1]:void 0},clear:function(){return this.each(function(){if(e(this).data("datepickerId")){var t=e("#"+e(this).data("datepickerId")),n=t.data("datepicker");"single"!=n.mode&&(n.date=[],o(t.get(0)))}})},fixLayout:function(){return this.each(function(){if(e(this).data("datepickerId")){var t=e("#"+e(this).data("datepickerId")),n=t.data("datepicker");n.flat&&l(t.get(0))}})}}}();e.fn.extend({DatePicker:t.init,DatePickerHide:t.hidePicker,DatePickerShow:t.showPicker,DatePickerSetDate:t.setDate,DatePickerGetDate:t.getDate,DatePickerClear:t.clear,DatePickerLayout:t.fixLayout})}(jQuery),function(){var e={};this.tmpl=function t(n,i){var o=/\W/.test(n)?Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+n.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):e[n]=e[n]||t(document.getElementById(n).innerHTML);return i?o(i):o}}(),function(e){var t=window.EYE=function(){var t={init:[]};return{init:function(){e.each(t.init,function(e,t){t.call()})},extend:function(e){for(var t in e)void 0!=e[t]&&(this[t]=e[t])},register:function(e,n){t[n]||(t[n]=[]),t[n].push(e)}}}();e(t.init)}(jQuery),function(e){EYE.extend({getPosition:function(e,t){var n=0,i=0,o=e.style,r=!1;if(t&&"none"==jQuery.curCSS(e,"display")){var s=o.visibility,a=o.position;r=!0,o.visibility="hidden",o.display="block",o.position="absolute"}var l=e;if(l.getBoundingClientRect){var u=l.getBoundingClientRect();n=u.left+Math.max(document.documentElement.scrollLeft,document.body.scrollLeft)-2,i=u.top+Math.max(document.documentElement.scrollTop,document.body.scrollTop)-2}else{if(n=l.offsetLeft,i=l.offsetTop,l=l.offsetParent,e!=l)for(;l;)n+=l.offsetLeft,i+=l.offsetTop,l=l.offsetParent;for(jQuery.browser.safari&&"absolute"==jQuery.curCSS(e,"position")&&(n-=document.body.offsetLeft,i-=document.body.offsetTop),l=e.parentNode;l&&"BODY"!=l.tagName.toUpperCase()&&"HTML"!=l.tagName.toUpperCase();)"inline"!=jQuery.curCSS(l,"display")&&(n-=l.scrollLeft,i-=l.scrollTop),l=l.parentNode}return 1==r&&(o.display="none",o.position=a,o.visibility=s),{x:n,y:i}},getSize:function(e){var t=parseInt(jQuery.curCSS(e,"width"),10),n=parseInt(jQuery.curCSS(e,"height"),10),i=0,o=0;if("none"!=jQuery.curCSS(e,"display"))i=e.offsetWidth,o=e.offsetHeight;else{var r=e.style,s=r.visibility,a=r.position;r.visibility="hidden",r.display="block",r.position="absolute",i=e.offsetWidth,o=e.offsetHeight,r.display="none",r.position=a,r.visibility=s}return{w:t,h:n,wb:i,hb:o}},getClient:function(e){var t,n;if(e)n=e.clientWidth,t=e.clientHeight;else{var i=document.documentElement;n=window.innerWidth||self.innerWidth||i&&i.clientWidth||document.body.clientWidth,t=window.innerHeight||self.innerHeight||i&&i.clientHeight||document.body.clientHeight}return{w:n,h:t}},getScroll:function(e){var t=0,n=0,i=0,o=0,r=0,s=0;return e&&"body"!=e.nodeName.toLowerCase()?(t=e.scrollTop,n=e.scrollLeft,i=e.scrollWidth,o=e.scrollHeight):(document.documentElement?(t=document.documentElement.scrollTop,n=document.documentElement.scrollLeft,i=document.documentElement.scrollWidth,o=document.documentElement.scrollHeight):document.body&&(t=document.body.scrollTop,n=document.body.scrollLeft,i=document.body.scrollWidth,o=document.body.scrollHeight),"undefined"!=typeof pageYOffset&&(t=pageYOffset,n=pageXOffset),r=self.innerWidth||document.documentElement.clientWidth||document.body.clientWidth||0,s=self.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0),{t:t,l:n,w:i,h:o,iw:r,ih:s}},getMargins:function(e,t){var n=jQuery.curCSS(e,"marginTop")||"",i=jQuery.curCSS(e,"marginRight")||"",o=jQuery.curCSS(e,"marginBottom")||"",r=jQuery.curCSS(e,"marginLeft")||"";return t?{t:parseInt(n,10)||0,r:parseInt(i,10)||0,b:parseInt(o,10)||0,l:parseInt(r,10)}:{t:n,r:i,b:o,l:r}},getPadding:function(e,t){var n=jQuery.curCSS(e,"paddingTop")||"",i=jQuery.curCSS(e,"paddingRight")||"",o=jQuery.curCSS(e,"paddingBottom")||"",r=jQuery.curCSS(e,"paddingLeft")||"";return t?{t:parseInt(n,10)||0,r:parseInt(i,10)||0,b:parseInt(o,10)||0,l:parseInt(r,10)}:{t:n,r:i,b:o,l:r}},getBorder:function(e,t){var n=jQuery.curCSS(e,"borderTopWidth")||"",i=jQuery.curCSS(e,"borderRightWidth")||"",o=jQuery.curCSS(e,"borderBottomWidth")||"",r=jQuery.curCSS(e,"borderLeftWidth")||"";return t?{t:parseInt(n,10)||0,r:parseInt(i,10)||0,b:parseInt(o,10)||0,l:parseInt(r,10)||0}:{t:n,r:i,b:o,l:r}},traverseDOM:function(e,t){for(t(e),e=e.firstChild;e;)EYE.traverseDOM(e,t),e=e.nextSibling},getInnerWidth:function(e,t){var n=e.offsetWidth;return t?Math.max(e.scrollWidth,n)-n+e.clientWidth:e.clientWidth},getInnerHeight:function(e,t){var n=e.offsetHeight;return t?Math.max(e.scrollHeight,n)-n+e.clientHeight:e.clientHeight},getExtraWidth:function(t){return e.boxModel?(parseInt(e.curCSS(t,"paddingLeft"))||0)+(parseInt(e.curCSS(t,"paddingRight"))||0)+(parseInt(e.curCSS(t,"borderLeftWidth"))||0)+(parseInt(e.curCSS(t,"borderRightWidth"))||0):0},getExtraHeight:function(t){return e.boxModel?(parseInt(e.curCSS(t,"paddingTop"))||0)+(parseInt(e.curCSS(t,"paddingBottom"))||0)+(parseInt(e.curCSS(t,"borderTopWidth"))||0)+(parseInt(e.curCSS(t,"borderBottomWidth"))||0):0},isChildOf:function(t,n,i){if(t==n)return!0;if(!n||!n.nodeType||1!=n.nodeType)return!1;if(t.contains&&!e.browser.safari)return t.contains(n);if(t.compareDocumentPosition)return!!(16&t.compareDocumentPosition(n));for(var o=n.parentNode;o&&o!=i;){if(o==t)return!0;o=o.parentNode}return!1},centerEl:function(t,n){var i=EYE.getScroll(),o=EYE.getSize(t);n&&"vertically"!=n||e(t).css({top:i.t+(Math.min(i.h,i.ih)-o.hb)/2+"px"}),n&&"horizontally"!=n||e(t).css({left:i.l+(Math.min(i.w,i.iw)-o.wb)/2+"px"})}}),e.easing.easeout||(e.easing.easeout=function(e,t,n,i,o){return-i*((t=t/o-1)*t*t*t-1)+n})}(jQuery),function(e){var t=function(){var t=window.location.hash.replace("#",""),i=e("ul.navigationTabs a").bind("click",n).filter("a[rel="+t+"]");0==i.size()&&(i=e("ul.navigationTabs a:first")),n.apply(i.get(0)),e("#date").DatePicker({flat:!0,date:"2008-07-31",current:"2008-07-31",calendars:1,starts:1,view:"years"});var o=new Date;o.addDays(-10);var r=new Date;r.addDays(-5),r.setHours(0,0,0,0),e("#date2").DatePicker({flat:!0,date:["2008-07-31","2008-07-28"],current:"2008-07-31",format:"Y-m-d",calendars:1,mode:"multiple",onRender:function(e){return{disabled:e.valueOf()<o.valueOf(),className:e.valueOf()==r.valueOf()?"datepickerSpecial":!1}},onChange:function(){},starts:0}),e("#clearSelection").bind("click",function(){return e("#date3").DatePickerClear(),!1}),e("#date3").DatePicker({flat:!0,date:["2009-12-28","2010-01-23"],current:"2010-01-01",calendars:3,mode:"range",starts:1}),e(".inputDate").DatePicker({format:"m/d/Y",date:e("#inputDate").val(),current:e("#inputDate").val(),starts:1,position:"right",onBeforeShow:function(){e("#inputDate").DatePickerSetDate(e("#inputDate").val(),!0)},onChange:function(t){e("#inputDate").val(t),e("#closeOnSelect input").attr("checked")&&e("#inputDate").DatePickerHide()}});var s=new Date;s.addDays(-4);var a=new Date;e("#widgetCalendar").DatePicker({flat:!0,format:"d B, Y",date:[new Date(s),new Date(a)],calendars:3,mode:"range",starts:1,onChange:function(t){e("#widgetField span").get(0).innerHTML=t.join(" &divide; ")}});var l=!1;e("#widgetField>a").bind("click",function(){return e("#widgetCalendar").stop().animate({height:l?0:e("#widgetCalendar div.datepicker").get(0).offsetHeight},500),l=!l,!1}),e("#widgetCalendar div.datepicker").css("position","absolute")},n=function(){var t=e("ul.navigationTabs a").removeClass("active").index(this);e(this).addClass("active").blur(),e("div.tab").hide().eq(t).show()};EYE.register(t,"init")}(jQuery);var window_lib=window.jQuery?jQuery:Zepto;(function(e){e.fn.passStrength=function(t,n,i,o){return this.each(function(){var r=e(this);e(r).unbind().bind("keyup blur",function(){if(null!==e(this).val()){var r=e.fn.teststrength(e(this).val(),o,i);r[2]?(t.attr("disabled","disabled"),t.addClass("disabled")):(t.removeAttr("disabled"),t.removeClass("disabled")),n.html(r[0]),n.removeClass(o.badPassStyle),n.removeClass(o.goodPassStyle),n.removeClass(o.strongPassStyle),n.addClass(r[1])}})})},e.fn.teststrength=function(t,n,i){var o=0;return t.length<6?[n.shortPassStr,n.badPassStyle,1]:n.userid.length>0&&t.toLowerCase()==n.userid.toLowerCase()?[n.samePasswordStr,n.badPassStyle,1]:e.inArray(t.toLowerCase(),i)>-1?[n.blackPassStr,n.badPassStyle,1]:(o+=2*t.length,o+=3*e.fn.uniqueCharacters(t),t.match(/(.*[0-9].*[0-9].*[0-9])/)&&(o+=15),t.match(/(.*[!,@,#,$,%,\^,&,*,?,_,~].*[!,@,#,$,%,\^,&,*,?,_,~])/)&&(o+=15),t.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(o+=10),t.match(/([a-zA-Z])/)&&t.match(/([0-9])/)&&(o+=15),t.match(/([!,@,#,$,%,\^,&,*,?,_,~])/)&&t.match(/([0-9])/)&&(o+=15),t.match(/([!,@,#,$,%,\^,&,*,?,_,~])/)&&t.match(/([a-zA-Z])/)&&(o+=15),(t.match(/^[a-z]+$/)||t.match(/^[A-Z]+$/)||t.match(/^\d+$/))&&(o-=10),o<34?[n.badPassStr,n.badPassStyle,0]:o<68?[n.goodPassStr,n.goodPassStyle,0]:[n.strongPassStr,n.strongPassStyle,0])}})(window_lib),$.fn.uniqueCharacters=function(e){for(var t={},n=0,i=0;i<e.length;i++)e.charAt(i)in t||(t[e.charAt(i)]=!0,n++);return n},function(){window.P||(window.P={e:{}}),P.NOOP=function(){},P.state={},P.Mixins={},P.app=null,P.getCSRFToken=function(){return Cookie.get("csrftoken")},$("html").ajaxSend(function(e,t){t.setRequestHeader("X-CSRFToken",P.getCSRFToken()),t.setRequestHeader("X-NEW-APP","1")}),P.start=function(e){P.Viewport.init(),P.Loader.require([e.name],function(t){P.app=new t({parent:null,el:$("#"+e.uid),children:e.children,options:e.options,resource:e.resource,deps:e.deps,data:e.data,error:e.error})})}}(),function(){P.CONST={SUBDOMAIN_PREFIXES:{developers:"/developer"},NOTIFICATIONS_POLL:45e3,UPDATES_MIN_POLL:45e3,UPDATES_MAX_POLL:9e5,BOARD_PRIVACY_SECRET:"secret",MAX_SECRET_BOARDS:3,CLASS_DROPDOWN_BUTTON_ACTIVE:"active",COOKIE_FB_AUTO_LOGIN_DISABLED:"fba",COOKIE_LOCAL_STORAGE:"ls",COOKIE_SESSION_STORAGE:"ss",COOKIE_SHOW_WELCOME:"d_welcome",COOKIE_USE_DENZEL:"_in_d",COOKIE_NAG_LANGUAGE:"nl",SESSION_FACEBOOK_ID:"_fbid",SESSION_FACEBOOK_TOKEN:"_fbt",SESSION_KEY_INVITE_FOLLOW:"d_pif_invite",EVENT_BOARD_SELECTED:"boardSelected",EVENT_BODY_COLUMN_CHANGE:"bodyColumnChange",EVENT_BUTTON_CLICK:"buttonClick",EVENT_CHANGE:"change",EVENT_CLOSE:"close",EVENT_CONFIRM:"confirm",EVENT_CONTENT_CHANGED:"contentChanged",EVENT_DATA:"data",EVENT_DATEPICKER_DATE_SELECTED:"datePickerDateSelected",EVENT_DATEPICKER_RANGE_SELECTED:"datePickerRangeSelected",EVENT_DESTROYED:"destroyed",EVENT_DIMS_CHANGED:"dimsChanged",EVENT_DISMISS:"dismiss",EVENT_DROPDOWN_HIDE:"dropdownHide",EVENT_DROPDOWN_SHOW:"dropdownShow",EVENT_ERROR:"error",EVENT_ERROR_RESOLVED:"errorResolved",EVENT_EXTERNAL_CLICK:"externalLinkClicked",EVENT_BOARD_FOLLOW:"boardFollowed",EVENT_BOARD_UNFOLLOW:"boardUnfollowed",EVENT_FAST_FOLLOW_CATEGORY_SELECTED:"followpageCategorySelected",EVENT_HOVERINTENT_ENTER_COMPLETE:"mouseEnterComplete",EVENT_HOVERINTENT_ENTER_START:"mouseEnterStart",EVENT_HOVERINTENT_OUT_COMPLETE:"mouseOutComplete",EVENT_HOVERINTENT_OUT_START:"mouseOutStart",EVENT_INCREMENT_BUTTON_CREATE:"incrementButtonCreate",EVENT_INCREMENT_BUTTON_DESTROY:"incrementButtonDestroy",EVENT_INVITE_EMAIL:"inviteEmail",EVENT_INVITE_USER:"inviteUser",EVENT_ITEM_HIGHLIGHTED:"itemHighlighted",EVENT_ITEM_SELECTED:"itemSelected",EVENT_ITEMS_END:"itemsEnd",EVENT_ITEMS_REQUEST_START:"itemsRequestStart",EVENT_ITEMS_REQUEST_SUCCESS:"itemsRequestSuccess",EVENT_LAZY_IMAGE_COMPLETE:"lazyImageComplete",EVENT_NAVIGATE:"navigate",EVENT_NEXT:"next",EVENT_OPEN:"open",EVENT_PIN_CREATE:"pinCreate",EVENT_PIN_CREATE_OPENED:"pinCreateOpened",EVENT_PIN_LIKED:"pinLiked",EVENT_PIN_UNLIKED:"pinUnliked",EVENT_PIN_UPDATED:"pinUpdated",EVENT_PREVIOUS:"previous",EVENT_PROGRESS_COMPLETED:"progressCompleted",EVENT_RESIZE:"resize",EVENT_STICKY_FIXED:"stickyUpdate",EVENT_SUBMIT_VALIDATED:"submitValidated",EVENT_TYPEAHEAD_NO_RESULTS_RETURNED:"typeaheadNoResultsReturned",EVENT_TYPEAHEAD_RESULTS_RETURNED:"typeaheadResultsReturned",EVENT_UPLOAD_SUCCESS:"uploadSuccess",EVENT_UPLOAD_START:"uploadStart",EVENT_UPLOAD_ERROR:"uploadError",EVENT_UPLOAD_PROGRESS:"uploadProgress",EVENT_USER_CLICK:"userClick",EVENT_USER_FOLLOW:"userFollow",GA_ACTION_CLICK:"click",GA_ACTION_CLICK_CANCEL:"click_cancel",GA_ACTION_CLICK_CLOSE:"click_close",GA_ACTION_CLICK_CONFIRM:"click_confirm",GA_ACTION_CLICK_SUBMIT:"click_submit",GA_ACTION_ENTER_SUBMIT:"enter_submit",GA_ACTION_ERROR:"error",GA_ACTION_OPEN_MODAL:"open_modal",GA_ACTION_SELECT_SUBMIT:"select_submit",GA_ACTION_SUCCESS:"success",PUBSUB_CHANNEL_ANALYTICS:"analytics",PUBSUB_CHANNEL_CURRENT_USER:"currentUser",PUBSUB_CHANNEL_MAIN_MODULE:"mainModule",PUBSUB_CHANNEL_SITE:"site",PUBSUB_CHANNEL_TUTORIAL:"tutorial",PUBSUB_MESSAGE_BOARD_SET_PUBLIC:"boardSetPublic",PUBSUB_MESSAGE_USER_EMAIL_UPDATED:"userEmailUpdated",PUBSUB_TOPIC_APP_VERSION:"appVersion",PUBSUB_TOPIC_BOARD_APPROVED_COLLABORATOR_INVITE:"boardApprovedCollaboratorInvite",PUBSUB_TOPIC_BOARD_COVER_UPDATED:"boardCoverUpdated",PUBSUB_TOPIC_BOARD_CREATED:"boardCreated",PUBSUB_TOPIC_BOARD_DELETED:"boardDeleted",PUBSUB_TOPIC_BOARD_FOLLOW:"boardFollow",PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF:"boardRemovedCollaboratorSelf",PUBSUB_TOPIC_BOARD_UNFOLLOW:"boardUnfollow",PUBSUB_TOPIC_BOARD_UPDATED:"boardUpdated",PUBSUB_TOPIC_BOARD_WRITE_ACCESS_UPDATED:"boardWriteAccessUpdated",PUBSUB_TOPIC_CONSUMER_UPDATED:"consumerUpdated",PUBSUB_TOPIC_CONSUMER_LIST_UPDATED:"consumerListUpdated",PUBSUB_TOPIC_CURRENT_CATEGORY:"currentCategory",PUBSUB_TOPIC_MAIN_MODULE_NEW:"mainModuleNew",PUBSUB_TOPIC_PAGE_INFO:"pageInfo",PUBSUB_TOPIC_PIN_COMMENT_CREATED:"pinCommentCreated",PUBSUB_TOPIC_PIN_CREATED:"pinCreated",PUBSUB_TOPIC_PIN_DELETED:"pinDeleted",PUBSUB_TOPIC_PIN_LIKED:"pinLiked",PUBSUB_TOPIC_PIN_UNLIKED:"pinUnliked",PUBSUB_TOPIC_PIN_UPDATED:"pinUpdated",PUBSUB_TOPIC_SEARCH_QUERY_UPDATED:"searchQueryUpdated",PUBSUB_TOPIC_SEARCH_SCOPE_UPDATED:"searchScopeUpdated",PUBSUB_TOPIC_SOCIAL_NETWORK_UPDATED:"socialNetworkUpdated",PUBSUB_TOPIC_TIMING_METRICS_EMITTED:"timingMetricsEmitted",PUBSUB_TOPIC_TIMING_TRACE_EMITTED:"timingTraceEmitted",PUBSUB_TOPIC_TUTORIAL_CATEGORIES:"categories",PUBSUB_TOPIC_USER_BLOCKED:"userBlocked",PUBSUB_TOPIC_USER_FOLLOW:"userFollow",PUBSUB_TOPIC_USER_UNBLOCKED:"userUnblocked",PUBSUB_TOPIC_USER_UNFOLLOW:"userUnfollow",PUBSUB_TOPIC_USER_UPDATED:"userUpdated",PUBSUB_TOPIC_USER_CHANGED_PASSWORD:"userChangedPassword",STOPWATCH_SET_AS_MAIN_MODULE_SUCCESS:"setAsMainModule success",MAX_CHARS_FOR_BOARD_TITLE:100,MAX_CHARS_FOR_USER_DESCRIPTION:160,MAX_CHARS_FOR_BOARD_PIN_DESCRIPTION:500,OVERFLOWING_TEXT_OVERFLOWING_CLASS:"overflowing",MIN_PINNABLE_IMAGE_HEIGHT:50,MIN_PINNABLE_IMAGE_WIDTH:100,ErrorStrategy:{SHOW:0,BUBBLE:1,REMOVE:2},PositionMode:{VIEWPORT_MIDDLE:1,ANCHORED:2}};var e,t,n=parseInt("0000000000001",2),i=0;P.CONST.PositionPointFlag={},_.each(["VERTICAL","HORIZONTAL"],function(o){t=0,_.each(["BOTTOM","LEFT","CENTER","RIGHT","TOP"],function(r){e=n<<i++,t|=e,P.CONST.PositionPointFlag["FLAG_"+o+"_"+r]=e}),P.CONST.PositionPointFlag["FLAG_"+o]=t});var o=P.CONST.PositionPointFlag;P.CONST.PositionPoint={BOTTOM_CENTER:o.FLAG_VERTICAL_BOTTOM|o.FLAG_VERTICAL_CENTER,BOTTOM_LEFT:o.FLAG_VERTICAL_BOTTOM|o.FLAG_VERTICAL_LEFT,BOTTOM_RIGHT:o.FLAG_VERTICAL_BOTTOM|o.FLAG_VERTICAL_RIGHT,TOP_CENTER:o.FLAG_VERTICAL_TOP|o.FLAG_VERTICAL_CENTER,TOP_LEFT:o.FLAG_VERTICAL_TOP|o.FLAG_VERTICAL_LEFT,TOP_RIGHT:o.FLAG_VERTICAL_TOP|o.FLAG_VERTICAL_RIGHT,LEFT_BOTTOM:o.FLAG_HORIZONTAL_LEFT|o.FLAG_HORIZONTAL_BOTTOM,LEFT_CENTER:o.FLAG_HORIZONTAL_LEFT|o.FLAG_HORIZONTAL_CENTER,LEFT_TOP:o.FLAG_HORIZONTAL_LEFT|o.FLAG_HORIZONTAL_TOP,RIGHT_BOTTOM:o.FLAG_HORIZONTAL_RIGHT|o.FLAG_HORIZONTAL_BOTTOM,RIGHT_CENTER:o.FLAG_HORIZONTAL_RIGHT|o.FLAG_HORIZONTAL_CENTER,RIGHT_TOP:o.FLAG_HORIZONTAL_RIGHT|o.FLAG_HORIZONTAL_TOP}}(),function(){var e=P.NOOP;_.extend(e.prototype,{length:function(){var e=Cookie.get(P.CONST.COOKIE_SESSION_STORAGE),t=e?JSON.parse(e):{};return _.keys(t).length},key:function(){P.log("ERROR","intentionally unimplemented function")},getItem:function(e){var t=Cookie.get(P.CONST.COOKIE_SESSION_STORAGE),n=t?JSON.parse(t):{};return n[e]},setItem:function(e,t){var n=Cookie.get(P.CONST.COOKIE_SESSION_STORAGE),i=n?JSON.parse(n):{};i[e]=t,Cookie.set(P.CONST.COOKIE_SESSION_STORAGE,JSON.stringify(i))},removeItem:function(e){var t=Cookie.get(P.CONST.COOKIE_SESSION_STORAGE),n=t?JSON.parse(t):{};delete n[e],Cookie.set(P.CONST.COOKIE_SESSION_STORAGE,JSON.stringify(n))},clear:function(){Cookie.unset(P.CONST.COOKIE_SESSION_STORAGE)}});var t=P.NOOP;_.extend(t.prototype,{length:function(){return window.sessionStorage.length},key:function(){P.log("ERROR","intentionally unimplemented function")},getItem:function(e){return JSON.parse(window.sessionStorage.getItem(e))},setItem:function(e,t){window.sessionStorage.setItem(e,JSON.stringify(t))},removeItem:function(e){window.sessionStorage.removeItem(e)},clear:function(){window.sessionStorage.clear()}});var n=P.NOOP;_.extend(n.prototype,{length:function(){return window.localStorage.length},key:function(){P.log("ERROR","intentionally unimplemented function")},getItem:function(e){return JSON.parse(window.localStorage.getItem(e))},setItem:function(e,t){window.localStorage.setItem(e,JSON.stringify(t))},removeItem:function(e){window.localStorage.removeItem(e)},clear:function(){window.localStorage.clear()}});var i=function(i){var o=i?window.sessionStorage:window.localStorage,r=i?P.CONST.COOKIE_SESSION_STORAGE:P.CONST.COOKIE_LOCAL_STORAGE,s=!1,a=o;if(a)try{a.setItem("testing","test"),a.removeItem("testing")}catch(l){if(l.code!==window.DOMException.QUOTA_EXCEEDED_ERR||0!==a.length)throw l;s=!0}else s=!0;return s?new e(r):i?new t:new n};P.SessionStorage=i(!0),P.LocalStorage=i(!1),window.P_TEST_MODE&&(P.CookieBackedStorage=e,P.WindowSessionStorage=t,P.WindowLocalStorage=n,P.FakeStorage=function(){this.len=0,this.storage={}},_.extend(P.FakeStorage.prototype,{length:function(){return this.length},key:function(){P.log("ERROR","intentionally unimplemented function")},getItem:function(e){return this.storage[e]},setItem:function(e,t){this.storage[e]=t},removeItem:function(e){delete this.storage[e]},clear:function(){this.storage.key={}}}))}(),function(){P.Logger=function(e){this.name=e;var t;if(P.DEBUG){var n=P.LocalStorage.getItem(this._getStorageKey());null!==n&&void 0!==n&&(t=parseInt(n,10))}void 0===t&&(t=P.DEBUG?P.Logger.LOG_LEVEL.DEBUG:P.Logger.LOG_LEVEL.NONE),this.setLogLevel(t)};var e=window.navigator.userAgent,t=window.navigator.platform,n=[],i={};_.extend(P.Logger,{LOG_LEVEL:{DEBUG:0,WARN:1,ERROR:2,NONE:3},SERVER_LOG_TYPE:{LOG:"log",ERROR:"error",PAGE_LOAD_METRIC:"page_load_metric",APP_METRIC:"app_metric"},getLogger:function(e){var t=i[e];return t||(t=new P.Logger(e),n.push(t),i[e]=t),t},getAll:function(){return n},getByName:function(e){return i[e]}}),window.P_TEST_MODE&&(P.Logger.clear=function(){n=[],i={}}),_.extend(P.Logger.prototype,{debug:function(){var e=_.toArray(arguments);this._addLogName(e),this._printToConsole(P.Logger.LOG_LEVEL.DEBUG,e)},warn:function(){var e=_.toArray(arguments);this._addLogName(e),this._printToConsole(P.Logger.LOG_LEVEL.WARN,e)},error:function(){var e=_.toArray(arguments);this._addLogName(e),this._printToConsole(P.Logger.LOG_LEVEL.ERROR,e);var t=e.shift(),n={message:t,messages:e};this.logToServer(P.Logger.SERVER_LOG_TYPE.ERROR,"post",n)},setLogLevel:function(e){this.logLevel=e,P.DEBUG&&P.LocalStorage.setItem(this._getStorageKey(),e)},_getStorageKey:function(){return"logLevel."+this.name},_addLogName:function(e){e[0]=this.name+": "+e[0]},_printToConsole:function(e,t){var n=window.console||null;if(n&&!(this.logLevel>e)){var i;e===P.Logger.LOG_LEVEL.ERROR&&n.error?i=n.error:e===P.Logger.LOG_LEVEL.WARN&&n.warn?i=n.warn:n.log&&(i=n.log),i&&Function.prototype.apply.apply(i,[n,t])}},logToServer:function(n,i,o){var r="/_/_/report/"+n+"/",s={app_version:P.AppVersion.currentVersion,source_url:P.getCurrentUrl(),user_agent:e,platform:t,app_invalid:P.AppVersion.invalid};P.state.activeTarget&&(s.active_target=P.state.activeTarget.getFullName());var a=_.extend(s,o),l=function(){var e={message:"Failed to log error!",method:i};$.post("/_/_/report/error/",e)};if("get"===i){var u={data:JSON.stringify(a)};$.get(r,u).fail(l)}else $.post(r,JSON.stringify(a)).fail(l)}});var o=P.Logger.getLogger("Default");P.log=function(){var e=_.toArray(arguments),t="DEBUG";switch(_.contains(["DEBUG","WARN","ERROR"],e[0])&&(t=e.shift()),t){case"DEBUG":o.debug(e);break;case"WARN":o.warn(e);break;case"ERROR":o.error(e)}}}(),function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var n=(new Date).getTime(),i=Math.max(0,16-(n-e)),o=window.setTimeout(function(){t(n+i)},i);return e=n+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),function(){var e=0;P.PubSub=function(e){this.ns=e,this.channels={};var t=this;this.Subscriber=function(e,i){n.call(this,t,e,i)},this.Subscriber.prototype=n.prototype},_.extend(P.PubSub.prototype,{subscribe:function(e,t,n,i){var o=new this.Subscriber(e,{handler:n,scope:i});return o.subscribe(t),o},publish:function(e,t,n){this.getChannel(e).publish(t,n)},getChannel:function(e){return this.channels[e]||(this.channels[e]=new t(this,e)),this.channels[e]},clearChannel:function(e){var t=this.channels[e];t&&(t.unsubscribeAll(),delete this.channels[e])}});var t=function(e,t){this.pubsub=e,this.target=t,this.subscribers={},this.filters={},this.messages={}};_.extend(t.prototype,{addSubscriber:function(e,t){var n=this,i=e.getId();return this.subscribers[i]=e,_.each(t,function(t){n.filters[t]||(n.filters[t]={}),n.filters[t][i]||(n.filters[t][i]=e,_.isUndefined(n.messages[t])||e.publish(t,n.messages[t]))}),e},removeSubscriber:function(e,t){var n=this,i=e.getId();_.each(t,function(e){n.filters[e]&&delete n.filters[e][i]}),_.keys(this.subscribers).length<1&&this.pubsub.clearChannel(this.target)},publish:function(e,t){_.each(this.filters[e],function(n){n.publish(e,t)}),"*"!==e&&this.publish("*",t),this.messages[e]=t},getSubscribers:function(){var e=_.toArray(arguments);if(!e.length)return _.values(this.subscribers);var t=this,n={};return _.each(e,function(e){_.extend(n,t.filters[e])}),_.values(n)},unsubscribeAll:function(){_.each(this.subscribers,function(e){e.unsubscribe()})}});var n=function(e,t,n){this.pubsub=e,this.target=t,this.options=n,this.topics={}};_.extend(n.prototype,{publish:function(e,t){return this.getHandler().call(this.getScope(),this.target,e,t),this},subscribe:function(){var e=this,t=_.toArray(arguments);return this.getChannel().addSubscriber(e,t),_.each(t,function(t){e.topics[t]=1}),this},unsubscribe:function(){var e=this,t=_.toArray(arguments);return 0===t.length&&(t=this.getTopics()),_.each(t,function(t){delete e.topics[t]}),this.getChannel().removeSubscriber(this,t),this},getChannel:function(){return this.pubsub.getChannel(this.target)},getHandler:function(){return this.options.handler},getScope:function(){return _.result(this.options,"scope")},getName:function(){return _.result(this.options,"name")},getId:function(){return this.id||(this.id=e++),this.id},getTopics:function(){return _.keys(this.topics)}}),P.PubSub.Subscriber=n,P.PubSub.Channel=t,P.pubsub=new P.PubSub("local")}(),function(){P.AppVersion={currentVersion:null,invalid:!1,setup:function(e){var t=this;this.currentVersion=e,P.pubsub.subscribe(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_APP_VERSION,function(e,n,i){t.updateVersion(i)})},updateVersion:function(e){e!==this.currentVersion&&(this.invalid=!0),this.currentVersion=e}}}(),function(){var e=P.Logger.getLogger("Errors");P.Errors={},P.Errors.ENABLE_WRAPPING=P.e.ew,P.Errors.wrapFn=function(e,t){return t?P.Errors.ENABLE_WRAPPING?function(){try{return t.apply(this,arguments)}catch(n){throw n.loggedToServer||(P.Errors.reportError(this,e,arguments,n),n.loggedToServer=!0),n}}:t:function(){}},P.Errors.wrap=function(e,t){_.each(t,function(t){var n=e[t];e[t]=P.Errors.wrapFn(t,n)})},P.Errors.reportError=function(t,n,i,o){var r={format:"sentry",fn_name:n||"unknown_function_name"};if(t instanceof P.Module){for(var s=n,a=t;a;)s=a.getDebugInfo()+":"+s,a=a.parent;r.error_path=s}else t instanceof P.Resource&&(r.resource_name=t.name,r.options=JSON.stringify(t.options));if(i[0]instanceof $.Event){var l=i[0],u=l.currentTarget;r.event={type:l.type,target_class:u.className.replace(/\s+/g," ")},u.href&&(r.event.target_href=u.href)}r.traceback=printStackTrace({e:o}).join("\n"),e.error(o.message,r)},P.showError=function(e,t){e=_.escape(e);var n={name:"ConfirmDialog",options:{view_type:"error",message:e,template:null}};P.loadModule(n,function(e){t&&e.on(P.CONST.EVENT_CONFIRM,t),P.ModalManager.instance().showInModal(e)})}}(),function(){P.Mixins.PreventScroll={startPreventScroll:function(e,t){this.stopPreventScroll(),this._preventScrollListener=this.listen(e,"mousewheel",function(n){var i=n.originalEvent.wheelDeltaY<0?"down":"up",o=e.scrollTop();if("down"===i){var r=e.height()+o;r>=t.height()&&n.preventDefault()}else 0===o&&n.preventDefault()})},stopPreventScroll:function(){this._preventScrollListener&&(this.removeListener(this._preventScrollListener),this._preventScrollListener=null)
}}}(),function(){P.User=Backbone.Model.extend({isAuthenticated:function(){return!!this.get("id")},attemptLogin:function(){P.e.fba&&this.attemptLoginWithFacebook()},attemptLoginWithFacebook:function(){if(!Cookie.get(P.CONST.COOKIE_FB_AUTO_LOGIN_DISABLED)){var e=this;P.FBEnsureInit(function(){var t=_.bind(e._attemptLoginWithFacebook,e);P.FB.getLoginStatus(t,!0)})}},_attemptLoginWithFacebook:function(e){if(e.authResponse){var t={facebook_id:e.authResponse.userID,facebook_token:e.authResponse.accessToken,facebook_autologin:!0};this.login(t,function(){window.location.reload(!0)})}},login:function(e,t,n,i){var o=new P.Resource("UserSessionResource",e);o.call("create",{success:function(e){P.log("Login, successful",e),P.trackRegisterAction("login"),t&&t(e)},error:n||P.NOOP,complete:i||P.NOOP,async:!1})},logout:function(e){Cookie.set(P.CONST.COOKIE_FB_AUTO_LOGIN_DISABLED,1),e()}}),P.currentUser=new P.User}(),function(){var e={SMALL:"Small",MEDIUM:"Medium"},t={size:e.MEDIUM},n=function(e){this.options=_.extend({},t,e),this.$spinEl=null};n.Size=e,n.prototype={spin:function(e){this.$spinEl&&this.stop();var t="spinner"+this.options.size;this.$spinEl=$('<div class="Spinner"><div class="'+t+'"></div></div>'),this.$spinEl.prependTo(e)},stop:function(){this.$spinEl.remove(),this.$spinEl=null}},P.Spinner=n}(),function(){P.string=function(e){return P.STRINGS?P.STRINGS[e]||e:e}}(),function(){function e(){}function t(){}function n(){}var i,o=function(e){this.name=e,this.notes=null,this.directChildren=[],this.asyncChildren=[],this.begin=null,this.end=null};i=window.performance&&window.performance.now?_.bind(window.performance.now,window.performance):Date.now?_.bind(Date.now,Date):function(){return+new Date},o.prototype={addChild:function(e){this.directChildren.push(e)},addAsync:function(e){this.asyncChildren.push(e)},start:function(){this.begin=i()},stop:function(){this.end=i()},getWallClockLength:function(){return this.end-this.begin},getSelfLength:function(){var e=_.reduce(this.directChildren,function(e,t){return e+t.getWallClockLength()},0);return this.getWallClockLength()-e},_getTreeEnd:function(){var e=this.end;return e=_.reduce(this.directChildren,function(e,t){return Math.max(t._getTreeEnd(),e)},e),e=_.reduce(this.asyncChildren,function(e,t){return Math.max(t._getTreeEnd(),e)},e)},getTreeLength:function(){return this._getTreeEnd()-this.begin},setNote:function(e,t){this.notes||(this.notes={}),this.notes[e]=t},find:function(e){if(e(this))return this;var t,n;for(t=0;t<this.directChildren.length;t++)if(n=this.directChildren[t].find(e))return n;for(t=0;t<this.asyncChildren.length;t++)if(n=this.asyncChildren[t].find(e))return n},each:function(e){this.find(function(t){return e(t),!1})}};var r=function(){this.stack=[]};r.prototype={peek:function(){return this.stack[this.stack.length-1]},setNote:function(e,t){this.peek().setNote(e,t)},start:function(e){var t=new o(e),n=this.peek();n&&n.addChild(t),this.push(t)},startContinuation:function(e,t){var n=new o(e),i=this.peek();i?i.addChild(n):t.addAsync(n),this.push(n)},push:function(e){e.start(),this.stack.push(e)},stop:function(){var e=this.stack.pop();if(e.stop(),0===this.stack.length){var t=function(){P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_ANALYTICS,P.CONST.PUBSUB_TOPIC_TIMING_TRACE_EMITTED,e)};_.delay(t,1e4)}}};var s=new r;e.prototype={wrap:function(){},wrapMethods:function(){},setNote:function(){},wrapContinuation:function(){}},t.prototype={wrap:function(e,t){return function(){s.start(e);var n=t.apply(this,arguments);return s.stop(),n}},wrapMethods:function(e,t,n){var i=this;_.each(n,function(n){var o=e[n];e[n]=i.wrap(t+"."+n,o)})},setNote:function(e,t){s.setNote(e,t)},wrapContinuation:function(e,t){var n=s.peek();return function(){s.startContinuation(e,n);var i=P.Errors.wrapFn(e,t),o=i.apply(this,arguments);return s.stop(),o}}},n.prototype={wrap:function(e,t){return t},wrapMethods:P.NOOP,setNote:P.NOOP,wrapContinuation:function(e,t){return t}},P.stopwatch=P.e.sw?new t:new n}(),function(){var e=function(e){this.timingTrace=e,this.category=null,this.subCategory=null,this.numResourceCalls=null,this.numModuleBuilds=null,this.numTimingTraceNodes=null,this.mainModuleMs=null,this.totalMs=null};e.prototype={setCategory:function(e){this.category=e},setSubCategory:function(e){this.subCategory=e},setNumResourceCalls:function(e){this.numResourceCalls=e},setNumModuleBuilds:function(e){this.numModuleBuilds=e},setNumTimingTraceNodes:function(e){this.numTimingTraceNodes=e},getCounts:function(){return{numResourceCalls:this.numResourceCalls,numModuleBuilds:this.numModuleBuilds,numTimingTraceNodes:this.numTimingTraceNodes}},setMainModuleMs:function(e){this.mainModuleMs=e},setTotalMs:function(e){this.totalMs=e},getTimes:function(){return{mainModuleMs:this.mainModuleMs,totalMs:this.totalMs}}};var t={fromTimingTrace:function(t){var n=new e(t);switch(t.name){case"P.navigate":case"Router.onStateChange":switch(t.name){case"P.navigate":n.setCategory("navigate");break;case"Router.onStateChange":n.setCategory("state change")}var i=t.find(function(e){return"Router.resolve"===e.name});i&&n.setSubCategory(_.values(i.notes).join(","));break;case"ShowModalButton.onClick":n.setCategory("open modal"),n.setSubCategory(_.values(t.notes).join(","));break;case"PinCreate.createPin":n.setCategory("createPin");break;default:return null}var o=0,r=0,s=0;t.each(function(e){"Resource.call"===e.name?o++:"Module._build"===e.name&&r++,s++}),n.setNumResourceCalls(o),n.setNumModuleBuilds(r),n.setNumTimingTraceNodes(s);var a=t.getTreeLength(),l=null;return t.find(function(e){var n=e.name===P.CONST.STOPWATCH_SET_AS_MAIN_MODULE_SUCCESS;return n&&(l=e.end-t.begin),n}),n.setMainModuleMs(l||a),n.setTotalMs(a),n}};P.pubsub.subscribe(P.CONST.PUBSUB_CHANNEL_ANALYTICS,P.CONST.PUBSUB_TOPIC_TIMING_TRACE_EMITTED,function(e,n,i){var o=i,r=t.fromTimingTrace(o);r&&P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_ANALYTICS,P.CONST.PUBSUB_TOPIC_TIMING_METRICS_EMITTED,r)})}(),function(){if(P.e.sw){var e=P.Logger.getLogger("ReportMetrics");$(window).on("load",function(){var t={};window.performance.getEntriesByType&&(t.resourceTimings=window.performance.getEntriesByType("resource")),window.performance.navigation&&(t.navigation=window.performance.navigation),window.performance.timing&&(t.timing=window.performance.timing),P.PAGE_ROUTE_PATTERN&&(t.routePattern=P.PAGE_ROUTE_PATTERN),_.isEmpty(t)||e.logToServer(P.Logger.SERVER_LOG_TYPE.PAGE_LOAD_METRIC,"post",t)}),P.pubsub.subscribe(P.CONST.PUBSUB_CHANNEL_ANALYTICS,P.CONST.PUBSUB_TOPIC_TIMING_METRICS_EMITTED,function(t,n,i){var o=_.clone(i);delete o.timingTrace,e.logToServer(P.Logger.SERVER_LOG_TYPE.APP_METRIC,"post",o)})}}(),function(){P.absolutify=function(e,t,n){return e?0===e.lastIndexOf("http://",0)||0===e.lastIndexOf("https://",0)?e:(t=t||window.location.protocol,n=n||window.location.hostname,t+"//"+n+e):e},P.normalizeUrl=function(e){if("/"===e.substr(0,0))return e;var t=P.absolutify("/");return 0===e.lastIndexOf(t,0)?e.substr(t.length-1):e},P.getCurrentUrl=function(){return window.location.pathname+("?"===window.location.search?"":window.location.search)};var e=function(e){if(!e)return null;var t=document.createElement("a");return t.href=e,t};P.isLocalUrl=function(t){var n=e(t);if(!n)return!1;var i=/^https{0,1}:$/,o=i.test(n.protocol),r=n.host===window.location.host;return o&&r},P.isOffsiteUrl=function(e){return!(!e||!e.match(/^https{0,1}:\/\//))}}(),function(){P.scrollbarWidth=_.memoize(function(){var e=document.createElement("div");$(e).css({height:"100px",left:"100px",overflow:"scroll",position:"absolute",width:"100px"}),document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t}),P.preloadImage=function(e,t,n){var i=new Image;i.src=e,i.onload=t||P.NOOP,i.onerror=n||P.NOOP},P.loadModule=function(e,t){var n=e.name;P.Loader.require([n],function(n){t(new n(e))})},P.loadTutorial=function(e,t){P.loadModule(t,function(t){e.showInModal(t,{mask_type:"dark"})})},jQuery.fn.positionAncestor=function(e){var t=0,n=0;return e.length>0&&this.each(function(i,o){var r=$(o),s=r.offset();if(e[0]===window)t=s.left,n=s.top;else{var a=e.scrollLeft(),l=e.scrollTop(),u=e.offset();t=a+s.left-u.left,n=l+s.top-u.top}return!1}),{left:t,top:n}},P.toArgumentString=function(e){var t=[];return _.each(e,function(e,n){e=e&&e.toString?""+e:JSON.stringify(e),t.push(n+"="+e)}),t.join(", ")},P.getLoginUrl=function(){return"/login/?"+$.param({next:window.location.href})},P.getRegisterUrl=function(){return"/join/?"+$.param({next:window.location.href})},P.getResetPasswordOneClickUrl=function(e){return"/login/reset/?"+$.param(e)},P.getQueryStringParams=function(e){e=e||window.location.search.substring(1);var t={};return _.each(e.split("&"),function(e){var n=e.split("="),i=decodeURIComponent(n[0]),o=decodeURIComponent(n[1]);t[i]=o}),t};var e=/(<([^>]+)>)/gi;P.stripTags=function(t){return t.replace(e,"")},P.historyNavigate=function(e,t){P.app.historyManager.navigate(e,t||{})},P.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},P.useHistory=function(){return!!(window.history&&window.history.pushState&&window.history.replaceState)},P.supportCSSTransitions=_.memoize(function(){var e=document.createElement("p").style,t="transition"in e||"WebkitTransition"in e||"MozTransition"in e||"msTransition"in e||"OTransition"in e;return t}),P.setTitlePrefix=function(e){var t=document.title;t=t.replace(/^\(\w+\) /,""),e&&(t="("+e+") "+t),document.title=t}}(),function(){P.getDebugWindow=function(){return window.opener||window}}(),function(){P.requestAnimationFrameThrottled=function(e){var t=!1;return function(){t||(t=!0,window.requestAnimationFrame(function(){e(),t=!1}))}}}(),function(){var e=[],t=function(){var t=e;e=[];for(var n=0;n<t.length;n++)t[n]()},n={scheduleFlush:P.requestAnimationFrameThrottled(t)};P.Errors.wrap(n,["scheduleFlush"]),P.deferDomManipulation=function(t){e.push(t),n.scheduleFlush()},P.stopwatch.wrapMethods(P,"P",["deferDomManipulation"])}(),function(){P.trackRegisterAction=function(e){var t=new P.Resource("UserRegisterTrackActionResource",{action:e});t.call("update",{error:function(e){P.log("ERROR","Call to UserRegisterTrackActionResource failed:",e)}})}}(),function(){P.FbUtil={};var e="publish_actions";P.FbUtil.checkFbTimelinePermission=function(t){var n=function(){P.FB.api("/me/permissions",function(n){var i=n.data;i&&i[0][e]?t.success&&t.success():t.error&&t.error()})};P.FBEnsureInit(n)},P.FbUtil.fbConnectedAccountMatchesLoggedInAccount=function(e){if(!e)return!0;var t=P.FB.getAuthResponse();return t?e===t.userID:!0},P.FbUtil.maybeRequestFbTimelinePermission=function(e,t){return P.FbUtil.fbConnectedAccountMatchesLoggedInAccount(t)?(P.FbUtil.checkFbTimelinePermission({success:function(){e.success&&e.success(),e.complete&&e.complete()},error:function(){P.FbUtil.fbLogin(e)}}),void 0):(P.showError(P.string("facebookAccountDoesntMatch")),e.error&&e.error(),e.complete&&e.complete(),void 0)},P.FbUtil.fbLogin=function(t){P.FB.login(function(e){e.authResponse?P.FbUtil.checkFbTimelinePermission(t):t.error&&t.error(),t.complete&&t.complete()},{scope:e})}}(),function(){var e=14,t=10,n=3,i=236;P.Viewport={height:0,width:0,init:function(){this.on(P.CONST.EVENT_RESIZE,this._onResize,this),$(window).on("resize",_.debounce(_.bind(this._cacheWindowSize,this),200)),this._cacheWindowSize(),this._updateBodyColumns()},_cacheWindowSize:function(){var e=$(window),t=e.height(),n=e.width();(t!==this.height||n!==this.width)&&(this.height=t,this.width=n,this.trigger(P.CONST.EVENT_RESIZE))},_onResize:function(){this._updateBodyColumns()},_updateBodyColumns:function(){this.setBodyColumns(this._calcBodyColumns())},_calcBodyColumns:function(){return Math.min(Math.max(Math.floor(this.width/(i+e)),n),t)},setBodyColumns:function(e){if(e!==this.numColumns){var t=$("body");if(t.length){var n="columns-"+this.numColumns,i="columns-"+e;t.removeClass(n).addClass(i),this.numColumns=e,this.trigger(P.CONST.EVENT_BODY_COLUMN_CHANGE)}}},isOverlapping:function(e,t){if(t||(t=0),!e.getBoundingClientRect)return!0;var n=e.getBoundingClientRect(),i=n.right-n.left,o=n.bottom-n.top;return i>0&&o>0&&n.top<this.height+t&&n.bottom>-t&&n.left<this.width+t&&n.right>-t?!0:!1}},_.extend(P.Viewport,Backbone.Events),P.Errors.wrap(P.Viewport,["isOverlapping"])}(),function(){P.window={open:function(e,t,n,i){var o=this._makeWindowOptions(n,i);P.debugWindow=window.open(e,t,o)},_makeWindowOptions:function(e,t){var n=screen.width,i=screen.height,o=Math.round((n-e)/2),r=i>t?Math.round((i-t)/2):0;return"scrollbars=yes,resizable=yes,toolbar=no,location=yes,width="+e+",height="+t+","+"left="+o+",top="+r}};var e=function(e,t){return P.Errors.ENABLE_WRAPPING?function(n,i,o){if(n){var r=e+":"+o,s=_.isFunction(n)?P.Errors.wrapFn(r,n):n;return t(s,i)}}:t};window.setTimeout=e("setTimeout",window.setTimeout),window.setInterval=e("setInterval",window.setInterval)}(),function(){var e="noScroll",t=function(){this.scrollStack=[!0]};t.prototype={pushScrolling:function(e){return this.push().setScrolling(e),this},pop:function(){return this.scrollStack.length<=1?(P.log("ERROR","Tried to pop with only one item on stack.  Mismatched push and pops?"),void 0):(this.scrollStack.pop(),this.updateElement(),this)},setScrolling:function(e){return this.scrollStack[this.scrollStack.length-1]=e,this.updateElement(),this},push:function(){return this.scrollStack.push(this.peek()),this},peek:function(){return this.scrollStack[this.scrollStack.length-1]},updateElement:function(){var t=this.peek();$("body").toggleClass(e,!t)}},P.Body=new t,window.P_TEST_MODE&&(P.Body.constructor=t)}(),function(){var e=" loaded",t=" fade";P.Lazy={imageLoad:function(n){var i=e;P.Viewport.isOverlapping(n)&&(i+=t),P.deferDomManipulation(function(){n.className+=i})}}}(),function(){var e="sticky",t="absolute",n="below",i=t+" "+n,o=i+" "+e,r=e,s=0,a=1,l=2;P.Sticky=function(e,t){this.$el=e,this.elementHeight=null,this.headerHeight=t.headerHeight,this.boundElementHeight=null,this.$boundTo=t.$boundTo,this.$scrollable=t.$scrollable,_.bindAll(this,"updateFixed","_onScroll"),this.$scrollable.on("scroll.sticky",this._onScroll),this.pendingScrollRAF=!1,this.lastState=null;var n=this;P.deferDomManipulation(function(){n.elementHeight=e.height(),n.boundElementHeight=n.$boundTo.height()})},_.extend(P.Sticky.prototype,Backbone.Events,{destroy:function(){this.$scrollable.off("scroll.sticky",this.updateFixed)},unSticky:function(){this.destroy()},_onScroll:function(){if(!this.pendingScrollRAF){var e=this;P.deferDomManipulation(function(){return e.scrollTop=e.$scrollable.scrollTop(),e.scrollTop===e.lastScrollTop?(e.pendingScrollRAF=!1,void 0):(e.updateFixed(),e.lastScrollTop=e.scrollTop,e.pendingScrollRAF=!1,void 0)}),this.pendingScrollRAF=!0}},updateFixed:function(){var t,n=$(window),r=n.scrollTop(),u=r,c=this.$boundTo.offset().top-this.headerHeight,d=this.$boundTo.offset().top+this.boundElementHeight-this.headerHeight;t=u>=c&&u<=d?a:u>=d?l:s,t!==this.lastState&&(t===a?(this.$el.css("top","").addClass(e).removeClass(i),this.trigger(P.CONST.EVENT_STICKY_FIXED,!0)):t===l?(this.$el.removeClass(e),this.trigger(P.CONST.EVENT_STICKY_FIXED,!1),this.handleReachingBottom()):t===s&&(this.$el.removeClass(o),this.trigger(P.CONST.EVENT_STICKY_NORMAL),this.trigger(P.CONST.EVENT_STICKY_FIXED,!1))),this.lastState=t},handleReachingBottom:function(){if(!this.$el.hasClass(i)){var e=this.boundElementHeight||0,o=parseInt(this.$el.css("top").split("px")[0],10)||0;this.$el.addClass(t+" "+n).css("top",e+o+1)}}}),jQuery.fn.sticky=function(t){return this.each(function(n,i){var o=$(i),s=o.data(r);if(s&&(s.destroy(),o.removeData(e)),"unsticky"===t);else if("object"===typeof t){var a=t.$scrollable,l=t.$boundTo,u=t.headerHeight||0;a&&(s=new P.Sticky(o,a,l,u),o.data(r,s))}}),this}}(),jQuery.fn.overflowingText=function(){return this.each(function(e,t){if(t.offsetHeight<t.scrollHeight||t.offsetWidth<t.scrollWidth){var n=$(t);n.addClass(P.CONST.OVERFLOWING_TEXT_OVERFLOWING_CLASS)}}),this};var ATTR_IS_HOVERING="data-is-hovering";jQuery.fn.initHovering=function(){return this.each(function(e,t){$(t).hover(function(){$(t).attr(ATTR_IS_HOVERING,"true")},function(){$(t).attr(ATTR_IS_HOVERING,"")}).attr(ATTR_IS_HOVERING,"")}),this},jQuery.fn.isHovering=function(){return $(this).attr(ATTR_IS_HOVERING)},function(){function e(e){P.log("gaqPush",e),window._gaq.push(e)}window._gaq=window._gaq||[],P.initializeGA=function(t){var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=("https:"===document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(n),P.DEBUG&&(e(["_setSampleRate",100]),e(["_setSiteSpeedSampleRate",100])),e(["_setAccount",t])},P.trackGALoggedInUser=function(t){var n=t?"logged in":"logged out";e(["_setCustomVar",1,"is_logged_in",n,2])},P.trackGAPageview=function(t){t&&e(["_setCustomVar",2,"page_name",t,1]);var n=document.URL;n.replace(/email=[^&]+/,"email=*"),e(["_trackPageview",n])};var t=function(t,n,i,o){e(["_trackEvent",t,n,i,o])};P.trackGAEvent=t;var n=function(t,n,i,o){var r=100;e(["_trackTiming",t,n,o,i,r])};P.pubsub.subscribe(P.CONST.PUBSUB_CHANNEL_ANALYTICS,P.CONST.PUBSUB_TOPIC_TIMING_METRICS_EMITTED,function(e,i,o){var r=o;_.each(r.getCounts(),function(e,n){t(r.category,r.subCategory,n,e)}),_.each(r.getTimes(),function(e,t){n(r.category,r.subCategory,t,e)})})}(),P.Event=function(e,t,n){this.type=e,this.target=t,this.currentTarget=t,this.data=n||{};var i=!1;this.stopPropagation=function(){i=!0},this.shouldPropagate=function(){return!i}},function(){P.Loader={require:require,define:define,load:function(e){var t=new $.Deferred;return require(e,function(){t.resolve.apply(t,arguments)},function(e){t.fail(e.message)}),t.promise()}},delete define.amd,delete require.amd}(),function(){var e=P.Logger.getLogger("TutorialManager"),t={existingUser:{stepNames:["WelcomeStep","HomefeedStep","CategoriesStep","ProfileStep","PinterestLogoStep"],nextUrl:"/",canExit:!0,onUserExit:function(e){0===e&&P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_TUTORIAL,P.CONST.PUBSUB_TOPIC_TUTORIAL_CATEGORIES)}},newUser:{stepNames:["WelcomeStep","HomefeedStep","CategoriesStep","ProfileStep","PinterestLogoStep"],nextUrl:"/",canExit:!1,onUserExit:P.NOOP},newUserPinIntro:{stepNames:["WelcomeStep","PinIntro","HomeFeedPinIntro"],nextUrl:"/",canExit:!1,onUserExit:P.NOOP}},n="tutorial",i="Tutorial";P.TutorialManager=function(){},P.TutorialManager.prototype={startTutorial:function(e){this._start(e,!0)},resumeTutorial:function(){var e=this._getStoredData();e&&e.name&&this._start(e.name,!1)},_start:function(e,n){var o=t[e];o&&(this._clear(n),this._isActive=!0,this.tutorialName=e,this.tutorialClassName=this.tutorialName+i,$("body").addClass(this.tutorialClassName),this.tutorial=o,this.allStepNames=this.tutorial.stepNames,this.numTotalSteps=this.tutorial.stepNames.length,this._setupModal(),this._setStep(this._getStoredStep()||this.allStepNames[0]))},isTutorialActive:function(){return this._isActive},_setupModal:function(){var e=this,t={name:"Modal",options:{mask_type:"dark",can_dismiss:!1}};P.loadModule(t,function(t){e.modal=t,e.modal.render(),e.modal.childListen(P.CONST.EVENT_NEXT,_.bind(e._next,e)),e.modal.childListen(P.CONST.EVENT_PREVIOUS,_.bind(e._previous,e)),P.ModalManager.instance().showModal(e.modal)})},_next:function(){var e=this._getStepIndex(this.currentStep);return this.currentStep===_.last(this.allStepNames)?(this._endTutorial(!0),void 0):(this._setStep(this.allStepNames[e+1]),void 0)},_previous:function(){var t=this._getStepIndex(this.currentStep);return 0===t?(e.logToServer(P.Logger.SERVER_LOG_TYPE.LOG,"get",{type:"tutorial",tutorial:this.tutorialName,step:this.currentStep,step_number:t,action:"exit"}),this.tutorial.onUserExit(t),this._endTutorial(),void 0):(this._setStep(this.allStepNames[t-1]),void 0)},_endTutorial:function(){var e=this,t=function(){var t=e.tutorial.nextUrl;e._clear(!0),t&&P.historyNavigate(t)};this.currentModule?this.currentModule.onExit(function(){e.currentModule.cleanHighlightedElements(),t()}):t()},_setStep:function(e){if(P.log("set step from",this.currentStep,"to",e),e!==this.currentStep){if(this.currentStep=e,this._saveCurrentStep(),!this.currentModule)return this._loadModuleForStep(this.currentStep),void 0;var t=this;this.currentModule.onExit(function(){t.currentModule.cleanHighlightedElements(),t._loadModuleForStep(e)})}},_loadModuleForStep:function(e){var t=this,n={name:"tutorials."+e,options:{tutorial_name:this.tutorialName,current_step:this._getStepIndex(e),total_steps:this.numTotalSteps,can_exit:this.tutorial.canExit}};P.loadModule(n,function(e){var n=t.currentModule;t.currentModule=e,e.onEnter(function(){e.render(function(){t.modal.setModule(e),n&&n.destroy(),e.setModalPosition(),e.onShow()})})})},_getStepIndex:function(e){var t=_.indexOf(this.allStepNames,e);return-1!==t?t:0},_getStoredStep:function(){var e=this._getStoredData();return e&&e.name!==this.tutorialName&&(this._clearStoredData(),e=null),e&&e.step||null},_getStoredData:function(){return P.SessionStorage.getItem(n)},_saveCurrentStep:function(){P.SessionStorage.setItem(n,{name:this.tutorialName,step:this.currentStep})},_clear:function(e){this.tutorial&&(this._isActive=!1,$("body").removeClass(this.tutorialClassName),this.tutorialName=null,this.tutorialClassName=null,this.tutorial=null,this.allStepNames=null,this.numTotalSteps=null,this._destroyModal(),e&&this._clearStoredData())},_clearStoredData:function(){P.SessionStorage.removeItem(n)},_destroyModal:function(){this.modal.destroy(),this.modal=null}};var o=null;P.TutorialManager.instance=function(){return o||(o=new P.TutorialManager),o}}(),function(){function e(e){this.name=e,this.id=null,this.options={},this.data=null,this.resource=null,this.append=!1,this.errorStrategy=P.CONST.ErrorStrategy.REMOVE}e.prototype={setOptions:function(e){this.options=e},setData:function(e){this.data=e},setResource:function(e){this.resource=e},setAppend:function(e){this.append=e},setErrorStrategy:function(e){this.errorStrategy=e}},e.fromPlainObject=function(t){var n=new e(t.name);if(t.options&&n.setOptions(t.options),t.data&&n.setData(t.data),t.resource){var i=P.ResourceFactory.create(t.resource.name,t.resource.options);n.setResource(i)}return t.append&&n.setAppend(t.append),t.errorStrategy&&n.setErrorStrategy(t.errorStrategy),n},P.ModuleRenderOptions=e}(),function(){var e=function(){};e.prototype={render:function(){}},P.ModuleRenderer=e}(),function(){var e=P.Logger.getLogger("ModuleRendererLocal"),t=function(t){var n=/([^\.]*)$/,i=n.exec(t),o=i[1];if(!o)return e.error("Couldn't compute lastNameComponent from "+t),"";var r=t.replace(/\./g,"/")+"/"+o+".html";return r},n=function(e){this.templateName=t(e)};n.prototype={templateName:null,_renderInnerHtml:function(e){var t=nunjucks.env.render(this.templateName,e);return t},_getData:function(e){if(e.data||!e.resource){var t=new $.Deferred;return t.resolve(e.data),t.promise()}return e.resource.call("get")},_getErrorModuleTree:function(e){var t=new P.ModuleTree(e.name);return t.setInnerHtml("error"),t},_renderModuleTree:function(e,t){var n=[],i=function(e){var t=P.ModuleRenderOptions.fromPlainObject(e);return n.push(t),P.ModuleTree.modulePlaceholder},o={module:i};void 0!==t&&(o.data=t);var r=this._renderInnerHtml(o),s=_.map(n,function(e){return P.Loader.load([e.name]).then(function(t){var n=t.prototype.moduleRenderer;return n.render(e)})});return $.when.apply($,s).then(function(){var t=_.toArray(arguments);t=_.without(t,null);var n=new P.ModuleTree(e.name);return e.id&&n.setId(e.id),e.options&&n.setOptions(e.options),n.setChildren(t),n.setInnerHtml(r),n})},render:function(t){var n=this;return this._getData(t).then(function(e){return n._renderModuleTree(t,e)}).then(null,function(){switch(t.errorStrategy){case P.CONST.ErrorStrategy.SHOW:return n._getErrorModuleTree(t);case P.CONST.ErrorStrategy.BUBBLE:var i=new $.Deferred;return i.reject.apply(i,arguments),i.promise();case P.CONST.ErrorStrategy.REMOVE:return null;default:return e.warn("unknoen moduleRenderOptions.errorStrategy",t.errorStrategy),null}})}},P.ModuleRendererLocal=n}(),function(){var e=function(){};e.prototype={render:function(e){var t=e.resource;return t||(t=new P.Resource(P.Resource.NOOP_RESOURCE.name,P.Resource.NOOP_RESOURCE.options)),t.call("get",{options:{module:{name:e.name,options:e.options,append:e.append,errorStrategy:e.errorStrategy}},error:P.NOOP}).then(function(e){var t=P.ModuleTree.fromPlainObject(e.module.html,e.module.tree);return t},function(e,t){var n=new $.Deferred,i=null;return t&&t.module?i=P.ModuleTree.fromPlainObject(t.module.html,t.module.tree):(i=new P.ModuleTree("default"),i.setOuterHtml("")),i.setError(e),n.reject(i),n})}},P.ModuleRendererRemote=e}(),function(){var e=300,t="fadeIn",n="fadeOut",i=t+" "+n,o="loading",r=300,s="moduleMask",a="inModal",l="notNavigatable",u="savedScrollTop",c=_.invert(P.CONST.ErrorStrategy),d=0,h=function(e,t,n){var i="other";this.object=e,this.event=t,this.fn=n,this.object instanceof P.Module?this.id=this.object.cid:(this.id=i+d,d+=1)};P.Module=Backbone.View.extend({className:"Module",moduleRenderer:new P.ModuleRendererRemote,constructor:function(e){Backbone.View.apply(this,arguments),this._build(e)},_configure:function(){this.parent=null,this.children=[],this._childrenIdMap={},this._listeners={},this._pubsubHandlers={},this.inDom=!1,this.contentReady=!1,this._moduleTree=null,this._html=null,this._pendingRenderRequest=!1,this._pendingRenderAppendRequest=!1,this.extraState={},this._spinner=null,this._$mask=null,Backbone.View.prototype._configure.apply(this,arguments)},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var e=this.attributes||{};if(!e["class"]){var t=["Module"],n=this.className.replace(/\./g,"-");t.push(n),e["class"]=t.join(" ")}var i=$(document.createElement(this.tagName));i.attr(e),this.setElement(i,!1)}},initialize:function(){},setAsMainModule:function(e,t,n,i,o){return this.errorStrategy=P.CONST.ErrorStrategy.SHOW,this.hasSameOptions(e,t)&&this.contentReady&&!this._forceRefresh(n)?(i(),void 0):(this.empty(),this._forceRefresh(n)&&(this.extraState={}),this.setOptions(e),this.setResource(t),this.performTransition(n,i,o),void 0)},_forceRefresh:function(e){return e&&e.evt&&e.evt.data&&e.evt.data.forceRefresh},performTransition:function(e,t){this.render(t,t)},setResource:function(e){(!e||_.isEqual(e,{}))&&(e=P.Resource.NOOP_RESOURCE),this.resource=P.resourceFactory.create(e.name,e.options)},setOptions:function(e){var t=this.options;this.options=e||{},this.onOptionsChanged(t,this.options)},setModal:function(e){e?this.$el.addClass(a):this.$el.removeClass(a),this.modal=e,e&&this.onAddedToModal(e)},prependChild:function(e){this.$el.prepend(e.getElement()),this.addChild(e,0)},appendChild:function(e){this.insertChild(e,this.$el)},insertChild:function(e,t,n){t.append(e.getElement()),this.addChild(e,n)},removeChild:function(e){if(e.parent===this){e.parent=null,this._removeListenersOnModule(e),this.children=_.filter(this.children,function(t){return e!==t}),e.id&&delete this._childrenIdMap[e.id];var t=e.getParentElement();e.detachElement(),e.onRemoved(),this.onChildRemoved(e,t)}},getChildByElement:function(e){var t=_.find(this.children,function(t){return t.$el.is(e)});return t},getChildByModuleName:function(e){var t=_.find(this.children,function(t){return t.className===e});return t},getChildrenByModuleName:function(e){var t=_.filter(this.children,function(t){return t.className===e});return t},getChildById:function(e){return this._childrenIdMap[e]},removeChildById:function(e){var t=this.getChildById(e);t&&t.remove()},remove:function(){this.parent&&this.parent.removeChild(this)},detachElement:function(){this.remove(),this.$el.detach(),this.inDom&&this._setInDom(!1)},destroy:function(){this.triggerEvent(P.CONST.EVENT_DESTROYED),this.empty(),this.detachElement(),this._removeListeners(),this._subscribers&&_.each(this._subscribers,function(e){e.unsubscribe()}),this.undelegateEvents(),this.destroyed=!0,this.onDestroyed()},destroyIfEmpty:function(){return this.contentReady&&this.isEmpty()?(this.destroy(),!0):!1},empty:function(){for(this.$el.empty();this.children.length;)this.children[0].destroy();this.children=[],this._childrenIdMap={},this.contentReady=!1,this.onEmpty()},onEmpty:P.NOOP,onRendered:P.NOOP,onContentReady:P.NOOP,onAdded:P.NOOP,onRemoved:P.NOOP,onDestroyed:P.NOOP,onChildAdded:function(){},onChildRemoved:function(){},onChildRendered:P.NOOP,onAddedToDom:P.NOOP,onRemovedFromDom:P.NOOP,onPubSubMessage:function(){},onOptionsChanged:function(){},onAddedToModal:function(){},handleError:function(e){var t=this.getFullName();this.errorStrategy===P.CONST.ErrorStrategy.REMOVE?(this.log.warn("Removing module because of error."),this.destroy()):this.errorStrategy===P.CONST.ErrorStrategy.BUBBLE&&(this.log.warn("Bubbling up the error."),this.parent.handleError(e)),this.log.warn("Error in",t,"\n","Code:",e.code,"\n","Strategy:",c[this.errorStrategy],"\n","HTTP Status:",e.http_status,"\n",e.message),this.triggerEvent(P.CONST.EVENT_ERROR,e,this)},getSubscriber:function(e){if(this._subscribers||(this._subscribers={}),!this._subscribers[e]){var t=new P.pubsub.Subscriber(e,{handler:this._handlePubsub,scope:this,name:this.className});this._subscribers[e]=t}return this._subscribers[e]},pubsubSubscribe:function(e,t){var n=this.getSubscriber(e);n.subscribe.apply(n,_.keys(t)),this._pubsubHandlers[e]||(this._pubsubHandlers[e]={}),_.extend(this._pubsubHandlers[e],t)},pubsubUnsubscribe:function(e){var t=_.tail(arguments),n=this.getSubscriber(e);n.unsubscribe.apply(n,t)},_handlePubsub:function(e,t,n){var i=(this._pubsubHandlers[e]||{})[t];i&&i.call(this,e,t,n),this.onPubSubMessage(e,t,n)},ensureAuthentication:function(){return P.currentUser.isAuthenticated()?!0:(this.navigate(P.getRegisterUrl()),!1)},getFullName:function(){for(var e=[this.toString(!0)],t=this;t.parent;)t=t.parent,e.unshift(""+t);return e.join(">")},toString:function(e){var t=this.className,n=[];return e&&this.options&&n.push(P.toArgumentString(this.options)),this.resource&&"NoopResource"!==this.resource.name&&n.push("resource="+(""+this.resource)),t+"("+n.join(", ")+")"},getHeight:function(e){return e=e||!1,this.$el.outerHeight(e)},getWidth:function(e){return e=e||!1,this.$el.outerWidth(e)},getParentElement:function(){return this.$el.parent()},getElement:function(){return this.$el},getScrollableElement:function(){return this.getScrollableElementForElement(this.$el)},getScrollableElementForElement:function(e){var t=this.getOwnedScrollables();if(t.length>0){var n=e;n=n.add(e.parentsUntil(this.$el)),n=n.add(this.$el);var i=n.filter(t);if(i.length>0)return i.first()}return this.parent?this.parent.getScrollableElementForElement(this.$el.parent()):$(window)},listen:function(e,t,n){var i=this,o=function(){n.apply(i,arguments)};e.on(t,o);var r=new h(e,t,o);return this._listeners[r.id]||(this._listeners[r.id]=[]),this._listeners[r.id].push(r),r},childListen:function(e,t){return this.listen(this,"child:"+e,t)},delegateEvents:function(){if(!this.__wrapEvents){this.events=this.events||{},this.events["click a"]="_handleLinkClick";var e=this,t={};_.each(this.events,function(n,i){t[i]=_.isFunction(n)?P.Errors.wrapFn("eventFunction",n):P.Errors.wrapFn(n,function(){return P.state.activeTarget=e,e[n].apply(e,arguments)})}),this.events=t,this.__wrapEvents=!0}return Backbone.View.prototype.delegateEvents.call(this)},navigate:function(e,t,n){var i={url:e,$el:t};n&&(i.forceRefresh=1),this.triggerEvent("navigate",i,!0)&&(this.log.debug("Navigate event wasn't prevented. Navigating to:",e),P.historyNavigate(e))},showInModal:function(e,t){this.triggerEvent("modal",{module:e,extraOptions:t},!0)&&(this.log.debug("Modal event wasn't prevented. Telling modalManager to open:",e),P.ModalManager.instance().showInModal(e,t||{},this))
},removeListener:function(e){e.object.off(e.event,e.fn),this._listeners[e.id]=_.filter(this._listeners[e.id],function(t){return e!==t})},triggerEvent:function(e,t,n){var i=new P.Event(e,this,t);if(this.trigger(e,i),i.shouldPropagate()&&n){for(var o=new P.Event("child:"+e,this,t),r=this.parent;r&&o.shouldPropagate();)r.trigger.call(r,o.type,o),o.currentTarget=r,r=r.parent;return o.shouldPropagate()}return i.shouldPropagate()},_removeListenersOnModule:function(e){_.each(this._listeners[e.cid],function(e){e.object.off(e.event,e.fn)}),delete this._listeners[e.cid]},showLoading:function(e){if(this.$el.addClass(o),null===this._spinner){var t=this.getLoadingSpinnerOptions();null!==t&&(this._spinner=new P.Spinner(t),this._spinner.spin(this.$el))}e?this.showMask():this.hideMask()},hideLoading:function(){this.$el.removeClass(o),null!==this._spinner&&(this._spinner.stop(),this._spinner=null),this.hideMask()},showMask:function(){null===this._$mask&&(this._$mask=$("<div></div>").addClass(s).css({left:0,top:0,width:this.getWidth(),height:this.getHeight()}).prependTo(this.$el))},hideMask:function(){null!==this._$mask&&(this._$mask.remove(),this._$mask=null)},show:function(){this.$el.show()},hide:function(){this.$el.hide()},fadeIn:function(i){this.$el.removeClass(n).addClass(t);var o=function(){i&&i()};setTimeout(o,e)},fadeOut:function(i){this.$el.removeClass(t).addClass(n);var o=function(){i&&i()};setTimeout(o,e)},clearFades:function(){this.$el.removeClass(i)},getLoadingSpinnerOptions:function(){return{}},render:function(e,t){var n=this.getParentElement();return 0===n.length&&(n=$(document.body)),this._render(n,e,t)},renderAppend:function(e,t){var n=this;return!this.contentReady||this._pendingRenderRequest||this._pendingRenderAppendRequest||this.resource.atEnd()?!1:(this._fetch(!0,function(){n._pendingRenderAppendRequest=!1,e&&e.call(n),n.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,null,!0)},function(){n._pendingRenderAppendRequest=!1,t&&t.call(n),n.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,null,!0)},function(e,t){"abort"===t&&(n._pendingRenderAppendRequest=!1)}),this._pendingRenderAppendRequest=!0,!0)},renderAbort:function(){return this._pendingRenderRequest?(this.resource.abort(),!0):!1},_render:function(e,t,n){if(this._pendingRenderRequest)return!1;this._pendingRenderAppendRequest&&this.resource.abort();var i=this,o=setTimeout(function(){i.showLoading(),o=null},r,"_render Loading"),s=function(){o?clearTimeout(o):i.hideLoading()},a=function(){i.rendered=!0,i._pendingRenderRequest=!1,s(),i.onRendered(),i.parent&&i.parent.onChildRendered(i),t&&t.call(i),i.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,null,!0)},l=function(){i._pendingRenderRequest=!1,s(),n&&n.call(i)},u=function(e,t){"abort"===t&&(i._pendingRenderRequest=!1,s())};return this._fetch(!1,a,l,u),this._pendingRenderRequest=!0,this._pendingRenderRequest},_fetch:function(e,t,n,i){var o=this;!e&&this.resource&&this.resource.resetBookmark();var r=new P.ModuleRenderOptions(this.className);r.setOptions(this.options),r.setData(this.data),r.setResource(this.resource),r.setAppend(e),r.setErrorStrategy(this.errorStrategy),this.moduleRenderer.render(r).done(function(n){o.loadFromModuleTree(n,e,t)}).fail(function(t){o.loadFromModuleTree(t,e,n)}).always(i)},loadFromModuleTree:function(e,t,n){var i=e.getTreeOuterHtml(),o=$(i),r=this;P.deferDomManipulation(P.stopwatch.wrapContinuation("Module._fetch build",function(){var i=_.extend({},e,{parent:r.parent,el:o,append:t,complete:n});r._build(i)}))},_build:function(e){if(P.stopwatch.setNote("className",this.className),e=e||{},e.complete=e.complete||P.NOOP,e.el&&!e.append&&(this.contentReady=!1),e.id&&(this.id=e.id),e.data&&(this.data=e.data),e.extraData&&(this.extraData=e.extraData),e.options&&this.setOptions(e.options),!e.resource||e.error&&e.append||this.setResource(e.resource),e.el){var t=e.el;if(e.append)this.$el.append(t);else{var n=!!document.getElementById(t.attr("id")),i=!this.inDom&&n;this.inDom=this.inDom||n,this._replaceElement(t),this.$el.removeAttr("id"),i&&this.onAddedToDom()}}if(e.parent&&e.parent.addChild(this),_.isUndefined(e.errorStrategy)||null===e.errorStrategy||(this.errorStrategy=e.errorStrategy),e.error)return e.error.target=this,this.handleError(e.error),e.complete.call(this),void 0;if(e.async)return this.render(e.complete),void 0;var o=this,r=e.children,s=_.pluck(r,"name");P.Loader.require(s,function(){var t=_.object(s,arguments);r&&r.length>0&&_.each(r,function(e){var n=$("#"+e.uid,o.$el),i=t[e.name];new i(_.extend(e,{parent:o,el:n}))}),e.el&&!e.append&&(o.contentReady=!0,o.onContentReady()),e.complete.call(o)})},addChild:function(e,t){var n="undefined"===typeof t&&-1||t;e.parent!==this&&(e.parent&&e.remove(),e.parent=this,-1===n?this.children.push(e):this.children.splice(n,0,e),e.id&&(this._childrenIdMap[e.id]=e),e.onAdded(),this.onChildAdded(e,t),this.inDom&&e._setInDom(!0))},isEmpty:function(){return!$.trim(this.$el.html())&&!this.children.length},isInModal:function(){return!!this.modal},loadFromData:function(){this.log.error("override method loadFromData")},hasSameOptions:function(e,t){var n=this.hasSameModuleOptions(e),i=this.hasSameResourceOptions(t);return this.log.debug("has same options? ",n,this.options,e,i,!this.resource||this.resource.options,t),n&&i},hasSameModuleOptions:function(e){return e=e||{},_.isEqual(this.options,e)},hasSameResourceOptions:function(e){(!e||_.isEqual(e,{}))&&(e=P.Resource.NOOP_RESOURCE);var t=!this.resource&&_.isEqual(e,P.Resource.NOOP_RESOURCE);return t||this.resource&&this.resource.isEqual(e)},setChildId:function(e,t){e.parent===this&&(this.removeChildId(e),e.id=t,this._childrenIdMap[e.id]=e)},removeChildId:function(e){e.id&&e.parent===this&&(delete this._childrenIdMap[e.id],delete e.id)},getOwnedScrollables:function(){return $()},saveExtraState:function(e){if(e){var t=this.getScrollableElement().scrollTop();this.extraState={scrollableElementScrollTop:t}}this.getOwnedScrollables().each(function(e,t){var n=$(t),i=n.scrollTop();n.data(u,i)}),_.each(this.children,function(e){e.saveExtraState(!1)})},restoreExtraState:function(e){var t=this;if(e){var n=this.extraState.scrollableElementScrollTop||0;P.deferDomManipulation(P.stopwatch.wrapContinuation("Module.restoreExtraState callback",function(){t.getScrollableElement().scrollTop(n)}))}var i=t.getOwnedScrollables();i.length&&P.deferDomManipulation(P.stopwatch.wrapContinuation("Module.restoreExtraState callback2",function(){i.each(function(e,t){var n=$(t),i=n.data(u);void 0!==i&&n.scrollTop(i)})})),_.each(this.children,function(e){e.restoreExtraState(!1)})},_setInDom:function(e){this.inDom!==e&&(this.inDom=e,e?this.onAddedToDom():this.onRemovedFromDom(),_.each(this.children,function(t){t._setInDom(e)}))},_replaceElement:function(e){e[0]!==this.$el[0]&&(this.empty(),this.undelegateEvents(),e.css({display:this.$el.css("display")}),e.insertBefore(this.$el),this.$el.remove(),this.$el=e,this.el=e[0],this.delegateEvents())},_removeListeners:function(){_.each(this._listeners,function(e){_.each(e,function(e){e.object.off(e.event,e.fn)})}),this._listeners={}},_handleLinkClick:function(e){var t=$(e.currentTarget),n=$(e.target),i=t.attr("href"),o=!n.hasClass(l)&&!t.hasClass(l),r=t.hasClass("external"),s=n.attr("data-ga");return s&&P.trackGAEvent(s,P.CONST.GA_ACTION_CLICK),o?r?(P.changeWindowLocation(i,!0),this.triggerEvent(P.CONST.EVENT_EXTERNAL_CLICK,null,!0),!1):P.isOffsiteUrl(i)||!(e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey)?i&&i.length&&"#"!==i.charAt(0)&&0!==i.lastIndexOf("javascript:",0)?(this.navigate(i,n,!!t.attr("data-force-refresh")),!1):void 0:void 0:!1},getDebugInfo:function(){return this.className}}),P.Errors.wrap(P.Module.prototype,["_build","loadFromModuleTree","render","renderAppend"]),P.stopwatch.wrapMethods(P.Module.prototype,"Module",["_build","_fetch","loadFromModuleTree","render","restoreExtraState","showInModal"]);var p=P.Module.extend;_.extend(P.Module,{define:function(e,t,n){return P.Loader.define(e,t,function(){var t=n.apply(this,arguments);return t.prototype.className=t.className=e,t.prototype.log=P.Logger.getLogger(e),t})},extend:function(e,t){return e&&e.mixins&&_.extend.apply(_,[e].concat(e.mixins)),p.call(this,e,t)}})}(),function(){function e(e){this.name=e,this.attributes={"class":"",id:""},this.id=null,this.children=[],this.data=null,this.extraData=null,this.errorStrategy=P.CONST.ErrorStrategy.REMOVE,this.options={},this.uid="",this.async=!1,this.resource=null,this.innerHtml=null,this.outerHtml=null,this.error=null}e.prototype={setAttributes:function(e){this.attributes=e},setId:function(e){this.id=e},setChildren:function(e){this.children=e},addChild:function(e){this.children.push(e)},setData:function(e){this.data=e},setExtraData:function(e){this.extraData=e},setErrorStrategy:function(e){this.errorStrategy=e},setError:function(e){this.error=e},setOptions:function(e){this.options=e},setUid:function(e){this.uid=e},setAsync:function(e){this.async=e},setResource:function(e){this.resource=e},setInnerHtml:function(e){this.innerHtml=e},setOuterHtml:function(e){this.outerHtml=e},getTreeOuterHtml:function(){if(null!==this.outerHtml)return this.outerHtml;var t=this,n=this.innerHtml.split(e.modulePlaceholder),i=this.name.replace(".","-");this.uid=_.uniqueId("m");var o='<div class="Module '+i+'" id="'+this.uid+'">';return _.each(n,function(e,n){o+=e;var i=t.children[n];i&&(o+=i.getTreeOuterHtml())}),o+="</div>"}},e.fromPlainObject=function(t,n){var i=new e(n.name);return t&&i.setOuterHtml(t),n.attributes&&i.setAttributes(n.attributes),n.id&&i.setId(n.id),n.data&&i.setData(n.data),n.extraData&&i.setExtraData(n.extraData),n.errorStrategy&&i.setErrorStrategy(n.errorStrategy),n.options&&i.setOptions(n.options),n.uid&&i.setUid(n.uid),n.async&&i.setAsync(n.async),n.resource&&i.setResource(n.resource),_.each(n.children,function(t){var n=e.fromPlainObject(null,t);i.addChild(n)}),i},e.modulePlaceholder="<!--placeholder-->",P.ModuleTree=e}(),function(){var e=/\$\{(\d+)\}/g,t=/\?\{(\w+)\}/g,n=/\$\{(\w+)\}/g,i=function(i,o,r,s){return i=i.replace(t,function(e,t){return r[t]||""}),i=i.replace(e,function(e,t){return o[parseInt(t,10)]}),s&&(i=i.replace(n,function(e,t){var n=s[t];return o[n]})),i},o=function(e,t,n,r){var s={};return _.each(e,function(e,a){var l=e;_.isObject(e)?l=o(e,t,n,r):_.isString(e)&&(l=i(e,t,n,r)),s[i(a,t,n,r)]=l}),s};P.Router=function(){this.routes=[],this.lastUrl=window.location.href},_.extend(P.Router.prototype,Backbone.Events,{start:function(){if(P.useHistory()){var e=this;if(_.each(P.ROUTES,function(t){e.addRoute(t)}),window.history.replaceState){var t=$("link[rel=canonical]").attr("href");if(window.location.href!==t){var n="state"in window.history?window.history.state:{};window.history.replaceState(n,document.title,t),this.lastUrl=window.location.href}}$(window).on("popstate",function(t){P.log("popstate fired, lastUrl",e.lastUrl," new URL ",window.location.href),e.lastUrl===window.location.href?P.log("ignoring spurious popstate event"):e.onStateChange(t),e.lastUrl=window.location.href})}},navigate:function(e,t,n){n=n||{},this.navigateData=n,t.trigger&&($("link[rel=canonical]").remove(),window.history.pushState({},document.title,e),this.lastUrl=window.location.href);var i=this.resolve(e);P.log("matchedRoute",i,e),i?this.trigger("route",i):this.trigger("404",e)},resolve:function(e){var t=null,n=null;if(/\?/g.test(e)){var i=e.split("?");t=i[0],n=i[1]}else t=e;var o=window.location.hostname.split("pinterest.com")[0];if(o){var r=P.CONST.SUBDOMAIN_PREFIXES[o.split(".")[0]];P.log("Has prefix: ",r),r&&-1===t.indexOf(r)&&(t=r+t)}var s=decodeURIComponent(t),a=this,l=null;return _.find(this.routes,function(e){var t=e.uri.exec(s);if(t){var i=t.slice(1);l=a.subRoute(e.route,i,n)}return l}),l&&P.stopwatch.setNote("routePattern",l.url),l},addRoute:function(e){var t={uri:RegExp(e.url,"i"),route:e};this.routes.push(t)},subRoute:function(e,t,n){var i=P.getQueryStringParams(n),r={navigateData:this.navigateData,options:o(e.options,t,i,e.named),resource:o(e.resource,t,i,e.named)};return _.defaults(r,e),this.navigateData={},r},onStateChange:function(){this.navigate(window.location.pathname,{trigger:!1})}}),P.changeWindowLocation=function(e,t){t?window.open(e,"_blank"):window.location.href=e},P.navigate=function(e,t,n){return e=P.normalizeUrl(e),P.isOffsiteUrl(e)?(P.SafeLink.open(e),void 0):P.useHistory()?(t=t||{},n=n||{},t.fromNavigate=!0,P.router.navigate(e,{trigger:!0},t,n),void 0):(P.changeWindowLocation(e),void 0)},P.stopwatch.wrapMethods(P,"P",["navigate"]),P.Errors.wrap(P.Module.prototype,["start"]),P.stopwatch.wrapMethods(P.Router.prototype,"Router",["navigate","resolve","onStateChange"]),P.router=new P.Router}(),function(){P.Style=function(e,t){P.Style.addStyle(e,t)},P.Style.addStyle=function(e,t){var n=e+"Styles",i=document.getElementById(n);i||(i=document.createElement("style"),i.setAttribute("type","text/css"),i.setAttribute("id",n),document.getElementsByTagName("head")[0].appendChild(i)),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}(),function(){"use strict";P.HoverIntent=function(e,t){this.$el=e,this.options=_.extend({sensitivity:10,enterDelay:0,exitDelay:0,interval:40},t),this.$el.on("mouseenter mouseleave",_.bind(this._handleHover,this))},_.extend(P.HoverIntent.prototype,Backbone.Events,{_checkMouseEnter:function(){this._clearTimeout(),this._isMouseStill()?this._onMouseEnterComplete():(this._setPreviousXY(this._currX,this._currY),this._timeout=setTimeout(_.bind(this._checkMouseEnter,this),this.options.interval))},_clearTimeout:function(){this._timeout&&(this._timeout=clearTimeout(this._timeout))},_handleHover:function(e){this._clearTimeout();var t=this;"mouseenter"===e.type?(this._onMouseEnterStart(),this.options.enterDelay?(this._setPreviousXY(e.pageX,e.pageY),this.$el.on("mousemove.HoverIntent",function(e){t._setCurrentXY(e.pageX,e.pageY)}),this._isEntered||(this._timeout=setTimeout(function(){t._checkMouseEnter()},this.options.enterDelay))):this._onMouseEnterComplete()):(this._onMouseOutStart(),this._isEntered&&(this._timeout=setTimeout(function(){t._onMouseOutComplete()},this.options.exitDelay)))},_isMouseStill:function(){var e=Math.abs(this._prevX-this._currX),t=Math.abs(this._prevY-this._currY);return e||t||(e=0,t=0),e+t<this.options.sensitivity},_onMouseEnterStart:function(){this.trigger(P.CONST.EVENT_HOVERINTENT_ENTER_START)},_onMouseEnterComplete:function(){this.$el.off("mousemove.HoverIntent"),this._isEntered=1,this.trigger(P.CONST.EVENT_HOVERINTENT_ENTER_COMPLETE)},_onMouseOutStart:function(){this.$el.off("mousemove.HoverIntent"),this.trigger(P.CONST.EVENT_HOVERINTENT_OUT_START)},_onMouseOutComplete:function(){this._clearTimeout(),this._isEntered=0,this.trigger(P.CONST.EVENT_HOVERINTENT_OUT_COMPLETE)},_setCurrentXY:function(e,t){this._currX=e,this._currY=t},_setPreviousXY:function(e,t){this._prevX=e,this._prevY=t}})}(),function(){var e=P.Logger.getLogger("Resource"),t="/resource/",n="-end-";P.Resource=function(e,t){_.bindAll(this,"onResponseSuccess","onResponseError"),this.name=e,this.options=t},_.extend(P.Resource.prototype,Backbone.Events,{setOptions:function(e){this.options=e,this.trigger("setOptions",e)},set:function(e,t){this.options[e]=t,this.trigger("set",e,t)},get:function(e){return this.options[e]||null},copy:function(e){return new P.Resource(this.name,this.copyOptions(e))},copyOptions:function(e){var t=_.clone(this.options);return t&&e&&delete t.bookmarks,t},getUrl:function(e){var n=t+this.name+"/";return e&&(n=n+e+"/"),n},call:function(t,n){var i=this;n=n||{};var o=this.getUrl(t),r=n.success||P.NOOP,s=n.complete||P.NOOP,a=n.error,l=n.options||{},u=n.async||!0,c=new $.Deferred,d={options:this.options};_.extend(d,l),d.context=P.CONTEXT,this.xhr&&this.xhr.abort();var h=function(e){var t=e.error;return e.resource_response&&e.resource_response.error&&(t=e.resource_response.error),t?(p(t,e),void 0):(i.onResponseSuccess(e),r(e),c.resolve(e),void 0)},p=function(e,t){return 403!==e.http_status||P.currentUser.isAuthenticated()?(i.onResponseError(e,t),a?a(e,t):P.showError(e.message),c.reject(e,t),void 0):(window.location.href="/login/",void 0)},f={data:JSON.stringify(d),source_url:P.getCurrentUrl()};return P.state.activeTarget&&(f.module_path=P.state.activeTarget.getFullName()),this.xhr=$.ajax({cache:!1,url:o,async:u,data:f,dataType:"json",type:"get"===t?"get":"post",success:P.stopwatch.wrapContinuation("Resource.call success",h),error:P.stopwatch.wrapContinuation("Resource.call error",function(t,n){if("abort"!==n){var i=null,o=null,r=-1;if((t.responseText||"").match(/^\{.*\}$/))try{o=JSON.parse(t.responseText),i=o.error&&o.error.message,r=o.error&&o.error.api_error_code}catch(s){e.debug("Tried parsing the error response but failed")}p({message:i||P.string("errorMessage"),http_status:t.status,code:3,api_error_code:r},o)}}),complete:P.stopwatch.wrapContinuation("Resource.call complete",function(){i.xhr=null,s.apply(null,arguments)})}),this.trigger("call",t,d),c.promise()},abort:function(){this.xhr&&this.xhr.abort()},resetBookmark:function(){this.options&&delete this.options.bookmarks},atEnd:function(){var e=this.options.bookmarks;return e&&_.last(e)===n},onResponseSuccess:function(e){e&&e.resource&&this.setOptions(e.resource.options),this.trigger("response",e),e.context&&P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_APP_VERSION,e.context.app_version),P.CONTEXT=e.context,e.page&&(e.page.title||_.keys(e.page.meta).length)&&P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_PAGE_INFO,e.page)},onResponseError:function(t,n){var i={type:"sentry",http_status:t.http_status,error_message:t.message,error_target:t.target};n&&(i.api_code=n.api_error_code),e.error("Request error for "+this.name,i),this.trigger("error",t)},isEqual:function(e){if(this.name!==e.name)return!1;var t=_.omit(this.options,"bookmarks"),n=_.omit(e.options,"bookmarks");return _.isEqual(t,n)},toString:function(){var e=_.omit(this.options,"bookmarks","field_set_key");return this.name+"("+P.toArgumentString(e)+")"},isCalling:function(){return!!this.xhr}}),P.stopwatch.wrapMethods(P.Resource.prototype,"Resource",["call"]),P.Resource.NOOP_RESOURCE={name:"NoopResource",options:{}}}(),function(){var e=function(){this.nameToConstructorFn={}};e.prototype={create:function(e,t){var n=this.nameToConstructorFn[e];return n?new n(t):new P.Resource(e,t)},register:function(e,t){this.nameToConstructorFn[e]=t}},P.resourceFactory=new e}(),function(){var e=function(){};e.prototype={call:function(e,t){t=t||{};var n=new $.Deferred,i=t.success||P.NOOP,o=t.complete||P.NOOP;if("get"===e){var r=P.getDebugWindow(),s=P.Logger.getAll();r&&(s=r.P.Logger.getAll()),s=_.sortBy(s,function(e){return e.name.toLowerCase()});for(var a=3,l=Math.ceil(s.length/a),u=[],c=0;c<a;c++){for(var d=[],h=0;h<l;h++){var p=c*l+h;if(p>=s.length)break;d.push(s[p])}u.push(d)}var f={levels:_.pairs(r.P.Logger.LOG_LEVEL),loggerColumns:u};i(f),o(f),n.resolve(f)}else n.reject("invalid args");return n.promise()},resetBookmark:function(){}},P.resourceFactory.register("LogLevelResource",e)}(),function(){P.ModalManager=function(e){_.bindAll(this,"_onModalDestroyed","_onKeyup"),this.$container=e||$("body"),this.modals=[]},_.extend(P.ModalManager.prototype,{showModal:function(e,t){return this.modals.push(e),this.$container.append(e.getElement()),e.moduleOpener=t,e._setInDom(!0),e.on(P.CONST.EVENT_DESTROYED,this._onModalDestroyed),e.show(),1===this.modals.length&&this._addListeners(),e},removeModal:function(e){e.destroy()},removeAllModals:function(e){_.each(this.modals,function(t){(e||t.getCanDismiss())&&t.destroy()})},showInModal:function(e,t,n){var i={module:e};_.extend(i,t);var o=this,r={name:"Modal",options:i};P.loadModule(r,function(e){o.showModal(e,n)})},_onModalDestroyed:function(e){var t=e.target;t.off(P.CONST.EVENT_DESTROYED,this._onModalDestroyed),this.modals=_.filter(this.modals,function(e){return t!==e}),this.modals.length||this._removeListeners()},_addListeners:function(){$(document).on("keyup",this._onKeyup)},_removeListeners:function(){$(document).off("keyup",this._onKeyup)},_onKeyup:function(e){e.keyCode===P.keyCode.ESCAPE&&this.removeAllModals(!1)}});var e=null;P.stopwatch.wrapMethods(P.ModalManager.prototype,"ModalManager",["showModal","showInModal"]),P.ModalManager.instance=function(){return e||(e=new P.ModalManager),e}}(),function(){"use strict";function e(e,t,i,o){var r=$.Deferred(),s=[],a=e.$el,l=_.map(t,i);return $.when.apply($,l).then(function(){_.each(arguments,function(e){s=s.concat(e.errors)});var t={$el:a,errors:s};e.trigger(n,t),o&&o(t),r.resolve(t)}),r.promise()}var t="hasError",n="validated",i="disabled",o="[type=submit]",r=100,s=["pinterest","password","123456","welcome","ninja","abc123","123456789","12345678","sunshine","princess","qwerty","master","michael","jordan","dragon","soccer","killer","pepper","devil","princess","1234567","iloveyou"],a=function(e,t){this.$el=e,this.rules=t};_.extend(a.prototype,Backbone.Events,{validate:function(t){var n=this;return e(this,this.rules,function(e){return e(n.$el)},t)}}),a.Required=function(e){return function(t,n){var i=$.Deferred(),o=t.val(),r=[],s="checkbox"===t.attr("type")&&!t.is(":checked"),a="radio"===t.attr("type")&&!t.is(":checked");if(s||a||!o){var l=e&&e.message?e.message:P.string("formFieldRequired");r.push(l)}var u={$el:t,errors:r};return n&&n(u),i.resolve(u),i.promise()}},a.Email=function(e){return function(t,n){var i=$.Deferred(),o=$.trim(t.val()),r=[];if(o&&!o.match(/.+@.+\..+/gi)){var s=e&&e.message?e.message:P.string("formEmailNotValid");r.push(s)}var a={$el:t,errors:r};return n&&n(a),i.resolve(a),i.promise()}},a.URL=function(e){return function(t,n){var i=$.Deferred(),o=t.val(),r=[];if(o&&!o.match(/^(https?:\/\/){0,1}[a-z0-9_\-]+\..+/gi)){var s=e&&e.message?e.message:P.string("formURLNotValid");r.push(s)}var a={$el:t,errors:r};return n&&n(a),i.resolve(a),i.promise()}},a.Password=function(e){return function(t,n){var i=$.Deferred(),o=t.val(),r=[],a={shortPassStr:e&&e.shortPassStr?e.shortPassStr:P.string("passwordTooShort"),badPassStyle:e&&e.badPassStyle?e.badPassStyle:P.string("passwordBadStyle"),samePasswordStr:e&&e.samePasswordStr?e.samePasswordStr:P.string("passwordSamePasswordStr"),blackPassStr:e&&e.blackPassStr?e.blackPassStr:P.string("passwordBlackPasswordStr"),goodPassStr:e&&e.goodPassStr?e.goodPassStr:P.string("passwordGoodPasswordStr"),userid:$('[name="username"]').length?$('[name="username"]').val():""},l=$.fn.teststrength(o,a,s);if(l.length){var u=l[l.length-1];if(u){var c=l[0];r.push(c)}}var d={$el:t,errors:r};return n&&n(d),i.resolve(d),i.promise()}},a.Length=function(e){return function(t,n){var i,o,r=$.Deferred(),s=t.val(),a=e.max||1/0,l=e.min||0,u=[],c=s.length;c<l?(i="Please enter at least "+l+" characters.",o=e&&e.messages&&e.messages.min?e.messages.min:i,u.push(o)):c>a&&(i="Please enter no more than "+a+" characters.",o=e&&e.messages&&e.messages.max?e.messages.max:i,u.push(o));var d={$el:t,errors:u};return n&&n(d),r.resolve(d),r.promise()}},P.Validator=a,P.Form=function(e,t,i){var o=this;i=i||{},this.$el=e,this.validators={},this.errorFields={},this.fastValidateFields={},this.prevalidating=!!i.prevalidate,_.bindAll(this,"onFieldBlur","onFieldChange","onFieldKeyup","onFieldValidated"),_.each(t,function(e,t){var i=o.getField(t);if(i[0]){var r=new P.Validator(i,e);o.validators[t]=r,r.on(n,o.onFieldValidated),i.on("blur",o.onFieldBlur),i.on("change",o.onFieldChange),i.on("keyup",o.onFieldKeyup)}else P.log("WARN",t+" wasn't found in the form")}),this.prevalidating&&this.validate(function(){o.prevalidating=!1}),e.submit(function(){return o.trigger("submitStarted",e),o.validate(function(e,t){o.trigger(P.CONST.EVENT_SUBMIT_VALIDATED,e,t)}),!1}),e.find("[placeholder]").placeholder()},_.extend(P.Form.prototype,Backbone.Events,{validate:function(t){return e(this,this.validators,function(e){return e.validate()},t)},getField:function(e){return this.$el.find("[name="+e+"]")},getFieldErrorMessages:function(e){return e.nextAll(".formErrorMessage")},getFieldLabels:function(e){var t=e.attr("id"),n=this.$el.find('label[for="'+t+'"]'),i=e.closest("label",this.$el);return n.add(i)},validateField:function(e,t){var n=e.attr("name");return this.validators[n].validate(t)},getValue:function(e){var t=this.getField(e);return"checkbox"===t.attr("type")?"checked"===t.attr("checked"):t.val()},getSubmitButtons:function(){return this.$el.find(o)},disableSubmitButtons:function(){this.getSubmitButtons().prop(i,!0)},enableSubmitButtons:function(){this.getSubmitButtons().prop(i,!1)},hasErrors:function(){return _.find(this.errorFields,function(e){return e})||!!this.$el.find("."+t)[0]},setFieldErrors:function(e,n){this.clearFieldErrorMessages(e);var i=!!n[0];if(this.errorFields[e.attr("name")]=i,!this.prevalidating){var o=this.getFieldLabels(e),r=o.add(e);r.toggleClass(t,i),this.appendFieldErrorMessages(e,n)}},appendFieldErrorMessages:function(e,t){t&&t.length&&e.parent().children().last().after('<p class="formErrorMessage">'+t.join(" ")+"</p>")},clearFieldErrorMessages:function(e){var t=this.getFieldErrorMessages(e);t.remove()},enableFastValidateOnField:function(e){this.fastValidateFields[e]=1},onFieldValidated:function(e){var t=e.$el,n=e.errors;n[0]&&this.enableFastValidateOnField(t.attr("name")),this.setFieldErrors(t,n),this.hasErrors()?this.disableSubmitButtons():this.enableSubmitButtons()},onFieldKeyup:function(e){if(e.keyCode!==P.keyCode.TAB){var t=$(e.target);this.fastValidateFields[t.attr("name")]&&this.validateField(t)}},onFieldBlur:function(e){var t=this,n=$(e.target);_.delay(function(){t.validateField(n)},r)},onFieldChange:function(e){var t=$(e.target);this.validateField(t)}})}(),function(){P.BrowserHistory=function(e){this._onRemoved=e,this._uidToData={},this._views=[],this._currentIndex=-1},_.extend(P.BrowserHistory.prototype,{add:function(e){var t=this.getCurrentUid(),n=void 0===this._uidToData[t],i=n&&null!==t;t=null!==t?t:this._getNewUid(),n?(i||(this._removeViewsAfter(this._currentIndex),this._saveState(t)),this._insert(t)):this._currentIndex=this._views.indexOf(t),this._uidToData[t]=e},_insert:function(e){var t=this._views.length;if(0===t||e>this._views[t-1])return this._views.push(e),this._currentIndex=t,void 0;for(var n=0;n<t;n++){var i=this._views[n];if(e<i){this._views.splice(n,0,e),this._currentIndex=n;break}if(e===i){this._currentIndex=n,P.log("ERROR","Duplicate uid in browser history.");break}}},_removeViewsAfter:function(e){e<0&&(e=-1);var t=this,n=this._views.slice(e+1);_.each(n,function(e){var n=t._uidToData[e];t._onRemoved&&t._onRemoved(n),delete t._uidToData[e]}),this._views=this._views.slice(0,e+1)},_saveState:function(e){window.history.replaceState({uid:e},document.title,window.location.href)},getCurrentUid:function(){var e=window.history.state&&void 0!==window.history.state.uid?window.history.state.uid:null;return e},_getNewUid:function(){return window.history.length},getCurrent:function(){return this._uidToData[this.getCurrentUid()]},get:function(e){return this._uidToData[e]}})}(),function(){P.SimpleBrowserHistory=function(){this._uidToData={}},_.extend(P.SimpleBrowserHistory.prototype,{add:function(e){var t=this.getCurrentUid();t=null!==t?t:this._getNewUid(),this._uidToData[t]=e},getCurrentUid:function(){return window.location.href},_getNewUid:function(){return window.location.href},getCurrent:function(){return this._uidToData[this.getCurrentUid()]},get:function(e){return this._uidToData[e]}})}(),function(){var e=10,t=function(e,t){this.uid=e,this.item=t,this.next=null,this.prev=null};P.LruCache=function(t){this._maxNumItems=t||e,this._uidToData={},this._numItems=0,this._firstData=null,this._lastData=null},_.extend(P.LruCache.prototype,{set:function(e,n){var i=this._uidToData[e];i||(i=new t(e,n),this._uidToData[e]=i,this._numItems+=1),this._moveToFront(i),this._numItems>this._maxNumItems&&this._evict()},get:function(e){var t=this._uidToData[e];return t?(this._moveToFront(t),t.item):null},remove:function(e){var t=this._uidToData[e];t&&(delete this._uidToData[e],this._firstData===t&&(this._firstData=t.next),this._lastData===t&&(this._lastData=t.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),this._numItems-=1)},_moveToFront:function(e){this._firstData!==e&&(this._firstData?(this._lastData===e&&(this._lastData=e.prev),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this._firstData.prev=e,e.next=this._firstData,e.prev=null,this._firstData=e):(this._firstData=e,this._lastData=e))},_evict:function(){delete this._uidToData[this._lastData.uid],this._firstData===this._lastData?(this._firstData=null,this._lastData=null):(this._lastData=this._lastData.prev,this._lastData.next=null),this._numItems-=1}})}(),function(){var e=10,t=function(e,t,n){this.url=e,this.moduleUid=t,this.backgroundModuleUid=n||null,this.numHopsToBackground=0},n=function(e,t){this.module=e,this.backgroundModule=t||null},i=function(){this._browserHistory=null,this._seenModules=null,this._pageInfoCache={},this._init()};_.extend(i.prototype,{start:function(e){this._init(),e&&(e.uid=this._getNewUid(e),this._addToHistory(e,null))},_init:function(){this._seenModules=new P.LruCache(e),this._browserHistory=new P.SimpleBrowserHistory},navigate:function(e,t){t.fromHistoryUid=this._browserHistory.getCurrentUid(),t.reuseLast=!!t.handled,P.navigate(e,t,{})},getModule:function(e,t){var i=null,o=null,r=null,s=null;return s=t.reuseLast?this._browserHistory.get(t.fromHistoryUid):this._browserHistory.getCurrent(),s&&(i=this._seenModules.get(s.moduleUid),r=s.moduleUid,o=this._seenModules.get(s.backgroundModuleUid)),i||(i=new e({}),r=null!==r?r:this._getNewUid(i),i.uid=r),this._addToHistory(i,o),new n(i,o)},updateBackgroundModule:function(e,t){var n=this._browserHistory.getCurrent(),i=this._browserHistory.get(t.fromHistoryUid);e?(n.backgroundModuleUid=e.uid,this._seenModules.set(e.uid,e),t.fromNavigate&&i&&(n.numHopsToBackground=i.numHopsToBackground+1)):(n.backgroundModuleUid=null,n.numHopsToBackground=0)},cancelNavigation:function(){var e=this._browserHistory.getCurrent();this._seenModules.remove(e.moduleUid),this._go(-1)},closeCurrentModule:function(){var e=this._browserHistory.getCurrent();e&&0!==e.numHopsToBackground&&this._go(-e.numHopsToBackground)},setPageInfo:function(e){var t=this._getUrl();this._pageInfoCache[t]=e},getPageInfo:function(e){return e=e||this._getUrl(),this._pageInfoCache[e]},_go:function(e){window.history.go(e)},_getUrl:function(){return window.location.href},_getNewUid:function(e){return e.cid},_addToHistory:function(e,n){var i=this._getUrl(),o=n?n.uid:null,r=this._browserHistory.getCurrent();r||(r=new t(i,e.uid,o)),this._browserHistory.add(r),this._seenModules.set(e.uid,e),n&&this._seenModules.set(o,n)}}),P.stopwatch.wrapMethods(i.prototype,"PushStateHistoryManager",["closeCurrentModule"]);var o=function(){this._pageInfoCache={}};_.extend(o.prototype,{start:P.NOOP,navigate:function(e,t){P.navigate(e,t,{})},getModule:function(e){return[new e({}),[]]},updateBackgroundModule:P.NOOP,cancelNavigation:P.NOOP,closeCurrentModule:P.NOOP,setPageInfo:function(e){var t=this._getUrl();this._pageInfoCache[t]=e},getPageInfo:function(e){return e=e||this._getUrl(),this._pageInfoCache[e]},_getUrl:function(){return window.location.href}}),P.HistoryManager=P.useHistory()?i:o,window.P_TEST_MODE&&(P.PushStateHistoryManager=i,P.NoPushStateHistoryManager=o,P.HistoryRecord=t)}(),function(){var e="placeholder",t="placeholder",n="placeholder-visible",i=e in document.createElement("input");if(i)return jQuery.fn.placeholder=function(){return this},void 0;var o={initPlaceholder:function(){this.blur(o._onPlaceholderBlur),this.focus(o._onPlaceholderFocus),this.each(function(e,t){o._setPlaceholder(t)})},_onPlaceholderBlur:function(){o._setPlaceholder(this)},_setPlaceholder:function(i){var o=$(i),r=o.val();r.length||(i[n]=!0,o.addClass(t),i.value=o.attr(e))},_onPlaceholderFocus:function(){o._clearPlaceholder(this)},_clearPlaceholder:function(e){var i=$(e);e[n]&&(e[n]=!1,i.removeClass(t),e.value="")}};jQuery.fn.placeholder=function(){return o.initPlaceholder.apply(this),this
};var r={get:function(t){var i=$(t),o=t[n];return o&&i.attr(e)===t.value?"":t.value},set:function(e,t){var i=$(e);return t&&e[n]?o._clearPlaceholder(e):t||o._setPlaceholder(e),e.value=t,o._setPlaceholder(e),i}};P.log("Adding hooks on input and textarea for placeholders."),$.valHooks.input=r,$.valHooks.textarea=r,$(document).delegate("form","submit",function(){var e=$("input",this).each(o._clearPlaceholder);window.setTimeout(function(){e.each(o._setPlaceholder)},10)})}(),function(){P.Positioning={positionElementAtAnchor:function(e,t,n,i,o){var r=P.CONST.PositionPointFlag,s=t.offset();e.offset();var a=e.outerWidth(),l=t.outerWidth(),u=0,c=0;if(n&r.FLAG_VERTICAL_BOTTOM||n&r.FLAG_VERTICAL_TOP?(u=n&r.FLAG_VERTICAL_BOTTOM?s.top+t.outerHeight():s.top-e.outerHeight(),c=n&r.FLAG_VERTICAL_LEFT?s.left:n&r.FLAG_VERTICAL_RIGHT?s.left+l-a:s.left+(l-a)/2):(n&r.FLAG_HORIZONTAL_LEFT||n&r.FLAG_HORIZONTAL_RIGHT)&&(c=n&r.FLAG_HORIZONTAL_LEFT?s.left-a:s.left+l,u=n&r.FLAG_HORIZONTAL_TOP?s.top:n&r.FLAG_HORIZONTAL_BOTTOM?s.top+t.outerHeight()-e.outerHeight():s.top+(t.outerHeight()-e.outerHeight())/2),i){var d=u-$(window).scrollTop();d>0&&(u=d)}var h={left:c,top:u};return o&&(h=this.checkIfInViewportAndAdjustAccordingly(e,h,n)),e.css(h),n},checkIfInViewportAndAdjustAccordingly:function(e,t){e.offset();var n,i,o=e.width(),r=t.left,s=t.top,a=r+o,l=7;a>P.Viewport.width?n=r-(a-P.Viewport.width+l):r<0&&(n=l);var u={};return u.left=n?n:r,u.top=i?i:s,u}}}(),function(){P.TransitionState={NOT_STARTED:0,STARTED:1,ENDED:2};var e=function(e){return{"animation-duration":e,"-webkit-animation-duration":e,"-o-animation-duration":e}},t=function(e){return{width:e.width+"px",height:e.height+"px"}},n=function(e){return{top:e.top+"px",left:e.left+"px"}},i=function(e){return{transition:e,"-moz-transition":e,"-webkit-transition":e,"-o-transition-duration":e}};P.Transition=function(e,t,n,i){this.element=e,this.endPos=t,this.endDim=n,this.duration=i,this.state=P.TransitionState.NOT_STARTED,this.listener=null},_.extend(P.Transition.prototype,{start:function(){this.state=P.TransitionState.STARTED,this.onStart(),this.listener.started();var e=this;setTimeout(function(){e.end()},this.duration)},end:function(){this.state=P.TransitionState.ENDED,this.onEnd(),this.listener.ended()},addListener:function(e){this.listener=e},onStart:function(){},onEnd:function(){}}),P.Transition.extend=Backbone.View.extend,P.Transition.Zoom=P.Transition.extend({onStart:function(){var e=this.duration/1e3,o="all "+e+"s ease-out",r=_.extend({position:"fixed"},i(o),t(this.endDim),n(this.endPos));this.element.css(r)}}),P.Transition.Spin=P.Transition.extend({onStart:function(){var o=this.duration/1e3+"s",r="all "+o+" ease-out",s=_.extend({position:"fixed"},i(r),e(o),t(this.endDim),n(this.endPos));this.element.addClass("rotate").css(s)}})}(),function(){var e=null,t=function(){};_.extend(t.prototype,Backbone.Events,{connect:function(e,t){t=_.extend({},{success:P.NOOP,error:P.NOOP,complete:P.NOOP},t);var n,i=P.FacebookDialog._getWindowOptions();if(n=window.open("/connect/"+e+"/",null,i),!n)return P.showError(P.string("popupErrorMessage")),void 0;var o=this,r=setInterval(function(){n.closed&&(clearInterval(r),o.handleComplete({network:e,error_message:"Window closed."}))},1e3);this.once("connect:"+e,function(e){clearInterval(r),e.error_message?t.error(e):t.success(e),t.complete()})},complete:function(e){var t=JSON.parse(e);this.handleComplete(t)},handleComplete:function(e){var t="connect:"+e.network;this.trigger(t,e)}}),_.extend(t,{instance:function(){return e||(e=new t),e},FACEBOOK:"facebook",TWITTER:"twitter",GOOGLE:"google",YAHOO:"yahoo"}),P.SocialConnect=t}(),function(){P.FacebookDialog={open:function(e){var t=this._getWindowUrl(e),n=this._getWindowOptions();return window.open(t,null,n)},_getWindowUrl:function(e){var t=["description","name","picture"],n=_.extend({app_id:P.FB_KEY,display:"popup"},_.pick(e,t));n.link=P.absolutify(e.path),n.redirect_uri=P.absolutify("/close_window/");var i=_.contains(["send","feed"],e.type),o=i?e.type:"feed",r="https://www.facebook.com/dialog/"+o+"?",s=$.param(n);return r+s},_getWindowOptions:function(){var e=580,t=400,n=screen.width,i=screen.height,o=Math.round((n-e)/2),r=i>t?Math.round((i-t)/2):0;return"scrollbars=yes,resizable=yes,toolbar=no,location=yes,width="+e+",height="+t+","+"left="+o+",top="+r}}}(),function(){var e="offsite_",t="-";P.SafeLink={open:function(n,i){var o=Math.round(1e3*Math.random())+"",r=Math.round(1e3*Math.random())+"";Cookie.set(e+o,r);var s={token:o+t+r,url:n};i&&(s.pin=i),P.changeWindowLocation("/offsite/?"+$.param(s),!0)},validateToken:function(n){if(!n)return!1;var i=n.split(t),o=i[0],r=i[1],s=e+o,a=Cookie.get(s,r);return Cookie.unset(s),a===r},checkLink:function(e,t){var n={name:"ConfirmDialog",options:{template:"offsite_warning"},resource:{name:"OffsiteLinkResource",options:{url:e,pin_id:t&&t.pin_id}}};P.loadModule(n,function(e){e.render(function(){var n=e.data,i=t&&t.proceed,o=t&&t.cancel;n&&"safe"===n.redirect_status?i&&i(n):(P.ModalManager.instance().showInModal(e),e.on(P.CONST.EVENT_CONFIRM,function(){i&&i(n),e.off(P.CONST.EVENT_DESTROYED,o)}),e.on(P.CONST.EVENT_DESTROYED,o),e.on("navigate",function(e){e.data.$el&&e.data.$el.hasClass("safe")&&(e.stopPropagation(),window.location.replace(e.data.url))}))})})}}}(),function(){P.Updater=function(){this.decay=0,this.lastFetchTime=0,this.timeout=null,this.recentPinId=null,this.updatesResource=new P.Resource("UpdatesResource",{});var e=this;$(document).on("mousemove",_.throttle(function(){e.wake()},1e3)),this.deferredFetch()},_.extend(P.Updater.prototype,Backbone.Events,{getUpdatesResourceOptions:function(){var e={};return this.recentPinId&&(e.last_pin_id=this.recentPinId),e},setRecentPinId:function(e){this.recentPinId=e},wake:function(){this.msSinceLastFetch()>P.CONST.UPDATES_MIN_POLL&&(this.decay=0,this.fetch())},fetch:function(){var e=this;clearTimeout(this.timeout),this.lastFetchTime=(new Date).getTime(),this.updatesResource.setOptions(this.getUpdatesResourceOptions()),this.updatesResource.call("get",{success:function(t){var n=t.resource_response.data;_.each(n,function(t,n){e.trigger(n,t)}),e.deferredFetch()},error:function(){e.decay=1e4,e.deferredFetch()}})},deferredFetch:function(){this.decay=Math.min(2*(this.decay||1e3),P.CONST.UPDATES_MAX_POLL);var e=this;this.timeout=setTimeout(function(){e.fetch()},P.CONST.UPDATES_MIN_POLL+this.decay)},msSinceLastFetch:function(){return(new Date).getTime()-this.lastFetchTime}}),P.Updater.instance=function(){return P.Updater._instance||(P.Updater._instance=new P.Updater),P.Updater._instance}}(),function(){var e=5;P.TypeaheadProvider=function(t){t=t||{},this.tags=t.tags,this.enable_recent_queries=!!t.enable_recent_queries,this.searchResource=new P.Resource("TypeaheadResource",{tags:t.tags,pin:t.pin_id,count:e}),this.itemsCache=new P.LruCache},_.extend(P.TypeaheadProvider.prototype,Backbone.Events,{search:function(e,t){var n;if(e=$.trim(e),!e&&"sendPin"===this.tags)return this.abortSearch(),this.publishData(e,[],t);if(!e&&this.enable_recent_queries&&P.currentUser&&P.currentUser.isAuthenticated())n="recent_search";else{var i=this.itemsCache.get(e);if(i&&i.length)return this.abortSearch(),this.publishData(e,i,t),void 0}this.fetch(e,n,t)},abortSearch:function(){this.searchResource.abort()},publishData:function(e,t,n){var i={term:e,items:t};this.trigger(P.CONST.EVENT_DATA,i),n&&n(i)},setAutocompleteScope:function(e){this.searchResource.set("autocompleteScope",e)},fetch:function(e,t,n){var i=this.searchResource;if(i.isCalling()){var o=i.get("term");if(e===o)return;this.abortSearch()}var r=this;this.searchResource.set("term",e),this.searchResource.set("tags",t||this.tags),this.searchResource.resetBookmark(),this.searchResource.call("get",{success:function(t){var i=t.resource_response.data;r.cacheData(e,i),r.publishData(e,i,n)},error:function(e){r.trigger("fetchError",e)}}),this.warm=!0},cacheData:function(e,t){this.itemsCache.set(e,t)},prefetch:function(){if(!this.warm){var e=new P.Resource("TypeaheadPrepareResource");e.call("get",{success:P.NOOP,error:P.NOOP}),this.warm=!0}}})}(),function(){P.TemplateModuleLoader=function(){this._templates={}},P.TemplateModuleLoader.prototype={cacheTemplate:function(e){var t=this;P.Loader.load([e.name]).done(function(n){var i=n.prototype.moduleRenderer;i.render(e).done(function(e){t._templates[e.name]=e})})},buildTemplateModule:function(e,t,n){var i=this._templates[e],o={name:i.name,options:i.options};P.loadModule(o,function(e){e.loadFromModuleTree(i,!1,function(){e.loadFromData(t,function(){n(e)})})})}};var e=null;P.TemplateModuleLoader.instance=function(){return e||(e=new P.TemplateModuleLoader),e}}(),function(){var e=P.Logger.getLogger("UserRegistration");P.UserRegistration={fastTrackSocialRegistration:function(e){var t=this,n=new $.Deferred;return e===P.SocialConnect.FACEBOOK&&(n=this.fetchNetworkData(e).then(function(e){return t.sendImmediateFbRegisterRequest(e)})),n},sendImmediateFbRegisterRequest:function(e){var t={first_name:e.first_name,last_name:e.last_name,email:e.email,gender:e.gender,social_username:e.username,image_url:e.image_url,facebook_id:e.id,facebook_token:e.access_token,country:null};return this.addExtraSocialParams(P.SocialConnect.FACEBOOK,t),this.register(P.SocialConnect.FACEBOOK,t)},addExtraSocialParams:function(t,n){var i=P.SessionStorage.getItem(P.CONST.SESSION_FACEBOOK_ID),o=P.SessionStorage.getItem(P.CONST.SESSION_FACEBOOK_TOKEN);i&&(n.facebook_id||(n.facebook_id=i),P.SessionStorage.removeItem(P.CONST.SESSION_FACEBOOK_ID)),o&&(n.facebook_token||(n.facebook_token=o),P.SessionStorage.removeItem(P.CONST.SESSION_FACEBOOK_TOKEN)),t!==P.SocialConnect.FACEBOOK||n.facebook_token||(e.error("facebook token wasn't set"),n.facebook_token=P.FB.getAccessToken());var r=P.SessionStorage.getItem(P.CONST.SESSION_KEY_INVITE_FOLLOW);r&&(r.invite_follow_board&&(n.board_to_follow=r.invite_follow_board),r.invite_follow_user&&(n.user_to_follow=r.invite_follow_user))},fetchNetworkData:function(e){var t=new $.Deferred;return e===P.SocialConnect.FACEBOOK?(P.trackRegisterAction("register_facebook"),P.FBEnsureInit(function(){P.FB.getLoginStatus(function(e){if(e.authResponse){var n=["picture","id","first_name","last_name","email","username","gender"],i="/me?fields="+n.join(",");P.FB.api(i,function(e){e&&!e.error?(e.picture&&e.picture.data&&e.picture.data.url&&!e.picture.data.is_silhouette&&(e.image_url=e.picture.data.url),t.resolve(e)):t.reject("P.FB.api errored: "+e.error)})}else t.reject("not authed")},!0)})):t.reject("Unsupported social network: "+e),t.promise()},register:function(e,t){var n=this.getResource(t);return n.call("create",{success:function(e){P.SessionStorage.removeItem(P.CONST.SESSION_KEY_INVITE_FOLLOW),P.log("Login, successful",e)},error:function(n,i){P.showError(n.message);var o=[],r=[];_.each(t,function(e,t){e?r.push(t):o.push(t)});var s=window.navigator,a={error_code:n.code,http_status:n.http_status,userAgent:s.userAgent,platform:s.platform,message:"Sign up error: "+n.message,extraData:{emptyKeys:o,keys:r,network:e},appVersion:P.AppVersion.currentVersion};i&&(i.resource&&i.resource.name&&(a.resource=i.resource.name),i.error&&i.error.api_error_code&&(a.api_error_code=i.error.api_error_code)),$.post("/_/_/report/error/",JSON.stringify(a))}})},getResource:function(e){return new P.Resource("UserRegisterResource",e)}}}(),P.Module.define("AboutLinks",[],function(){return P.Module.extend({events:{}})}),P.Module.define("AddPin",[],function(){var e="loading",t="upload_button",n="url_button",i="recommended_button";return P.Module.extend({onContentReady:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function(o){var r,s=this,a=o.target,l=a.id,u=!1,c=this.options.board_id;a.$el.addClass(e),l===t?r={name:"UploadPin",options:{default_board_id:c}}:l===n?r={name:"AddPinURL",options:{show_title:!0}}:l===i&&(r={name:"AddRecommendedPinsModal",options:{default_board_id:c}},u=!0),r&&P.loadModule(r,function(e){s.modal.setModule(e),u&&s.modal.setTransparentContent(!0)})}})}),P.Module.define("AddPinRep",["ModalTrigger"],function(e){return e.extend({events:{click:"onClick"},onClick:function(){return this.showModal(),!1}})}),P.Module.define("AddPinURL",[],function(){return P.Module.extend({events:{},onContentReady:function(){var e=this.$(".standardForm"),t={url:[P.Validator.Required(),P.Validator.URL()]},n={prevalidate:!0};this.form=new P.Form(e,t,n),this.form.getField("url").placeholder(),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(e){if(!e.errors[0]){var t=this.form.getValue("url");this.navigate("/pin/find/?"+$.param({url:t}))}}})}),P.Module.define("AddRecommendedPinsModal",[],function(){return P.Module.extend({events:{}})}),P.Module.define("AdhocFeedIndexPage",[],function(){return P.Module.extend({events:{}})}),P.Module.define("AdhocFeedPage",[],function(){return P.Module.extend({})}),P.Module.define("Analytics.Metric",[],function(){return P.Module.extend({events:{}})}),P.Module.define("Analytics.MetricChange",[],function(){return P.Module.extend({events:{}})}),P.Module.define("Analytics.MetricGraph",[],function(){return P.Module.extend({events:{"click .legendColorBox":"onClickLegend","click .legendLabel":"onClickLegend",resize:"onResize"},graphContainer:function(){return void 0===this.placeholder&&(this.placeholder=$(".graphPlaceholder",this.el)),this.placeholder},initialize:function(){this.placeholder=void 0,this.disabledSeries={},this.resetCurrentHover()},onAddedToDom:function(){this._addedToDom=!0,this.trySetupGraph()},onContentReady:function(){this._contentReady=!0,this.trySetupGraph()},onRemoved:function(){this.hideDropdown()},resizeGraph:function(){this.updateGraph()},trySetupGraph:function(){this._addedToDom&&this._contentReady&&(this.listen(P.Viewport,P.CONST.EVENT_BODY_COLUMN_CHANGE,this.resizeGraph),this.updateGraph(),this.setupGraphClicks(),this.anchor=$("<em></em>").css({position:"absolute"}).appendTo(this.$el))},onClickLegend:function(e){var t=$(e.target).attr("data-index");this.toggleSeries(t)},toggleSeries:function(e){this.disabledSeries[e]=!this.disabledSeries[e],this.updateGraph()},extractMetricSeries:function(e){var t=this.data;return $.map(t,function(t){var n=1e3*t.timestamp,i=t[e];return[[n,i]]})},buildTimeSeries:function(){for(var e=[],t=0;t<this.options.metric_group.length;t++){var n=this.options.metric_group[t],i=[],o=0===t?"#E6E6FF":"#FAF0B4";this.disabledSeries[t]!==!0&&(i=this.extractMetricSeries(n),o=0===t?"#367CBD":"#C06506");var r=this.options.metric_type_map[n].graph_name;e.push({data:i,label:r,color:o,points:{show:!0,fill:!0,fillColor:o}})}return e},updateGraph:function(){var e=this.buildTimeSeries();this.drawGraph(e)},tickFormatterY:function(e,t){return e<0?"":t.max<1e6?e.toFixed(t.tickDecimals):(e/=1e6,e.toFixed(1)+"m")},timeFormatter:function(e,t){if(e<t.datamin||e>t.datamax)return"";var n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i=new Date(e),o=n[i.getUTCDay()],r=i.getUTCMonth()+1,s=i.getUTCDate();return r+"/"+s+"<br/>"+o},seriesMinMax:function(e,t){for(var n=0,i=Number.MAX_VALUE,o=0;o<e.length;o++)for(var r=e[o].data,s=0;s<r.length;s++){var a=r[s][t];n=n>a?n:a,i=i<a?i:a}return{min:i,max:n}},seriesMinMaxY:function(e){var t=this.seriesMinMax(e,1);return t.min-=.35*t.max,t.max+=.3*t.max,t},seriesMinMaxX:function(e){var t=864e5,n=this.seriesMinMax(e,0),i=n.max-n.min,o=.08*i;return n.max+=Math.max(t,o),n.min-=Math.max(t,o),n},drawGraph:function(e){var t=this.graphContainer(),n=this.seriesMinMaxX(e),i=this.seriesMinMaxY(e),o={series:{shadowSize:1,lines:{show:!0},points:{show:!0,lineWidth:1,fill:!0,radius:5}},legend:{margin:[140,10],noColumns:2,backgroundOpacity:0,labelBoxBorderColor:"rgba(0,0,0,0)"},grid:{backgroundColor:"rgb(249, 249, 249)",borderColor:"rgb(230, 230, 230)",borderWidth:0,minBorderMargin:0,labelMargin:0,clickable:!0,hoverable:!0,axisMargin:0},yaxis:{tickColor:"rgb(230, 230, 230)",reserveSpace:!0,max:i.max,min:i.min,tickFormatter:this.tickFormatterY},xaxis:{tickColor:"rgb(230, 230, 230)",mode:"time",min:n.min,max:n.max,tickFormatter:this.timeFormatter}};$.plot(t,e,o)},checkAndSetNewHover:function(e){var t={dataIndex:e.dataIndex,seriesIndex:e.seriesIndex};return t.dataIndex===this.currentHover.dataIndex&&t.seriesIndex===this.currentHover.seriesIndex?!1:(this.currentHover=t,!0)},onPointHovered:function(e){if(this.checkAndSetNewHover(e)!==!1){var t=this.getChildById("metricPoint");this.pointDropdown=t._dropdown;var n=this.pointDropdown.getChildById("dropdownModule");n.updateData({seriesIndex:e.seriesIndex,date:new Date(e.datapoint[0]),value:e.datapoint[1]}),this.anchor.css({top:e.pageY+10,left:e.pageX}),this.pointDropdown.options.anchor=$(this.anchor),this.pointDropdown.show()}},onPointUnhovered:function(){this.hideDropdown()},hideDropdown:function(){this.pointDropdown&&this.pointDropdown.hide(),this.resetCurrentHover()},resetCurrentHover:function(){this.currentHover={}},setupGraphClicks:function(){var e=this,t=this.graphContainer();t.bind("plothover",function(t,n,i){i?e.onPointHovered(i):e.onPointUnhovered(n)})}})}),P.Module.define("Analytics.MetricOverview",[],function(){return P.Module.extend({events:{}})}),P.Module.define("Analytics.MetricPoint",[],function(){return P.Module.extend({events:{},updateData:function(e){this.updateValue(e.value),this.updateDate(e.date),this.updateMetricClass(e.seriesIndex)},updateDate:function(e){var t=e.days[e.getUTCDay()];this.$(".day").text(t);var n=e.getMonthName(),i=n+" "+e.getUTCDate()+", "+e.getFullYear();this.$(".date").text(i)},updateValue:function(e){this.$(".value").text(e.toLocaleString())},updateMetricClass:function(e){this.$(".value").removeClass("metric-primary metric-secondary");var t="metric-primary";1===e&&(t="metric-secondary"),this.$(".value").addClass(t)}})}),P.Module.define("Analytics.MetricRecommendation",[],function(){return P.Module.extend({events:{"click .recommendationWrapper":"onClick"},onClick:function(e){e.preventDefault();var t=parseInt($(e.target).attr("data-index"),10);return this.showModal(t),!1},showModal:function(e){var t=this;this.showLoading();var n={name:"Analytics.MetricTipModal",options:{tipIndex:e,tips:this.data}};P.loadModule(n,function(e){P.trackGAEvent("analytics_tips",P.CONST.GA_ACTION_OPEN_MODAL),t.hideLoading(),t.showInModal(e)})}})}),P.Module.define("Analytics.MetricTipModal",[],function(){return P.Module.extend({events:{"click .nextTip":"nextTip","click .prevTip":"prevTip"},onContentReady:function(){this.currentTip=this.options.tipIndex,this.tips=this.$(".tipGroup"),this.showTip(this.currentTip)},showTip:function(e){if(!(e>=this.tips.length||e<0)){this.currentTip=e;var t=this;this.tips.each(function(n,i){var o=e===n;o?($(i).show(),t.$("h1").text($(i).attr("data-title"))):$(i).hide()}),this.updateButtons(e)}},updateButtons:function(e){var t=e<this.tips.length-1;this.toggleButton("nextTipButton",t);var n=e>0;this.toggleButton("prevTipButton",n)},toggleButton:function(e,t){t?this.getChildById(e).enable():this.getChildById(e).disable()},nextTip:function(){this.showTip(this.currentTip+1)},prevTip:function(){this.showTip(this.currentTip-1)}})}),P.Module.define("Analytics.MetricTypeInfo",[],function(){return P.Module.extend({events:{}})}),P.Module.define("AnnotationFeedPage",[],function(){return P.Module.extend({events:{"click .annotationText a":"onClick"},onClick:function(e){var t=$(e.target),n=this.$(".feedName");n.text(t.text()),this.$(".highlight").removeClass("highlight"),t.parent().addClass("highlight"),this.updateFeedGrid(new P.Resource("AnnotatedPinsResource",{term:t.text()}))},updateFeedGrid:function(e){var t=this.getChildById("feedGrid"),n=this;this.$el.css("height",this.$el.height()),t.emptyItems(),t.setItemsResource(e),t.renderItems(function(){P.NOOP(),n.$el.css("height","auto")})}})}),P.Module.define("App",["Header","Grid","Modal","ScrollToTop"],function(){var e="mainModule",t="Closeup",n=500,i="HomePage",o={REPLACE:0,REPLACE_TOP:1,APPEND:2,CLOSE:3,IGNORE:4},r=P.Module.extend({events:{},initialize:function(){this.modalManager=null,this.historyManager=new P.HistoryManager,this.backgroundModule=null,this.canUpdatePageInfo=!1,P.currentUser.isAuthenticated()||P.currentUser.attemptLogin()},onAddedToDom:function(){P.router.start(),P.AppVersion.setup(P.CONTEXT.app_version),this.childListen(P.CONST.EVENT_NAVIGATE,this.onChildNavigate),this.childListen("modal",this.onChildModal),this.childListen("close",this.onChildClose),this.childListen("switchToOld",this.switchToOld),this.listen(P.router,"route",this.onRoute),this.listen(P.router,"404",this.onRouteNotFound),this.modalManager||(this.modalManager=P.ModalManager.instance());var e={};e[P.CONST.PUBSUB_TOPIC_PAGE_INFO]=this.onPageInfoChange,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_SITE,e)},showWelcomeDialog:function(){Cookie.unset(P.CONST.COOKIE_SHOW_WELCOME);var e={name:"ConfirmDialog",options:{template:"welcome"}},t=this;P.loadModule(e,function(e){t.listen(e,P.CONST.EVENT_DESTROYED,function(){var e=t._getCurrentMainModule();e.className===i&&e.showsFollowingFeed()&&P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_TUTORIAL,P.CONST.PUBSUB_TOPIC_TUTORIAL_CATEGORIES)}),t.modalManager.showInModal(e)})},showFastFollowDialog:function(){var e=this._getCurrentMainModule(),t=e.options.from_fast_follow,n=P.currentUser.get("show_fast_follow");if(!t&&n&&!this.isTutorialActive()&&"HomePage"===e.className){var i={id:"fastFollow",name:"FastFollow",resource:{name:"UserResource",options:{username:P.currentUser.get("username"),field_set_key:"fast_follow"}}};P.loadModule(i,_.bind(function(e){this.showInModal(e,{can_dismiss:!1,mask_type:"dark"})},this))}},isTutorialActive:function(){return P.TutorialManager.instance().isTutorialActive()},onContentReady:function(){P.trackGAPageview();var t=this._getCurrentMainModule();this.setChildId(t,e),this.historyManager.start(t),this.historyManager.setPageInfo(P.PAGE_INFO);var n=Cookie.get(P.CONST.COOKIE_SHOW_WELCOME);if(n){switch(n){case"new":var i="newUser";P.e.nuo_po&&(i="newUserPinIntro"),P.TutorialManager.instance().startTutorial(i);break;case"existing":P.TutorialManager.instance().startTutorial("existingUser");break;default:this.showWelcomeDialog()}Cookie.unset(P.CONST.COOKIE_SHOW_WELCOME)}else P.TutorialManager.instance().resumeTutorial();if(this.showFastFollowDialog(),this.updateScrollWatchers(this._getCurrentMainModule()),P.e.fr){var o=new P.ModuleRenderOptions("PinCreate");o.setOptions({action:"repin"}),P.TemplateModuleLoader.instance().cacheTemplate(o)}},updateScrollWatchers:function(e){var t=this.getChildById("scrollToTop");t&&t.setScroller(e.getScrollableElement())},onRemovedFromDom:function(){P.router.stop(),this._removeListeners()},onChildNavigate:function(e){if(this.midNavigate)return e.stopPropagation(),void 0;var t=e.data.url;if(P.isOffsiteUrl(t)||(this.midNavigate=!0),P.AppVersion.invalid)return window.location.href=t,void 0;this.log.debug("App got navigate event from child",e.target,"for url:",t);var n={handled:!!e.data.handled,evt:e};this.historyManager.navigate(t,n),e.stopPropagation()},onChildModal:function(e){this.log.debug("Got modal event from child",e.target,"for module:",e.data.module),e.stopPropagation(),this.modalManager.showInModal(e.data.module,e.data.extraOptions||{},e.target)},onChildClose:function(){this.historyManager.closeCurrentModule()},onRoute:function(e){if(P.AppVersion.invalid)return window.location.reload(),void 0;this.log.debug("onRoute",e),P.trackGAPageview(e.module);var t=e.module,n=e.options,i=e.resource,o="https:"===window.location.protocol;if(e.https&&!o)return window.location.replace(window.location.href.replace(/http:\/\//,"https://")),void 0;if(!e.https&&o)return window.location.replace(window.location.href.replace(/https:\/\//,"http://")),void 0;this.isTutorialActive()||this.modalManager.removeAllModals(!0);var r=this;P.Loader.require([t],P.stopwatch.wrapContinuation("P.Loader.require callback",function(t){var o=r.historyManager.getModule(t,e.navigateData);return r._getCurrentMainModule()?(r.updateMainModule(o,n,i,e.navigateData),void 0):(window.location.reload(),void 0)}));var s=this.historyManager.getPageInfo();s&&this.setPageInfo(s),this.canUpdatePageInfo=!s},onRouteNotFound:function(){window.location.reload()},onPageInfoChange:function(e,t,n){this.canUpdatePageInfo&&(this.historyManager.setPageInfo(n),this.setPageInfo(n),this.canUpdatePageInfo=!1)},setPageInfo:function(e){e.title&&$(document).attr("title",e.title),$("head meta[data-app]").remove();var t=[];_.each(e.meta,function(e,n){t.push($("<meta>").prop({name:n,property:n,content:e,"data-app":1}))}),$("head").append(t)},startModuleTransition:function(e){var t=this;e.fadeOut(),clearTimeout(this._loaderTimeout),this._loaderTimeout=setTimeout(function(){t.loadingShown=!0,t.showLoading()},n,"App loader")},stopModuleTransition:function(e){clearTimeout(this._loaderTimeout),e.fadeIn(),this.loadingShown&&(this.hideLoading(),this.loadingShown=!1)},_getCurrentMainModule:function(){var t=this.getChildById(e);return t?t:this.children[this.children.length-1]},updateMainModule:function(e,n,i,r){var s=e.module,a=e.backgroundModule,l=this._getCurrentMainModule();l.getScrollableElement().scrollTop(),l.saveExtraState(!0),this.log.debug("Current:",l.className,"New:",s.className);var u=this._getNextAction(l,s,a,r),c=u===o.REPLACE&&l.className!==t&&s.className!==t;c&&this.startModuleTransition(l),s.clearFades();var d=this._getCanClose(l,e,u);null!==d&&(n.can_close=d);var h=null===d||d===!1;P.Body.setScrolling(h);var p=this,f=P.stopwatch.wrapContinuation("updateMainModule cleanup",function(){p.midNavigate=!1,c&&p.stopModuleTransition(s),p.updateScrollWatchers(s)});r.currentModule=l,s.setAsMainModule(n,i,r,P.stopwatch.wrapContinuation(P.CONST.STOPWATCH_SET_AS_MAIN_MODULE_SUCCESS,function(){p._performNextAction(u,l,e,r),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_MAIN_MODULE,P.CONST.PUBSUB_TOPIC_MAIN_MODULE_NEW,_.bind(p._getCurrentMainModule,p)),p.showFastFollowDialog(),f()}),P.stopwatch.wrapContinuation("setAsMainModule failure",function(){p.historyManager.cancelNavigation(),f()}))},_getNextAction:function(e,n,i,r){var s=null;return s=e===n?o.IGNORE:n.className!==t?e.className===t&&e.options.can_close&&this.backgroundModule&&n===this.backgroundModule?o.CLOSE:o.REPLACE:r.fromNavigate?e.className===t?e.options.can_close?o.REPLACE_TOP:o.REPLACE:o.APPEND:e===i&&n.className===t?o.APPEND:o.REPLACE},_getCanClose:function(e,n,i){var r=n.module,s=n.backgroundModule;if(r.className!==t)return null;var a=e.className===t,l=!!e.options.can_close;switch(i){case o.REPLACE:return!!s;case o.REPLACE_TOP:return l;case o.APPEND:return!a||l;case o.IGNORE:return l}return null},_performNextAction:function(t,n,i,r){var s=this,a=i.module,l=i.backgroundModule;n.getElement();var u=a.getElement(),c=t!==o.IGNORE;if(t===o.IGNORE)s.backgroundModule&&s.historyManager.updateBackgroundModule(s.backgroundModule,r);else if(t===o.CLOSE)s.backgroundModule=null,n.detachElement(),s.removeChildId(n);else if(t===o.REPLACE){if(s.backgroundModule!==l&&(s.backgroundModule&&(s.backgroundModule.detachElement(),s.backgroundModule=null),l)){var d=l.getElement();l!==n&&(s.$(".mainContainer").append(d),s.addChild(l)),s.backgroundModule=l}n!==l&&(this.removeChildId(n),n.detachElement()),s.removeChildId(n),u.css("min-height",P.Viewport.height);var h=s.backgroundModule?$(".appendedContainer"):$(".mainContainer");h.append(u),s.addChild(a)}else t===o.REPLACE_TOP?(n.detachElement(),u.css("min-height",P.Viewport.height),$(".appendedContainer").append(u),s.addChild(a),s.historyManager.updateBackgroundModule(s.backgroundModule,r)):t===o.APPEND&&(s.backgroundModule=n,s.removeChildId(n),u.css("min-height",P.Viewport.height),$(".appendedContainer").append(u),s.addChild(a),s.historyManager.updateBackgroundModule(s.backgroundModule,r));c&&(s.setChildId(a,e),a.restoreExtraState(!0))},switchToOld:function(e){this.modalManager.removeAllModals(),this.getScrollableElement().scrollTop(0),this.$el.empty();var t=this,n={name:"ConfirmDialog",options:{template:"goodbye"}},i=function(){var t=e.data;P.changeWindowLocation(t,!1)};P.loadModule(n,function(e){t.listen(e,"rendered",function(){var e=$(".oldHeader");$("body").append(e)}),t.listen(e,P.CONST.EVENT_DESTROYED,i),t.showInModal(e)})},debugNumGridItems:function(){for(var e,t=this,n=[],i=[this];i.length>0;)e=i.pop(),"GridItems"===e.className&&n.push(e),i=i.concat(e.children);return _.each(n,function(e,n){for(var i=e.parent,o=e.className+" has "+e.children.length+" children";i;)o=i.className+"->"+o,i=i.parent;t.log.debug(n+1+": "+o)}),0===n.length&&this.log.debug("There are no grids in the page."),":)"}});return P.Errors.wrap(r.prototype,["initialize","onAddedToDom","onChildNavigate","onChildModal","onContentReady","onRoute","onRouteNotFound"]),P.stopwatch.wrapMethods(r.prototype,"App",["onChildClose","onRoute","updateMainModule"]),r}),P.Module.define("AuthHomePage",["NewPinsIndicator"],function(e){return P.Module.extend({events:{},onContentReady:function(){this._setUpFastFollow(),P.e.nps&&(this.listen(P.Updater.instance(),"new_pins_count",this.onNewPins),this.setRecentPinId())},_setUpFastFollow:function(){this.inDom&&this.contentReady},onBoardInteraction:function(){this.render()},onAddedToDom:function(){this._setUpFastFollow(),this.setRecentPinId()},onRemovedFromDom:function(){P.Updater.instance().setRecentPinId(null)},setRecentPinId:function(){P.e.nps&&P.Updater.instance().setRecentPinId(this.getRecentPinId())},onNewPins:function(e){var t=this.ensureNewPinsIndicator();(e||t.options.count)&&e!==t.options.count&&(P.setTitlePrefix(e),t.options.count=e,t.render(function(){e&&t.show()}))},onNewPinsClick:function(e){e.stopPropagation();var t=this,n=this.ensureNewPinsIndicator(),i=this.getChildById("feedGrid");n.hide(),i&&$("body,html").animate({scrollTop:0},{duration:300,complete:_.once(function(){i.prependNewItems(n.options.count,function(){t.setRecentPinId()}),n.options.count=0})}),P.setTitlePrefix(null)},ensureNewPinsIndicator:function(){var t=this.getChildById("newPins");return t||(t=new e({id:"newPins"}),this.listen(t,"click",this.onNewPinsClick),this.appendChild(t),t.hide()),t},showsFollowingFeed:function(){return!!this.getChildById("feedGrid")},getRecentPinId:function(){var e=this.getChildById("feedGrid");if(!e)return null;var t=e.getFirstGridItem("Pin");return t?t.getPinId():void 0}})}),P.Module.define("AutoFollow",[],function(){return P.Module.extend({events:{},onContentReady:function(){var e={username:this.options.username,username_and_slug:this.options.username_and_slug},t="UserAutoFollowResource",n="/"+this.options.username+"/",i="user_auto_follow";this.options.username_and_slug&&(t="BoardAutoFollowResource",n="/"+this.options.username_and_slug+"/",i="board_auto_follow");var o=new P.Resource(t,e);o.call("create",{success:function(){P.trackGAEvent(i,P.CONST.GA_ACTION_SUCCESS)},error:function(){P.trackGAEvent(i,P.CONST.GA_ACTION_ERROR)},complete:function(){P.navigate(n+"?auto_follow=1")}})}})}),P.Module.define("Board",["Dropdown"],function(e){var t="noShadow",n="follow_view";return P.Module.extend({events:{"click .dismiss":"onDismissClick"},getOwnedScrollables:function(){return this.$(".pinGridWrapper")},getId:function(){return this.data&&this.data.id},onContentReady:function(){var e=this.getId();if(e){var i={};i[P.CONST.PUBSUB_TOPIC_BOARD_COVER_UPDATED]=this.onBoardCoverUpdated,i[P.CONST.PUBSUB_TOPIC_BOARD_DELETED]=this.onBoardDeleted,i[P.CONST.PUBSUB_TOPIC_BOARD_UPDATED]=this.onBoardUpdated,this.pubsubSubscribe(e,i)}"boardPinsGrid"===this.options.view_type&&(this._maxBoardPinsGridHeight=this.$el.css("max-height").replace(/[^0-9]/g,""),this.$el.outerHeight()<this._maxBoardPinsGridHeight&&this.$el.addClass(t)),this.options.view_type===n&&this.initHoverListeners()},onDismissClick:function(){this.dismissed=!0,this.triggerEvent(P.CONST.EVENT_DISMISS,null,!0)},onBoardUpdated:function(){this.render()},onBoardDeleted:function(){this.destroy()},onBoardHoverEnter:function(){this.$el.isHovering()&&this._dropdown.show()},onBoardHoverExit:function(){this._dropdown.getElement().isHovering()||this._dropdown.hide()
},onBoardCoverUpdated:function(e,t,n){this.setBoardCover(n)},positionBoardPinsGrid:function(){var e=this.getChildById("pinGrid");e.$(".activeItem").focus()},initHoverListeners:function(){this._hoverIntent||(this._hoverIntent=new P.HoverIntent(this.getElement(),{enterDelay:500,exitDelay:200}),this.listen(this,P.CONST.EVENT_NAVIGATE,this.onBoardHoverExit),this.listen(this._hoverIntent,P.CONST.EVENT_HOVERINTENT_ENTER_COMPLETE,this.onBoardHoverEnter),this.listen(this._hoverIntent,P.CONST.EVENT_HOVERINTENT_OUT_COMPLETE,this.onBoardHoverExit),this.setActiveStyle=P.NOOP,this.isClickButton=function(){return!1},this._dropdown=new e({options:{anchor:this.getElement(),class_name:"followViewHover underneathHeader",position_point:"RIGHT_TOP",module:{name:"Board",options:{view_type:"boardPinsGrid",scrollable:!0,prevent_default_scroll:!0,board_follow_button_options:{board_id:this.resource.options.board_id}},resource:{name:"BoardResource",options:{board_id:this.resource.options.board_id}}}}}),this.appendChild(this._dropdown),this.$el.initHovering(),this._dropdown.getElement().initHovering())},setBoardCover:function(e){var t=e.url,n=e.crop_x,i=e.crop_y,o=e.nativeHeight,r=e.nativeWidth,s=e.scale,a=this.$(".boardCoverWrapper img");a.attr("src",t).css({height:o*s,left:-n,"max-width":"none",position:"absolute",top:-i,width:r*s});var l=this.getChildById("boardCoverEditButton"),u=l.options.submodule.options;u.board_cover_edit_options.cover_pin_id=e.pin_id},disabledButtons:[],disable:function(){this.$el.find(".hoverMask").addClass("notNavigatable"),this.disabledButtons=[];var e=this;_.each(this.getChildrenByModuleName("ShowModalButton"),function(t){t.isDisabled()||(t.disable(),e.disabledButtons.push(t))})},enable:function(){this.$el.find(".hoverMask").removeClass("notNavigatable"),_.each(this.disabledButtons,function(e){e.enable()})},setFollowButtonState:function(e){var t=this.getChildByModuleName("BoardFollowButton");t&&t.setState(e)}})}),P.Module.define("BoardCollaboratorInvitesBase",[],function(){return P.Module.extend({initialize:function(){this.childListen(P.CONST.EVENT_INVITE_USER,this.onChildInviteUser),this.childListen(P.CONST.EVENT_INVITE_EMAIL,this.onChildInviteEmail)},onChildInviteUser:function(e){var t=this.getChildById("boardInviteForm");t.showLoading();var n=e.data.userId,i={board_id:this.getBoardId(),invited_user_id:n},o=new P.Resource("BoardInviteResource",i);o.call("create",{success:function(){t.clearTypeahead()},complete:function(){t.hideLoading()}})},getBoardId:function(){return this.resource.options.board_id},onChildInviteEmail:function(e){var t=this.getChildById("boardInviteForm");t.showLoading();var n=e.data.email,i={board_id:this.getBoardId(),email:n},o=new P.Resource("BoardEmailInviteResource",i);o.call("create",{success:function(){var e=_.template(P.string("successInviteSentToEmail"));t.clearTypeahead();var i=$("<div class='alert'>"+e({email:n})+"</div>");i.hide().insertAfter(t.$el).fadeIn(function(){i.delay(5e3).fadeOut(function(){i.remove()})})},complete:function(){t.hideLoading()}})}})}),P.Module.define("BoardCollaborators",["BoardCollaboratorInvitesBase"],function(e){return e.extend({onContentReady:function(){this.boardInviteForm=this.getChildById("boardInviteForm");var e=this.getBoardId();if(e){var t={};t[P.CONST.PUBSUB_TOPIC_BOARD_UPDATED]=this.onBoardUpdated,this.pubsubSubscribe(e,t)}},onBoardUpdated:function(){this.render()}})}),P.Module.define("BoardCount",["NavigateButton"],function(e){return e.extend({onContentReady:function(){var t={};t[P.CONST.PUBSUB_TOPIC_BOARD_CREATED]=this.onBoardCountUpdate,t[P.CONST.PUBSUB_TOPIC_BOARD_DELETED]=this.onBoardCountUpdate,t[P.CONST.PUBSUB_TOPIC_BOARD_UPDATED]=this.onBoardCountUpdate,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,t),e.prototype.onContentReady.call(this)},onBoardCountUpdate:function(e,t,n){n.privacy!==P.CONST.BOARD_PRIVACY_SECRET&&this.render()}})}),P.Module.define("BoardCoverEdit",[],function(){return P.Module.extend({pins:null,index:null,prefetchBuffer:10,events:{"click .previous":"previous","click .next":"next"},initialize:function(){_.bindAll(this,"onKeyup","next","previous"),this.$img=$("<img>")},_positionIfReady:function(){!this._positioned&&this.inDom&&this.contentReady&&(this._positioned=!0,this.imageCrop=this.getChildByModuleName("ui.ImageCrop"),this.listen($("body"),"keyup",this.onKeyup),this.coverPinId=this.options.cover_pin_id,this._initializePins(!0))},_initializePins:function(e){if(e&&null!==this.coverPinId){var t={id:this.coverPinId,field_set_key:"board_cover_picker"},n=new P.Resource("PinResource",t),i=this;n.call("get",{success:function(e){i._appendPinsFromData([e.resource_response.data]),i._initializePins()},error:function(){i.coverPinId=null,i._initializePins()}})}else this._appendPinsFromData(this.data),this.setIndex(0),this.updateButtons()},_appendPinsFromData:function(e){this.pins||(this.pins=[]);var t=this;_.each(e,function(e){var n={id:e.id,url:e.images["236x"].url};n.id===t.coverPinId&&t.pins.length||t.pins.push(n)})},onAddedToDom:function(){this._positionIfReady()},onContentReady:function(){this._positionIfReady()},onKeyup:function(e){null!==this.index&&(e.keyCode===P.keyCode.LEFT?this.previous():e.keyCode===P.keyCode.RIGHT&&this.next())},requestMoreIfNeeded:function(){if(!(this.index+this.prefetchBuffer<this.pins.length)&&!this.resource.atEnd()){var e=this;this.resource.call("get",{options:this.options,success:function(t){e.data=t.resource_response.data,e._appendPinsFromData(e.data)},error:function(){e.data=[]}})}},next:function(){if(this.requestMoreIfNeeded(),this.index===this.pins.length-1)return!1;var e=this.index+1;return this.setIndex(e),!1},previous:function(){var e=this.index-1;return this.setIndex(e),!1},setIndex:function(e){var t=this.pins[e];t&&(this.imageCrop.setImage(t.url),this.index=e,this.preload([this.index-2,this.index-1,this.index+1,this.index+2]),this.updateButtons())},preload:function(e){var t=this;_.each(e,function(e){var n=t.pins[e];n&&P.preloadImage(n.url)})},updateButtons:function(){var e=0<this.index;this.$(".previous").toggle(e);var t=this.index<this.pins.length-1||!this.resource.atEnd();this.$(".next").toggle(t)},getBoardCoverData:function(){var e=this.pins[this.index].id,t=this.pins[this.index].url,n=_.extend({},{pin_id:e,pin_image_url:t},this.imageCrop.getCropData());return n}})}),P.Module.define("BoardCoverEditPage",[],function(){var e=P.Module.extend({events:{"click .save":"save","click .cancel":"cancel"},save:function(){P.trackGAEvent("board_edit_cover",P.CONST.GA_ACTION_CLICK_SUBMIT);var e=this.getChildByModuleName("BoardCoverEdit"),t=e.getBoardCoverData(),n=this.getChildById("saveCover");n.showLoading();var i=this,o=_.extend(t,{board_id:this.extraData.boardId,url:i.$(".in").attr("src")}),r=new P.Resource("BoardResource",o);r.call("update",{success:function(){P.trackGAEvent("board_edit_cover",P.CONST.GA_ACTION_SUCCESS),i.destroy(),P.pubsub.publish(i.extraData.boardId,P.CONST.PUBSUB_TOPIC_BOARD_COVER_UPDATED,o)},complete:function(){n.hideLoading()}})},cancel:function(){P.trackGAEvent("board_edit_cover",P.CONST.GA_ACTION_CLICK_CANCEL),this.destroy()}});return e}),P.Module.define("BoardCreate",["BoardEditBase"],function(e){return e.extend({})}),P.Module.define("BoardCreateRep",["ModalTrigger"],function(e){return e.extend({events:{click:"onClick"},onClick:function(){return this.showModal(),!1},onContentReady:function(){var e={};e[P.CONST.PUBSUB_TOPIC_BOARD_CREATED]=this.onBoardCreated,e[P.CONST.PUBSUB_TOPIC_BOARD_DELETED]=this.onBoardDeleted,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,e)},isSecretBoard:function(e){return e.privacy&&e.privacy===P.CONST.BOARD_PRIVACY_SECRET},onBoardDeleted:function(e,t,n){this.isSecretBoard(n)&&this.options.submodule.options.num_secret_boards--},onBoardCreated:function(e,t,n){this.isSecretBoard(n)&&this.options.submodule.options.num_secret_boards++}})}),P.Module.define("BoardEdit",["BoardEditBase"],function(e){return e.extend({initialize:function(t){e.prototype.initialize.call(this,t),this.childListen(P.CONST.EVENT_INVITE_USER,this.onChildInviteUser),this.childListen(P.CONST.EVENT_INVITE_EMAIL,this.onChildInviteEmail),this.childListen(P.CONST.EVENT_CHANGE,this.onChildChange)},onContentReady:function(){e.prototype.onContentReady.call(this);var t={};t[P.CONST.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF]=this.onBoardRemovedSelf,this.pubsubSubscribe(this.data.id,t)},onSubmitValidated:function(){var e=this;if(!this._showSecretBoardStatusChangeConfirmation)return e.saveBoard(),void 0;var t={name:"ConfirmDialog",options:{template:"make_public"}};P.loadModule(t,function(t){e.showInModal(t),e.listen(t,P.CONST.EVENT_CONFIRM,e.saveBoard)})},onButtonClick:function(t){e.prototype.onButtonClick.call(this,t);var n=t.target;"deleteBoardButton"===n.id&&this.onDeleteClick()},onChildChange:function(e){if("secretCheckbox"===e.target.id){var t=!e.target.isChecked();this._showSecretBoardStatusChangeConfirmation=t?!0:!1}},onChildInviteUser:function(e){var t=this.getChildById("boardInviteForm");t.showLoading();var n=e.data.userId,i={board_id:this.getBoardId(),invited_user_id:n},o=e.data.pending,r=o?this.getChildById("boardPendingInvites"):this.getChildById("boardInvites"),s=new P.Resource("BoardInviteResource",i);s.call("create",{success:function(){P.trackGAEvent("collaborator_invite_user",P.CONST.GA_ACTION_SUCCESS),r.addUserInvite(n),t.clearTypeahead()},error:function(e){P.showError(e.message),P.trackGAEvent("collaborator_invite_user",P.CONST.GA_ACTION_ERROR)},complete:function(){t.hideLoading()}})},onChildInviteEmail:function(e){var t=this.getChildById("boardInviteForm");t.showLoading();var n=e.data.email,i={board_id:this.getBoardId(),email:n},o=new P.Resource("BoardEmailInviteResource",i);o.call("create",{success:function(){P.trackGAEvent("collaborator_invite_email",P.CONST.GA_ACTION_SUCCESS);var e=_.template(P.string("successInviteSentToEmail"));t.clearTypeahead();var i=$("<div class='alert'>"+e({email:n})+"</div>");i.hide().insertAfter(t.$el).fadeIn(function(){i.delay(5e3).fadeOut(function(){i.remove()})})},error:function(e){P.showError(e.message),P.trackGAEvent("collaborator_invite_email",P.CONST.GA_ACTION_ERROR)},complete:function(){t.hideLoading()}})},onDeleteClick:function(){P.trackGAEvent("board_delete",P.CONST.GA_ACTION_OPEN_MODAL),this.showConfirmation()},onDeleteConfirm:function(){P.trackGAEvent("board_delete",P.CONST.GA_ACTION_CLICK_SUBMIT),this.deleteBoard()},showConfirmation:function(){var e=this,t={name:"ConfirmDialog",options:{template:"delete_board"}};P.loadModule(t,function(t){e.showInModal(t),e.listen(t,P.CONST.EVENT_CONFIRM,e.onDeleteConfirm)})},deleteBoard:function(){var e=this,t=this.getBoardId(),n=this.getFieldValues(),i=n.privacy,o=new P.Resource("BoardResource",{board_id:t}),r=function(e){P.showError(e.message),P.trackGAEvent("board_delete",P.CONST.GA_ACTION_ERROR)},s=function(n){if(P.trackGAEvent("board_delete",P.CONST.GA_ACTION_SUCCESS),n){var o=n.resource_response;if(o&&!o.error){if(e.isInModal())P.pubsub.publish(t,P.CONST.PUBSUB_TOPIC_BOARD_DELETED),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_BOARD_DELETED,{privacy:i}),e.destroy();else{var s=e.data.owner?"/"+e.data.owner.username+"/":"/";e.navigate(s)}return}}r(n)};this.showLoading(),o.call("delete",{success:s,error:r,complete:function(){e.hideLoading()}})},onBoardRemovedSelf:function(){this.destroy()}})}),P.Module.define("BoardEditBase",["BoardCollaboratorInvitesBase"],function(e){return e.extend({initialize:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},setupForm:function(){this.$form=this.$("form");var e={},t=this.extraData;if(t.isOwner){var n=t.errorMessages.name.required;e={name:[P.Validator.Required({message:n}),P.Validator.Length({max:P.CONST.MAX_CHARS_FOR_BOARD_TITLE})],description:[P.Validator.Length({max:P.CONST.MAX_CHARS_FOR_BOARD_PIN_DESCRIPTION})]}}this.form=new P.Form(this.$form,e),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onContentReady:function(){this.setupForm()},onButtonClick:function(e){var t=e.target;if(t){var n=this._getGACategory();"submitButton"===t.id?P.trackGAEvent(n,P.CONST.GA_ACTION_CLICK_SUBMIT):"cancelButton"===t.id&&P.trackGAEvent(n,P.CONST.GA_ACTION_CLICK_CANCEL)}},onSubmitValidated:function(e){e.errors[0]||this.saveBoard()},getBoardId:function(){return this.data&&this.data.id},_getGACategory:function(){return this.getBoardId()?"board_edit":"board_create"},isMakePublic:function(e){return this.data&&"secret"===this.data.privacy&&"public"===e},getFieldValues:function(){var e=this.$("form"),t={},n=e.find("[name=name]");n.length&&(t.name=n.val());var i=this.getChildById("boardCategory");i&&(t.category=i.getValue());var o=e.find("[name=description]");o.length&&(t.description=o.val());var r=this.getChildById("secretCheckbox");r&&(t.privacy=r.isChecked()?"secret":"public");var s=this.getChildById("emailCheckbox");return s&&(t.collab_board_email=s.isChecked()),t},saveBoard:function(){var e=this,t=this.getChildById("submitButton");t.showLoading();var n=this.getFieldValues(),i=this.getBoardId(),o=_.clone(n);i&&(o.board_id=i);var r;this.extraData.isOwner?(r=new P.Resource("BoardResource",o),r.call(i?"update":"create",{success:_.bind(this.onSaveSuccess,this),error:_.bind(this.onSaveError,this),complete:function(){t.hideLoading()}})):(r=new P.Resource("BoardSettingsResource",o),r.call("update",{complete:function(){t.hideLoading(),e.destroy()}}))},onSaveError:function(e){P.trackGAEvent(this._getGACategory(),P.CONST.GA_ACTION_ERROR);var t=this.$(".formFooter"),n=this.$(".inlineError");n.length?n.empty():n=$("<p></p>").addClass("inlineError"),n.text(e.message),n.insertBefore(t)},onSaveSuccess:function(e){var t=this.getBoardId(),n=!t;if(P.trackGAEvent(this._getGACategory(),P.CONST.GA_ACTION_SUCCESS),e){var i=e.resource_response;if(i&&!i.error&&i.data){var o=i.data;return t?(P.pubsub.publish(t,P.CONST.PUBSUB_TOPIC_BOARD_UPDATED,o),this.isMakePublic(o.privacy)&&P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_BOARD_UPDATED,P.CONST.PUBSUB_MESSAGE_BOARD_SET_PUBLIC)):P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_BOARD_CREATED,o),!n&&this.isInModal()?this.destroy():this.navigate(o.url),void 0}}}})}),P.Module.define("BoardFollowButton",["ui.FollowButton"],function(e){return e.extend({getResourceId:function(){return this.options.board_id},getFollowResource:function(){return new P.Resource("BoardFollowResource",{board_id:this.getResourceId()})},getFollowClass:function(){return this.options.follow_class},onContentReady:function(){if(this.options.user_id){var e={};e[P.CONST.PUBSUB_TOPIC_USER_FOLLOW]=this.onFollowUser,e[P.CONST.PUBSUB_TOPIC_USER_UNFOLLOW]=this.onUnfollowUser,this.pubsubSubscribe(this.options.user_id,e)}var t={};t[P.CONST.PUBSUB_TOPIC_USER_FOLLOW]=this._onFollow,t[P.CONST.PUBSUB_TOPIC_USER_UNFOLLOW]=this._onUnfollow,this.pubsubSubscribe(this.getResourceId(),t),this.showMemo()},_onFollow:function(){var e={board_id:this.getResourceId()};this.triggerEvent(P.CONST.EVENT_BOARD_FOLLOW,e,!0)},_onUnfollow:function(){var e={board_id:this.getResourceId()};this.triggerEvent(P.CONST.EVENT_BOARD_UNFOLLOW,e,!0),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_BOARD_UNFOLLOW,!0)},onFollowUser:function(){this.setState(!0)},onUnfollowUser:function(){this.setState(!1)}})}),P.Module.define("BoardHeader",[],function(){var e="BoardInfoBar";return P.Module.extend({showEditModal:function(){var t=this.getChildByModuleName(e);return t.showEditModal()}})}),P.Module.define("BoardInfoBar",[],function(){var e="editButton";return P.Module.extend({events:{},onContentReady:function(){var e={};e[P.CONST.PUBSUB_TOPIC_BOARD_WRITE_ACCESS_UPDATED]=this.onWriteAccessChange,this.pubsubSubscribe(this.data.id,e)},onWriteAccessChange:function(){this.render()},showEditModal:function(){var t=this.getChildById(e);return t?(t.showModal(),!0):!1}})}),P.Module.define("BoardInvite",[],function(){var e=5e3;return P.Module.extend({onContentReady:function(){this.declineButton=this.getChildById("declineButton"),this.removeButton=this.getChildById("removeButton"),this.acceptButton=this.getChildById("acceptButton"),this.approveButton=this.getChildById("approveButton"),this.declineButton&&this.listen(this.declineButton,P.CONST.EVENT_BUTTON_CLICK,this.onClickDecline),this.removeButton&&this.listen(this.removeButton,P.CONST.EVENT_BUTTON_CLICK,this.onClickRemove),this.acceptButton&&this.listen(this.acceptButton,P.CONST.EVENT_BUTTON_CLICK,this.onClickAccept),this.approveButton&&this.listen(this.approveButton,P.CONST.EVENT_BUTTON_CLICK,this.onClickApprove)},getInvitedUserId:function(){return this.extraData.invitedUserId},getRemoveResource:function(){var e=this.extraData.accepted,t=e?"BoardCollaboratorResource":"BoardInviteResource",n=new P.Resource(t,this.resource.copyOptions(!0));return n},getCurrentUserIsInvitedUser:function(){return this.extraData.currentUserIsInvitedUser},getInvitedUserFullName:function(){return this.extraData.invitedUserFullName},getConfirmBoardInvite:function(){return"boardEdit"===this.options.view_type},onClickRemove:function(){this.getConfirmBoardInvite()?this.confirmDeleteBoardInvite():this.deleteBoardInvite()},confirmDeleteBoardInvite:function(){var e=this.getCurrentUserIsInvitedUser(),t=this.getInvitedUserFullName(),n=this,i={name:"ConfirmDialog",options:{template:"delete_board_invite",current_user_is_invited_user:e,invited_user_full_name:t}};P.loadModule(i,function(e){n.showInModal(e),n.listen(e,P.CONST.EVENT_CONFIRM,n.deleteBoardInvite)})},deleteBoardInvite:function(){var e,t=this.getCurrentUserIsInvitedUser(),n=this;e=t?"collaborator_decline_invite":"collaborator_delete_invite",P.trackGAEvent(e,P.CONST.GA_ACTION_CLICK),this.removeButton.showLoading();var i=this.getRemoveResource();i.call("delete",{success:function(){P.trackGAEvent(e,P.CONST.GA_ACTION_SUCCESS),n.fadeOut(function(){n.destroy()});var i=n.data.board.id;t&&(P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF),P.pubsub.publish(i,P.CONST.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF))},error:function(){P.trackGAEvent(e,P.CONST.GA_ACTION_ERROR)},complete:function(){n.removeButton.hideLoading()}})},onClickAccept:function(){var t="collaborator_invite_accept";P.trackGAEvent(t,P.CONST.GA_ACTION_CLICK);var n=this;this.acceptButton.showLoading();var i=this.resource.copy(!0);i.call("update",{success:function(){P.trackGAEvent(t,P.CONST.GA_ACTION_SUCCESS);var i=n.$(".pending"),o=n.$(".success"),r=n.data.board.id;P.pubsub.publish(r,P.CONST.PUBSUB_TOPIC_BOARD_WRITE_ACCESS_UPDATED),i.fadeOut(function(){o.fadeIn(function(){o.delay(e).fadeOut(function(){n.destroy()})})})},error:function(){P.trackGAEvent(t,P.CONST.GA_ACTION_ERROR)},complete:function(){n.acceptButton.hideLoading()}})},onClickApprove:function(){var e="collaborator_approve_invite",t=new P.Resource("BoardInviteResource",this.resource.copyOptions(!0));this.approveButton.showLoading();var n=this;t.call("update",{success:function(){P.trackGAEvent(e,P.CONST.GA_ACTION_SUCCESS),n.fadeOut(function(){n.destroy()});var t=n.data.board.id;P.pubsub.publish(t,P.CONST.PUBSUB_TOPIC_BOARD_APPROVED_COLLABORATOR_INVITE,{userId:n.getInvitedUserId()})},error:function(){P.trackGAEvent(e,P.CONST.GA_ACTION_ERROR)},complete:function(){n.approveButton.hideLoading()}})}})}),P.Module.define("BoardInviteForm",[],function(){return P.Module.extend({initialize:function(){this.childListen(P.CONST.EVENT_ITEM_SELECTED,this.onChildItemSelected),this.childListen("enterPressed",this.onChildEnterPressed),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onClickInviteButton)},onChildItemSelected:function(e){P.trackGAEvent("collaborator_invite_user",P.CONST.GA_ACTION_SELECT_SUBMIT);var t=e.data.item,n=t.get("id");this.inviteUser(n),e.stopPropagation()},onChildEnterPressed:function(e){P.trackGAEvent("collaborator_invite_email",P.CONST.GA_ACTION_ENTER_SUBMIT),this.submit(),e.stopPropagation()},onClickInviteButton:function(e){P.trackGAEvent("collaborator_invite_email",P.CONST.GA_ACTION_CLICK_SUBMIT),this.submit(),e.stopPropagation()},submit:function(){var e=this.getChildById("typeaheadField"),t=e.getValue(),n=e.getField(),i=this;if(this.options.email_supported){var o=new P.Validator(n,[P.Validator.Length({min:1}),P.Validator.Email()]);o.validate(function(e){e.errors.length>0?P.log(e.errors):i.inviteEmail(t)})}return!1},setTypeaheadFieldValue:function(e){var t=this.getChildById("typeaheadField");t.setValue(e)},clearTypeahead:function(){var e=this.getChildById("typeaheadField");e.clear()},inviteEmail:function(e){this.triggerEvent(P.CONST.EVENT_INVITE_EMAIL,{email:e},!0)},inviteUser:function(e){this.triggerEvent(P.CONST.EVENT_INVITE_USER,{userId:e,pending:this.options.pending},!0)}})}),P.Module.define("BoardInvites",["BoardInvite"],function(e){return P.Module.extend({onContentReady:function(){if(!this.options.pending){var e=this.resource.options.board_id,t={};t[P.CONST.PUBSUB_TOPIC_BOARD_APPROVED_COLLABORATOR_INVITE]=this.onApprovedCollaboratorInvite,this.pubsubSubscribe(e,t)}},_prependUserToTop:function(t){var n=new e({resource:{name:"BoardInviteResource",options:{board_id:this.resource.options.board_id,invited_user_id:t,field_set_key:"boardEdit"}}}),i=this.getChildByModuleName("PagedGrid");n.render(function(){i.prependChildItem(n)})},addUserInvite:function(e){this._prependUserToTop(e)},onApprovedCollaboratorInvite:function(e,t,n){this.addUserInvite(n.userId)}})}),P.Module.define("BoardPage",[],function(){return P.Module.extend({onContentReady:function(){if(this.data.id){var e={};e[P.CONST.PUBSUB_TOPIC_BOARD_UPDATED]=this.onBoardUpdated,e[P.CONST.PUBSUB_TOPIC_BOARD_DELETED]=this.onBoardDeleted,e[P.CONST.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF]=this.onBoardRemovedSelf,e[P.CONST.PUBSUB_TOPIC_PIN_CREATED]=this.onPinAdded,this.pubsubSubscribe(this.data.id,e)}this.childListen("pinUpdated",this.onChildPinUpdated),this.options.show_edit&&(this.extraData.canEdit&&this.showEditModal(),delete this.options.show_edit)},onBoardUpdated:function(e,t,n){n.url!==this.data.url&&this.inDom?(this.data.url=n.url,this.navigate(n.url)):this.headerDataChanged(n)&&this.renderHeader()},onPinAdded:function(){var e=this.getChildByModuleName("Grid");e.prependNewItems(1)},headerDataChanged:function(e){var t=_.pick(this.data,"privacy","description"),n=_.pick(e,"privacy","description");return!_.isEqual(t,n)},onBoardDeleted:function(){this.inDom&&this.navigateToUserPage()},navigateToUserPage:function(){var e=this.extraData&&this.extraData.currentUsername,t="/",n=e?t+e+"/":t;this.navigate(n)},getHeader:function(){return this.getChildById("boardHeader")},renderHeader:function(){var e=this.getHeader();e.render()},showEditModal:function(){var e=this.getHeader();return e.showEditModal()},onChildPinUpdated:function(e){var t=e.data.board.id,n=e.target;t!==this.data.id&&n.destroy()},onBoardRemovedSelf:function(){this.data.privacy===P.CONST.BOARD_PRIVACY_SECRET&&this.inDom?this.navigateToUserPage():this.renderHeader()}})}),P.Module.define("BoardPicker",[],function(){var e="data-id",t="data-privacy",n="data-collaborative",i="active",o="visible";return P.Module.extend({events:{"click .boardPickerOuter":"onOuterClick","click .boardPickerItem":"onItemClick","keydown .createBoardName":"onCreateBoardKeydown"},onCreateBoardKeydown:function(e){var t=P.keyCode;return e.keyCode===t.ENTER?(this.onCreateBoard(),!1):void 0},onButtonClick:function(e){var t=e.target;t&&"createBoard"===t.id&&this.onCreateBoard()},initialize:function(){this.$boardOuter=null,this.$boardMenuWrapper=null,this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},onItemClick:function(i){var o=$(i.target),r=o.attr(e);if(!r)return i.stopImmediatePropagation(),void 0;this._selectedBoardId=r;var s=o.text(),a=o.attr(t),l=!!o.attr(n);this.setSelectedBoard(r,s,a,l),this.triggerEvent(P.CONST.EVENT_BOARD_SELECTED,{privacy:a},!0),this.closeMenu()},onCreateBoard:function(){function e(e){P.showError(e.message)}function t(t){if(t){var n=t.resource_response;if(n&&!n.error&&n.data&&n.data.url)return r.options.default_board_id=n.data.id,r.render(),r.triggerEvent(P.CONST.EVENT_BOARD_SELECTED,null,!0),void 0}e()}var n=this.getChildById("createBoard"),i=this.$(".createBoardName").val(),o=new P.Resource("BoardResource",{name:i}),r=this;n.showLoading(),o.call("create",{success:t,error:e,complete:function(){n.hideLoading()}})},getSelectedBoardName:function(){return this.$(".currentBoardName").text()},getPrivacy:function(){return this.$(".currentBoard").attr(t)},getCollaborative:function(){return!!this.$(".currentBoard").attr(n)},setSelectedBoardAttributes:function(e,i){var o=$(".currentBoard",this.$boardOuter);o.attr(t,e),o.attr(n,i)},setSelectedBoardIcons:function(e,t){var n=$(".currentBoard",this.$boardOuter),i=n.find(".secretIcon"),o=n.find(".collaborativeIcon");i.toggleClass("hidden",!e),o.toggleClass("hidden",!t)},setSelectedBoard:function(t,n,i,o){var r=this,s=$(".currentBoard",this.$boardOuter),a=o,l="secret"===i;this._selectedBoardId=t,this.setSelectedBoardAttributes(i,o),this.setSelectedBoardIcons(l,a),s.attr(e,r._selectedBoardId),$(".currentBoardName",s).text(n)},onContentReady:function(){this.$boardOuter=this.$(".boardPickerOuter"),this.$boardMenuWrapper=this.$(".boardPickerInnerWrapper"),this.$(".createBoardName").placeholder(),this._selectedBoardId=this.$boardOuter.attr(e)},onOuterClick:function(t){this.options.disabled||(this._selectedBoardId=$(t.target).attr(e),this.openMenu())},openMenu:function(){var t=this,n=$("<div></div>").addClass("boardPickerMask");this.$el.append(n);var r=this._selectedBoardId||this.$(".currentBoard").attr(e),s=this.$(".boardPickerInner").find("["+e+"="+r+"]");s.addClass(i),n.on("click.boardpicker",function(e){t.closeMenu(),e.stopPropagation(),e.stopImmediatePropagation()}),this.$boardMenuWrapper.addClass(o)},closeMenu:function(){var e=$(".boardPickerMask");e.off("click.boardpicker"),e.detach(),this.$(".boardPickerInner").find("."+i).removeClass(i),this.$boardMenuWrapper.removeClass(o)},getSelectedBoardId:function(){return $(".currentBoard",this.$boardOuter).attr(e)}})}),P.Module.define("BoardPicker2",[],function(){var e="data-id",t="boardListItem",n="boardsShortlist",i="allBoardsHeader",o="allBoardsList",r="hidden",s="highlighted";return P.Module.extend({events:{"click .boardListItem":"onBoardClick","input .boardSelectorInput":"onBoardSelectorInput","keydown .boardSelectorInput":"onBoardSelectorKeydown"},initialize:function(){this._lastInputValue="",this._boardsShortlistVisible=!0,this._boardDivsVisible=null,this._selectedBoardIdx=null,this._selectedBoardId=null},onContentReady:function(){this.$boardSelectorInput=this.$(".boardSelectorInput")},onBoardClick:function(e){for(var n=$(e.target);!n.hasClass(t);)if(n=n.parent(),n===this.$el)return;var i=n;this.selectBoard(i,!0)||e.stopImmediatePropagation()},selectBoard:function(t,n){var i=t.attr(e);return i?(this.setSelectedBoardId(i),n&&this.triggerEvent(P.CONST.EVENT_BOARD_SELECTED,{boardId:i},!0),!0):!1},setSelectedBoardId:function(e){this._selectedBoardId=e},getSelectedBoardId:function(){return this._selectedBoardId},onBoardSelectorInput:function(){this._syncBoardSelectorToInput(),this._lastInputValue=this._getBoardSelectorInputValue()},_syncBoardSelectorToInput:function(){this._resetBoardSelector();var e=this._getBoardSelectorInputValue(),n=""===e;this._setBoardsShortlistVisibility(n);var i=this._tokenizeString(e),s=this,a=function(t){if(""===e)return!0;var n=t.find(".boardName").text(),o=s._tokenizeString(n),r=_.some(i,function(e){return _.some(o,function(t){var n=0===t.lastIndexOf(e,0);return n})});return r},l="."+t;n||(l="."+o+" "+l),_.each(this.$(l),function(e){var t=$(e),n=a(t);t.toggleClass(r,!n),n&&s._boardDivsVisible.push(t)})},_getBoardSelectorInputValue:function(){return this.$boardSelectorInput.val()},_tokenizeString:function(e){return e=e.toLowerCase(),e.split(" ")},_resetBoardSelector:function(){if(null!==this._selectedBoardIdx){var e=this._boardDivsVisible[this._selectedBoardIdx];e&&e.removeClass(s)}this._boardDivsVisible=[],this._selectedBoardIdx=null,this.setSelectedBoardId(null)},_setBoardsShortlistVisibility:function(e){var t=this.$("."+n+","+"."+i);t.toggleClass(r,!e),this._boardsShortlistVisible=e},onBoardSelectorKeydown:function(e){if((null===this._boardDivsVisible||""===this._getBoardSelectorInputValue()&&""!==this._lastInputValue)&&this._syncBoardSelectorToInput(),this._boardDivsVisible.length){var t=P.keyCode;switch(e.keyCode){case t.UP:this._boardSelectorHighlightUp(),e.preventDefault();break;case t.DOWN:this._boardSelectorHighlightDown(),e.preventDefault();break;case t.ENTER:case t.NUMPAD_ENTER:var n=this._boardDivsVisible[this._selectedBoardIdx];this.selectBoard(n,!0)}}},_boardSelectorHighlightUp:function(){if(null!==this._selectedBoardIdx){this._highlightBoardAtIdx(this._selectedBoardIdx,!1);var e=this._setSelectedBoardIdx(this._selectedBoardIdx-1);if(null!==e){var t=this._highlightBoardAtIdx(e,!0);this._scrollSelectedBoardDivToView(),this.selectBoard(t,!1)}}},_boardSelectorHighlightDown:function(){null===this._selectedBoardIdx?this._selectedBoardIdx=-1:this._highlightBoardAtIdx(this._selectedBoardIdx,!1);var e=this._setSelectedBoardIdx(this._selectedBoardIdx+1),t=this._highlightBoardAtIdx(e,!0);this._scrollSelectedBoardDivToView(),this.selectBoard(t,!1)},_setSelectedBoardIdx:function(e){return e<0?e=null:e>this._boardDivsVisible.length-1&&(e=this._boardDivsVisible.length-1),this._selectedBoardIdx=e,e},_highlightBoardAtIdx:function(e,t){var n=this._boardDivsVisible[e];return n&&n.toggleClass(s,t),n},_scrollSelectedBoardDivToView:function(){var e=this._boardDivsVisible[this._selectedBoardIdx],o=e.outerHeight(),r=o*this._selectedBoardIdx;if(this._boardsShortlistVisible){var s=this.$("."+n+" ."+t).length;this._selectedBoardIdx>=s&&(r+=this.$("."+i).outerHeight())}var a=this.$(".boardPickerListItems"),l=a.scrollTop();r<l?this._alignToViewTop(a,r):r+o>l+a.outerHeight()&&this._alignToViewBottom(a,r+o)},_alignToViewTop:function(e,t){e.scrollTop(t)},_alignToViewBottom:function(e,t){e.scrollTop(t-e.outerHeight())}})}),P.Module.define("BoardRecFeedHomePage",[],function(){return P.Module.extend({onContentReady:function(){var e=this.getChildById("grid"),t="none";e&&!e.hasItems()&&(e.remove(),t="block"),this.$(".noResults").css("display",t)}})}),P.Module.define("BoardRecommendationsModule",[],function(){return P.Module.extend({onContentReady:function(){this.destroyIfEmpty()},isEmpty:function(){if(!this.contentReady)return!1;var e=this.getChildById("relatedBoardsFeed");return!e||!e.hasItems()}})}),P.Module.define("BoardsToFollow",["Board","Dropdown"],function(e){var t=4,n="follow_view";return P.Module.extend({events:{},boardsUsed:[],boardsUnused:[],boardsToReplace:[],initialize:function(){this.childListen(P.CONST.EVENT_DISMISS,this.onChildDismiss),this.childListen(P.CONST.EVENT_BOARD_FOLLOW,this.onChildBoardFollow)},onContentReady:function(){var e=this;this.boardsUnused=this.extraData.boardsUnused,e.requestMoreBoardsIfNeeded(),e.replaceBoardsWithUnused()},onChildDismiss:function(e){var t=e.target;this.dismissBoard(t)},onChildBoardFollow:function(e){var t=e.target.parent,i=this;t.options.view_type===n&&window.setTimeout(function(){i.dismissBoard(t)},500)},requestMoreBoardsIfNeeded:function(){var e=this;e.boardsUnused.length>t||this.resource.xhr||this.resource.call("get",{success:function(t){var n=t.resource_response.data;e.boardsUnused=e.boardsUnused.concat(n),e.replaceBoardsWithUnused()}})},dismissBoard:function(e){if(e&&!e.dismissing){var t=this;e.dismissing=!0,t.requestMoreBoardsIfNeeded(),e.fadeOut(function(){t.replaceBoard(e)})}},getBoard:function(t){var i=new e({options:{show_board_context:!0,view_type:n,size:"small"},resource:{name:"BoardResource",options:{board_id:t.id}},data:t});return i},hideBoard:function(e){e&&(e._dropDown&&e._dropDown.hide(),e.destroy())},replaceBoardsWithUnused:function(){for(var e=this;e.boardsToReplace.length&&e.boardIdsUnused.length;){var t=e.boardsToReplace.shift();
e.replaceBoard(t)}},replaceBoard:function(e){var t=this,n=this.boardsUnused.pop();if(n){var i=t.getBoard(n);i.render(function(){t.getChildByModuleName("List").appendChild(i),t.hideBoard(e),i.show(),i.fadeIn()},function(){t.hideBoard(e),t.replaceBoard(i)}),this.boardsUsed.push(n)}}})}),P.Module.define("BusinessAccountConvert",[],function(){return P.Module.extend({events:{"keyup .aboutText":"onAboutTextKeyup"},onContentReady:function(){var e={contact_name:[P.Validator.Required()],email:[P.Validator.Email(),P.Validator.Required()],account_type:[P.Validator.Required()],business_name:[P.Validator.Required()],username:[P.Validator.Required()],about:[P.Validator.Length({max:P.CONST.MAX_CHARS_FOR_USER_DESCRIPTION})],accept_terms:[P.Validator.Required()]},t={prevalidate:!0};this.$aboutCounter=$(".aboutCounter"),this.$(".aboutText").keyup(),this.$form=this.$("form"),this.form=new P.Form(this.$form,e,t),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(e){e.errors[0]||this.save()},onAboutTextKeyup:function(e){var t=e.target.value.replace(/\{.*\}/g,"").length,n=P.CONST.MAX_CHARS_FOR_USER_DESCRIPTION,i=t<n?n-t:0;this.$aboutCounter.text(i)},save:function(){var e=this,t=this.$form.serializeArray(),n={};_.each(t,function(e){n[e.name]="on"===e.value?!0:e.value});var i=this.getChildById("submitButton"),o=new P.Resource("PartnerResource",n),r=function(t){t&&!t.resource_response.error&&e.navigate("/business/getstarted/")};i.showLoading(),o.call("update",{success:r,complete:function(){i.hideLoading()}})}})}),P.Module.define("BusinessAccountCreate",[],function(){return P.Module.extend({events:{},onContentReady:function(){if(P.currentUser.isAuthenticated()){var e="/business/convert/";return P.currentUser.attributes.is_partner&&(e="/business/getstarted/"),this.navigate(e),void 0}}})}),P.Module.define("BusinessGetStarted",[],function(){return P.Module.extend({events:{"click .partnerCreateBoard":"createBoard"},createBoard:function(){return P.trackGAEvent("board_create",P.CONST.GA_ACTION_OPEN_MODAL),this.showBoardCreateModal(),!1},showBoardCreateModal:function(){var e=this;P.Loader.require(["BoardCreate"],function(t){var n=new t({options:{}});e.showInModal(n)})}})}),P.Module.define("BusinessGetStartedCards",[],function(){return P.Module.extend({events:{"click .dismiss":"onDismissClick"},onDismissClick:function(e){var t=$(e.target),n=t.parents(".getStartedCard"),i=n.data("card-name"),o=new P.Resource("PartnerCardResource",{card_name:i});o.call("delete",{}),n.remove()}})}),P.Module.define("BusinessGetStartedHeader",[],function(){return P.Module.extend({events:{}})}),P.Module.define("Button",[],function(){var e="disabled",t="disabled";return P.Module.extend({events:{click:"onClick"},onClick:function(e){return this.isDisabled()?(e.preventDefault(),!1):(this.triggerEvent(P.CONST.EVENT_BUTTON_CLICK,null,!0),void 0)},isDisabled:function(){return this.$el.is(":disabled")},disable:function(){this.$el.attr(e,!0).addClass(t)},enable:function(){this.$el.removeAttr(e).removeClass(t)},setStyles:function(e){var t=this.$el;_.each(e,function(e,n){t.toggleClass(n,e)})},setDisabled:function(e){var t="disabled",n=this.$el;return e?n.removeAttr(t):n.attr(t,!0)},getLoadingSpinnerOptions:function(){return{size:P.Spinner.Size.SMALL}},showLoading:function(){this.disable(),this.options.borderless||P.Module.prototype.showLoading.call(this)},hideLoading:function(){this.enable(),this.options.borderless||P.Module.prototype.hideLoading.call(this)},isCancelButton:function(){return this.options.cancelButton},isActive:function(){return this.$el.hasClass("active")}})}),P.Module.define("CategoriesMenu",[],function(){var e="selected",t=P.Module.extend({getItemByCategory:function(e){return this.$("a[data-category="+e+"]")},onCategoryUpdated:function(t,n,i){if(this.$("a").removeClass(e),i){var o=this.getItemByCategory(i);o.length?(o.addClass(e),this.waitingMessage=null):this.waitingMessage=i}},onContentReady:function(){var t={};t[P.CONST.PUBSUB_TOPIC_CURRENT_CATEGORY]=this.onCategoryUpdated,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_SITE,t),this.waitingMessage&&this.getItemByCategory(this.waitingMessage).addClass(e)}});return t}),P.Module.define("CategoriesSelect",[],function(){return P.Module.extend({getValue:function(){return $.trim(this.$("option:selected").val())}})}),P.Module.define("Category",[],function(){return P.Module.extend({events:{click:"onClick"},onClick:function(){this.triggerEvent("showAll",{title:this.data.name,category:this.data.key,resource:new P.Resource("BoardRecommendationsByCategoryFeedResource",{category:this.data.key})},!0)}})}),P.Module.define("Close",[],function(){return P.Module.extend({onContentReady:function(){window.close()}})}),P.Module.define("Closeup",["PinActionBar","CloseupContent","CloseupSidebar","CloseupBottom"],function(e,t,n,i){var o="actions",r="content",s="sidebar",a="bottom",l=".closeupActionBarContainer",u=736,c=57,d=40,h=14,p=1e3,f="visible";return P.Module.extend({events:{click:"_onClick","click button.close":"onCloseButtonClick"},getOwnedScrollables:function(){return this.options.can_close?this.$el:$()},initialize:function(){this.closeDiv=$('<button class="Button borderless close"><em></em>&nbsp;</button>')},onKeyup:function(e){this.options.can_close&&e.keyCode===P.keyCode.ESCAPE&&this._close()},_close:function(){this.triggerEvent("close",this,!0)},_unsticky:function(){this._actionBar&&this._actionBar.unsticky()},_updateSticky:function(){if(this.parent&&this.inDom&&this._actionBar){var e=this.$(".PaddedPin"),t=this.getScrollableElement(),n=0;this.options.can_close||(n=$(".headerBackground").height()),this._actionBar.updateSticky({$boundTo:e,$scrollable:t,headerHeight:n})}},resetCloseButton:function(){this.$close.removeClass(f)},onAddedToDom:function(){var e=this;this.options.can_close&&$("body").on("keyup.closeup",function(t){e.onKeyup(t)}),this.childListen(P.CONST.EVENT_NAVIGATE,this.onChildNavigate);var t=P.scrollbarWidth();this.$close||(this.$close=this.$(".close")),this.$close.css("right",t+h+"px").addClass(f)},_positionActionBar:function(){this._actionBar&&this.inDom&&this.contentReady&&this._updateSticky()},onContentReady:function(){this._actionBar=this.getChildById(o),this.options.show_repin?(this.showRepinModal(),delete this.options.show_repin):this.options.show_edit&&(this.extraData.canEdit&&this.showEditModal(),delete this.options.show_edit),this._positionActionBar()},onChildRemoved:function(e){"CloseupContent"===e.className&&(this.options.can_close?this._close():(this.destroy(),this.navigate("/")))},_removeTransitionImage:function(){this.transitionPinImage&&(this.transitionPinImage.remove(),this.transitionPinImage=null)},onRemovedFromDom:function(){this._actionBar&&this._actionBar.removeDropdowns(),this._unsticky(),this.options.can_close&&$("body").off("keyup.closeup"),this._removeListeners()},render:function(u){if(!this.options.can_close)return P.Module.prototype.render.call(this,u);this.$el.empty().addClass("canClose"),this.$el.append(this.closeDiv),this.$el.append('<div class="closeupActionBarContainer"></div><div class="closeupContainer"></div><div class="closeupBottom"></div>');var c=!!this.transitionPinImage;c&&(this.$el.append(this.transitionPinImage),u());var d=this,h=this.resource.copy(),p=this.resource.options.id,f=this.resource.copy();f.options.view_type="detailed";var m=new t({id:r,resource:f}),g=d.$(l),v=new e({id:o,options:{pin_id:p},resource:h});v.render(),this._actionBar=v,this.insertChild(v,g);var C=this.$(".closeupContainer");m.render(function(){if(d.insertChild(m,C),c){var e=m.getPin(),t=e.getPinMedia(),n=t.attr("src");t.load(_.bind(d._removeTransitionImage,d)),t.error(_.bind(d._removeTransitionImage,d)),t.attr("src",n),t[0]&&t[0].complete&&d._removeTransitionImage()}d.contentReady=!0,d.onContentReady(),c||u();var o=new i({id:a,options:{pin_id:d.resource.options.id}}),r=d.$(".closeupBottom");o.render(function(){d.insertChild(o,r)})});var y=this.resource.copy();y.options.view_type="closeup_sidebar";var T=new n({id:s,resource:y});T.render(function(){d.insertChild(T,C)})},setCloseupBottomMinHeight:function(){var e=this.$(".closeupContainer").height(),t=this.getScrollableElement().scrollTop(),n=this.getChildById(a),i=P.Viewport.height,o=t+i-e;n.$el.css("min-height",o)},removeCloseupBottomMinHeight:function(){var e=this.getChildById(a);e.$el.css("min-height","")},showRepinModal:function(){this._actionBar&&this._actionBar.showRepinModal()},showEditModal:function(){var e=this.getChildById(r);return e.showEditModal()},setAsMainModule:function(t,n,i,u){var c=this,d=this.getChildById(r),h=this.getChildById(s),p=this.getChildById(a),f=n.options.id;if(!d||!h||!p)return P.Module.prototype.setAsMainModule.apply(this,arguments);if(this._removeTransitionImage(),t.can_close?0===this.closeDiv.parent().length&&(this.$el.prepend(this.closeDiv),this.$el.addClass("canClose")):this.closeDiv.parent().length>0&&(this.closeDiv.remove(),this.$el.removeClass("canClose")),this.options.can_close=t.can_close,this.hasSameOptions(t,n)&&this.contentReady&&!this._forceRefresh(i))return u(),void 0;this.setOptions(t),this.setResource(n),i.evt&&i.evt.currentTarget&&"Closeup"===i.evt.currentTarget.className||d.empty();var m={name:n.name,options:_.extend({},n.options)},g=this.resource.copy(),v=new e({id:o,options:{pin_id:f},resource:g});m.options.view_type="detailed",d.setResource(m),this.setCloseupBottomMinHeight(),v.render(),d.render(function(){var e=c.$(l);c.insertChild(v,e),c._actionBar&&c._actionBar.destroy(),c._actionBar=v,c._positionActionBar(),p.setOptions({pin_id:f}),p.render(function(){c.removeCloseupBottomMinHeight()}),h.updateDomain(d.data.domain)}),u()},onChildNavigate:function(e){if(P.log("Closeup got navigate event from child",e.target,"for url:",e.data.url),!P.isOffsiteUrl(e.data.url)){var t=this.getChildById(s);return t===e.currentTarget&&"Pin"===e.target.className&&(e.data.handled=!0),!1}},onCloseButtonClick:function(){return this._close(),this.resetCloseButton(),!1},_onClick:function(e){if(this.options.can_close){var t=e.target;(t&&(t===this.$el[0]||t===this.$(".closeupContainer")[0])||t===this.$(".closeupBottom")[0])&&(e.stopPropagation(),this._close())}},performTransition:function(e,t){var n=this,i=e.evt&&e.evt.target||null,o=e.evt&&e.evt.currentTarget||null;i&&"Pin"===i.className&&"summary"===i._getViewType()&&"Closeup"!==o.className&&(this.transitionPinImage=this._getTransitionPinImage(i)),n.render(function(){t()})},_getTransitionPinImage:function(e){var t=e.getPinMedia();if(!t)return null;var n=t.clone(),i=e.data.link;i||(e.data.images.orig?i=e.data.images.orig.url:e.data.images.originals&&(i=e.data.images.originals.url));var o=$("<a class='transitionImage' href='"+i+"'></a>").append(n);n[0].onload=null;var r,s=e.getDetailedImageDimensions(),a=s.height,l=s.width;if(l<u){var f=Math.round((u-l)/2);r=f<d?f+c:d+c}else r=c;var m=2*h,g=(P.Viewport.width-p+h)/2,v=(u-l)/2;return o.css({height:a,padding:r+"px "+v+"px "+(r-c)+"px",left:g,top:m}),n.css({height:a,width:l}),o},getPin:function(){return this.getChildById(r).getPin()}})}),P.Module.define("CloseupBottom",[],function(){var e="relatedPins",t="relatedBoards";return P.Module.extend({events:{},onChildRendered:function(n){var i,o,r=n.id===e,s=n.id===t;if(r&&(i=n.getChildByModuleName("Grid"),o=this.$(".relatedPinsWrapper")),s&&(i=n.getChildByModuleName("PagedGrid"),o=this.$(".relatedBoardsWrapper")),i&&o.length){var a=i.hasItems(),l=a?"visible":"hidden";o.css("visibility",l)}}})}),P.Module.define("CloseupContent",[],function(){return P.Module.extend({events:{},getPin:function(){return this.getChildById("pin")},showEditModal:function(){var e=this.getPin();return e.showEditModal()},onContentReady:function(){if(this.data.id){var e={};e[P.CONST.PUBSUB_TOPIC_PIN_DELETED]=this.onPinDeleted,this.pubsubSubscribe(this.data.id,e)}},onPinDeleted:function(){this.destroy()}})}),P.Module.define("CloseupRelatedBoards",[],function(){return P.Module.extend({onContentReady:function(){this.destroyIfEmpty()},isEmpty:function(){if(!this.contentReady)return!1;var e=this.getChildById("relatedBoardsFeed");return!e||!e.hasItems()}})}),P.Module.define("CloseupRelatedPins",[],function(){return P.Module.extend({onContentReady:function(){this.destroyIfEmpty()},isEmpty:function(){if(!this.contentReady)return!1;var e=this.getChildById("relatedPinsFeed");return!e||!e.hasItems()}})}),P.Module.define("CloseupSidebar",[],function(){return P.Module.extend({events:{},onContentReady:function(){if(this.data.id){var e={};e[P.CONST.PUBSUB_TOPIC_PIN_UPDATED]=this.onPinUpdated,this.pubsubSubscribe(this.data.id,e)}var t=this.getChildByModuleName("Board");t.positionBoardPinsGrid()},onPinUpdated:function(){this.render()},updateDomain:function(e){var t=this.getChildById("domain");if(!e)return t&&(t.destroy(),this.$(".domainContainerTitle").hide()),void 0;if(!t&&e){var n={name:"Domain",id:"domain",resource:{name:"DomainResource",options:{domain:e}}},i=this;return P.loadModule(n,function(e){e.render(function(){i.$(".domainContainerTitle").show(),i.insertChild(e,i.$("#domainContainer"))})}),void 0}t.resource.set("domain",e),t.render(function(){t.fadeIn()})}})}),P.Module.define("ConfirmDialog",[],function(){return P.Module.extend({events:{"click .cancelButton":"close","click .confirm":"confirm","change #confirmCheckbox":"onConfirmCheckboxChange"},render:function(e){var t=this,n=function(){t.triggerEvent("rendered",t),e&&e()};return this.options.message?(this.empty(),this.$el.append('<form class="standardForm"><h1>'+P.string("errorTitle")+"</h1>"+'<p class="body">'+this.options.message+"</p>"+'<div class="formFooter">'+'<div class="formFooterButtons">'+'<button class="Button confirm btn primary rounded">'+P.string("ok")+"</button>"+"</div>"+"</div>"+"</form>"),n(),void 0):P.Module.prototype.render.call(this,n)},onConfirmCheckboxChange:function(){this.$("#confirmCheckbox").is(":checked")?this.$(".confirm").removeAttr("disabled"):this.$(".confirm").attr("disabled","disabled")},close:function(){return this.triggerEvent(P.CONST.EVENT_CLOSE,this),this.destroy(),!1},open:function(){this.triggerEvent(P.CONST.EVENT_OPEN,this)},confirm:function(){return this.showLoading(!0),this.triggerEvent(P.CONST.EVENT_CONFIRM,this),this.destroy(),!1}})}),P.Module.define("Consumer",[],function(){return P.Module.extend({events:{}})}),P.Module.define("ConsumerEditDialog",[],function(){return P.Module.extend({events:{},onContentReady:function(){var e={name:[P.Validator.Required()],description:[P.Validator.Required()]};this.formListener&&this.removeListener(this.formListener),this.form=new P.Form(this.$("form"),e),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(e){e.errors[0]||this.updateConsumer()},getFormData:function(){var e=this.$("form").serializeArray(),t={};return _.each(e,function(e){t[e.name]=e.value}),t},getSaveResource:function(e){return new P.Resource("ConsumerResource",e)},updateConsumer:function(){var e=this.getFormData();e.id=this.data.id;var t=this.getChildById("submitButton"),n=this;t.showLoading();var i=this.getSaveResource(e);i.call("update",{success:function(e){var i;t.hideLoading(),e.resource_response.error?e.resource_response.message&&(i={message:e.resource_response.message}):(P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_CONSUMER_LIST_UPDATED),n.destroy())},error:function(e){P.showError(e.message)},complete:function(){t.hideLoading()}})}})}),P.Module.define("ConsumerManagePage",[],function(){return P.Module.extend({events:{},onContentReady:function(){var e={};e[P.CONST.PUBSUB_TOPIC_CONSUMER_LIST_UPDATED]=this.onListUpdated,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,e)},showNewDialog:function(){var e=this;P.loadModule({name:"ConsumerNewDialog"},function(t){e.showInModal(t,{})})},onListUpdated:function(){this.render()}})}),P.Module.define("ConsumerNewDialog",[],function(){return P.Module.extend({events:{},onContentReady:function(){var e={name:[P.Validator.Required()],description:[P.Validator.Required()]};this.formListener&&this.removeListener(this.formListener),this.form=new P.Form(this.$("form"),e),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(e){e.errors[0]||this.createConsumer()},getFormData:function(){var e=this.$("form").serializeArray(),t={};return _.each(e,function(e){t[e.name]=e.value}),t},getSaveResource:function(e){return new P.Resource("ConsumerResource",e)},createConsumer:function(){var e=this.getFormData(),t=this.getChildById("submitButton"),n=this;t.showLoading();var i=this.getSaveResource(e);i.call("create",{success:function(e){var i;t.hideLoading(),e.resource_response.error?e.resource_response.message&&(i={message:e.resource_response.message}):(P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_CONSUMER_LIST_UPDATED),n.destroy())},error:function(e){P.showError(e.message)},complete:function(){t.hideLoading()}})}})}),P.Module.define("DatePicker",[],function(){return P.Module.extend({events:{},onContentReady:function(){this.minDate=new Date(2012,10,1),this.maxDate=this.getYesterday(),this.setupPicker(),this.setupQuickSelect()},setupQuickSelect:function(){var e={yesterday:this.onYesterdayClick,lastWeek:this.onWeekClick,lastTwoWeeks:this.onTwoWeekClick,lastMonth:this.onMonthClick},t=this;_.each(e,function(e,n){var i=t.getChildById(n);i&&t.listen(i,P.CONST.EVENT_BUTTON_CLICK,e)})},updateUsingQuickSelect:function(e){"single"===this.options.selectionMode&&2===e.length&&(e=e[0]);var t=this.$(".pickerContainer");t.DatePickerSetDate(e,!0);var n=t.DatePickerGetDate(!0),i=t.DatePickerGetDate(!1);this.onChange(n,i)},onYesterdayClick:function(){this.updateUsingQuickSelect(this.getYesterday())},onWeekClick:function(){var e=this.getYesterday(),t=this.getDaysAgo(7),n=[t,e];this.updateUsingQuickSelect(n)},onTwoWeekClick:function(){var e=this.getYesterday(),t=this.getDaysAgo(14),n=[t,e];this.updateUsingQuickSelect(n)},onMonthClick:function(){var e=this.getYesterday(),t=this.getDaysAgo(28),n=[t,e];this.updateUsingQuickSelect(n)},getDaysAgo:function(e){var t=new Date;return t.setDate(t.getDate()-e),t},getYesterday:function(){return this.getDaysAgo(1)},setupPicker:function(){var e=this;this.$(".pickerContainer").DatePicker({flat:!0,date:this.options.selectedDate||this.getYesterday(),calendars:1,mode:this.options.selectionMode||"range",starts:1,onChange:function(t,n){return e.onChange(t,n)},onRender:function(t){return e.onDateRender(t)}})},onDateRender:function(e){return{disabled:e.valueOf()>this.maxDate.valueOf()||e.valueOf()<this.minDate.valueOf()}},onChange:function(e,t){var n={formatted:e,dates:t};this.triggerEvent("datePickerDateSelected",n,!0),e.length>1&&e[0]!==e[1]&&this.triggerEvent("datePickerRangeSelected",n,!0)},hidePicker:function(){this.parent.hide()}})}),P.Module.define("Developer",[],function(){return P.Module.extend({events:{}})}),P.Module.define("Domain",[],function(){return P.Module.extend({})}),P.Module.define("DomainAnalyticsPage",[],function(){return P.Module.extend({events:{},onContentReady:function(){this.childListen(P.CONST.EVENT_DATEPICKER_DATE_SELECTED,this.onDateChanged),this.checkValidData()},checkValidData:function(){var e=!1;$.each(this.data,function(t,n){(n.PIN_REPIN||n.PIN_VIEW)&&(e=!0)}),e||(this.$(".noData").show(),this.$(".metricsContainer").hide())},onDateChanged:function(e){var t=e.data.formatted[0],n=e.data.formatted[1];if(t!==n){this.showLoading(!0),e.target.parent.hide();var i=window.location.pathname,o=$.param({start_date:t,end_date:n}),r=i+"?"+o;this.navigate(r)}}})}),P.Module.define("DomainFeedPage",[],function(){return P.Module.extend({events:{},onContentReady:function(){this.checkGridContent(),this.childListen(P.CONST.EVENT_DATEPICKER_DATE_SELECTED,this.onDateChanged)},checkGridContent:function(){var e=this.getChildById("feedGrid");e.hasItems()||this.$(".noData").show()},changeDate:function(e){var t=(e.endDate-e.startDate)/6e8,n={end_date:e.formattedEndDate};t>=2?n.aggregation="biweekly":t>=1&&(n.aggregation="weekly");var i=window.location.pathname,o=$.param(n),r=i+"?"+o;this.navigate(r)},onDateChanged:function(e){this.showLoading(!0),e.target.hidePicker();var t=e.data.dates[0],n=e.data.dates[1],i=e.data.formatted[1];this.changeDate({startDate:t,endDate:n,formattedEndDate:i})}})}),P.Module.define("DomainInfoBar",[],function(){return P.Module.extend({events:{}})}),P.Module.define("DomainOwnerInfoBar",[],function(){return P.Module.extend({events:{"click .export":"exportClicked"},exportMetricsUrl:function(){return this._buildUrl("",{end_date:this.options.end_date,start_date:this.options.start_date})},exportMostRepinnedUrl:function(){return this._buildUrl("top/repins/",{end_date:this.options.end_date})},exportMostClickedUrl:function(){return this._buildUrl("top/clicks/",{end_date:this.options.end_date})},exportMostRecentUrl:function(){return this._buildUrl("recent/",{})},_buildUrl:function(e,t){this.options.aggregation&&(t.aggregation=this.options.aggregation);var n=$.param(t),i="/analytics/"+this.options.domain+"/export/",o=i+e,r=o+"?"+n;return r},exportClicked:function(){var e=this.urlExportMap[this.options.feed_item_type];e||(e=this.exportMetricsUrl),this.downloadFile(e.apply(this))},downloadFile:function(e){var t="downloaderIFrame",n=document.getElementById(t);null===n&&(n=document.createElement("iframe"),n.id=t,n.style.display="none",document.body.appendChild(n)),n.src=e},initialize:function(){this.urlExportMap={most_recent:this.exportMostRecentUrl,most_repinned:this.exportMostRepinnedUrl,most_clicked:this.exportMostClickedUrl}}})}),P.Module.define("DomainVerify",[],function(){return P.Module.extend({events:{"click .helpText a":"onClickType"},initialize:function(){this.METATAG="metatag",this.FILENAME="filename",this.verificationType=this.FILENAME},onContentReady:function(){this.formListener&&this.removeListener(this.formListener),this.form=new P.Form(this.$("form")),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.downloadButton=this.getChildById("downloadButton"),this.listen(this.downloadButton,P.CONST.EVENT_BUTTON_CLICK,this.onClickDownload)},onSubmitValidated:function(e){e.errors[0]||this.verifyDomain()},swapVerificationType:function(){this.$(".filename, .metaTag").toggle(),this.verificationType=this.verificationType===this.METATAG?this.FILENAME:this.METATAG},onClickType:function(){this.swapVerificationType()},showError:function(e){this.$(".errorReason").text(e),this.$(".errorSection").show()},hideError:function(){this.$(".errorSection").hide()},waitForVerification:function(e,t){t=t||3;var n=0,i=new P.Resource("TaskStatusResource",{task_id:e}),o=this,r=function(){n>=t||i.call("get",{success:function(e){var t=e.resource_response;t.error||("running"===t.data.status?setTimeout(r,200):"failure"===t.data.data.status?o.showError(t.data.data.message):o.isInModal()?(P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_USER_UPDATED),P.pubsub.publish(P.currentUser.attributes.id,P.CONST.PUBSUB_TOPIC_USER_UPDATED),o.destroy()):this.navigate("/"))},error:function(){P.showError("Trouble verifying your domain. Please try again later.")}})};setTimeout(r,200)},verifyDomain:function(){var e=this.getChildById("submitButton");e.showLoading(),this.hideError();var t=this,n={type:this.verificationType,domain:this.options.domain},i=new P.Resource("DomainVerifyResource",n);i.call("update",{success:function(n){var i;e.hideLoading(),n.resource_response.error?n.resource_response.message&&(i={message:n.resource_response.message}):t.waitForVerification(n.resource_response.data.task_id)},error:function(e){P.showError(e.message)},complete:function(){e.hideLoading()}})},downloadFile:function(e){var t="downloaderIFrame",n=document.getElementById(t);null===n&&(n=document.createElement("iframe"),n.id=t,n.style.display="none",document.body.appendChild(n)),n.src=e},onClickDownload:function(){this.downloadFile("/website/verify/download/")}})}),P.Module.define("Dropdown",["PositionModule"],function(e){var t="active",n="dropdownContainer",i="dropdownModule";return e.extend({initialize:function(){this.alreadyInitialized=!1,this.childListen("cancelClicked",this.disableAnchorAndHideDropdown),this.childListen(P.CONST.EVENT_DROPDOWN_HIDE,this.disableAnchorAndHideDropdown),this.childListen(P.CONST.EVENT_NAVIGATE,this.disableAnchorAndHideDropdown),this.childListen(P.CONST.EVENT_EXTERNAL_CLICK,this.disableAnchorAndHideDropdown),e.prototype.initialize.apply(this)},_positionIfReady:function(){this.inDom&&this.contentReady&&(this.positionModule(),this.ensureHoverIntent(),this.getPositionAnchor().initHovering())},onAdded:function(){this.options.prefetch&&(this.options.prefetch=!1,this.render())},onAddedToDom:function(){this._positionIfReady()},onContentReady:function(){this._positionIfReady()},disableAnchorAndHideDropdown:function(){this.setAnchorActive(!1),this.hide()},render:function(e){this.renderContainer(),$("body").append(this.$el);var t=_.bind(function(){this.contentReady=!0,this.onContentReady(),this.onRendered(),e&&e()},this),n=this.getPositionElement();this.options.title&&n.append('<h2 class="dropdownTitle">'+this.options.title+"</h2>"),this.options.text&&n.append('<p class="dropdownText">'+this.options.text+"</p>"),this.options.module?P.loadModule(this.options.module,_.bind(function(e){e.id=i,this.insertChild(e,this.getPositionElement()),e.render(t),this.options.displayWhileLoading&&t()},this)):t()},setAnchorActive:function(e){this.parent.setActiveStyle(e)},ensureHoverIntent:function(){var e=this;this.parent.isClickButton()||this._hoverIntent||this.options.manually_close||(this._hoverIntent=new P.HoverIntent(this.$el,{exitDelay:500}),this.listen(this._hoverIntent,P.CONST.EVENT_HOVERINTENT_OUT_COMPLETE,function(){e.getPositionAnchor().isHovering()||(e.hide(),e.setAnchorActive(!1))}))},hide:function(){this.$el.removeClass(t),this.triggerEvent(P.CONST.EVENT_DROPDOWN_HIDE,null,!0),this._bodyListener&&(this.removeListener(this._bodyListener),this._bodyListener=null),this._dropdownSubscriber&&(this._dropdownSubscriber.unsubscribe(),this._dropdownSubscriber=null)},ensureModule:function(e){var t=this;return e=e||P.NOOP,this.rendering||this.getChildById(i)?e():(this.rendering=!0,this.render(function(){return t.rendering=!1,e()}),void 0)},ensureOpenListeners:function(){this.options.sticky||(this._bodyListener=this.listen($("body"),"mousedown",function(e){$(e.target).closest(this.$el).length>0||$(e.target).closest(this.options.anchor).length>0||this.hide()}))},show:function(e){var n=this;this.ensureOpenListeners(),this.ensureModule(function(){n.$el.addClass(t),n.positionModule(),n.triggerEvent(P.CONST.EVENT_DROPDOWN_SHOW,null,!0),e&&e()})},fadeIn:function(e,t){var n=this;this.show(function(){n.$el.addClass("fadeIn"),t&&t()})},getDropdown:function(){return this.$("."+n)},isVisible:function(){return this.$el.hasClass(t)}})}),P.Module.define("DropdownButton",["Dropdown"],function(e){var t="tutorialDropdown",n="click",i="hover",o={};return o[n]=n,o[i]=i,P.Module.extend({events:{click:"onClick"},handleClick:function(e){if(this.openStrategy===i)return!1;var t=this._dropdown.isVisible();t?this.hideDropdown():(this.showDropdown(),e.stopPropagation())},onClick:function(e){this.handleClick(e)},getDropdown:function(){return this.getChildById("dropdown")},getDropdownOptions:function(){return this.options.dropdown_options||{}},getDropdownModule:function(){return this.options.module},ensureDropdown:function(){if(this.getDropdown())return this._dropdown;var t={module:this.getDropdownModule(),anchor:this.getElement()};_.map(this.getDropdownOptions(),function(e,n){t[n]=e});var n=this._dropdown=new e({options:t,id:"dropdown"});this.listen(n,P.CONST.EVENT_DROPDOWN_HIDE,this.onDropdownHide),this.addChild(n)},onMouseEnterComplete:function(){this.isHoverEnabled()&&this.$el.isHovering()&&this.showDropdown()},showDropdown:function(e){this.setActiveStyle(!0),this.hideTutorial(),this._dropdown.show(e)},hideDropdown:function(){this.setActiveStyle(!1),this._dropdown.hide()},onMouseOutComplete:function(){this._dropdown.$el.isHovering()||this.hideDropdown()},initListeners:function(){var e=this;this.openStrategy!==n&&(this._hoverIntent&&this._hoverIntent.$el===this.$el||(this._hoverIntent=new P.HoverIntent(this.$el,{enterDelay:5,exitDelay:200}),this.listen(this._hoverIntent,P.CONST.EVENT_HOVERINTENT_ENTER_COMPLETE,function(){e.onMouseEnterComplete()}),this.listen(this._hoverIntent,P.CONST.EVENT_HOVERINTENT_OUT_COMPLETE,function(){e.onMouseOutComplete()})))},onContentReady:function(){this.ensureDropdown(),this.$el.initHovering(),this._dropdown.$el.initHovering(),this.openStrategy=this.options.show_dropdown_on_hover?o[i]:o[n],this.initListeners(),this.options.tutorial&&this.options.tutorial.topic&&(this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_TUTORIAL,_.object([[this.options.tutorial.topic,this.onShowTutorial]])),this.options.tutorial.show&&this.showTutorial())},onDropdownHide:function(){this.setActiveStyle(!1)},ensureTutorialDropdown:function(){if(!this.getChildById(t)){var n=_.extend({},this.options.dropdown_options,{title:this.options.tutorial.title,text:this.options.tutorial.text,anchor:this.getElement(),class_name:"tutorial",largeCaret:!1}),i=new e({id:t,options:n});this.appendChild(i)}return this.getChildById(t)},onShowTutorial:function(){this.showTutorial()},isClickButton:function(){return this.openStrategy===n},showTutorial:function(){if(this.options.tutorial){var e=this.ensureTutorialDropdown();e.fadeIn(1e3)}},hideTutorial:function(){if(this.options.tutorial){var e=this.getChildById(t);e&&e.destroy()}},setActiveStyle:function(e){var t=this.getChildByModuleName("Button");t?t.$el.toggleClass(P.CONST.CLASS_DROPDOWN_BUTTON_ACTIVE,e):this.$el.toggleClass(P.CONST.CLASS_DROPDOWN_BUTTON_ACTIVE,e)},isHoverEnabled:function(){return(!this.options.button_options||this.options.button_options.disabled!==!0)&&this.openStrategy!==n}})}),P.Module.define("FacebookShareButton",["Button"],function(e){return e.extend({onClick:function(){var e=this.options.ga_category||"share_facebook";return P.trackGAEvent(e,P.CONST.GA_ACTION_CLICK),P.FacebookDialog.open(this.options.dialog_options),!1}})}),P.Module.define("FastFollow",["Grid"],function(e){var t="fastFollowContent",n="fastFollowHeader",i="categoryBoardsGrid",o="wholeBoardMask",r=355,s=102,a=56,l=P.Module.extend({_boardsFollowed:[],_modalDisplayed:!1,_cachedGrids:{},getOwnedScrollables:function(){return this.$(".fastFollowGridContainer")},_getBoardIdFromEvent:function(e){var t=e.data||{};return t.board_id},_onBoardFollow:function(e){var t=this._getBoardIdFromEvent(e),n=$.inArray(t,this._boardsFollowed);t&&-1===n&&(this._boardsFollowed.push(t),this._updateFollowedBoards(1),this._updateFollowedBoardMask(e,!0))},_onBoardUnfollow:function(e){var t=this._getBoardIdFromEvent(e);if(t){var n=$.inArray(t,this._boardsFollowed);-1!==n&&(this._boardsFollowed.splice(n,1),this._updateFollowedBoards(-1)),this._updateFollowedBoardMask(e,!1)}},_updateFollowedBoardMask:function(e,t){var n=this._getBoardIdFromEvent(e);if(n){var i=this.$("."+o+".mask"+n);t?i.show():i.hide()}},_onCategoryUpdate:function(n){var o=n.data,r=P.e.nuo_po;if(this._currentGrid||(this._currentGrid=this.getChildById(i),this._cachedGrids[this._currentGrid.resource.options.category]=this._currentGrid),o!==this._currentGrid.resource.options.category){this._currentGrid.remove();var s=this._cachedGrids[o];s||(s=new e({id:i,options:{centered:!1,layout:"fixed_height",show_grid_footer:!1,scrollable:!0,item_options:{allow_click_thru:!1,board_click_mask:r}},resource:{name:"CategoryBoardsResource",options:{category:o}}}),s.render(),this._cachedGrids[o]=s);var a=this.$(".fastFollowGridContainer");this.$("."+t).scrollTop(0),this.insertChild(s,a),this._currentGrid=s,this._updateBoardHeading(o)}},_updateBoardHeading:function(e){if(P.e.nuo_po){e=this.$(".followPageSidebarCategory[data-category="+e+"]"),e=e?e.text():null;var t=this.$(".heading .boardCategory");
t&&t.length&&e&&t.text(e)}},_onProgressCompletion:function(){this._userRegisterTrackActionOrientationComplete(),this._setProgressCompletion(!0),P.currentUser.set("show_fast_follow",!1)},_userRegisterTrackActionOrientationComplete:function(){P.trackRegisterAction("orientation_complete")},_setProgressCompletion:function(e){var t=this.getChildById(n);t&&(t.options.progress_completed=e,t.render())},_updateFollowedBoards:function(e){if(!this._modalDisplayed){var t=this.getChildById(n);t&&t.stepProgress(e)}},onContentReady:function(){var e=this;_.each(this.extraData.followed_boards,function(t){e._boardsFollowed.push(t.id)}),this.childListen(P.CONST.EVENT_FAST_FOLLOW_CATEGORY_SELECTED,this._onCategoryUpdate),this.childListen(P.CONST.EVENT_PROGRESS_COMPLETED,this._onProgressCompletion),this.childListen(P.CONST.EVENT_BOARD_FOLLOW,this._onBoardFollow,this),this.childListen(P.CONST.EVENT_BOARD_UNFOLLOW,this._onBoardUnfollow,this),this.listen(P.Viewport,P.CONST.EVENT_RESIZE,this.position),this.position()},position:function(){if(this.inDom&&this.contentReady){this.fastFollowHeaderHeight||(this.fastFollowHeaderHeight=this.$(".FastFollowHeader").outerHeight(!0));var e=s+a,t=P.Viewport.height,n=t-e-this.fastFollowHeaderHeight,i=Math.max(r,n);this.$(".fastFollowContent").height(i)}},onDestroyed:function(){_.each(_.values(this._cachedGrids),function(e){e.destroy()})}});return l}),P.Module.define("FastFollowHeader",[],function(){var e="followPageProgress";return P.Module.extend({events:{},stepProgress:function(t){var n=this.getChildById(e);n&&n.moveStep(t)}})}),P.Module.define("FastFollowSidebar",[],function(){var e="selected",t=P.Module.extend({events:{"click .followPageSidebarCategory":"onCategoryClick"},onContentReady:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.toggleShowMoreCategories)},onCategoryClick:function(e){var t=$(e.currentTarget);if(t.length){var n=t.attr("data-category");n.length&&(this.highlightCategory(n),this.triggerEvent(P.CONST.EVENT_FAST_FOLLOW_CATEGORY_SELECTED,n,!0))}},highlightCategory:function(t){this.$("."+e).removeClass(e),this.$("*[data-category="+t+"]").addClass(e)},toggleShowMoreCategories:function(){return this.$el.toggleClass("expand"),!1}});return t}),P.Module.define("FeedEditorBoardGroup",[],function(){return P.Module.extend({events:{},onContentReady:function(){var e=this.getChildById("items");e&&!e.hasItems()&&this.destroy();var t=this.getChildById("showMoreButton");t&&this.listen(t,"buttonClick",this.onShowMoreButtonClick)},onShowMoreButtonClick:function(){this.triggerEvent("showAll",{title:this.options.title,category:this.options.category,resource:this.resource.copy()},!0)}})}),P.Module.define("FeedEditorBoardGroupModal",[],function(){return P.Module.extend({events:{"click .close":"destroy",click:"destroy"}})}),P.Module.define("FeedEditorPage",[],function(){return P.Module.extend({events:{},onContentReady:function(){this.childListen("showAll",this.onShowAll)},onShowAll:function(e){e.stopPropagation(),this.showAllBoards(e.data)},showAllBoards:function(e){var t=this,n=e.resource;n.set("page_size",50);var i={name:"FeedEditorBoardGroupModal",options:{title:e.title,category:e.category,canClose:!0},resource:n};P.loadModule(i,function(e){t.appendChild(e),e.render(),P.Body.setScrolling(!1),t.listen(e,P.CONST.EVENT_DESTROYED,function(){P.Body.setScrolling(!0)})})}})}),P.Module.define("FeedPage",[],function(){return P.Module.extend({onContentReady:function(){P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_CURRENT_CATEGORY,this.options.feed)},onRemovedFromDom:function(){P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_CURRENT_CATEGORY,null)}})}),P.Module.define("FindFriendsContent",["SocialNetworkSettingsBase"],function(e){var t=1e3,n=110;return e.extend({events:{},initialize:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function(e){var t=e.target,n=null;switch(t.id){case"facebookConnectButton":n=P.SocialConnect.FACEBOOK;break;case"twitterConnectButton":n=P.SocialConnect.TWITTER;break;default:return}t.showLoading(!0);var i=this,o={success:function(){i.pollForFriends(n)},error:function(){i.hideLoading()}};this.handleConnect(n,!0,o)},_getResourceNameForNetworkFriends:function(e){var t=null;switch(e){case P.SocialConnect.FACEBOOK:t="UserFacebookFriendsResource";break;case P.SocialConnect.TWITTER:t="UserTwitterFriendsResource";break;default:return}return t},pollForFriends:function(e){var i=this._getResourceNameForNetworkFriends(e);if(i){var o=new P.Resource(i,{username:this.options.username}),r=this;o.call("get",{success:function(){r.render()},error:function(i){i.api_error_code===n?setTimeout(function(){r.pollForFriends(e)},t):(r.hideLoading(),r.render())}})}}})}),P.Module.define("FindFriendsInfoBar",[],function(){return P.Module.extend({events:{}})}),P.Module.define("FindFriendsPage",[],function(){return P.Module.extend({events:{}})}),P.Module.define("FindFriendsRep",[],function(){return P.Module.extend({})}),P.Module.define("FlagComment",[],function(){return P.Module.extend({events:{},onContentReady:function(){var e=this.$("form"),t={reason:[P.Validator.Required()]},n={prevalidate:!0};this.form=new P.Form(e,t,n),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(e){e.errors[0]||this.flagComment()},flagComment:function(){var e=this,t=this.getChildById("submitButton");t.showLoading();var n={pin_id:this.options.pin_id,comment_id:this.options.comment_id,reason:this.$("form :checked").attr("value")};"other"===n.reason&&(n.explanation=this.$("textarea").val()),P.trackGAEvent("comment_flag",P.CONST.GA_ACTION_CLICK_SUBMIT,"reason",n.reason);var i=new P.Resource("CommentFlagResource",n);i.call("create",{success:function(){P.trackGAEvent("comment_flag",P.CONST.GA_ACTION_SUCCESS),e.destroy()},error:function(e){P.trackGAEvent("comment_flag",P.CONST.GA_ACTION_ERROR),P.showError(e.message)},complete:function(){t.hideLoading()}})}})}),P.Module.define("FlagCommentReasons",[],function(){return P.Module.extend({events:{}})}),P.Module.define("FlagContent",[],function(){var e="hidden",t="active",n="other";return P.Module.extend({events:{"change input":"onChange"},initialize:function(){this.listen(this,"change",this.checkIfOtherIsSelected)},onChange:function(e){var t=this,n=this.options,i=$(e.target),o=i.siblings("label");if(this._reason=i.attr("id"),this._reasonNoun=o.text(),this.checkIfOtherIsSelected(),this.triggerEvent("change",this,!0),"blockInput"===n.class_name&&this.updateLabel(i),n.reason=this._reason,n.reason_noun=this._reasonNoun,this.options.show_confirmation_on_change){var r={name:"FlagContentConfirm",options:n};P.loadModule(r,function(e){var i;"user"===n.object_flagged?i="user_flag":"pin"===n.object_flagged?i="pin_flag":"comment"===n.object_flagged&&(i="comment_flag"),i&&P.trackGAEvent(i,P.CONST.GA_ACTION_OPEN_MODAL,"reason",t._reason),t.hideLoading(),t.showInModal(e)})}},updateLabel:function(e){var n=$(e),i=n.siblings("label");this.$("."+t).removeClass(t),i.addClass(t)},showOtherFieldIfNeed:function(){this.options.hide_other_field||this.$(".explanation").toggleClass(e,!this.options.show_explanation)},checkIfOtherIsSelected:function(){this.options.show_explanation=this._reason===n?!0:!1,this.showOtherFieldIfNeed()}})}),P.Module.define("FlagContentConfirm",[],function(){var e="user_flag";return P.Module.extend({onContentReady:function(){var e=this.$("form"),t={};this.options.show_explanation&&(t={explanation:[P.Validator.Required(),P.Validator.Length({max:P.CONST.MAX_CHARS_FOR_BOARD_TITLE})]});var n={prevalidate:!0};this.form=new P.Form(e,t,n),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function(t){var n=t.target;n&&("cancelButton"===n.id?P.trackGAEvent(e,P.CONST.GA_ACTION_CLICK_CANCEL):"reportButton"===n.id&&P.trackGAEvent(e,P.CONST.GA_ACTION_CLICK_SUBMIT))},onSubmitValidated:function(e){e.errors[0]||this.reportUser()},onReportUserSuccess:function(){var e=this,t={name:"ConfirmDialog",options:{template:"flag_user_success"}};P.loadModule(t,function(t){e.showInModal(t),e.listen(t,P.CONST.EVENT_CONFIRM,e.onFlagConfirm)})},onFlagConfirm:function(){this.destroy()},reportUser:function(){var t=this,n=this.options.user_id,i={reported_user:n,reason:this.options.reason};this.options.show_explanation&&(i.explanation=this.$("textarea").val());var o=new P.Resource("UserReportResource",i);o.call("create",{success:function(){P.trackGAEvent(e,P.CONST.GA_ACTION_SUCCESS),t.onReportUserSuccess()},error:function(t){P.showError(t.message),P.trackGAEvent(e,P.CONST.GA_ACTION_ERROR)},complete:function(){t.destroy()}})}})}),P.Module.define("FlagPin",[],function(){var e="pin_flag";return P.Module.extend({events:{},onContentReady:function(){var e=this.$("form"),t={reason:[P.Validator.Required()]},n={prevalidate:!0};this.form=new P.Form(e,t,n),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(e){e.errors[0]||this.flagPin()},flagPin:function(){var t=this,n=this.getChildById("submitButton");n.showLoading();var i={pin_id:this.options.pin_id,reason:this.$("form :checked").attr("value")};"other"===i.reason&&(i.explanation=this.$("textarea").val());var o={name:"ConfirmDialog",options:{template:"flag_pin"}};P.trackGAEvent(e,P.CONST.GA_ACTION_CLICK_SUBMIT,"reason",i.reason);var r=new P.Resource("PinFlagResource",i);r.call("create",{success:function(){P.trackGAEvent(e,P.CONST.GA_ACTION_SUCCESS),P.loadModule(o,function(e){t.showInModal(e),t.listen(e,P.CONST.EVENT_CONFIRM,t.destroy)})},error:function(t){P.trackGAEvent(e,P.CONST.GA_ACTION_ERROR),P.showError(t.message)},complete:function(){n.hideLoading()}})}})}),P.Module.define("FlagUser",[],function(){return P.Module.extend({events:{"click .cancelButton":"onCancelButtonClick"},onCancelButtonClick:function(){var e=this.options.blocked_by_me?"user_unblock":"user_block";P.trackGAEvent(e,P.CONST.GA_ACTION_CLICK_CANCEL),this.triggerEvent("cancelClicked",this,!0)}})}),P.Module.define("FlagUserPinReasons",[],function(){return P.Module.extend({events:{}})}),P.Module.define("FollowerCount",["NavigateButton"],function(e){return e.extend({onContentReady:function(){var t={};t[P.CONST.PUBSUB_TOPIC_USER_FOLLOW]=this.onFollowerChange,t[P.CONST.PUBSUB_TOPIC_USER_UNFOLLOW]=this.onFollowerChange,this.pubsubSubscribe(this.options.user_id,t),e.prototype.onContentReady.call(this)},onFollowerChange:function(){this.render()}})}),P.Module.define("FriendsToFollow",[],function(){return P.Module.extend({events:{},friendIdsUsed:[],friendIdsUnused:[],usersToReplace:[],usersDismissing:[],onContentReady:function(){this.friendIdsUsed=this.extraData.friendIdsUsed,this.destroyIfEmpty()||(this.childListen(P.CONST.EVENT_DISMISS,this.onChildDismiss),this.childListen(P.CONST.EVENT_USER_FOLLOW,this.onChildUserFollow))},onChildDismiss:function(e){var t=e.target,n=new P.Resource("UserFriendSuggestionResource",{});n.set("user_id",t.getUserId()),n.call("delete"),this.dismissUser(t)},onChildUserFollow:function(e){var t=e.target,n=this;window.setTimeout(function(){n.dismissUser(t)},500)},requestMoreFriendsIfNeeded:function(){var e=this.friendIdsUnused,t=this.usersDismissing.length+this.usersToReplace.length;if(!(e.length>=t||this.resource.xhr)){var n=this;this.resource.resetBookmark(),this.resource.options.excluded_user_ids=this.friendIdsUsed,this.resource.call("get",{success:function(t){var i=t.resource_response.data,o=_.pluck(i,"id");for(n.friendIdsUnused=e.concat(o);n.usersToReplace.length;){var r=n.usersToReplace.shift();n.replaceUser(r)}}})}},dismissUser:function(e){if(e){var t=this;this.usersDismissing.push(e),e.fadeOut(function(){t.usersDismissing=_.without(t.usersDismissing,e),t.friendIdsUnused.length?t.replaceUser(e):(t.usersToReplace.push(e),t.requestMoreFriendsIfNeeded())})}},removeUser:function(e){var t=e.$el.parent();t.remove(),e.destroy();var n=this.getChildById("friendList");n.isEmpty()&&this.destroy()},replaceUser:function(e){var t=this.friendIdsUnused.pop();return t?(e.resource.options.user_id=t,e.render(function(){e.show(),e.fadeIn()}),this.friendIdsUsed.push(t),void 0):(this.removeUser(e),void 0)}})}),P.Module.define("Grid",[],function(){var e="hasError";return P.Module.extend({events:{"click .gridFooter .gridError .Button":"onTryAgainClick"},initialize:function(e){e.options.show_grid_footer&&(this.childListen(P.CONST.EVENT_ERROR,this.onError),this.childListen(P.CONST.EVENT_ERROR_RESOLVED,this.onErrorResolved),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(P.CONST.EVENT_ITEMS_REQUEST_START,this.onItemsRequestStart),this.childListen(P.CONST.EVENT_ITEMS_REQUEST_SUCCESS,this.onItemsRequestSuccess),this.childListen(P.CONST.EVENT_ITEMS_END,this.onItemsEnd))},onContentReady:function(){this.items=this.getChildByModuleName("GridItems"),this.footer=this.getChildByModuleName("GridFooter"),this.footer&&this.hasItems()&&this.footer.show()},hasItems:function(){return this.items.hasItems()},hasItemsOfType:function(e){return!!this.items.getChildrenByModuleName(e).length},hasMoreItems:function(){return this.items.hasMoreItems()},requestMoreItems:function(){this.items.requestMoreItems()},emptyItems:function(){this.items.empty()},renderItems:function(e,t){this.items.render(e,t)},setPageSize:function(e){this.items.setPageSize(e)},getItemsResource:function(){return this.items.resource},setItemsResource:function(e){this.setResource(e),this.items&&this.items.setResource(e)},onError:function(){this.hasError=!0,this.$el.addClass(e),this.footer&&(this.footer.showError(),this.footer.hideGridLoading())},onErrorResolved:function(){this.hasError&&(this.hasError=!1,this.$el.removeClass(e))},onButtonClick:function(){return this.requestMoreItems(),!1},onItemsRequestStart:function(){this.footer&&this.footer.showGridLoading()},onItemsRequestSuccess:function(){this.footer&&this.footer.hideError()},onItemsEnd:function(){this.footer&&this.footer.hideGridLoading()},prependChildItem:function(e){this.getGridItems().prependChildItem(e)},prependNewItems:function(e,t){return this.getGridItems().prependNewItems(e,t)},getGridItems:function(){return this.items},getFirstGridItem:function(e){return this.getGridItems().getChildByModuleName(e)}})}),P.Module.define("GridFooter",[],function(){var e="showGridLoading";return P.Module.extend({events:{"click .gridError .Button":"onTryAgainClick"},onTryAgainClick:function(e){this.triggerEvent(P.CONST.EVENT_BUTTON_CLICK,e,!0)},show:function(){this.$el.css("display","block")},_getErrorDiv:function(){return this.$el.find(".gridError")},showError:function(){var e=this._getErrorDiv();e.css("display","block")},hideError:function(){var e=this._getErrorDiv();e.css("display","none")},showGridLoading:function(){this.$el.addClass(e)},hideGridLoading:function(){this.$el.removeClass(e)}})}),P.Module.define("GridItems",[],function(){var e="activeItem",t=3,n=1e3,i=3e3,o=1e3,r="gridSortable",s={UP:0,DOWN:1},a=function(e){var t=parseInt(e.replace("px",""),10);return isNaN(t)?0:t},l=function(e){this.childModule=e,this.top=null,this.height=null,this.bottom=null,this.$itemWrapper=e.getParentElement().closest(".item"),this.columnIndex=null,this.inDom=!0};l.prototype={_calculateHeight:function(){this.height=this.$itemWrapper.height()},ensureHeightCalculated:function(){null===this.height&&this._calculateHeight()},recalculateHeight:function(){this.inDom?this._calculateHeight():this.log.error("Cannot calculate height because this item is not inDom")},setPosition:function(e,t){this.top=e,this.bottom=t},hasPosition:function(){return null!==this.top}};var u=function(e,t){this.gridItems=e,this.options=t,this.shortestColumnIndex=0,this.columnLengths=[],this.childCidToItemInfo={};var n=this;_.each(this.gridItems.children,function(e){n.childCidToItemInfo[e.cid]=new l(e)})};u.prototype={getFilledHeight:function(){return this.columnLengths[this.shortestColumnIndex]},onChildRendered:function(e){this._reflowOnChildChanged(e)},onChildAdded:function(e){this.childCidToItemInfo[e.cid]=new l(e)},onChildRemoved:function(e,t){if(!this.gridItems.isEmptying){t.remove();var n=this.childCidToItemInfo[e.cid],i=n.columnIndex;delete this.childCidToItemInfo[e.cid],this._reflowColumnContent(i)}},empty:function(){this.childCidToItemInfo={}},onChildContentChanged:function(e){this._reflowOnChildChanged(e)},onChildDimsChanged:function(e){this._reflowOnChildChanged(e,!1)},_reflowOnChildChanged:function(e,t){var n=this.childCidToItemInfo[e.cid];n.recalculateHeight(),this._reflowColumnContent(n.columnIndex,t)},_reflowColumnContent:function(e,t){void 0===t&&(t=this.options.reflow_all),t?this.positionGrid():this._repositionItemsInColumn(e)},_calculateNumColumns:function(){var e=this.options.minimum_num_columns||t;if(!this.itemWidth)return e;this.options.centered||this.gridItems.$el.css("width","auto");var n=this.gridItems.getWidth(!1),i=Math.floor(n/this.itemWidth);return Math.max(e,i)},_positionItemInColumn:function(e,t){if(this.gridItems.isReady()){var n=this.childCidToItemInfo[e.cid],i=n.$itemWrapper;t=Math.max(0,t),t=Math.min(this.columnLengths.length-1,t);var o=this.columnLengths[t];i.css({top:o+"px",left:t*this.itemWidth+"px",visibility:"visible"}),n.columnIndex=t;var r=n.height+this.topBuffer+this.bottomBuffer,s=o+r;n.setPosition(o,s),this.columnLengths[t]=s,this._setShortestColumnIndex()}},_positionItem:function(e){if(this.gridItems.isReady()){if(0===this.columnLengths.length){if(!this.itemWidth){var t=this.childCidToItemInfo[e.cid],n=t.$itemWrapper;this.itemWidth=n.outerWidth(!0);var i=n.css("margin-top"),o=n.css("padding-top"),r=n.css("margin-bottom"),s=n.css("padding-bottom");this.topBuffer=a(i)+a(o),this.bottomBuffer=a(r)+a(s)}var l=this._calculateNumColumns();this.options.centered||this.gridItems.$el.css("width",l*this.itemWidth),this.columnLengths=Array(l),this._setShortestColumnIndex()}var u=this.shortestColumnIndex;this._positionItemInColumn(e,u)}},_setShortestColumnIndex:function(){this.shortestColumnIndex=0;for(var e=0;e<this.columnLengths.length;e++)this.columnLengths[e]=this.columnLengths[e]||0,this.columnLengths[e]<this.columnLengths[this.shortestColumnIndex]&&(this.shortestColumnIndex=e)},_repositionItemsInColumn:function(e){if(this.gridItems.isReady()){var t=this;this.columnLengths[e]=0;var n=_.filter(this.childCidToItemInfo,function(t){return t.columnIndex===e}),i=_.sortBy(n,function(e){return e.top});_.each(i,function(n){t._positionItemInColumn(n.childModule,e)}),this.resizeContainer()}},resizeGrid:function(){var e=this.columnLengths.length,t=this._calculateNumColumns();e!==t&&(this.positionGridChildren(),this.gridItems.rearrangeItems(!0))},resizeContainer:function(){var e=Math.max.apply(Math,this.columnLengths);this.gridItems.$el.css("height",e+"px"),this.gridItems.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,null,!0)},positionGrid:function(){this.gridItems.isReady()&&(this.positionGridChildren(),this.gridItems.rearrangeItems())},positionGridChildren:function(e){if(this.gridItems.isReady()){var t=this;e||(this.columnLengths=[]),_.each(this.gridItems.children,function(e){var n=t.childCidToItemInfo[e.cid];n.ensureHeightCalculated()}),_.each(this.gridItems.children,function(n){var i=t.childCidToItemInfo[n.cid];e&&i.hasPosition()||t._positionItem(i.childModule)}),this.resizeContainer()}},hideAndShowItems:function(e,t,n,i,o){var r=this,a=[],l=[];_.each(this.childCidToItemInfo,function(r){var u=r.$itemWrapper[0];r.bottom<i?e&&r.inDom&&(t||n!==s.DOWN||(a.push(u),r.inDom=!1)):r.top>o?e&&r.inDom&&(t||n!==s.UP||(a.push(u),r.inDom=!1)):r.inDom||(l.push(u),r.inDom=!0)}),(l.length>0||a.length>0)&&P.deferDomManipulation(function(){r.gridItems.log.debug("hideAndShowItems DOM manip showing ",l.length," hiding ",a.length);var e;if(l.length>0){var t=document.createDocumentFragment();for(e=0;e<l.length;e++)t.appendChild(l[e]);r.gridItems.$el[0].appendChild(t)}for(e=0;e<a.length;e++){var n=a[e];n.parentNode&&n.parentNode.removeChild(n)}})}};var c=function(e,t){this.gridItems=e,this.options=t};c.prototype={resizeGrid:function(){},onChildContentChanged:function(){},onChildDimsChanged:function(){},onChildRendered:function(){},onChildAdded:function(){},positionGridChildren:function(){},empty:function(){},positionGrid:function(){this.gridItems.isReady()&&this.gridItems._requestMoreItemsIfNeeded()},hideAndShowItems:function(){},onChildRemoved:function(e,t){t.remove(),this.gridItems.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,null,!0)},getFilledHeight:function(){var e=this.gridItems.getWidth(!1),t=this.gridItems.children.length;if(0===t)return 0;var n=this.gridItems.children[0],i=n.$el.outerWidth(!0),o=n.$el.outerHeight(!0),r=Math.floor(e/i),s=Math.ceil(t/r),a=0!==t%r,l=s*o;return a&&(l-=o),l}};var d=function(e,t,n,i){this.gridItems=e,t||(t={}),t=_.extend({containment:"parent",cursor:"move",items:"."+r,tolerance:"pointer",zIndex:o},t),this.gridItems.$el.sortable(t),this.childModuleName=n,this.idFn=i,this._setSortableMetadata()};d.prototype={_setSortableMetadata:function(){var e=this;_.each(this.gridItems.getChildrenByModuleName(this.childModuleName),function(t){e._setSortableMetadataOnModule(t)})},_setSortableMetadataOnModule:function(e){e.$el.attr("data-sort-id",this.idFn(e));var t=e.getParentElement();t.addClass(r)},onChildAdded:function(e){this._setSortableMetadataOnModule(e)},getSortOrder:function(){var e=[];return _.each(this.gridItems.$el.find("."+this.childModuleName),function(t){e.push($(t).attr("data-sort-id"))}),e}};var h=P.Module.extend({events:{"click .trackActiveItem .item":"onTrackItemClick"},mixins:[P.Mixins.PreventScroll],onChildNavigate:function(e){var t=e.currentTarget;this.updateActiveItem(t.getParentElement())},onTrackItemClick:function(e){var t=e.currentTarget;this.updateActiveItem($(t))},updateActiveItem:function(t){var n=this.$(".activeItem");n.removeClass(e),t.addClass(e)},initialize:function(){this._scrollListener=null,this.alreadyInitialized=!1,this.scrollTop=0,this.lastScrollTop=null,this.viewableHeight=null,this.lastTopBorder=null,this.lastBottomBorder=null,this.layoutManager=null,this.childListen(P.CONST.EVENT_CONTENT_CHANGED,this.onChildContentChanged),this.childListen(P.CONST.EVENT_DIMS_CHANGED,this.onChildDimsChanged)},initializeSortManager:function(e,t,n){this.sortManager=new d(this,e,t,n)},getSortOrder:function(e,t){return this.sortManager?this.sortManager.getSortOrder(e,t):void 0},onOptionsChanged:function(){this._setScrollableElement(),this.alreadyInitialized=!1},onResourceChanged:function(){this.alreadyInitialized=!1},prependChildItem:function(e){var t=0;this.children.length>0&&this.children[0].options.anchored&&(t=1),this.insertChild(e,this.$el,t),this.layoutManager.positionGrid()},prependNewItems:function(e,t){var n=this,i=0,o=this.resource.copy();o.resetBookmark(),o.set("prepend",!0),o.set("page_size",e);var r=new h({resource:o});this.children.length>0&&this.children[0].options.anchored&&(i=1),r.options=this.options,r.render(function(){_.each(r.children.reverse(),function(e){e.remove(),n.insertChild(e,n.$el,i)}),n.layoutManager.positionGrid(),t&&t()})},requestMoreItems:function(){this.isReady()&&this._requestMoreItems()},hasMoreItems:function(){return!this.resource.atEnd()},_triggerIfItemsEnd:function(){this.hasMoreItems()||this.triggerEvent(P.CONST.EVENT_ITEMS_END,null,!0)},setPageSize:function(e){this.resource.set("page_size",e)},onAddedToDom:function(){this.resizeListener=this.listen(P.Viewport,P.CONST.EVENT_RESIZE,this.onResize),this.navigateListener=this.childListen(P.CONST.EVENT_NAVIGATE,this.onChildNavigate),this._setUpGrid(),this.onResize()},onResize:function(){this.isReady()&&this.layoutManager.resizeGrid()},hasItems:function(){return this.children.length>0},onContentReady:function(){var e=this.options.layout;if(e&&"variable_height"!==e){if("fixed_height"!==e)return this.log.error('GridItems invalid value for "layout"',e),void 0;this.layoutManager=new c(this,this.options)}else this.layoutManager=new u(this,this.options);this._setUpGrid(),this._triggerIfItemsEnd()},onRemovedFromDom:function(){this._scrollListener&&(this.removeListener(this._scrollListener),this._scrollListener=null),this.stopPreventScroll(),this.navigateListener&&this.removeListener(this.navigateListener),this.resizeListener&&this.removeListener(this.resizeListener)},scrollToActiveItem:function(e){var t=e.height(),n=this.$(".activeItem"),i=n.offset().top;e.scrollTop(i-t)},onChildContentChanged:function(e){e.stopPropagation();var t=e.currentTarget;this.isReady()&&(this.layoutManager.onChildContentChanged(t),this.rearrangeItems(!0))},onChildDimsChanged:function(e){e.stopPropagation();var t=e.currentTarget;this.isReady()&&this.layoutManager.onChildDimsChanged(t)},onChildRendered:function(e){this.isReady()&&this.layoutManager.onChildRendered(e)},onChildAdded:function(e){var t=e.getParentElement();if(!t.hasClass("item")){var n=$("<div></div>").addClass("item");n.insertBefore(e.getElement()),n.append(e.getElement()),t=n}this.layoutManager&&this.layoutManager.onChildAdded(e),this.sortManager&&this.sortManager.onChildAdded(e)},onChildRemoved:function(e,t){this.layoutManager&&this.layoutManager.onChildRemoved(e,t)},empty:function(){this.isEmptying=!0,P.Module.prototype.empty.call(this),this.alreadyInitialized=!1,this.contentReady=!1,this.layoutManager&&this.layoutManager.empty(),this.isEmptying=!1},handleError:function(e){this.pendingMoreRequest?this.$(".errorMessage").remove():P.Module.prototype.handleError.call(this,e)},_setUpGrid:function(){this._setScrollableElement(),this.isReady()&&!this.alreadyInitialized&&(this.layoutManager.positionGrid(),this.alreadyInitialized=!0)},_setScrollableElement:function(){this._scrollListener&&(this.removeListener(this._scrollListener),this._scrollListener=null),this.scrollableElement=this.getScrollableElement(),this.options.scrollable&&(this._scrollListener=this.listen(this.scrollableElement,"scroll",this._onScroll)),this._preventDefaultIfNeeded()},isReady:function(){return this.inDom&&this.contentReady},rearrangeItems:function(){this._requestMoreItemsIfNeeded(),this._hideAndShowItems()},_onScroll:function(){this.lastScrollTop=this.scrollTop,this.scrollTop=this.getScrollableElement().scrollTop(),this.rearrangeItems(!1)},_hideAndShowItems:function(e){if(this.options.virtualize){e=e||!1;var t=!this.lastScrollTop||this.scrollTop>=this.lastScrollTop?s.DOWN:s.UP,n=this.scrollTop-this.offsetFromScrollElement,o=n+this.viewableHeight,r=n-i,a=o+i,l=null===this.lastTopBorder||null===this.lastBottomBorder||n<this.lastTopBorder||o>this.lastBottomBorder;(l||e)&&(this.layoutManager.hideAndShowItems(e,this.pendingMoreRequest,t,r,a),this.lastTopBorder=r,this.lastBottomBorder=a),e||this.scheduleHideShowItems()}},scheduleHideShowItems:_.debounce(function(){this._hideAndShowItems(!0)},n),onRendered:function(){this._requestMoreItemsIfNeeded()},_requestMoreItemsIfNeeded:function(){if(this.isReady()&&this.options.scrollable&&!this.pendingMoreRequest&&!this.hasError&&this.hasMoreItems()){this.viewableHeight=this.scrollableElement.height(),this.offsetFromScrollElement=this.$el.positionAncestor(this.scrollableElement).top;var e=this.offsetFromScrollElement+this.layoutManager.getFilledHeight();e-(this.viewableHeight+this.scrollTop)>2*this.viewableHeight||this._requestMoreItems()}},_requestMoreItems:function(e){_.isUndefined(e)&&(e=2),this.triggerEvent(P.CONST.EVENT_ITEMS_REQUEST_START,null,!0),this.pendingMoreRequest=!0;var t=this,n=this.renderAppend(function(){t.layoutManager.positionGridChildren(!0),t.pendingMoreRequest=!1,t.hasError&&(t.triggerEvent(P.CONST.EVENT_ERROR_RESOLVED,null,!0),t.hasError=!1),t.triggerEvent(P.CONST.EVENT_ITEMS_REQUEST_SUCCESS,null,!0),t._requestMoreItemsIfNeeded(),t._triggerIfItemsEnd()},function(){e>0?t._requestMoreItems(e-1):(t.pendingMoreRequest=!1,t.hasError=!0,t.triggerEvent(P.CONST.EVENT_ERROR,null,!0),t._triggerIfItemsEnd()),this.log.error("in grid append")});return n||(t.pendingMoreRequest=!1),n},_preventDefaultIfNeeded:function(){this.options.prevent_default_scroll&&this.startPreventScroll(this.scrollableElement,this.$el)}});return h}),P.Module.define("GroupBoardEmailSettings",[],function(){return P.Module.extend({initialize:function(){this.childListen("change",this.onChildChange)},onSubmitValidated:function(){return this.save(),!1},save:function(){var e=this,t={},n=[];this.$form.find("input[name=collab_board_email]:checked").each(function(){n.push(this.value)}),t.email_collaborative_board_ids=n;var i=this.getChildById("submitButton"),o=new P.Resource("UserSettingsResource",t),r=function(e){e&&!e.resource_response.error};i.showLoading(),o.call("update",{success:r,complete:function(){i.hideLoading(),e.destroy()}})},onContentReady:function(){var e={};this.$form=this.$("form"),this.form=new P.Form(this.$form,e),this.listen(this.form,"submitValidated",this.onSubmitValidated)},onChildChange:function(e){var t=e.target;if("toggleAll"===t.id){var n;n=t.isChecked()?function(e){e.setChecked(!0)}:function(e){e.setChecked(!1)};var i=this.getChildrenByModuleName("ui.Checkbox");_.each(i,n)}}})}),P.Module.define("Header",[],function(){return P.Module.extend({events:{"click .exploreIcon":"onExploreIconClick"},onExploreIconClick:function(){var e=new P.Resource("UserRecommendedBoardResource");e.call("get",{success:function(e){var t=e.resource_response.data.url;P.navigate(t)}})},getUserMenu:function(){return this.getChildById("userMenu")},getLogo:function(){return this.$(".logo")}})}),P.Module.define("HomePage",[],function(){return P.Module.extend({events:{},showsFollowingFeed:function(){return this.getChildById("authHome").showsFollowingFeed()}})}),P.Module.define("IframeEmbed",[],function(){return P.Module.extend({events:{}})}),P.Module.define("ImagesFeedPage",[],function(){return P.Module.extend({events:{},onContentReady:function(){var e=this.getChildById("domainPinsGrid");e&&0===e.children.length?e.destroy():this.$(".domainPinsHolder").css("visibility","visible")}})}),P.Module.define("IncrementingNavigateButton",["NavigateButton"],function(e){var t="hidden";return e.extend({onContentReady:function(){this.listen(this,P.CONST.EVENT_INCREMENT_BUTTON_CREATE,this.makeVisible),this.listen(this,P.CONST.EVENT_INCREMENT_BUTTON_DESTROY,this.makeInvisible)},getValue:function(){if(this.extraData&&this.extraData.actionCount)return this.extraData.actionCount;var e=$.trim(this.$el.text()),t=parseInt(e,10);return t},setValue:function(e){this.extraData.actionCount=e,this.$el.text(e)},isHidden:function(){return this.$el.hasClass(t)},makeVisible:function(){var e=this.isHidden();e&&this.$el.removeClass(t)},makeInvisible:function(){var e=this.isHidden();e||this.$el.addClass(t)},increment:function(){var e=this,t=this.getValue();isNaN(t)&&(t=0),this.triggerEvent(P.CONST.EVENT_INCREMENT_BUTTON_CREATE,e.options.siblingButtonId,!0),t+=1,this.setValue(t)},decrement:function(){var e=this,t=this.getValue();return t-=1,0===t?(this.triggerEvent(P.CONST.EVENT_INCREMENT_BUTTON_DESTROY,e.options.siblingButtonId,!0),void 0):(this.setValue(t),void 0)}})}),P.Module.define("InfoBarBase",[],function(){var e="active";return P.Module.extend({onContentReady:function(){this.listen(this,P.CONST.EVENT_NAVIGATE,this.onTabClick),this.childListen(P.CONST.EVENT_NAVIGATE,this.onTabClick)},onTabClick:function(e){var t=e.data.url;t&&this.selectTab(t)},selectTab:function(t){this.$("a").each(function(){var n=$(this);n.attr("href")===t?n.addClass(e):n.removeClass(e)})}})}),P.Module.define("InlineHoverButton",[],function(){return P.Module.extend({events:{}})}),P.Module.define("InterestFeedPage",[],function(){return P.Module.extend({events:{}})}),P.Module.define("InviteFriendsRep",[],function(){return P.Module.extend({events:{click:"onClick"},onClick:function(){return"facebook"===this.options.network&&P.FacebookDialog.open({type:"send",name:this.extraData.name,description:this.extraData.description,path:"/",picture:this.extraData.picture}),!1}})}),P.Module.define("LanguageDropdown",[],function(){return P.Module.extend({events:{"click .language":"onClick"},onClick:function(e){var t=$(e.currentTarget),n=t.attr("data-url");
return P.navigate(n),!1}})}),P.Module.define("LanguageMenu",[],function(){return P.Module.extend({events:{}})}),P.Module.define("List",[],function(){return P.Module.extend({})}),P.Module.define("Login",[],function(){var e=85;return P.Module.extend({events:{"blur input[name=username_or_email]":"onBlurEmail","click .suggestionEmail":"onClickSuggestionEmail"},setupForm:function(){this.$form=this.$("form"),this.form=new P.Form(this.$form,{username_or_email:[P.Validator.Required(),P.Validator.Email()],password:[P.Validator.Required()]})},onBlurEmail:function(){if(this.extraData.show_email_suggestion){var e=this.$inputEmail.val(),t=_.extend({},{email:e,email_filter:"allow_all"});null==this.emailSuggestionResource&&(this.emailSuggestionResource=new P.Resource("EmailSuggestionResource",t));var n=this;this.emailSuggestionResource.options=t,this.emailSuggestionResource.call("get",{success:function(e){var t=e.resource_response.data;t.length>0?(n.$suggestionEmail.text(t[0]),n.$suggestion.slideDown()):n.$suggestion.slideUp()},error:function(){n.$suggestion.slideUp()}})}},onClickSuggestionEmail:function(e){var t=this.$suggestionEmail.text();this.$inputEmail.val(t),this.$suggestion.slideUp(),e.preventDefault()},onContentReady:function(){var e={},t=this.options.invite_follow_board,n=this.options.invite_follow_user;return n&&(t?e.invite_follow_board=n+"/"+t:e.invite_follow_user=n,P.SessionStorage.setItem(P.CONST.SESSION_KEY_INVITE_FOLLOW,e)),P.currentUser.isAuthenticated()?(this.redirect(e),void 0):(this.$suggestion=this.$(".suggestion"),this.$suggestionEmail=this.$(".suggestionEmail"),this.$inputEmail=this.$("input[name=username_or_email]"),this.setupForm(),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.getChildById("emailSignup")&&this.listen(this.getChildById("emailSignup"),P.CONST.EVENT_BUTTON_CLICK,this.onEmailSignup),this.getChildById("facebookSignup")&&this.listen(this.getChildById("facebookSignup"),P.CONST.EVENT_BUTTON_CLICK,this.onFacebookSignup),this.getChildById("facebookLogin")&&this.listen(this.getChildById("facebookLogin"),P.CONST.EVENT_BUTTON_CLICK,this.onFacebookLogin),this.getChildById("twitterLogin")&&this.listen(this.getChildById("twitterLogin"),P.CONST.EVENT_BUTTON_CLICK,this.onTwitterConnect),void 0)},onSubmitValidated:function(e){e.errors[0]||this.login({username_or_email:this.form.getValue("username_or_email"),password:this.form.getValue("password")})},onTwitterConnect:function(e){e.stopPropagation(),this.connect(P.SocialConnect.TWITTER,this.onTwitterConnectSuccess)},onEmailSignup:function(){P.trackRegisterAction("register_email")},onFacebookSignup:function(e){e.stopPropagation(),P.trackRegisterAction("register_facebook_attempt"),this.facebookConnect()},onFacebookLogin:function(e){e.stopPropagation(),this.facebookConnect()},facebookConnect:function(){this.connect(P.SocialConnect.FACEBOOK,this.onFacebookConnectSuccess)},onTwitterConnectSuccess:function(e){this.login({twitter_id:e.id,twitter_token:e.oauth_token,twitter_token_secret:e.oauth_secret})},onFacebookConnectSuccess:function(e){var t=P.NOOP,n=this.getChildById("facebookSignup"),i=this;this.options.register&&(t=function(){return i.extraData.fast_track_enabled?(n.showLoading(),P.UserRegistration.fastTrackSocialRegistration(P.SocialConnect.FACEBOOK).then(function(){n.hideLoading(),P.navigate("/")},function(){n.hideLoading(),P.navigate("/join/register/facebook/")})):P.navigate("/join/register/facebook/"),P.NOOP}),this.login({facebook_id:e.id,facebook_token:e.access_token},t)},connect:function(e,t){var n=P.SocialConnect.instance(),i=this;return n.connect(e,{success:function(e){t.call(i,e)},error:function(){P.showError(P.string("connectError"))}}),!1},login:function(t,n){var i=this.getChildById("loginButton");i&&i.showLoading();var o=P.SessionStorage.getItem(P.CONST.SESSION_KEY_INVITE_FOLLOW),r=this,s=function(){r.showLoading(!0),r.redirect(o)};n||(n=function(n){if(r.showError(n.message),n.api_error_code===e&&t.username_or_email){var i=P.getResetPasswordOneClickUrl({username_or_email:t.username_or_email});r.navigate(i)}});var a=function(){i&&i.hideLoading()};P.currentUser.login(t,s,n,a)},redirect:function(e){var t="/";e&&(e.invite_follow_user?t="/"+e.invite_follow_user+"/":e.invite_follow_board&&(t="/"+e.invite_follow_board+"/"),P.SessionStorage.removeItem(P.CONST.SESSION_KEY_INVITE_FOLLOW));var n=this.options.next||t;P.isLocalUrl(n)||(n="/"),window.location.href=n},showError:function(e){this.$(".loginError").html("<p>"+e+"</p>").show()}})}),P.Module.define("LoginButton",["NavigateButton"],function(e){return e.extend({getNavigateUrl:function(){var e=P.normalizeUrl(window.location.href),t="/login/";return e&&(t+="?"+$.param({next:e})),t}})}),P.Module.define("LoginPage",[],function(){var e=50;return P.Module.extend({events:{},resizeWindow:function(){var t=this.getChildByModuleName("Login").$el.height(),n=P.Viewport.height,i=P.Viewport.width;n<t&&window.resizeTo(i+e,t+e)},onContentReady:function(){this.resizeWindow()}})}),P.Module.define("LogoutPage",[],function(){return P.Module.extend({events:{},onContentReady:function(){this.logout()},logout:function(){var e=new P.Resource("UserSessionResource",{});e.call("delete",{success:function(){P.SessionStorage.clear(),P.LocalStorage.clear(),Cookie.unset(P.CONST.COOKIE_USE_DENZEL),Cookie.unset(P.CONST.COOKIE_SHOW_WELCOME),P.currentUser.logout(function(){window.location.href="/"})}})}})}),P.Module.define("Modal",["PositionModule"],function(e){var t="show",n=e.extend({events:{"click .modalMask":"onClick","click .modalContainer":"onModalContainerClick"},positionMode:P.CONST.PositionMode.VIEWPORT_MIDDLE,initialize:function(){e.prototype.initialize.apply(this),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onChildButtonClick)},render:function(e){this.empty();var t=this.options.mask_type||"",n=this.options.container_class||"";this.$el.append('<div class="modalMask '+t+'"></div>'+'<div class="modalContainer '+n+'">'+'<span class="positionModuleCaret"></span>'+'<div class="modalContent">'+'<div class="modalModule"></div>'+"</div>"+"</div>"),this.getCanDismiss()&&(this.$(".modalContent").append("<button class='Button closeModal inModal cancelButton borderless'><em></em>&nbsp;</button>"),this.$(".closeModal").on("click",_.bind(this.destroy,this)));var i=this.getModule();i&&(this.addModuleToContainer(i),i.options.transparent_modal&&this.setTransparentContent()),e&&e.call(this)},addModuleToContainer:function(e){var t=this;e.id="modalModule",e.errorStrategy=P.CONST.ErrorStrategy.SHOW,this.insertChild(e,this.getModuleContainer()),e.contentReady?this.setupModule(e):e.render(P.stopwatch.wrapContinuation("Modal.addModuleToContainer success",function(){t.setupModule(e)}),P.stopwatch.wrapContinuation("Modal.addModuleToContainer failed",function(){P.showError(P.string("errorMessage")),t.hide()}))},onChildRendered:function(e){this.setupModule(e)},setupModule:function(e){e.setModal(this),this.onRendered(),this.onContentReady()},show:function(){this.render(P.stopwatch.wrapContinuation("Modal:show continuation",function(){P.log("success")}))},hide:function(){this.destroy()},onAddedToDom:function(){P.Body.pushScrolling(!1)},onRemovedFromDom:function(){P.Body.pop()},getModule:function(){return this.options.module},setTransparentContent:function(e){this.getContent().toggleClass("transparent",e),this.$(".closeModal").toggle(!e)},getContent:function(){return this.$(".modalContent")},getModuleContainer:function(){return this.$(".modalModule")},getFullName:function(){var e=P.Module.prototype.getFullName.call(this);return this.moduleOpener&&(e=this.moduleOpener.getFullName()+"#"+e),e},getPositionElement:function(){return this.$(".modalContainer")},setModule:function(e){var t=this.getChildById("modalModule");t&&(t.id="",t.remove()),this.options.module=e,t=this.$(".modalModule"),t.empty(),this.addModuleToContainer(e)},onChildRemoved:function(){this.getChildById("modalModule")||this.hide()},onChildButtonClick:function(e){var t=e.target;if(t&&t.isCancelButton()){var n=this.options.module,i=n.GACategory;i||(i=n.options.ga_category),i&&P.trackGAEvent(i,P.CONST.GA_ACTION_CLICK_CANCEL),e.stopPropagation(),this.hide()}},onClick:function(){this.getCanDismiss()&&this.hide()},onModalContainerClick:function(e){e.target===e.currentTarget&&(e.stopPropagation(),this.onClick())},onRendered:function(){this.positionModule();var e=this.$el;e.addClass(t),this.options.transparent&&this.setTransparentContent(!0)},getCanDismiss:function(){var e=this.options.can_dismiss;return void 0===e||e}});return P.stopwatch.wrapMethods(n.prototype,"Modal",["render","addModuleToContainer","setModule","show"]),n}),P.Module.define("ModalTrigger",[],function(){var e=P.Module.extend({showModal:function(){this.options.ga_category&&P.trackGAEvent(this.options.ga_category,P.CONST.GA_ACTION_OPEN_MODAL);var e=this;this.showLoading(),P.loadModule(this.options.submodule,P.stopwatch.wrapContinuation("P.loadModule continuation",function(t){e.hideLoading(),e.showInModal(t,e.options.extra_options)}))}});return P.stopwatch.wrapMethods(e.prototype,"ModalTrigger",["showModal"]),e}),P.Module.define("NagBase",[],function(){return P.Module.extend({events:{"click .nagClose":"onCloseButtonClick"},clickHandler:function(){return null},onCloseButtonClick:function(){this.destroy(),P.trackGAEvent("nag",P.CONST.GA_ACTION_CLICK_CLOSE,"type",this.extraData.type)},onContentReady:function(){var e={};e[P.CONST.PUBSUB_TOPIC_USER_UPDATED]=this.onActionSaved,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,e)},onActionSaved:function(e,t,n){this.$(".message").text(n)},resourceCall:function(e,t,n){var i=n.success,o=n.error;this.xhr=$.ajax({cache:!1,url:e,data:{},dataType:"json",type:"get"===t?"get":"post",success:i,error:o})}})}),P.Module.define("NagEmail",["NagBase"],function(e){return e.extend({events:{"click .editEmail":"clickHandler","click .resendEmail":"clickHandler"},clickHandler:function(e){return"editEmail"===e.target.className?this.updateEmail():this.resendEmail(),!1},onActionSaved:function(t,n,i){i===P.CONST.PUBSUB_MESSAGE_USER_EMAIL_UPDATED?this.resendEmail():e.prototype.onActionSaved.apply(this,arguments)},updateEmail:function(){var e="email_verification"===this.extraData.type,t=this;this.showLoading();var n={name:"UserEditEmail",options:{sendVerifyEmail:e},resource:{name:"UserSettingsResource"}};P.loadModule(n,function(e){t.hideLoading(),t.showInModal(e)})},resendEmail:function(){var e=function(e){var t;e.error&&(t=e.error),t="success"===e.status?P.string("resendConfirmationEmailSuccess"):"nothingtodo"===e.status?P.string("resendConfirmationEmailNoOp"):e.message,P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_USER_UPDATED,t)},t=function(e){P.log(e)};return this.resourceCall("/verify_email/resend/","post",{success:e,error:t}),!1}})}),P.Module.define("NagPolicy",["NagBase"],function(e){return e.extend({events:{"click .policy":"clickHandler"},clickHandler:function(){var e=this,t={name:"ConfirmDialog",options:{template:"pin_policy"}};return P.loadModule(t,function(t){e.showInModal(t),e.listen(t,P.CONST.EVENT_CONFIRM,function(){e.savePolicyConfirmation()})}),!1},onActionSaved:function(){e.prototype.onActionSaved.apply(this,arguments);var t=this;setTimeout(function(){t.parent.render()},2e3)},savePolicyConfirmation:function(){var e=function(e){"success"===e.status?P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_USER_UPDATED,"Thanks for confirming!"):P.log(e)},t=function(e){P.log(e)};this.resourceCall("/confirm_guidelines/","post",{success:e,error:t})}})}),P.Module.define("NagSearch",[],function(){return P.Module.extend({events:{}})}),P.Module.define("NagSecurity",["NagBase"],function(e){return e.extend({events:{"click .resetPassword":"clickHandler"},clickHandler:function(){var e="/password/reset/";return P.changeWindowLocation(e),!1}})}),P.Module.define("NagUnauth",["NagBase"],function(e){return e.extend({events:{},onContentReady:function(){var e=this;this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onNavigateButtonClick),P.e.duf&&P.FBEnsureInit(function(){P.FB.getLoginStatus(function(t){("connected"===t.status||"not_authorized"===t.status)&&e.$(".facepileWrapper").removeClass("hidden")})})},onNavigateButtonClick:function(e){var t=e.target;"join"===t.id&&P.trackRegisterAction("register_from_nag")}})}),P.Module.define("Nags",[],function(){return P.Module.extend({events:{}})}),P.Module.define("NavigateButton",["Button"],function(e){return e.extend({getNavigateUrl:function(){return this.options.url},onClick:function(t){this.options.ga_category&&P.trackGAEvent(this.options.ga_category,P.CONST.GA_ACTION_CLICK),t.stopPropagation(),t.preventDefault();var n=this.getNavigateUrl();e.prototype.onClick.call(this),this.options.safe_link?P.SafeLink.open(n,this.options.safe_link_pin_id):this.navigate(n,null,this.options.force_refresh)}})}),P.Module.define("NewPinsIndicator",[],function(){return P.Module.extend({events:{click:"onClick"},render:function(e){var t=P.string("oneNewPin");this.options.count&&(1!==this.options.count&&(t=this.options.count+" "+P.string("newPins")),this.$el.text(t),this.$el.append('<em class="arrows"></em>')),P.e.npsb&&this.$el.addClass("biggie"),this.onContentReady(),this.onRendered(),e&&e()},onClick:function(){this.triggerEvent("click",null,!0)}})}),P.Module.define("NotificationItems",[],function(){return P.Module.extend({events:{}})}),P.Module.define("NotificationSettings",[],function(){return P.Module.extend({events:{},onContentReady:function(){this.$form=this.$("form");var e=new P.Form(this.$form);this.listen(e,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(){var e=this;this.$form.serializeArray();var t={},n={};this.$(".pushNotifSettings input[type=checkbox]").each(function(){var e=$(this),t=e.attr("name");n[t.substr(5)]=e.is(":checked")?"anyone":"none"}),t.push_settings=JSON.stringify(n),t.filter_settings=this.$("input[name=filter_settings]:checked").val();var i=new P.Resource("NotificationSettingsResource",t);return this.showLoading(!0),i.call("update",{complete:function(){e.hideLoading()},success:function(){e.destroy()}}),!1}})}),P.Module.define("Notifications",[],function(){var e="data-actor-id",t=300;return P.Module.extend({events:{"mouseover .notifMessage a":"onActorMouseover","click .notifItem":"onNotificationClick","click .notifSettings":"onSettingsClick"},mixins:[P.Mixins.PreventScroll],initialize:function(){_.bindAll(this,"onNotificationsScroll"),this.onNotificationsScroll=_.throttle(this.onNotificationsScroll,200)},onContentReady:function(){this.scrollableElement=this.$(".notifContent"),this._scrollListener=this.listen(this.scrollableElement,"scroll",this.onNotificationsScroll),this.startPreventScroll(this.scrollableElement,this.$(".NotificationItems")),this.listen(this.parent,P.CONST.EVENT_DROPDOWN_HIDE,this.onHide)},onHide:function(){this.$(".unseen").removeClass("unseen")},onSettingsClick:function(){var e=this,t={name:"NotificationSettings",resource:{name:"NotificationSettingsResource",options:{}}};return P.loadModule(t,function(t){e.showInModal(t)}),!1},onActorMouseover:function(t){var n=$(t.target);n.attr(e),this.setActiveUser(n.attr(e),n.parents(".notifItem"))},onNotificationClick:function(e){var t=$(e.target),n=$(e.currentTarget),i=n.attr("data-url");return t.is("a")?!0:(i&&this.navigate(i),void 0)},onNotificationsScroll:function(){if(!this.rendering){var e=this.$(".NotificationItems"),n=e.height()+e.position().top-this.scrollableElement.height();return n<=t&&this.fetchMore(),!1}},fetchMore:function(){if(!this.rendering){if(this.resource.atEnd())return this.removeListener(this._scrollListener),void 0;var e=this;this.rendering=!0,this.getChildById("items").renderAppend(function(){e.rendering=!1})}},setActiveUser:function(t,n){n.find(".actorImage, .notifComment").each(function(){var n=$(this);n.toggleClass("active",n.attr(e)===t)})}})}),P.Module.define("NotificationsButton",["DropdownButton"],function(e){return e.extend({getDropdownModule:function(){return this.getNotificationsModule()},getNotificationsModule:function(){var e=Math.max(this.unseenCount||10,20);return{name:"Notifications",resource:{name:"NotificationsResource",options:{count:e}}}},onContentReady:function(){e.prototype.onContentReady.call(this),this.data&&this.setBadge(this.data),this.childListen(P.CONST.EVENT_DROPDOWN_HIDE,this.onDropdownHide),this.childListen(P.CONST.EVENT_DROPDOWN_SHOW,this.onDropdownShow),this.listen(P.Updater.instance(),"notifications_count",function(e){this.setBadge(e)})},onDropdownHide:function(){if(this.shouldClearDropdown){var e=this.getDropdown();e&&e.empty()}this.shouldClearDropdown=!1,this.setActiveStyle(!1)},onDropdownShow:function(){this.setBadge(0)},setBadge:function(e){if(!this.$badge){this.$badge=$('<div class="badge"></div>');var t=this.getChildByModuleName("Button");t.$el.append(this.$badge)}e&&(this.$badge.text(e),this.clearDropdown()),this.unseenCount=e,this.$el.toggleClass("hasCount",!!e)},clearDropdown:function(){var e=this.getDropdown();e&&(e.isVisible()?this.shouldClearDropdown=!0:e.empty())}})}),P.Module.define("OffsitePage",[],function(){return P.Module.extend({events:{},onContentReady:function(){if(!P.SafeLink.validateToken(this.options.token))return P.showError(P.string("offsiteInvalidToken")),void 0;var e=this.options.url,t=this.options.pin_id;P.SafeLink.checkLink(e,{pin_id:t,proceed:function(e){window.location.replace(e.url)},cancel:function(){window.close()}})}})}),P.Module.define("PaddedPin",[],function(){return P.Module.extend({})}),P.Module.define("PagedGrid",[],function(){var e=9,t="hide";return P.Module.extend({initialize:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onMoreItemsClick)},onAddedToDom:function(){this.contentReady&&this._setUpGrid()},onContentReady:function(){this.inDom&&this._setUpGrid()},prependChildItem:function(e){var t=this.getChildById("grid");t.prependChildItem(e)},onMoreItemsClick:function(e){var t=e.target;t&&"moreItems"===t.id&&(e.stopPropagation(),this.requestMore())},_setUpGrid:function(){var n=this.getChildById("grid"),i=this.options.ajax_page_size||e;n.setPageSize(i),n.hasMoreItems()||this.$(".moreItems").addClass(t),this.childListen(P.CONST.EVENT_CONTENT_CHANGED,this.onChildContentChanged),this.childListen(P.CONST.EVENT_ERROR,this.onChildError)},hasItems:function(){var e=this.getChildById("grid");return e.hasItems()},requestMore:function(){if(this.contentReady){var e=this.getChildById("moreItems");e.showLoading();var t=this.getChildById("grid");t.requestMoreItems()}},onChildContentChanged:function(){var e=this.getChildById("moreItems");if(e){if(this.gridHasError)return e.hide(),this.gridHasError=!1,void 0;var t=this.getChildById("grid");t.hasMoreItems()?(e.show(),e.hideLoading()):e.destroy()}},onChildError:function(e){P.log("Child error!",e),e.target===this.getChildById("grid")&&(this.gridHasError=!0)}})}),P.Module.define("PasswordResetOneClick",[],function(){return P.Module.extend({initialize:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onResetPassword)},onSuccess:function(){this.$(".message").hide(),this.$(".successMessage").show()},onResetPassword:function(){var e={username_or_email:this.options.username_or_email},t=new P.Resource("UserResetPasswordResource",e),n=this.getChildById("resetPasswordButton");n.showLoading(),t.call("create",{success:this.onSuccess,complete:function(){n.hideLoading()}})}})}),P.Module.define("Pillow",[],function(){return P.Module.extend({events:{}})}),P.Module.define("Pin",[],function(){var e="PaddedPin",t="editButton",n="visible",i={DETAILED:"detailed",SUMMARY:"summary"};return P.Module.extend({events:{mouseleave:"onPinMouseout","mouseenter .pinImageSourceWrapper":"onMouseEnter"},onPinMouseout:function(){var e=this.getChildById("sendPinButton");if(e){var t=e.getDropdown();t&&t.isVisible()&&this.toggleRepinLikeWrapper(!0)}},toggleRepinLikeWrapper:function(e){this.$(".repinLikeWrapper").toggleClass("visible",e)},onButtonClick:function(e){"expandGiraffe"===e.target.options.class_name&&(this.onExpandGiraffeClick(e),e.target.$el.remove())},onExpandGiraffeClick:function(){this.$(".pinImageWrapper").removeClass("collapsed"),this.triggerEvent(P.CONST.EVENT_DIMS_CHANGED,null,!0)},showEditModal:function(){var n;return n=this.options.view_type===i.DETAILED?this.getChildByModuleName(e).getEditButton():this.getChildById(t),n?(n.showModal(),!0):!1},getPinMedia:function(){var e=this._getViewType();switch(e){case"detailed":return this.data.embed&&this.data.embed.src?this.$("iframe"):this.$(".PaddedPin img.pinImage");case"boardPinsGrid":return this.$("img");case"summary":return this.$(".pinHolder .pinImg");default:return this.log.error("requesting pin media for unsupported view_type:"+e),null}},getPinId:function(){return this.resource.get("id")},isEmbed:function(){return this.data.embed&&this.data.embed.src},getDetailedImageDimensions:function(){var e={width:600,height:300},t={youtube:e,vimeo:e,soundcloud:{width:553,height:166}};if(this.data.is_playable&&(this.data.is_video||this.data.attribution&&this.data.attribution.embed)){if(this.data.attribution){var n=t[this.data.attribution.provider_name];if(n)return n}if(this.data.embed)return this.data.embed}return this.data.images["736x"]},_getViewType:function(){return this.options.view_type?this.options.view_type:i.SUMMARY},onContentReady:function(){var e=this,t=this.options.pin_id;if(t){var n={};n[P.CONST.PUBSUB_TOPIC_PIN_COMMENT_CREATED]=this.onPinCommentCreated,n[P.CONST.PUBSUB_TOPIC_PIN_DELETED]=this.onPinDeleted,n[P.CONST.PUBSUB_TOPIC_PIN_LIKED]=this.onPinLiked,n[P.CONST.PUBSUB_TOPIC_PIN_UNLIKED]=this.onPinUnliked,n[P.CONST.PUBSUB_TOPIC_PIN_UPDATED]=this.onPinUpdated,this.pubsubSubscribe(t,n)}if(this.listen(this,P.CONST.EVENT_NAVIGATE,this.onNavigate),this.childListen(P.CONST.EVENT_NAVIGATE,this.onNavigate),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(P.CONST.EVENT_DROPDOWN_SHOW,this.onDropdownShow),this.childListen(P.CONST.EVENT_DROPDOWN_HIDE,this.onDropdownHide),this.childListen(P.CONST.EVENT_LAZY_IMAGE_COMPLETE,this.onImageLoaded),!this._hoverIntent){var i=this.$(".pinImageSourceWrapper");this._hoverIntent=new P.HoverIntent(i,{exitDelay:200})}this.listen(this._hoverIntent,P.CONST.EVENT_HOVERINTENT_OUT_COMPLETE,function(){e.onMouseOutComplete()})},onDropdownShow:function(){this.toggleRepinLikeWrapper(!0)},onDropdownHide:function(){this.toggleRepinLikeWrapper(!1)},onImageLoaded:function(e){e.stopPropagation();var t=this.$(".fadeContainer");if(t.length>0){var n=P.Viewport.isOverlapping(t,0);P.deferDomManipulation(function(){t.addClass("loaded"),n&&t.addClass("fade")})}},onNavigate:function(e){if(this.options.view_type===i.DETAILED&&P.isOffsiteUrl(e.data.url)){e.stopPropagation();var t=this.options.pin_id,n=e.data.url;P.SafeLink.open(n,t)}},onPinCommentCreated:function(){this.getChildById("commentList")||this.render()},onPinLiked:function(){this.triggerEvent(P.CONST.EVENT_PIN_LIKED,null,!0);var e=this.getChildById("likeButton");e&&e.setState(!0)},onPinUnliked:function(){this.triggerEvent(P.CONST.EVENT_PIN_UNLIKED,null,!0);var e=this.getChildById("likeButton");e&&e.setState(!1)},onPinUpdated:function(e,t,n){this.triggerEvent(P.CONST.EVENT_PIN_UPDATED,n,!0),this.render()},onPinDeleted:function(){this.destroy()},getEditButton:function(){return this.getChildById(t)},onMouseEnter:function(){var e=this.$(".sourceFlagWrapper");this.$sourceFlagWrapper||(this.$sourceFlagWrapper=e),this.$sourceFlagWrapper.addClass(n)},onMouseOutComplete:function(){this.$sourceFlagWrapper&&this.$sourceFlagWrapper.removeClass(n)}})}),P.Module.define("PinActionBar",[],function(){var e="leftRounded",t="likesButton",n="repinsButton",i="pinItButton";return P.Module.extend({events:{},onContentReady:function(){var e=this.options.pin_id;if(e){var t={};t[P.CONST.PUBSUB_TOPIC_PIN_LIKED]=this.onPinLiked,t[P.CONST.PUBSUB_TOPIC_PIN_UNLIKED]=this.onPinUnliked,this.pubsubSubscribe(e,t)}var n={};n[P.CONST.PUBSUB_TOPIC_PIN_CREATED]=this.onPinRepinned,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,n),this.childListen(P.CONST.EVENT_INCREMENT_BUTTON_DESTROY,this.onCloseupIncrementButtonHide),this.childListen(P.CONST.EVENT_INCREMENT_BUTTON_CREATE,this.onCloseupIncrementButtonShow)},removeDropdowns:function(){var e=this.getDropdowns();_.each(e,function(e){e.hide()})},getDropdowns:function(){var e=this.getChildrenByModuleName("DropdownButton"),t=[];return _.map(e,function(e){var n=e.getDropdown();t.push(n)}),t},showRepinModal:function(){var e=this.getChildById(i);e.showModal()},getLoadingSpinnerOptions:function(){return null},onPinRepinned:function(e,t,i){var o=this.getChildById(n);i.board&&"secret"!==i.board.privacy&&o&&o.increment()},onPinLiked:function(){var e=this.getChildById(t);e&&e.increment()},onPinUnliked:function(){var e=this.getChildById(t);e&&e.decrement()},onCloseupIncrementButtonHide:function(t){var n=t.data,i=this.getChildById(n);i.$el.removeClass(e)},onCloseupIncrementButtonShow:function(t){var n=t.data,i=this.getChildById(n);i.$el.addClass(e)},setDropdownsFixed:function(e){var t=this.getDropdowns();_.each(t,function(t){var n=_.clone(t.options);n.fixed=e,t.setOptions(n),t.positionModule()})},updateSticky:function(e){this._sticky||(this._sticky=new P.Sticky(this.$el,e),this.listen(this._sticky,P.CONST.EVENT_STICKY_FIXED,function(e){this.setDropdownsFixed(e)}))},unsticky:function(){this._sticky&&this._sticky.unSticky()}})}),P.Module.define("PinBookmarklet",[],function(){return P.Module.extend({events:{},initialize:function(){this.childListen(P.CONST.EVENT_NAVIGATE,this.onChildNavigate)},onContentReady:function(){this.resizeWindowToFit()},onChildRemoved:function(){this.children.length?this.resizeWindowToFit():window.close()},onChildNavigate:function(e){var t=!0;P.changeWindowLocation(e.data.url,t),window.close()},resizeWindowToFit:function(){var e=this.$el.outerHeight(!0),t=75,n=window.outerHeight;n&&(t=n-$(window).height());var i=e+t,o=this.$el.outerWidth(!0),r=o+P.scrollbarWidth()+20;window.resizeTo(r,i)}})}),P.Module.define("PinCloseupSettings",[],function(){return P.Module.extend({events:{}})}),P.Module.define("PinCloseupShare",[],function(){return P.Module.extend({events:{}})}),P.Module.define("PinComment",[],function(){return P.Module.extend({initialize:function(){this.childListen("commentDeleteSuccess",this.onPinCommentDelete)},onPinCommentDelete:function(){var e=this;this.$el.slideUp(300,function(){e.destroy()})}})}),P.Module.define("PinCommentList",[],function(){return P.Module.extend({events:{"click .showAll":"onShowAll","focus .content":"onFocusCommentInput","click .addComment":"addComment","mousedown .content":"onTextAreaMouseDown","keydown .content":"onTextAreaPossiblyResized","mouseup .content":"onTextAreaPossiblyResized"},initialize:function(){this.commentContentHeight=null},addComment:function(){P.trackGAEvent("comment_create",P.CONST.GA_ACTION_CLICK_SUBMIT);var e=this.getChildById("pinCommentField").getValue(),t=this.options.pin_id,n=new P.Resource("PinCommentResource",{pin_id:t,text:e}),i=this.getChildById("addCommentButton");i.showLoading(),n.call("create",{success:function(){P.trackGAEvent("comment_create",P.CONST.GA_ACTION_SUCCESS),P.pubsub.publish(t,P.CONST.PUBSUB_TOPIC_PIN_COMMENT_CREATED)},complete:function(){i.hideLoading()}})},onContentReady:function(){var e=this.options.pin_id;if(e){var t={};t[P.CONST.PUBSUB_TOPIC_PIN_COMMENT_CREATED]=this.onPinCommentCreated,this.pubsubSubscribe(e,t)}},onPinCommentCreated:function(){this.options.count++,this.render()},onShowAll:function(e){e.stopPropagation(),e.preventDefault();var t=this.options.count;this.options.max_num_to_show=t,this.render()},onFocusCommentInput:function(){var e=this.$el.find(".addComment");this.options.type&&"closeup"===this.options.type?e.css("display","block"):e.show(),this.triggerEvent(P.CONST.EVENT_DIMS_CHANGED,null,!0)},onTextAreaMouseDown:function(){this.commentContentHeight=this.$(".content").height()},onTextAreaPossiblyResized:function(){if(null!==this.commentContentHeight){var e=this.$(".content").height();this.commentContentHeight!==e&&(this.triggerEvent(P.CONST.EVENT_DIMS_CHANGED,null,!0),this.commentContentHeight=e)}}})}),P.Module.define("PinCreate",[],function(){var e=P.Module.extend({initialize:function(){_.bindAll(this,"onPinCreateSuccess")},onButtonClick:function(e){var t=e.target;switch(t.id){case"submitButton":P.trackGAEvent(this.GACategory,P.CONST.GA_ACTION_CLICK_SUBMIT);break;case"cancelButton":P.trackGAEvent(this.GACategory,P.CONST.GA_ACTION_CLICK_CANCEL),this.modal||this.destroy()}},onContentReady:function(){this.GACategory=this.isRepin()?"repin_create":"pin_create",this.pinForm=this.getChildById("pinForm"),this.listen(this.pinForm,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this.boardPicker=this.pinForm.getChildById("boardPicker");var e=this.pinForm.form;if(this.listen(this.boardPicker,P.CONST.EVENT_BOARD_SELECTED,_.bind(e.enableSubmitButtons,e)),this.boardPicker.getSelectedBoardId()||e.disableSubmitButtons(),this.isFR()){var t={};t[P.CONST.PUBSUB_TOPIC_SOCIAL_NETWORK_UPDATED]=this.onSocialNetworkChange,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,t)}},onSubmitValidated:function(e){var t=e.data;t.errors[0]||this.createPin()},isRepin:function(){return!(!this.data||!this.data.id)},getPinResource:function(){var e="PinResource",t=_.extend(this.pinForm.getData(),_.pick(this.options,"method","is_video"));return this.isRepin()&&(e="RepinResource",t.pin_id=this.data.id),new P.Resource(e,t)},createPin:function(){this.showLoading(!0);var e=this,t=this.getPinResource();t.call("create",{success:P.stopwatch.wrapContinuation("PinCreate.createPin success",this.onPinCreateSuccess),error:P.stopwatch.wrapContinuation("PinCreate.createPin error",function(t){if(P.trackGAEvent(this.GACategory,P.CONST.GA_ACTION_ERROR),"create"===e.options.action&&401===t.http_status){var n={name:"ConfirmDialog",options:{fluid:!0,template:"blocked_source"}};P.loadModule(n,function(t){t.render(function(){e.parent.appendChild(t),e.destroy()})})}else P.showError(t.message)}),complete:P.stopwatch.wrapContinuation("PinCreate.createPin complete",function(){e.hideLoading()})})},onPinCreateSuccess:function(e){P.trackGAEvent(this.GACategory,P.CONST.GA_ACTION_SUCCESS);var t=this,n=e.resource_response.data,i=n.board,o=i.url,r=this.options.action,s=i.name,a=i.privacy,l=i.is_collaborative,u={id:"pinSuccess",name:"PinCreateSuccess",options:{action:r,board:s,board_url:o,pin_id:n.id,is_collaborative:l,privacy:a},resource:P.Resource.NOOP_RESOURCE};this.showLoading(),P.loadModule(u,P.stopwatch.wrapContinuation("onPinCreateSuccess",function(e){var n=t.modal;n?n.setModule(e):e.render(function(){t.parent.appendChild(e),t.destroy()})})),this.triggerEvent(P.CONST.EVENT_PIN_CREATE,n),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_PIN_CREATED,n),P.pubsub.publish(n.board.id,P.CONST.PUBSUB_TOPIC_PIN_CREATED,n)},loadFromData:function(e,t){var n=this.getChildById("pinForm");e.id&&(this.data={id:e.id},n.loadAndInsertPinDupWarning(e.id)),e.description&&this.$('[name="description"]').val(e.description);var i=e.images["236x"];if(i||e.is_video){var o=n.getChildById("pinPreview");i&&(o.options.image_url=i.url),o.options.is_video=e.is_video||!1,o.render()}var r=n.getChildById("boardPicker");r.loading=!0,r.render(t||void 0)},isFR:function(){return P.e.fr&&this.options.is_template_module},onSocialNetworkChange:function(){if(this.isFR()){var e={name:"PinCreate",options:{action:"repin",is_template_module:!0}};P.loadModule(e,function(e){e.render(function(){var t=P.TemplateModuleLoader.instance();t.registerTemplateModule(e)})})}}});return P.stopwatch.wrapMethods(e.prototype,"PinCreate",["createPin","onPinCreateSuccess"]),e}),P.Module.define("PinCreate2",[],function(){var e=P.Module.extend({events:{},initialize:function(){_.bindAll(this,"onPinCreateSuccess")},onContentReady:function(){this.GACategory=this.isRepin()?"repin_create":"pin_create",this.boardPicker=this.getChildById("boardPicker2"),this.childListen(P.CONST.EVENT_BOARD_SELECTED,this.onBoardSelected)
},onBoardSelected:function(){this.createPin()},isRepin:function(){return!(!this.data||!this.data.id)},getPinResource:function(){var e="PinResource",t={};return this.extraData&&(t.description=this.extraData.description,t.link=this.extraData.link,t.is_video=this.extraData.isVideo,t.image_url=this.extraData.imageUrl),t=_.extend(t,_.pick(this.options,"method")),this.isRepin()&&(e="RepinResource",t.pin_id=this.data.id),new P.Resource(e,t)},createPin:function(e){this.showLoading(!1);var t=this,n=this.getPinResource();(e||(e=this.boardPicker.getSelectedBoardId()))&&(n.options.board_id=e,n.call("create",{success:P.stopwatch.wrapContinuation("PinCreate2.createPin success",this.onPinCreateSuccess),error:P.stopwatch.wrapContinuation("PinCreate2.createPin error",function(e){if(P.trackGAEvent(this.GACategory,P.CONST.GA_ACTION_ERROR),"create"===t.options.action&&401===e.http_status){var n={name:"ConfirmDialog",options:{fluid:!0,template:"blocked_source"}};P.loadModule(n,function(e){e.render(function(){t.parent.appendChild(e),t.destroy()})})}else P.showError(e.message)}),complete:P.stopwatch.wrapContinuation("PinCreate.createPin complete",function(){t.hideLoading()})}))},onPinCreateSuccess:function(e){P.trackGAEvent(this.GACategory,P.CONST.GA_ACTION_SUCCESS);var t=this,n=e.resource_response.data,i=n.board,o=i.url,r=this.options.action,s=i.name,a=i.privacy,l=i.is_collaborative,u={id:"pinSuccess",name:"PinCreateSuccess",options:{action:r,board:s,board_url:o,pin_id:n.id,is_collaborative:l,privacy:a},resource:P.Resource.NOOP_RESOURCE};P.loadModule(u,P.stopwatch.wrapContinuation("onPinCreateSuccess",function(e){var n=t.modal;n?(n.setTransparentContent(!1),n.setModule(e)):e.render(function(){t.parent.appendChild(e),t.destroy()})})),this.triggerEvent(P.CONST.EVENT_PIN_CREATE,n),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_PIN_CREATED,n),P.pubsub.publish(n.board.id,P.CONST.PUBSUB_TOPIC_PIN_CREATED,n)}});return P.stopwatch.wrapMethods(e.prototype,"PinCreate2",["createPin","onPinCreateSuccess"]),e}),P.Module.define("PinCreateSuccess",[],function(){var e=2e3,t=1e4,n=1e3;return P.Module.extend({onContentReady:function(){var n=e,i=!1,o=this.getChildById("successBoard");if(o&&o.hasBoard()){n=t,i=!0;var r={};r[P.CONST.PUBSUB_TOPIC_USER_FOLLOW]=this.onBoardFollow,this.pubsubSubscribe(o.getBoardId(),r)}i||this.$el.addClass("noBody"),this.closeOnDelay(n)},closeOnDelay:function(e){this.closeTimer&&clearTimeout(this.closeTimer);var t=this;this.closeTimer=setTimeout(function(){t.closeTimer=null,t.destroy()},e)},onBoardFollow:function(){this.closeOnDelay(n)}})}),P.Module.define("PinCreateSuccessBoard",[],function(){return P.Module.extend({onContentReady:function(){this.hasBoard||this.hide()},hasBoard:function(){return!!this.getChildById("board")},getBoardId:function(){return this.extraData.boardId}})}),P.Module.define("PinDeleteCommentButton",["InlineHoverButton"],function(e){return e.extend({events:{click:"onClick"},showConfirmation:function(){var e=this,t={name:"ConfirmDialog",options:{template:"delete_comment"}};P.loadModule(t,function(t){e.showInModal(t),e.listen(t,P.CONST.EVENT_CONFIRM,e.onDeleteConfirm)})},onDeleteConfirm:function(){P.trackGAEvent("comment_delete",P.CONST.GA_ACTION_CLICK_SUBMIT);var e={pin_id:this.options.pin_id,comment_id:this.options.comment_id},t=new P.Resource("PinCommentResource",e),n=this;t.call("delete",{success:function(){P.trackGAEvent("comment_delete",P.CONST.GA_ACTION_SUCCESS),n.triggerEvent("commentDeleteSuccess",this,!0)},error:function(){P.trackGAEvent("comment_delete",P.CONST.GA_ACTION_ERROR)}})},onClick:function(){P.trackGAEvent("comment_delete",P.CONST.GA_ACTION_OPEN_MODAL),this.showConfirmation()}})}),P.Module.define("PinDupWarning",[],function(){return P.Module.extend({events:{}})}),P.Module.define("PinEdit",[],function(){var e="pin_delete",t="pin_edit";return P.Module.extend({onContentReady:function(){this.pinForm=this.getChildById("pinForm"),this.boardPicker=this.pinForm.getBoardPicker(),this.listen(this.pinForm,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function(n){var i=n.target;switch(i.id){case"submitButton":P.trackGAEvent(t,P.CONST.GA_ACTION_CLICK_SUBMIT);break;case"cancelButton":P.trackGAEvent(t,P.CONST.GA_ACTION_CLICK_CANCEL);break;case"deleteButton":P.trackGAEvent(e,P.CONST.GA_ACTION_OPEN_MODAL),this.showConfirmation()}},onDeleteConfirm:function(){P.trackGAEvent(e,P.CONST.GA_ACTION_CLICK_SUBMIT),this.deletePin()},onSubmitValidated:function(e){var t=e.data;t.errors[0]||(this.needConfirm()?this.showPrivacyChangeConfirmation():this.savePin())},showConfirmation:function(){var t=this,n={name:"ConfirmDialog",options:{template:"delete_pin",ga_category:e}};P.loadModule(n,function(e){t.showInModal(e),t.listen(e,P.CONST.EVENT_CONFIRM,t.onDeleteConfirm)})},showPrivacyChangeConfirmation:function(){var e=this,n={name:"ConfirmDialog",options:{template:"change_pin_privacy"}};P.loadModule(n,function(n){e.showInModal(n),e.listen(n,P.CONST.EVENT_CONFIRM,function(){P.trackGAEvent(t,P.CONST.GA_ACTION_CLICK_CONFIRM),e.savePin()})})},needConfirm:function(){var e=this.boardPicker.getPrivacy();return"secret"===this.data.board.privacy&&"public"===e},savePin:function(){var e=this,n=this.data.id,i=this.pinForm.getData();i.id=n;var o=new P.Resource("PinResource",i),r=function(e){P.trackGAEvent(t,P.CONST.GA_ACTION_ERROR),P.showError(e.message)},s=function(i){if(P.trackGAEvent(t,P.CONST.GA_ACTION_SUCCESS),i){var o=i.resource_response;if(o&&!o.error){if(e.isInModal())P.pubsub.publish(n,P.CONST.PUBSUB_TOPIC_PIN_UPDATED,o.data),e.destroy();else{var s="/pin/"+n+"/";e.navigate(s)}return}}r()};this.showLoading(!0),o.call("update",{success:s,error:r,complete:function(){e.hideLoading()}})},deletePin:function(){var t=this.data.id,n=this,i={id:t},o=new P.Resource("PinResource",i),r=function(t){P.trackGAEvent(e,P.CONST.GA_ACTION_ERROR),P.showError(t.message)},s=function(i){if(P.trackGAEvent(e,P.CONST.GA_ACTION_SUCCESS),i){var o=i.resource_response;if(o&&!o.error){if(n.isInModal())P.pubsub.publish(t,P.CONST.PUBSUB_TOPIC_PIN_DELETED),n.destroy();else{var s=n.data.board.url;n.navigate(s)}return}}r(i)};this.showLoading(!0),o.call("delete",{success:s,error:r,complete:function(){n.hideLoading()}})}})}),P.Module.define("PinEmail",[],function(){return P.Module.extend({events:{},onContentReady:function(){var e={pin:[P.Validator.Required()],email:[P.Validator.Required(),P.Validator.Email()],recipient_name:[P.Validator.Required()]};this.formListener&&this.removeListener(this.formListener),this.form=new P.Form(this.$("form"),e),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function(e){var t=e.target;t&&("submitButton"===t.id?P.trackGAEvent("pin_email",P.CONST.GA_ACTION_CLICK_SUBMIT):"cancelButton"===t.id&&P.trackGAEvent("pin_email",P.CONST.GA_ACTION_CLICK_CANCEL))},onSubmitValidated:function(e){e.errors[0]||this.sendEmail()},sendEmail:function(){var e=this.$("form").serializeArray(),t={},n=this.getChildById("submitButton"),i=this;_.each(e,function(e){t[e.name]=e.value}),n.showLoading();var o={name:"ConfirmDialog",options:{template:"email_pin",recipient_name:t.recipient_name}},r=new P.Resource("EmailPinResource",t);r.call("create",{success:function(){P.trackGAEvent("pin_email",P.CONST.GA_ACTION_SUCCESS),P.loadModule(o,function(e){i.showInModal(e),i.listen(e,P.CONST.EVENT_CONFIRM,i.destroy)})},error:function(e){P.trackGAEvent("pin_email",P.CONST.GA_ACTION_ERROR),P.showError(e.message)},complete:function(){n.hideLoading()}})}})}),P.Module.define("PinFlagCommentButton",["InlineHoverButton"],function(e){return e.extend({events:{click:"onClick"},showReasonModal:function(){var e=this,t={name:"FlagComment",options:{pin_id:this.options.pin_id,comment_id:this.options.comment_id}};P.loadModule(t,function(t){e.showInModal(t)})},onClick:function(){P.trackGAEvent("comment_flag",P.CONST.GA_ACTION_OPEN_MODAL),this.showReasonModal()}})}),P.Module.define("PinForm",["UserSocialNetworkSettings"],function(e){var t=P.SocialConnect.FACEBOOK,n=P.SocialConnect.TWITTER,i="secret",o=".socialShareWrapper";return e.extend({events:{'change [name="share_facebook"]':"onFacebookCheckboxChanged"},initialize:function(){this.networkToSelectorMap={},this.networkToSelectorMap[t]='[name="share_facebook"]',this.networkToSelectorMap[n]='[name="share_twitter"]'},onFacebookCheckboxChanged:function(){var e=this.getNetworkChecked(P.SocialConnect.FACEBOOK);if(e){var t=this;P.FbUtil.maybeRequestFbTimelinePermission({error:function(){t.setNetworkChecked(P.SocialConnect.FACEBOOK,!e)}})}},onContentReady:function(){var e={description:[P.Validator.Required(),P.Validator.Length({max:P.CONST.MAX_CHARS_FOR_BOARD_PIN_DESCRIPTION})]};this.form=new P.Form(this.$("form"),e),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(P.CONST.EVENT_BOARD_SELECTED,this.onBoardSelected),this._boardPicker=this.getBoardPicker(),this._boardPicker.getPrivacy()===i&&this.hideSocialExplicitSharing(),this.extraData.facebookTimelineEnabled&&P.e.epfftensp&&"done"!==Cookie.get("first_time_timeline_exp")&&(Cookie.set("first_time_timeline_exp","pre-checked"),this.setNetworkChecked(P.SocialConnect.FACEBOOK,!0));var t=this.getChildById("uploader");t&&this.listen(t,P.CONST.EVENT_UPLOAD_SUCCESS,this.onUploadSuccess)},onBoardSelected:function(e){e.data.privacy===i?this.hideSocialExplicitSharing():this.showSocialExplicitSharing()},hideSocialExplicitSharing:function(){this.$(o).hide()},showSocialExplicitSharing:function(){this.$(o).show()},onSubmitValidated:function(e){this.triggerEvent(P.CONST.EVENT_SUBMIT_VALIDATED,e,!0)},onUploadSuccess:function(e){var t=e.data.image_url,n=this.getChildById("pinPreview");n.setImage(t),this.options.image_url=t},getBoardPicker:function(){return this.getChildById("boardPicker")},getBoardId:function(){return this._boardPicker.getSelectedBoardId()},getDescription:function(){return this.getChildById("pinDescriptionField").getValue()},setNetworkChecked:function(e,t){var n=this.networkToSelectorMap[e];n&&this.$(n).attr("checked",t)},getNetworkChecked:function(e){var t=this.networkToSelectorMap[e];if(t){var n=this.$(t);return n.length?n.is(":checked"):""}},getImageUrl:function(){return this.options.image_url},getLink:function(){return this.$("#pinFormLink").val()},getData:function(){this.extraData.facebookTimelineEnabled&&P.e.epfftensp&&"pre-checked"===Cookie.get("first_time_timeline_exp")&&Cookie.set("first_time_timeline_exp","done");var e={board_id:this.getBoardId(),description:this.getDescription(),link:this.getLink()},t=this.getNetworkChecked(P.SocialConnect.TWITTER);""!==t&&(e.share_twitter=t),t=this.getNetworkChecked(P.SocialConnect.FACEBOOK),""!==t&&(e.share_facebook=t);var n=this.getImageUrl();return n&&(e.image_url=n),e},loadAndInsertPinDupWarning:function(e){var t={name:"PinDupWarning",resource:{name:"PinResource",options:{id:e,field_set_key:"faster_repin"}}},n=this;P.loadModule(t,function(e){e.render(function(){e.getElement().insertAfter(n.$(".pinFormHeader"))})})}})}),P.Module.define("PinLikeButton",["Button"],function(e){var t="unlike";return e.extend({onClick:function(){this.ensureAuthentication()&&this.toggle()},setState:function(e){var n=this.$el;this.options.liked=e,e?(n.addClass(t),this.$(".buttonText").html(n.data("text-unlike"))):(n.removeClass(t),this.$(".buttonText").html(n.data("text-like")))},getPinLikeResource:function(){return new P.Resource("PinLikeResource",{pin_id:this.options.pin_id})},toggle:function(){var e,t,n;this.options.liked?(e="pin_unlike",t="delete",n=P.CONST.PUBSUB_TOPIC_PIN_UNLIKED):(e="pin_like",t="create",n=P.CONST.PUBSUB_TOPIC_PIN_LIKED),P.trackGAEvent(e,P.CONST.GA_ACTION_CLICK);var i=this,o=this.getPinLikeResource();this.showLoading(),o.call(t,{success:function(){P.trackGAEvent(e,P.CONST.GA_ACTION_SUCCESS),i.setState(!i.options.liked),P.pubsub.publish(i.options.pin_id,n)},complete:function(){i.hideLoading()}})}})}),P.Module.define("PinSend",["ui.TypeaheadField","UserSocialNetworkSettings"],function(e,t){var n="active",i="animate",o="hidden",r=2600;return t.extend({events:{"click .undoSendPin":"hideFakeSuccess"},onAddedToDom:function(){this._messageShowing=!1,this._hasQueriedTypeahead=!1},onContentReady:function(){var e={};e[P.CONST.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED]=this.onSearchQueryUpdated,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_SITE,e),this.$staticResults=this.$(".staticResults"),this.$message=this.$('input[name="message"]'),this.$beforeSend=this.$(".pinSendBeforeSend"),this.$afterSend=this.$(".pinSendAfterSend"),this.$pinSendMessageWrapper=this.$(".pinSendMessageWrapper"),this.$emailButtonWrapper=this.$(".emailButtonWrapper"),this.$facebookButtonWrapper=this.$(".facebookButtonWrapper"),this.$findFriend=this.$('input[name="sendPinFriendSearch"]'),this.typeaheadField=this.getChildById("sendPinField"),this.listen(this.parent,P.CONST.EVENT_DROPDOWN_SHOW,this.onEventDropdownShow),this.listen(this.parent,P.CONST.EVENT_DROPDOWN_HIDE,this.onHide),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(P.CONST.EVENT_ITEM_SELECTED,this.onChildItemSelected),this.childListen(P.CONST.EVENT_USER_CLICK,this.onUserClick),this.childListen(P.CONST.EVENT_TYPEAHEAD_RESULTS_RETURNED,this.onTypeaheadResultsReturned),this.childListen(P.CONST.EVENT_TYPEAHEAD_NO_RESULTS_RETURNED,this.onNoTypeaheadResultsReturned),this.$message.placeholder(),this.$findFriend.placeholder()},onEventDropdownShow:function(){this.focusFriendTypeahead()},onNoTypeaheadResultsReturned:function(){this.showStaticResults(),this.showSendEmailButton(),this.focusFriendTypeahead()},onTypeaheadResultsReturned:function(e){var t=e.data.count;this._hasQueriedTypeahead=!0,t?(this.showStaticResults(),this.showStaticSocialOptions()):this.showStaticSocialOptions()},hideFacebookConnectButton:function(){this.$facebookButtonWrapper.addClass(o)},showFacebookConnectButton:function(){this.$facebookButtonWrapper.removeClass(o)},hideSendEmailButton:function(){this.$emailButtonWrapper.addClass(o)},showSendEmailButton:function(){this.$emailButtonWrapper.removeClass(o)},hideStaticSocialOptions:function(){this.hideSendEmailButton(),this.hideFacebookConnectButton()},showStaticSocialOptions:function(){this.showSendEmailButton(),this.showFacebookConnectButton()},hideStaticResults:function(){this.$staticResults.addClass(o)},showStaticResults:function(){this.$staticResults.removeClass(o)},focusAddMessageField:function(){this.$message.focus()},focusFriendTypeahead:function(){this.$findFriend.focus()},onHide:function(){var e=this;this._timeout&&this.user&&(this.sendPin(),clearTimeout(e._timeout)),this.reset()},hideSendMessage:function(){this.$pinSendMessageWrapper.addClass(i)},showSendMessage:function(){this.$pinSendMessageWrapper.removeClass(i)},onShowMessageClick:function(e){return this.showSendMessage(),e.target.$el.addClass(o),this.focusAddMessageField(),!1},removeMessageContent:function(){this.$message.val("")},onUserClick:function(e){var t=e.target.data,n=e.target;t&&(this.user=t,t.image_medium_url||(this.user.image_medium_url=n.getProfileImage()),this.showSuccess())},onButtonClick:function(e){var t=this,n=e.target;if(n){var i=n.id;if("addMessage"===i)return this.onShowMessageClick(e),void 0;switch(i){case"connectGmail":break;case"connectYahoo":break;case"connectFacebook":this.handleConnect(P.SocialConnect.FACEBOOK,!0,{complete:function(){t.show()},success:function(){t.hideFacebookConnectButton(),t.focusFriendTypeahead()},error:function(){P.showError(P.string("connectError"))}})}}},showSuccess:function(){var e=this,t=this.user,o=t.full_name||t.first_name,s=t.image_medium_url||t.send_pin_image;this.$beforeSend.addClass(i),P.supportCSSTransitions()?setTimeout(function(){e.$afterSend.addClass(n)},400):this.$afterSend.addClass(n),this.$(".receiverName").text(o),this.$(".pinSendSuccessMug").attr("src",s),this._timeout=setTimeout(function(){e.triggerEvent(P.CONST.EVENT_DROPDOWN_HIDE,null,!0)},r)},reset:function(){this.hideFakeSuccess(),this.hideSendMessage(),this.setMessageValue(""),this.typeaheadField.clear(),this.typeaheadField.closeTypeahead(),this.getChildById("addMessage").$el.removeClass(o)},hideFakeSuccess:function(){var e=this;this.$beforeSend.removeClass(o+" "+i),this.$afterSend.removeClass(n+" "+i),clearTimeout(e._timeout),this._timeout=null},getMessageValue:function(){return $.trim(this.$(".message").val())},setMessageValue:function(e){return $.trim(this.$(".message").val(e))},sendPin:function(){var e=this,t=this.options.pin_id,n=this.user;if(n){var i=n.email,o=n.id,r=n.full_name;r||(r="");var s={pin:t,recipient_name:r},a=this.getMessageValue();a&&(s.message=a);var l;i?(s.email=i,l=new P.Resource("EmailPinResource",s)):(s.user_id=o,l=new P.Resource("SharePinResource",s)),clearTimeout(this._timeout),l.call("create",{success:function(){e.user=null},error:function(){P.showError(P.string("errorMessage"))}}),this.user=null}},showEmailModal:function(e){var t=this,n={name:"PinEmail",options:{pin_id:this.options.pin_id,pin_image:this.options.pin_image}};e&&(n.options.name=e.name);var i=this.getMessageValue();i&&(n.options.message=i),P.loadModule(n,function(e){t.showInModal(e)})},showTypeaheadResults:function(){var e=this.getChildByModuleName("ui.Typeahead");e.show()},onChildItemSelected:function(e){e.stopPropagation();var t=e.data.item.attributes;return"user"!==t.type?this.showEmailModal(t):(this.user=t,this.showSuccess(),!1)},onSearchQueryUpdated:function(e,t,n){var i=n||"";this.typeaheadField.setValue(i)}})}),P.Module.define("PinShareButton",[],function(){return P.Module.extend({events:{}})}),P.Module.define("PinUploader",[],function(){return P.Module.extend({events:{},onContentReady:function(){var e=this.getChildById("uploader");this.listen(e,P.CONST.EVENT_UPLOAD_SUCCESS,this.onUploadSuccess),this.listen(e,P.CONST.EVENT_UPLOAD_ERROR,this.onUploadError)},onUploadSuccess:function(e){P.trackGAEvent("pin_upload",P.CONST.GA_ACTION_SUCCESS),this.imageUrl=e.data.image_url,this.ensurePinCreate()},onUploadError:function(e){P.trackGAEvent("pin_upload",P.CONST.GA_ACTION_ERROR),P.showError(P.string(e.data))},ensurePinCreate:function(){var e=this,t={image_url:this.imageUrl,action:"upload",method:"uploaded",transparent_modal:P.e.nrf,show_preview:P.e.nrfsp,fast_repin:P.e.nrffr};this.options.default_board_id&&(t.default_board_id=this.options.default_board_id);var n=P.e.nrf?"PinCreate2":"PinCreate",i={name:n,options:t,id:"pinCreate"};this.showLoading(),P.loadModule(i,function(t){e.hideLoading(),e.showInModal(t),e.triggerEvent(P.CONST.EVENT_PIN_CREATE_OPENED,null,!0),e.destroy()})}})}),P.Module.define("Pinnable",[],function(){return P.Module.extend({events:{"click a.pinImageWrapper":"onClick"},initialize:function(){_.bindAll(this,"onImageLoad","onImageError")},onAdded:function(){this.updateImage()},onClick:function(){return this.createPin(),!1},createPin:function(){var e={image_url:this.options.url,action:"create",method:"scraped",link:this.options.link},t={name:"PinCreate",options:e,id:"pinCreate"},n=this;P.loadModule(t,function(e){n.showInModal(e)})},updateImage:function(){var e=this.$(".pinImageWrapper"),t=this.$img=$("<img>");t.on("load",this.onImageLoad),t.on("error",this.onImageError),t.attr("src",this.options.url),e.append(t)},onImageLoad:function(){return this.$img.width()<P.CONST.MIN_PINNABLE_IMAGE_WIDTH||this.$img.height()<P.CONST.MIN_PINNABLE_IMAGE_HEIGHT?(P.log("Too small!",this.$img.width(),this.$img.height()),this.destroy(),void 0):(this.$el.css("visibility","visible"),this.$img.addClass("pinnableImage"),this.triggerEvent("contentChanged",null,!0),void 0)},onImageError:function(){this.destroy()}})}),P.Module.define("PositionModule",[],function(){var e="positionModuleCaret",t=100,n=5,i=P.CONST.PositionPoint,o=P.CONST.PositionPointFlag,r={};return r[o.FLAG_HORIZONTAL_LEFT]="positionLeft",r[o.FLAG_HORIZONTAL_RIGHT]="positionRight",r[o.FLAG_VERTICAL_TOP]="positionTop",r[o.FLAG_VERTICAL_BOTTOM]="positionBottom",P.Module.extend({positionMode:P.CONST.PositionMode.ANCHORED,initialize:function(){var e=_.bind(this.positionModule,this);this.childListen(P.CONST.EVENT_CONTENT_CHANGED,e),this.listen(this,P.CONST.EVENT_DIMS_CHANGED,e),this.listen(this,P.CONST.EVENT_NAVIGATE,e),this.listen(P.Viewport,P.CONST.EVENT_RESIZE,e),this.listen(P.Viewport,P.CONST.EVENT_BODY_COLUMN_CHANGE,e)},getPositionMode:function(){return P.CONST.PositionMode[this.options.positionMode]||this.positionMode},onOptionsChanged:function(){this.updateFixed()},getPositionElement:function(){return this.$el},getPositionAnchor:function(){return this.options.anchor},getPositionPoint:function(){return i[this.options.position_point]||i.BOTTOM_LEFT},getPositionFixed:function(){return!!this.options.fixed},getPositionCaret:function(){return this.getCaret()},getCaret:function(){return this.$("."+e)},_getPositionType:function(){return this.getPositionFixed?"fixed":"absolute"},positionModuleAtAnchor:function(e,t){var n=this.getPositionElement();n.addClass("positionModuleElement"),n.toggleClass("positionFixed",this.getPositionFixed),_.each(r,function(e){n.removeClass(e)}),t=P.Positioning.positionElementAtAnchor(n,e,t,this.getPositionFixed(),this.options.force_in_viewport);var i=_.find(r,function(e,n){return t&n?!0:void 0});n.addClass(i),this.positionCaret(e,t)},positionCaret:function(t,i){var o=this.$("."+e);if(o.length){var r=P.CONST.PositionPointFlag,s=this.getPositionElement();s.addClass("bigCaret",!!this.options.largeCaret),s.addClass("defaultCaret",!this.options.largeCaret);var a="left",l="outerWidth",u="width";i&r.FLAG_HORIZONTAL&&(a="top",l="outerHeight",u="height");var c=0,d=i&(r.FLAG_HORIZONTAL_CENTER|r.FLAG_VERTICAL_CENTER),h=o[u]()>t[u]()-n;h&&!d&&(c=(o[u]()-t[u]())/2+n,(i&r.FLAG_VERTICAL_RIGHT||i&r.FLAG_HORIZONTAL_BOTTOM)&&(c=-c));var p=s.offset()[a],f=p+s[l](),m=t.offset()[a],g=m+t[l](),v=p;v<m&&(v=m);var _=f;_>g&&(_=g);var C=(v+_)/2-o[l]()/2+c,y={};if(y[a]=C,o.offset(y),c){var T=parseInt(s.css(a),10);s.css(a,T-c)}}},positionModule:function(){this.cleanPositionModuleElement(),this.getPositionMode()===P.CONST.PositionMode.ANCHORED?this.positionModuleAtAnchor(this.getPositionAnchor(),this.getPositionPoint()):this._positionAbsoluteCenter()},_positionAbsoluteCenter:function(){var e=this.getScrollableElement().outerHeight(),n=this.getContent().outerHeight(),i=(e-n)/2;this.getPositionElement().css({marginTop:Math.max(t,i)}),this.getContent().css({width:this.getModule().getWidth(!0)})},cleanPositionModuleElement:function(){var e=this.getPositionElement();e.removeClass("positionModuleElement"),e.css({top:"",left:"",margin:""})},updateFixed:function(){this.$el.toggleClass("positionModuleFixed",this.getPositionFixed())},renderContainer:function(){this.empty();var t=this.$el;if(t.addClass("PositionModule"),t.addClass(this.options.class_name),this.updateFixed(),this.options.view_type&&t.addClass(this.options.view_type),!this.options.hide_caret){var n=$('<span class="'+e+'"></span>');t.prepend(n)}},render:function(e){var t=_.bind(function(){this.onContentReady(),this.onRendered(),e&&e()},this);this.options.module?P.loadModule(this.options.module,_.bind(function(e){this.insertChild(e,this.getPositionElement()),e.render(t)},this)):t()}})}),P.Module.define("RecFeedHomePage",[],function(){return P.Module.extend({onContentReady:function(){var e=this.getChildById("grid"),t="none";e&&!e.hasItems()&&(e.remove(),t="block"),this.$(".noResults").css("display",t)}})}),P.Module.define("RecentContacts",[],function(){return P.Module.extend({events:{}})}),P.Module.define("RelatedInterests",[],function(){return P.Module.extend({events:{}})}),P.Module.define("RepinsLikesFeedPage",[],function(){return P.Module.extend({events:{}})}),P.Module.define("RichPinBase",[],function(){return P.Module.extend({events:{}})}),P.Module.define("RichPinDebugger",[],function(){var e="hidden",t="selected";return P.Module.extend({events:{"click .menu .main":"onShowMain","click .menu .scraped":"onShowScraped","click .menu .parsed":"onShowParsed"},onContentReady:function(){this.$form=this.$("form"),this.$main=this.$(".section.main"),this.$menus=this.$(".menu a"),this.$scraped=this.$(".section.scraped"),this.$sections=this.$(".section"),this.$parsed=this.$(".section.parsed"),this.form=new P.Form(this.$form),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.retrieve)},retrieve:function(){var e=this,t=this.$form.serializeArray(),n=t[0].value,i={link:n},o=this.getChildById("submitButton"),r=new P.Resource("RichPinReindexResource",i),s=function(t){var i=encodeURIComponent(n);if(t&&!t.resource_response.error&&t.resource_response.data){var o=t.resource_response.data;i=encodeURIComponent(o.url)}e.navigate("?link="+i)};o.showLoading(),r.call("create",{success:s,complete:function(){o.hideLoading()}})},onShowMain:function(n){return this.hideAllMenus(),this.$main.removeClass(e),$(n.target).addClass(t),!1},onShowParsed:function(n){return this.hideAllMenus(),this.$parsed.removeClass(e),$(n.target).addClass(t),!1},onShowScraped:function(n){return this.hideAllMenus(),this.$scraped.removeClass(e),$(n.target).addClass(t),!1},hideAllMenus:function(){this.$sections.addClass(e),this.$menus.removeClass(t)}})}),P.Module.define("RichPinDebuggerItem",[],function(){return P.Module.extend({events:{}})}),P.Module.define("RichPinHeading",[],function(){return P.Module.extend({events:{}})}),P.Module.define("ScrollToTop",[],function(){var e="visible",t=300,n=500,i=P.Module.extend({events:{"click button":"onScrollToTopClick"},$scroller:null,initialize:function(){this.visible=!1},setScroller:function(e){this.scrollListener&&(this.removeListener(this.scrollListener),this.scrollListener=null),this.$scroller=e,this.$scroller.length>0&&(this.updateButtonVisibility(),this.scrollListener=this.listen(this.$scroller,"scroll",this.updateButtonVisibility))},updateButtonVisibility:function(){var e=this.$scroller.scrollTop();e>n?this.showButton():this.hideButton()},onScrollToTopClick:function(){var e=this,n=this.$scroller;n[0]===window&&(n=$("body,html")),n.animate({scrollTop:0},{duration:t,complete:function(){e.animateButtonOut()}}),P.trackGAEvent("scroll_to_top",P.CONST.GA_ACTION_CLICK)},animateButtonIn:function(){var t=this;P.deferDomManipulation(function(){t.$el.addClass(e)})},animateButtonOut:function(){var t=this;P.deferDomManipulation(function(){t.$el.removeClass(e)})},showButton:function(){this.visible||(this.visible=!0,this.animateButtonIn())},hideButton:function(){this.visible&&(this.visible=!1,this.animateButtonOut())}});return P.stopwatch.wrapMethods(i.prototype,"ScrollToTop",["updateButtonVisibility"]),i}),P.Module.define("SearchInfoBar",["InfoBarBase"],function(e){return e.extend({})}),P.Module.define("SearchPage",[],function(){return P.Module.extend({onDestroyed:function(){this.publishSearchChange()},onRemovedFromDom:function(){this.publishSearchChange()},onAdded:function(){var e=_.pick(this.options,"query","scope");this.publishSearchChange(e)},onChildNavigate:function(e){if(this.universalSearch){var t=e.data.url;if(P.isOffsiteUrl(t))return;var n=P.router.resolve(e.data.url);if("SearchPage"===n.module)return e.data.handled=!0,void 0}return!1},publishSearchChange:function(e){e=e||{},P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED,e.query||""),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_SEARCH_SCOPE_UPDATED,e.scope||"")}})}),P.Module.define("SearchScopeSelector",[],function(){return P.Module.extend({events:{"change input":"onScopeChange"},onAddedToDom:function(){var e=this.options.scope;this.$("input").each(function(){var t=$(this);t.prop("checked",t.val()===e)})},onScopeChange:function(e){var t=$(e.currentTarget).val();if(t!==this.options.scope){var n=window.location.search;this.navigate("/search/"+t+"/"+n)}}})}),P.Module.define("ShowModalButton",["Button","ModalTrigger"],function(e,t){var n=_.extend({onClick:function(e){if(P.stopwatch.setNote("submoduleName",this.options.submodule.name),this.isDisabled())return e.preventDefault(),!1;var t=this.options.require_auth,n=P.currentUser.isAuthenticated();if(t&&!n){var i=this.options.url;return i||(i=P.getRegisterUrl()),this.navigate(i)}var o=this.options.submodule;if(P.e.fr&&o.options&&o.options.use_template_module){this.disable();var r=this;P.TemplateModuleLoader.instance().buildTemplateModule(o.name,o.options.template_module_data,function(e){r.showInModal(e),r.enable()})}else this.showModal();return!1},toString:function(){return this.className+"(module="+this.options.submodule.name+")"}},t.prototype),i=e.extend(n);return P.stopwatch.wrapMethods(i.prototype,"ShowModalButton",["onClick"]),i}),P.Module.define("SocialNetworkSettingsBase",[],function(){return P.Module.extend({events:{},handleConnect:function(e,t,n){var i=this;if(t){var o={success:function(o){var r={network:e,data:o};i._internalConnectNetwork(t,r,n)},error:function(){P.showError(P.string("connectError")),n.error&&n.error(),n.complete&&n.complete()}};this._externalConnectNetwork(e,t,o)}else{var r={network:e};this._internalConnectNetwork(t,r,n)}},_externalConnectNetwork:function(e,t,n){if(!t)return n.success&&n.success(),void 0;var i=P.SocialConnect.instance();i.connect(e,n)},_internalConnectNetwork:function(e,t,n){var i=e?"create":"delete",o=new P.Resource("UserSocialNetworkResource",t);o.call(i,n)}})}),P.Module.define("TextContainer",[],function(){return P.Module.extend({events:{}})}),P.Module.define("TweetButton",["Button"],function(e){return e.extend({onClick:function(){var e=this.options.ga_category||"share_twitter";P.trackGAEvent(e,P.CONST.GA_ACTION_CLICK),this.openWebIntent()},openWebIntent:function(){var e=this.getWindowUrl(),t=550,n=420;return P.window.open(e,null,t,n)},getWindowUrl:function(){var e="https://twitter.com/intent/tweet?via=pinterest",t={};return this.options.tweet_path&&(t.url=encodeURIComponent(P.absolutify(this.options.tweet_path))),this.options.tweet_text&&(t.text=encodeURIComponent(this.options.tweet_text)),_.reduce(t,function(e,t,n){return e+"&"+n+"="+t},e)}})}),P.Module.define("UnauthHomePage",[],function(){var e="hidden",t=985,n=461;return P.Module.extend({events:{},initialize:function(){this._minWindowHeight=810,this._minImageHeight=200},onNavigateEvent:function(e){var t=e.target.id,n="emailSignup",i=[n];if(t&&-1!==$.inArray(t,i)){var o;t===n&&(o="register_email"),e.target.options.url,o&&P.trackRegisterAction(o)}},onAddedToDom:function(){this.resize()},onContentReady:function(){var e=this;this.resize(),$(window).on("resize",_.bind(this.resize,this));var t=this.getChildById("facebookSignup");P.trackRegisterAction("unauth_home"),this.childListen(P.CONST.EVENT_NAVIGATE,this.onNavigateEvent),t&&this.listen(t,P.CONST.EVENT_BUTTON_CLICK,this.onFacebookButtonClick),this.$(".homeUnauthImage").load(function(){e.resize()})},onFacebookButtonClick:function(){var e=P.SocialConnect.instance(),t=this;P.trackRegisterAction("register_facebook_attempt"),e.connect("facebook",{success:function(e){t.login({facebook_id:e.id,facebook_token:e.access_token})}})},login:function(e){var t=this,n=this.getChildById("facebookSignup"),i=function(){P.navigate("/")},o=function(){P.SessionStorage.setItem(P.CONST.SESSION_FACEBOOK_ID,e.facebook_id),P.SessionStorage.setItem(P.CONST.SESSION_FACEBOOK_TOKEN,e.facebook_token),t.extraData.fast_track_enabled?(n.showLoading(),P.UserRegistration.fastTrackSocialRegistration(P.SocialConnect.FACEBOOK).then(function(){n.hideLoading(),P.navigate("/")},function(){n.hideLoading(),P.navigate("/join/register/facebook/")})):P.navigate("/join/register/facebook/")};P.currentUser.login(e,i,o)},resize:function(){this._$_content||(this._$content=this.$(".contentWrapper"),this._contentHeight=this._$content.height());var i=this.$(".homeUnauthImage"),o=this._contentHeight;i.width();var r=i.height(),s=$(window).height(),a=$(window).width(),l=this._minWindowHeight,u=t,c=this._minImageHeight;if(a<u){var d=a/u,h=Math.min(t*d,855);i.css({height:"auto",width:h+"px"})
}if(s<l){var p=s-o-100;p<c?i.addClass(e):(i.removeClass(e),i.css({width:"auto",height:p+"px"}))}else i.css({height:"auto",width:"auto"}),i.removeClass(e);r||(r=n);var f=s-r-this._contentHeight;f>=50?this._$content.css("marginTop",f/2):this._$content.css("marginTop",50)}})}),P.Module.define("UnblockButton",[],function(){return P.Module.extend({events:{click:"onClick"},onUserUnblockSuccess:function(){var e=this,t={name:"ConfirmDialog",options:{template:"block_unblock_user_success",name:e.options.full_name,action:"unblocked"}};_.extend(t.options,e.options.dialog_options),P.loadModule(t,function(t){e.showInModal(t),e.listen(t,P.CONST.EVENT_CONFIRM,e.onUnblockConfirm)})},onUnblockConfirm:function(){this.destroy()},onClick:function(){P.trackGAEvent("user_unblock",P.CONST.GA_ACTION_CLICK);var e=this,t=this.options.user_id;this.showLoading();var n={blocked_user_id:this.options.user_id},i=new P.Resource("UserBlockResource",n);i.call("delete",{success:function(){P.trackGAEvent("user_unblock",P.CONST.GA_ACTION_SUCCESS),P.pubsub.publish(t,P.CONST.PUBSUB_TOPIC_USER_UNBLOCKED),e.onUserUnblockSuccess()},error:function(e){P.showError(e.message),P.trackGAEvent("user_unblock",P.CONST.GA_ACTION_ERROR)},complete:function(){e.hideLoading()}})}})}),P.Module.define("UploadPin",[],function(){return P.Module.extend({events:{},onContentReady:function(){this.childListen(P.CONST.EVENT_PIN_CREATE_OPENED,this.onChildPinCreateOpened)},onChildPinCreateOpened:function(){this.destroy()}})}),P.Module.define("User",[],function(){var e="followFriendsItem";return P.Module.extend({events:{"click .dismiss":"onDismissClick",click:"onClick"},getLoadingSpinnerOptions:function(){return this.options.view_type===e?{size:P.Spinner.Size.SMALL}:{}},getProfileImage:function(){var e;switch(this.options&&this.options.view_type){case"send_pin":e=this.$(".profileImage");break;default:return}return e.attr("src")},onContentReady:function(){var e={};e[P.CONST.PUBSUB_TOPIC_USER_FOLLOW]=this.onUserFollow;var t=this.getUserId();this.pubsubSubscribe(t,e)},onUserFollow:function(){this.options.view_type===e&&this.$el.addClass("followed"),this.triggerEvent(P.CONST.EVENT_USER_FOLLOW,null,!0)},onDismissClick:function(){this.triggerEvent(P.CONST.EVENT_DISMISS,null,!0)},getUserId:function(){return this.data&&this.data.id},onClick:function(){"send_pin"===this.options.view_type&&this.triggerEvent(P.CONST.EVENT_USER_CLICK,null,!0)}})}),P.Module.define("UserBadge",[],function(){return P.Module.extend({events:{}})}),P.Module.define("UserBlock",[],function(){return P.Module.extend({events:{"click .cancelButton":"onCancelButtonClick"},onContentReady:function(){this.form=new P.Form(this.$("form")),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick)},onButtonClick:function(e){var t=e.target;if(t){var n=this.options.blocked_by_me?"user_unblock":"user_block";"cancelButton"===t.id?P.trackGAEvent(n,P.CONST.GA_ACTION_CLICK_CANCEL):"submitButton"===t.id&&P.trackGAEvent(n,P.CONST.GA_ACTION_CLICK_SUBMIT)}},onSubmitValidated:function(e){e.errors[0]||this.blockUser()},onUserBlockSuccess:function(){var e=this,t={name:"ConfirmDialog",options:{template:"block_unblock_user_success",name:e.options.full_name,action:"blocked"}};P.loadModule(t,function(t){e.showInModal(t),e.listen(t,P.CONST.EVENT_CONFIRM,e.onBlockConfirm)})},onBlockConfirm:function(){P.ModalManager.instance().removeAllModals();var e=P.getCurrentUrl().split("/")||[];e[1]&&e[1]===this.options.username&&this.navigate("/")},blockUser:function(){var e=this,t=this.getChildById("submitButton"),n=this.options.user_id;t.showLoading();var i={blocked_user_id:n},o=this.options.blocked_by_me?"delete":"create",r=new P.Resource("UserBlockResource",i),s=this.options.blocked_by_me?"user_unblock":"user_block";r.call(o,{success:function(){P.trackGAEvent(s,P.CONST.GA_ACTION_SUCCESS),P.pubsub.publish(e.options.user_id,P.CONST.PUBSUB_TOPIC_USER_BLOCKED),e.onUserBlockSuccess()},error:function(e){P.showError(e.message),P.trackGAEvent(s,P.CONST.GA_ACTION_ERROR)},complete:function(){t.hideLoading()}})},onCancelButtonClick:function(){this.destroy()}})}),P.Module.define("UserBoardInvites",[],function(){return P.Module.extend({onContentReady:function(){this.destroyIfEmpty(),this.pagedGrid=this.getChildById("pagedGrid"),this.childListen(P.CONST.EVENT_CONTENT_CHANGED,this.onChildContentChanged)},onChildRemoved:function(){this.destroyIfEmpty()},onChildContentChanged:function(){this.pagedGrid.hasItems()||this.pagedGrid.destroy()},isEmpty:function(){return!this.children.length}})}),P.Module.define("UserBoards",["BoardCreateRep","Board"],function(e,t){var n=P.CONST.BOARD_PRIVACY_SECRET,i="publicBoardsGrid",o="secretBoardsGrid",r="createsecretrep";return P.Module.extend({onContentReady:function(){this.numSecretBoards=this.numSecretBoards||parseInt(this.options.secret_board_count,10),this.numCreateSecretBoardRep=0;var e={};e[P.CONST.PUBSUB_TOPIC_BOARD_CREATED]=this.onBoardCreated,e[P.CONST.PUBSUB_TOPIC_BOARD_DELETED]=this.onBoardDeleted,e[P.CONST.PUBSUB_TOPIC_BOARD_UPDATED]=this.onBoardUpdated,this.extraData.isOwnProfile&&(e[P.CONST.PUBSUB_TOPIC_BOARD_REMOVED_COLLABORATOR_SELF]=this.onBoardRemovedSelf),this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,e),this.extraData.isOwnProfile&&(this.initializePublicBoardsSortManager(),this.addCreateSecretBoardReps())},initializePublicBoardsSortManager:function(){var e=this.getChildById(i),t=this,n=function(t){var n=t.find(".Board"),i=e.items.getChildByElement(n);i.disable()},o=function(t){var n=t.find(".Board"),i=e.items.getChildByElement(n);i.enable()},r={cancel:".BoardCreateRep",start:function(e,t){n(t.item)},stop:function(e,t){setTimeout(function(){o(t.item)},5)},over:function(e,t){var n=30,i=$(window).scrollTop(),o=t.offset.top-i,r=t.item.height(),s=o<0,a=o>P.Viewport.height-r;a&&(n*=-1),(s||a)&&$(window).scrollTop(i-n)},update:function(e,n){t.onPublicBoardsSortUpdate(e,n)}};e.items.initializeSortManager(r,"Board",function(e){return e.data&&e.data.id})},onPublicBoardsSortUpdate:function(){var e=this.getChildById(i);this.saveBoardOrder(e.items.getSortOrder())},saveBoardOrder:function(e){var t="BoardsReorderResource",n={board_ids:e},i=new P.Resource(t,n),o="user_boards_reorder";i.call("update",{success:function(){P.trackGAEvent(o,P.CONST.GA_ACTION_SUCCESS)},error:function(){P.trackGAEvent(o,P.CONST.GA_ACTION_ERROR)}})},addCreateSecretBoardReps:function(){if(this.extraData.isOwnProfile)for(var e,t=this.getChildById(o),i=this.numSecretBoards+this.numCreateSecretBoardRep,s=i;s<P.CONST.MAX_SECRET_BOARDS;s++)e=r+this.numCreateSecretBoardRep++,this.addCreateBoardRep(e,n,t)},removeCreateSecretBoardReps:function(){for(var e=this.getChildById(o),t=this.numCreateSecretBoardRep,n=0;n<t;n++)e.items.removeChildById(r+n),this.numCreateSecretBoardRep--},onBoardDeleted:function(e,t,i){i.privacy&&i.privacy===n&&(this.numSecretBoards--,this.addCreateSecretBoardReps())},onBoardCreated:function(e,r,s){var a,l=s,u=l.id,c=l.privacy,d=c===n?o:i,h=this.getChildById(d),p=new t({options:{show_board_context:!1},resource:{name:"BoardResource",options:{board_id:u}}}),f=this;c===n?(this.numSecretBoards++,this.removeCreateSecretBoardReps(),a=function(){f.addCreateSecretBoardReps()}):a=function(){},h.items.appendChild(p),p.render(a)},onBoardUpdated:function(e,t,n){n===P.CONST.PUBSUB_MESSAGE_BOARD_SET_PUBLIC&&(this.numSecretBoards--,this.render())},addCreateBoardRep:function(t,i,o){if(!o.items.getChildById(t)){var r=new e({id:t,options:{num_secret_boards:this.numSecretBoards,secret:i===n}});r.render(function(){o.items.appendChild(r)})}},onBoardRemovedSelf:function(){this.render()}})}),P.Module.define("UserChangePassword",[],function(){var e="changePasswordSubmit";return P.Module.extend({onContentReady:function(){this.$form=this.$("form");var e={"new":[P.Validator.Required(),P.Validator.Password()],new_confirm:[P.Validator.Required(),P.Validator.Password()]};this.extraData.has_password&&(e.old=[P.Validator.Required(),P.Validator.Password()]),this.form=new P.Form(this.$form,e),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated);var t=this.getChildById("forgotPasswordButton");t&&this.listen(t,P.CONST.EVENT_BUTTON_CLICK,this.onForgotPasswordClick)},onSubmitValidated:function(t){var n=this.getChildById(e);t.errors[0]||(n.showLoading(!0),this.changePassword())},changePassword:function(){var t=this;this.hideLoading(!0);var n=function(){var n=t.getChildById(e);n.hideLoading()},i=function(){if(t.isInModal()){var e={name:"ConfirmDialog",options:{template:"change_password_success"}},n=function(){t.triggerEvent("success",t),t.destroy(),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_USER_CHANGED_PASSWORD,t.extraData.render_social_networks)};P.loadModule(e,function(e){t.showInModal(e),t.listen(e,P.CONST.EVENT_CONFIRM,n)})}else t.navigate("/")},o=$("form",this.$el),r={"new":o.find("[name=new]").val(),new_confirm:o.find("[name=new_confirm]").val()};this.extraData.has_password&&(r.old=o.find("[name=old]").val());var s=new P.Resource("UserPasswordResource",r);s.call("update",{success:i,complete:n})},onForgotPasswordClick:function(){var e=this;P.trackGAEvent("forgot_password",P.CONST.GA_ACTION_CLICK),this.showLoading();var t=new P.Resource("ForgotPasswordResource",{username_or_email:P.currentUser.attributes.username}),n=function(){P.trackGAEvent("forgot_password",P.CONST.GA_ACTION_SUCCESS);var t={name:"ConfirmDialog",options:{template:"change_password"}};P.loadModule(t,function(t){e.showInModal(t),e.listen(t,P.CONST.EVENT_CONFIRM,e.destroy)})},i=function(){e.hideLoading()},o=function(){P.trackGAEvent("forgot_password",P.CONST.GA_ACTION_ERROR)};t.call("create",{success:n,complete:i,error:o})}})}),P.Module.define("UserCommonPins",[],function(){return P.Module.extend({events:{}})}),P.Module.define("UserDropdown",[],function(){return P.Module.extend({onContentReady:function(){this.childListen(P.CONST.EVENT_NAVIGATE,this.onChildNavigate),this.$(".switchToOld").click(_.bind(this.onSwitch,this))},onChildNavigate:function(e){e.data.$el&&e.data.$el.hasClass("addPin")&&(this.onClickAddPin(),e.stopPropagation())},onSwitch:function(e){e.stopPropagation(),e.preventDefault(),this.$el.empty(),this.triggerEvent("switchToOld",e.target.href,!0)},onClickAddPin:function(){var e=this,t={name:"AddPin",options:{shrinkToFit:!0,dropdown_style:!1}};return this.showLoading(),P.loadModule(t,function(t){P.trackGAEvent("pin_add",P.CONST.GA_ACTION_OPEN_MODAL),e.hideLoading(),e.showInModal(t)}),!1}})}),P.Module.define("UserEdit",[],function(){return P.Module.extend({events:{},onContentReady:function(){var e={first_name:[P.Validator.Required()],username:[P.Validator.Required()],about:[P.Validator.Length({max:P.CONST.MAX_CHARS_FOR_USER_DESCRIPTION})]};this.data.is_partner&&(e.business_name=[P.Validator.Required()]),this.formListener&&this.removeListener(this.formListener),this.form=new P.Form(this.$("form"),e),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(e){e.errors[0]||this.saveProfile()},getFormData:function(){var e=this.$("form").serializeArray(),t={};return _.each(e,function(e){t[e.name]=e.value}),t},getSaveResource:function(e){return new P.Resource("UserSettingsResource",e)},saveProfile:function(){var e=this.getFormData(),t=this.getChildById("submitButton"),n=this,i=this.extraData.currentUsername,o=e.username&&i!==e.username;t.showLoading();var r=this.getSaveResource(e);r.call("update",{success:function(i){var r;if(t.hideLoading(),i.resource_response.error)i.resource_response.message&&(r={message:i.resource_response.message});else{var s=n.isInModal()&&!o;if(s)P.pubsub.publish(n.options.user_id,P.CONST.PUBSUB_TOPIC_USER_UPDATED),n.destroy();else{var a="/"+e.username+"/";n.navigate(a)}}},error:function(e){P.showError(e.message)},complete:function(){t.hideLoading()}})}})}),P.Module.define("UserEditEmail",[],function(){return P.Module.extend({events:{},onContentReady:function(){this.$form=this.$("form"),this.form=new P.Form(this.$form,{email:[P.Validator.Required()]}),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated)},onSubmitValidated:function(e){e.errors[0]||this.updateEmail()},updateEmail:function(){var e=this,t=function(t){if(t){var n=t.resource_response;if(n&&!n.error){if(e.isInModal()){var i=P.string("emailUpdated");e.options.sendVerifyEmail&&(i=P.CONST.PUBSUB_MESSAGE_USER_EMAIL_UPDATED),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_USER_UPDATED,i),e.destroy()}return}}},n=$("form",this.$el),i=new P.Resource("UserSettingsResource",{email:n.find("[name=email]").val()});i.call("update",{success:t})}})}),P.Module.define("UserEditVerifyWebsite",[],function(){return P.Module.extend({events:{'keyup input[name="website_url"]':"onInput",'input input[name="website_url"]':"onInput"},onContentReady:function(){this.originalWebsite=this.data.website_url;var e={};e[P.CONST.PUBSUB_TOPIC_USER_UPDATED]=this.onUserUpdated,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,e);var t=this.getChildById("verifyWebsite");this.listen(t,P.CONST.EVENT_BUTTON_CLICK,this.onClick)},onUserUpdated:function(){this.render()},onInput:function(e){var t=$(e.target).val(),n=this.getChildById("verifyWebsite"),i=this.options.domain_verified&&t===this.originalWebsite;this.$(".verifiedDomainContainer").toggleClass("hidden",!i),this.$(".verifyButton").toggleClass("hidden",i),t?n.enable():n.disable()},showModal:function(e){this.showLoading();var t=this,n={name:"DomainVerify",resource:{name:"DomainVerifyResource",options:{domain:e}},options:{domain:e}};P.loadModule(n,function(e){t.hideLoading(),t.showInModal(e)})},onClick:function(){var e=this.$('input[name="website_url"]').val();if(e===this.originalWebsite)return this.showModal(e),void 0;var t=this,n=this.getChildById("verifyWebsite");n.showLoading();var i=new P.Resource("UserSettingsResource",{website_url:e});i.call("update",{success:function(){P.pubsub.publish(t.options.user_id,P.CONST.PUBSUB_TOPIC_USER_UPDATED),t.showModal(e)},error:function(e){P.showError(e.message)},complete:function(){n.hideLoading()}})}})}),P.Module.define("UserFollowButton",["ui.FollowButton"],function(e){return e.extend({getResourceId:function(){return this.options.user_id},getFollowResource:function(){return new P.Resource("UserFollowResource",{user_id:this.getResourceId()})},getFollowClass:function(){return this.options.follow_class},onContentReady:function(){this.showMemo()}})}),P.Module.define("UserInfoBar",["InfoBarBase"],function(e){return e.extend({events:{}})}),P.Module.define("UserMenu",["DropdownButton"],function(e){return e.extend({onContentReady:function(){var t=this.extraData.userId;if(t){var n={};n[P.CONST.PUBSUB_TOPIC_USER_UPDATED]=this.onUserUpdated,this.pubsubSubscribe(this.extraData.userId,n)}e.prototype.onContentReady.apply(this,arguments)},onUserUpdated:function(){this.render()},setSticky:function(e){this._dropdown.options.sticky=e}})}),P.Module.define("UserNews",[],function(){return P.Module.extend({onContentReady:function(){this.destroyIfEmpty()},onChildRemoved:function(){this.destroyIfEmpty()||this.triggerEvent(P.CONST.EVENT_CONTENT_CHANGED,null,!0)}})}),P.Module.define("UserProfileContent",[],function(){return P.Module.extend({initialize:function(){var e={};e[P.CONST.PUBSUB_TOPIC_PIN_CREATED]=this.onPinAdded,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,e)},onContentReady:function(){if(!this.data.board_count&&!this.data.secret_board_count){var e={};e[P.CONST.PUBSUB_TOPIC_BOARD_CREATED]=this.onFirstBoardCreated,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,e)}},onFirstBoardCreated:function(){this.pubsubUnsubscribe(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_BOARD_CREATED),this.render()},onPinAdded:function(e,t,n){if("pins"===this.options.tab&&n.board.privacy!==P.CONST.BOARD_PRIVACY_SECRET){var i=this.getChildById("userPins");i?i.prependNewItems(1):this.render()}}})}),P.Module.define("UserProfileHeader",[],function(){return P.Module.extend({events:{},initialize:function(){this._resized=!1},_resizeTextIfReady:function(){!this._resized&&this.inDom&&this.contentReady&&this.$(".userProfileHeaderBio").overflowingText()},onContentReady:function(){if(this._resizeTextIfReady(),this.options.user_id){var e={};e[P.CONST.PUBSUB_TOPIC_USER_UPDATED]=this.onUserUpdated,this.pubsubSubscribe(this.options.user_id,e)}if(this.options.report_user_spam&&!this.data.blocked_by_me){P.ModalManager.instance().removeAllModals();var t={name:"FlagUser",options:{full_name:this.data.full_name,first_name:this.data.first_name,blocked_by_me:this.data.blocked_by_me,user_id:this.data.id,username:this.data.username,hide_other_field:!0}},n=this;P.loadModule(t,function(e){n.showInModal(e)})}},onAddedToDom:function(){this._resizeTextIfReady()},onUserUpdated:function(){this.render()}})}),P.Module.define("UserProfileImageUploader",[],function(){return P.Module.extend({events:{},initialize:function(){_.bindAll(this,"onUpdateSuccess","onUpdateError")},onContentReady:function(){var e=this.getChildById("uploader");this.listen(e,P.CONST.EVENT_UPLOAD_SUCCESS,this.onUploadSuccess),this.listen(e,P.CONST.EVENT_UPLOAD_ERROR,this.onUploadError)},onUploadSuccess:function(e){P.trackGAEvent("user_profile_image_upload",P.CONST.GA_ACTION_SUCCESS),this.imageUrl=e.data.image_url,this.updateUserProfileImage()},onUploadError:function(e){P.trackGAEvent("user_profile_image_upload",P.CONST.GA_ACTION_ERROR),P.showError(P.string(e.data))},getUserSettingsResource:function(){return new P.Resource("UserSettingsResource",{profile_image_url:this.imageUrl})},updateUserProfileImage:function(){var e=this.getUserSettingsResource();e.call("update",{success:this.onUpdateSuccess,error:this.onUpdateError})},onUpdateSuccess:function(e){P.pubsub.publish(this.options.user_id,P.CONST.PUBSUB_TOPIC_USER_UPDATED,e.resource_response),this.destroy()},onUpdateError:function(){}})}),P.Module.define("UserProfilePage",[],function(){return P.Module.extend({events:{},_tabs_to_resource:{boards:"BoardsResource",pins:"UserPinsResource",likes:"UserLikesResource",followers:"UserFollowersResource",following:"UserFollowingResource"},onAddedToDom:function(){this.childListen(P.CONST.EVENT_NAVIGATE,this.onChildNavigate)},onRemovedFromDom:function(){this._removeListeners()},onContentReady:function(){var e={};e[P.CONST.PUBSUB_TOPIC_USER_BLOCKED]=this.render,e[P.CONST.PUBSUB_TOPIC_USER_UNBLOCKED]=this.render,this.pubsubSubscribe(this.data.id,e)},onChildNavigate:function(e){P.log("UserProfilePage got navigate event from child",e.target,"for url:",e.data.url);var t=P.router.resolve(e.data.url);if(t){var n=t.module,i=t.options,o=t.resource,r=i.username;if(this.contentReady&&n===this.className&&r===this.options.username){this.setOptions(i),this.setResource(o);var s=this.$el.height();this.$el.css("min-height",s);var a=this.getScrollableElement(),l=a.scrollTop(),u=this,c=i.tab,d=this.getChildByModuleName("UserProfileContent");d.setOptions({tab:c}),d.render(function(){u.$el.css("min-height","");var e=a.height(),t=u.$el.positionAncestor(a).top,n=u.$el.height(),i=l+e-n+t;i>0&&(u.$el.css("min-height",n+i),a.scrollTop(l))}),e.data.handled=!0}}}})}),P.Module.define("UserRecentActivity",[],function(){return P.Module.extend({events:{"mouseenter .username":"onUsernameMouseEnter","mouseout .username":"onUsernameMouseOut"},onContentReady:function(){this.destroyIfEmpty()},onAddedToDom:function(){_.each(this.$(".recentActivityRow"),function(e){var t=$(e),n=t.attr("href"),i=t.data("link_url");n!==i&&t.attr("href",i)}),this.destroyIfEmpty()},isEmpty:function(){return this.contentReady&&this.inDom&&!this.$(".recentActivityRow:visible").length},onUsernameMouseEnter:function(e){var t=$(e.target).parents("a");this._originalUrl=t.attr("href");var n=$(e.target),i=n.data("username");if(i){var o="/"+i+"/";t.attr("href",o)}},onUsernameMouseOut:function(e){var t=this,n=$(e.target).parents("a");n.attr("href",t._originalUrl)}})}),P.Module.define("UserRegister",[],function(){var e="hidden";return P.Module.extend({events:{"blur #userFirstName,#userLastName,#userEmail":"computeUsernameSuggestion","keyup #userEmail":"computeUsernameSuggestion","focus #userUserName":"onSuggestUsername","keyup #userUserName":"onUsernameChanged",'change select[name="country"]':"onCountryChanged","blur input[name=email]":"onBlurEmail","click .suggestionEmail":"onClickSuggestionEmail",'click input[name="facebook_timeline_enabled"]':"onCheckboxChanged"},network:null,networkCredentials:{},usernameSuggestionResource:null,fieldValues:{},currentUsernameSuggestion:"",userModifiedUsername:!1,fbAccess:!1,onCountryChanged:function(t){var n=this.$(".termsWrapper"),i=this.$(".helpText");"FR"===$(t.target).val()?(n.removeClass(e),i.addClass(e)):(n.addClass(e),i.removeClass(e))},onBlurEmail:function(){if(this.extraData.show_email_suggestion){var e=this.$inputEmail.val(),t=_.extend({},{email:e,email_filter:"unused"});null==this.emailSuggestionResource&&(this.emailSuggestionResource=new P.Resource("EmailSuggestionResource",t));var n=this;this.emailSuggestionResource.options=t,this.emailSuggestionResource.call("get",{success:function(e){var t=e.resource_response.data;t.length>0?(n.$suggestionEmail.text(t[0]),n.$suggestion.slideDown()):n.$suggestion.slideUp()},error:function(){n.$suggestion.slideUp()}})}},onClickSuggestionEmail:function(e){var t=this.$suggestionEmail.text();this.$inputEmail.val(t),this.$suggestion.slideUp(),e.preventDefault()},onContentReady:function(){if(P.currentUser.isAuthenticated())return this.redirect(),void 0;var e=this;P.FbUtil.checkFbTimelinePermission({success:function(){e.toggleFbTimelinePermission(!0)},error:function(){e.toggleFbTimelinePermission(!1)}});var t={first_name:[P.Validator.Required()],email:[P.Validator.Required(),P.Validator.Email()],gender:[P.Validator.Required()],country:[]};this.$suggestion=this.$(".suggestion"),this.$suggestionEmail=this.$(".suggestionEmail"),this.$inputEmail=this.$("input[name=email]"),this.extraData.show_username&&(t.username=[P.Validator.Required()]),this.extraData.show_password&&(t.password=[P.Validator.Password()]),this.formListener&&this.removeListener(this.formListener),this.form=new P.Form(this.$("form"),t),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated);var n=this.options.network&&!this.options.network_data;n&&(this.showLoading(),P.UserRegistration.fetchNetworkData(this.options.network).done(function(t){e.populateForm(t)}).always(function(){e.hideLoading()})),this.fieldValues=this.getFieldValues(),this.currentUsernameSuggestion=this.$("#userUserName").val(),this.currentUsernameSuggestion&&this.addUsernameAsSuggestionMessage()},toggleFbTimelinePermission:function(e){this.fbAccess=e;var t=this.$('input[name="facebook_timeline_enabled"]');t.prop("checked",e)},getFieldValues:function(){var e={first_name:this.$("#userFirstName").val(),last_name:this.$("#userLastName").val()},t=this.$("#userEmail").val();return t.match("@")&&(e.email=t.replace(/@.*/,"@")),e},computeUsernameSuggestion:function(){if(!this.userModifiedUsername){var e=this.getFieldValues();if(!_.isEqual(this.fieldValues,e)){this.fieldValues=e;var t=_.extend({},this.fieldValues,{limit:1});null==this.usernameSuggestionResource&&(this.usernameSuggestionResource=new P.Resource("UsernameSuggestionResource",t));var n=this;this.usernameSuggestionResource.options=t,this.usernameSuggestionResource.call("get",{success:function(e){n.currentUsernameSuggestion=e.resource_response.data[0]},error:function(){}})}}},onSuggestUsername:function(){if(!this.userModifiedUsername&&this.currentUsernameSuggestion){var e=this.$("#userUserName");e.val()!==this.currentUsernameSuggestion&&(e.val(this.currentUsernameSuggestion),this.form.validateField(e),this.addUsernameAsSuggestionMessage())}},onUsernameChanged:function(){var e=this.$("#userUserName");e.val()?this.currentUsernameSuggestion!==e.val()&&(this.userModifiedUsername=!0,this.removeUsernameAsSuggestionMessage()):(this.userModifiedUsername=!1,this.computeUsernameSuggestion(),this.removeUsernameAsSuggestionMessage())},addUsernameAsSuggestionMessage:function(){var e=this.$("#userUserName");if(0===e.nextAll(".formHelpMessage").length){var t=P.string("suggestedUsername");e.after('<p class="formHelpMessage">'+t+"</p>")}},removeUsernameAsSuggestionMessage:function(){var e=this.$("#userUserName"),t=e.nextAll(".formHelpMessage");t.remove()},onCheckboxChanged:function(e){var t=$(e.target),n=this;if(t.prop("checked")&&!this.fbAccess){var i={success:function(){n.fbAccess=!0},error:function(){t.prop("checked",!1)}};P.FbUtil.fbLogin(i)}},populateForm:function(e){this.options.network_data=e;var t={first_name:e.first_name,last_name:e.last_name,email:e.email,social_username:e.username,limit:1};this.resource=new P.Resource("UsernameSuggestionResource",t);var n=this,i=function(){n.hideLoading()};this.render(i,i)},onSubmitValidated:function(e){if(!e.errors[0]){var t=this.getChildById("submitButton"),n=this,i=this.extraData&&this.extraData.networkCredentials?this.extraData.networkCredentials:{},o=_.extend({},this.getFormData(),i);P.UserRegistration.addExtraSocialParams(this.options.network,o),this.options.network_data&&(o.social_username=this.options.network_data.username),t.showLoading(),P.UserRegistration.register(n.options.network,o).then(function(){n.redirect()},function(){t.hideLoading()})}},redirect:function(){this.navigate("/")},getFormData:function(){var e=this.$("form").serializeArray(),t={};return _.each(e,function(e){t[e.name]="on"===e.value?!0:e.value}),t}})}),P.Module.define("UserRegisterPage",[],function(){return P.Module.extend({events:{}})}),P.Module.define("UserSettingsPage",[],function(){var e="emailDisabled",t="emailSettings",n=["intro","confirm","delete"],i="emailGlobalToggle";return P.Module.extend({events:{},onContentReady:function(){var e={email:[P.Validator.Email()]};this.data.is_partner&&(e.contact_name=[P.Validator.Required()]),this.$form=this.$("form"),this.form=new P.Form(this.$form,e),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.childListen(P.CONST.EVENT_BUTTON_CLICK,this.onButtonClick),this.childListen(P.CONST.EVENT_CHANGE,this.onChildChange);var t={};t[P.CONST.PUBSUB_TOPIC_USER_CHANGED_PASSWORD]=this.onPasswordChanged,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_SITE,t)},onPasswordChanged:function(e,t,n){var i=this.getChildById("userChangePasswordButton");if(i.options.submodule.options.has_password=!0,i.options.text=this.extraData.change_password_text,i.render(),n){var o=this.getChildById("userSocialNetworkSettings");o.render()}},onButtonClick:function(e){var t=e.target,n=t.id;switch(n){case"deleteAccount":this.step=0,this.deleteAccountFlow();break;case"clearRecentSearches":this.clearRecentSearches(e);break;case"clearSendPinHistory":this.clearRecentSentPinContacts(e)}},onChildChange:function(e){var t=e.target;t.id===i&&(t.isChecked()?this.enableEmails():this.confirmDisableEmails())},clearRecentSearches:function(e){var t=e.target;t.disable();var n=new P.Resource("TypeaheadClearRecentResource");n.call("delete",{error:function(){t.enable()}})},clearRecentSentPinContacts:function(e){var t=e.target;t.disable();var n=new P.Resource("RecentContactsResource");n.call("delete",{error:function(){t.enable()}})},deleteAccountFlow:function(){var e=n[this.step];"delete"===e?this.deleteAccount():(this.showDeleteAccountStep(e),this.step++)},onSubmitValidated:function(e){e.errors[0]||this.save()},navigateToUserProfilePage:function(e){var t="/"+e+"/";this.navigate(t)},save:function(){var e=this,t=this.$form.serializeArray(),n={};_.each(t,function(e){n[e.name]="on"===e.value?!0:e.value}),this.$form.find("input[type=checkbox]").each(function(){var e=$(this);n[e.attr("name")]="checked"===e.attr("checked")});var i=this.getChildById("submitButton"),o=new P.Resource("UserSettingsResource",n),r=function(t){if(t&&!t.resource_response.error){var n=t.resource_response.data.username;return e.navigateToUserProfilePage(n)}};i.showLoading(),o.call("update",{success:r,complete:function(){i.hideLoading()}})},showDeleteAccountStep:function(e){var t=this,n="delete_account_"+e,i={name:"ConfirmDialog",options:{first_name:this.data.first_name,template:n,view_type:"wide"}};P.loadModule(i,function(e){t.showInModal(e),t.listen(e,P.CONST.EVENT_CONFIRM,t.deleteAccountFlow)})},deleteAccount:function(){var e=this;this.xhr=$.ajax({cache:!1,url:"/delete_user/",dataType:"json",type:"delete"}).done(function(t){"success"===t.status?e.showDeleteAccountStep("success"):P.showError(P.string("errorMessage"))}).fail(function(){P.showError(P.string("errorMessage"))})},confirmDisableEmails:function(){var e=this,t={name:"ConfirmDialog",options:{template:"disable_emails_confirm"}};P.loadModule(t,function(t){e.showInModal(t),e.listen(t,P.CONST.EVENT_CONFIRM,function(){e.disableEmails(),e.removeListener(n)});var n=e.listen(t,P.CONST.EVENT_DESTROYED,function(){var e=this.getChildById(i);e.setChecked(!0)})})},disableEmails:function(){this.setEmailsEnabled(!1)},enableEmails:function(){this.setEmailsEnabled(!0)},setEmailsEnabled:function(n){var i=new P.Resource("UserSettingsResource",{email_enabled:n}),o=this.$("."+t);o.toggleClass(e,!n),i.call("update")}})}),P.Module.define("UserSocialNetworkSettings",["SocialNetworkSettingsBase"],function(e){return e.extend({FB_PUBLISH_ACTIONS_PERMISSION:"publish_actions",initialize:function(){this.childListen("change",this.onChildChange)},disconnectFromSocial:function(e,t,n){this.showLoading(!0);var i=this,o={success:function(){P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_CURRENT_USER,P.CONST.PUBSUB_TOPIC_SOCIAL_NETWORK_UPDATED),i.render()},error:function(){e.toggle()},complete:function(){i.hideLoading()}};n||"facebookTimelineToggle"!==e.id?this.handleConnect(n,t,o):(o.success=function(){},P.FbUtil.maybeRequestFbTimelinePermission(o,this.extraData.facebookId))},onChildChange:function(e){var t=e.target,n=t.isChecked(),i=null;switch(t.id){case"facebookToggle":if(!(n&&!this.extraData.facebookUrl||!n&&this.extraData.facebookUrl))return;i=P.SocialConnect.FACEBOOK,n||this.getChildById("facebookTimelineToggle").setChecked(!1);break;case"facebookTimelineToggle":var o={};o.facebook_timeline_enabled=!this.extraData.facebookTimelineEnabled;var r=new P.Resource("UserSettingsResource",o);if(r.call("update",{}),!n||this.extraData.facebookTimelineEnabled)return this.extraData.facebookTimelineEnabled=!this.extraData.facebookTimelineEnabled,void 0;i=null;break;case"twitterToggle":if(!(n&&!this.extraData.twitterUrl||!n&&this.extraData.twitterUrl))return;i=P.SocialConnect.TWITTER;break;case"googleToggle":if(!(n&&!this.extraData.connected_to_google||!n&&this.extraData.connected_to_google))return;i=P.SocialConnect.GOOGLE;break;case"yahooToggle":if(!(n&&!this.extraData.connected_to_yahoo||!n&&this.extraData.connected_to_yahoo))return;i=P.SocialConnect.YAHOO;break;default:return}if(n||this.extraData.has_password)this.disconnectFromSocial(t,n,i);else{var s=this,a={name:"UserChangePassword",options:{has_password:!1,render_social_networks:!1}},l=!1;P.loadModule(a,function(e){s.showInModal(e),s.listen(e,"destroyed",function(){l?s.disconnectFromSocial(t,n,i):(P.showError(P.string("passwordMustBeSet")),t.toggle())}),s.listen(e,"success",function(){l=!0})})}}})}),P.Module.define("dev.API",[],function(){return P.Module.extend({})}),P.Module.define("dev.Android",[],function(){return P.Module.extend({})}),P.Module.define("dev.Apps",[],function(){return P.Module.extend({})}),P.Module.define("dev.Footer",[],function(){return P.Module.extend({onContentReady:function(){}})}),P.Module.define("dev.Goodies",[],function(){return P.Module.extend({})}),P.Module.define("dev.Header",[],function(){return P.Module.extend({})}),P.Module.define("dev.Hero",[],function(){return P.Module.extend({})}),P.Module.define("dev.HomeContent",[],function(){return P.Module.extend({})}),P.Module.define("dev.PinIt",[],function(){return P.Module.extend({})}),P.Module.define("dev.RichPinApplyForm",[],function(){return P.Module.extend({events:{'click input[name="input_type"]':"onFormatChange"},onContentReady:function(){var e={domain:[P.Validator.Required()]};
this.formListener&&this.removeListener(this.formListener),this.form=new P.Form(this.$("form"),e),this.formListener=this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.onSubmitValidated),this.options&&"oembed"===this.options.link_type&&this.$(".oembed-url").show()},onFormatChange:function(e){"oembed"===e.target.value?this.$(".oembed-url").show():this.$(".oembed-url").hide()},onSubmitValidated:function(e){e.errors[0]||this.submitApplication()},getFormData:function(){var e=this.$("form").serializeArray(),t={};return _.each(e,function(e){t[e.name]=e.value}),t},getSaveResource:function(e){return new P.Resource("RichPinApplyResource",e)},submitApplication:function(){var e=this.getFormData(),t=this.getChildById("submitButton"),n=this;t.showLoading();var i=this.getSaveResource(e);i.call("create",{success:function(e){var i;t.hideLoading(),e.resource_response.error?e.resource_response.message&&(i={message:e.resource_response.message}):n.showSuccessMessage()},error:function(e){P.showError(e.message)},complete:function(){t.hideLoading()}})},showSuccessMessage:function(){var e={name:"ConfirmDialog",options:{template:"richpin_apply_success"}},t=this;P.loadModule(e,function(e){t.listen(e,P.CONST.EVENT_DESTROYED,function(){t.destroy()}),t.showInModal(e)})}})}),P.Module.define("dev.RichPinValidate",[],function(){return P.Module.extend({events:{}})}),P.Module.define("dev.RichPinValidateMovie",[],function(){return P.Module.extend({events:{}})}),P.Module.define("dev.RichPinValidateProduct",[],function(){return P.Module.extend({events:{}})}),P.Module.define("dev.RichPinValidateRecipe",[],function(){return P.Module.extend({events:{}})}),P.Module.define("dev.RichPinValidator",[],function(){return P.Module.extend({events:{"click .retrieveMetadata":"retrieve"},onContentReady:function(){this.$form=this.$("form"),this.linkValidator=new P.Validator($(".urlInput"),[P.Validator.URL()]),this.form=new P.Form(this.$form),this.listen(this.form,P.CONST.EVENT_SUBMIT_VALIDATED,this.retrieve);var e=$(".sidebar"),t=$(".content"),n=e.height(),i=t.height();n>i&&t.height(n),"1"===this.options.apply&&this.showApplyDialog()},retrieve:function(){var e=this,t=this.$form.serializeArray();return this.linkValidator.validate(function(n){if(n.errors.length){var i=$(".urlInput").attr("error-message");P.showError(i)}else{var o=encodeURIComponent(t[0].value);this.getChildById("submitButton"),e.navigate("/developer/rich_pins/validator/?link="+o)}}),!1},showApplyDialog:function(){var e=this;P.loadModule({name:"dev.RichPinApplyForm"},function(t){e.showInModal(t,{})})}})}),P.Module.define("dev.RichPins",[],function(){return P.Module.extend({onContentReady:function(){this.setupRichPins()},onAddedToDom:function(){this.setupRichPins()},setupRichPins:function(){if(this.inDom&&this.contentReady){var e=this,t=this.$(".navigation"),n=window.location.hash?window.location.hash.substring(1):"";n&&($("a."+n,t).addClass("selected"),e.scrollToLocation("#"+n)),this.$("a.anchorable",t).click(function(){$("a",t).removeClass("selected"),$(this).addClass("selected");var n=$(this).attr("href");e.scrollToLocation(n)})}},scrollToLocation:function(e){var t=$(e).position();t&&(t=t.top-130,window.scrollTo(0,t))}})}),P.Module.define("dev.Sidebar",[],function(){return P.Module.extend({})}),P.Module.define("dev.Terms",[],function(){return P.Module.extend({events:{}})}),P.Module.define("dev.UserDropdown",[],function(){return P.Module.extend({})}),P.Module.define("dev.UserMenu",["DropdownButton"],function(e){return e.extend({onContentReady:function(){e.prototype.onContentReady.apply(this,arguments);var t=$(".devProfile a").width()+10;t=Math.max(t,130),$(".devUserDropdown").width(t)}})}),P.Module.define("dev.iOS",[],function(){return P.Module.extend({})}),P.Module.define("tutorials.BaseTutorialStep",[],function(){var e="tutorialHighlight",t="tutorialHighlightMask";return P.Module.extend({initialize:function(){this.childListen(P.CONST.EVENT_BUTTON_CLICK,this._onButtonClick),this.listen(P.Viewport,P.CONST.EVENT_RESIZE,_.bind(this.onResize,this))},setModalPosition:function(e,t,n){var i="VIEWPORT_MIDDLE";e&&t&&(i="ANCHORED",this.modal.options.position_point=e,this.modal.options.anchor=t),this.modal.options.positionMode=i,this.modal.options.caret=!0,n&&this.modal.positionModule()},onEnter:function(e){e&&e()},onShow:function(e){e&&e()},onExit:function(e){e&&e()},_onButtonClick:function(e){var t=e.target;t&&("previousButton"===t.id?(e.stopPropagation(),this.triggerEvent(P.CONST.EVENT_PREVIOUS,null,!0)):"nextButton"===t.id&&(e.stopPropagation(),this.triggerEvent(P.CONST.EVENT_NEXT,null,!0)))},ensurePath:function(e){window.location.pathname!==e&&this.navigate(e)},highlightedElements:{},cleanHighlightedElements:function(){$("."+e).remove(),this.highlightedElements={}},_getModuleChildById:function(e,t){var n=e._childrenIdMap[t];if(n)return n;for(var i,o=0,r=e.children.length;o<r;o++)if(i=e.children[o],n=this._getModuleChildById(i,t))return n},_getModuleChildrenByModuleName:function(e,t){var n=[],i=this;return _.each(e.children,function(e){e.className===t&&n.push(e),n=n.concat(i._getModuleChildrenByModuleName(e,t))}),n},_highlightModule:function(e,t){return this._highlightElement(e.cid,e.$el,t)},_highlightElement:function(n,i,o){var r;if(o){r=i.clone(),r.$origin=i,r.attr("id",n),r.addClass(e),this.highlightedElements[n]=r;var s=$("body");s.append(r);var a=$('<div class="'+t+'"/>');a.addClass(e),s.append(a),r.$mask=a,this.positionClone(r)}else r=this.highlightedElements[n],r&&(r.remove(),delete this.highlightedElements[n]);return r},positionClone:function(e){var t=e.$origin.offset();t={top:t.top,left:t.left};var n=t.top-$(window).scrollTop();n>0&&(t.top=n),e.css(t),e.$mask.css(t),e.$mask.css({height:e.outerHeight(),width:e.outerWidth()}),this.modal&&this.modal.positionModule()},onResize:function(){_.each(this.highlightedElements,_.bind(this.positionClone,this))},onRemoved:function(){this.cleanHighlightedElements()}})}),P.Module.define("tutorials.CategoriesStep",["tutorials.BaseTutorialStep"],function(e){return e.extend({onShow:function(e){var t=this._getCategoriesDropdownButton(),n=t.getDropdown();n.options.sticky=!0,t.showDropdown(_.bind(function(){var n=this._highlightModule(t,!0);this.setModalPosition("RIGHT_TOP",n,!0),e&&e()},this))},onExit:function(e){var t=this._getCategoriesDropdownButton(),n=t.getDropdown();n.options.sticky=!1,t.hideDropdown(),e&&e()},_getCategoriesDropdownButton:function(){return this._getModuleChildById(P.app,"categoriesDropdownButton")}})}),P.Module.define("tutorials.ExampleTutorial",["tutorials.BaseTutorial"],function(e){return e.extend({onStep1:function(){var e=this._getModuleChildrenByModuleName(P.app,"Header")[0],t=this._getModuleChildrenByModuleName(e,"Button"),n=t[0];this._highlightModule(n,!0)}})}),P.Module.define("tutorials.HomeFeedPinIntro",["tutorials.BaseTutorialStep"],function(e){var t="pinterestLogoStepBackground";return e.extend({onEnter:function(e){this.ensurePath("/"),e&&e()},onShow:function(e){var n=this._getModuleChildrenByModuleName(P.app,"Header")[0],i=n.getLogo(),o=this._highlightElement(i.id,i,!0),r=$("<div>");r.addClass(t),r.css({top:o.offset().top-60,left:o.offset().left}),$("body").append(r),e&&e()},onExit:function(e){$("."+t).remove(),e&&e()}})}),P.Module.define("tutorials.HomefeedStep",["tutorials.BaseTutorialStep"],function(e){return e.extend({onEnter:function(e){this.ensurePath("/"),e&&e()}})}),P.Module.define("tutorials.PinIntro",["tutorials.BaseTutorialStep"],function(e){var t="samplePinTutorialStep";return e.extend({onEnter:function(e){this.ensurePath("/"),$("body").append('<div class="'+t+'">&nbsp;</div>'),e&&e()},onShow:function(e){var n=$("."+t);this.setModalPosition("RIGHT_TOP",n,!0),e&&e()},onExit:function(e){$("."+t).remove(),e&&e()}})}),P.Module.define("tutorials.PinterestLogoStep",["tutorials.BaseTutorialStep"],function(e){var t="pinterestLogoStepBackground";return e.extend({onShow:function(e){var n=this._getModuleChildrenByModuleName(P.app,"Header")[0],i=n.getLogo(),o=this._highlightElement(i.id,i,!0),r=$("<div>");r.addClass(t),r.css({top:o.offset().top-60,left:o.offset().left}),$("body").append(r),e&&e()},onExit:function(e){$("."+t).remove(),e&&e()}})}),P.Module.define("tutorials.ProfileStep",["tutorials.BaseTutorialStep"],function(e){return e.extend({onShow:function(e){var t=this._getModuleChildById(P.app,"userMenu");t.setSticky(!0),t.showDropdown(_.bind(function(){var n=this._highlightModule(t,!0);n.width(t.$el.width()),this.setModalPosition("LEFT_TOP",n,!0),e&&e()},this))},onExit:function(e){var t=this,n=function(){e&&e();var n=t._getModuleChildById(P.app,"userMenu");n.setSticky(!1),n.hideDropdown()},i="/"+P.currentUser.get("username")+"/";if(window.location.pathname===i)return n(),void 0;var o={};o[P.CONST.PUBSUB_TOPIC_MAIN_MODULE_NEW]=function(){t.pubsubUnsubscribe(P.CONST.PUBSUB_CHANNEL_MAIN_MODULE,P.CONST.PUBSUB_TOPIC_MAIN_MODULE_NEW),_.delay(n,1e3)},this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_MAIN_MODULE,o),this.getChildById("previousButton").disable(),this.getChildById("nextButton").disable(),this.navigate(i)}})}),P.Module.define("tutorials.WelcomeStep",["tutorials.BaseTutorialStep"],function(e){return e.extend({})}),P.Module.define("ui.Checkbox",[],function(){var e="on",t=P.CONST.EVENT_CHANGE,n="checked";return P.Module.extend({onContentReady:function(){this.$input=this.$el,"fancyToggle"===this.options.view_type&&(this.$input=this.$("input"),this.$el.on("click",_.bind(this.onFancyToggleClick,this)))},onFancyToggleClick:function(){return this.toggle(),!1},toggle:function(){this.setChecked(!this.options.checked)},setChecked:function(i){i===this.options.checked||this.options.disabled||(this.options.checked=i,this.$el.toggleClass(e,i),this.$input.prop(n,i),this.triggerEvent(t,null,!0))},isChecked:function(){return!!this.options.checked}})}),P.Module.define("ui.FollowButton",["Button","Dropdown"],function(e,t){var n="dim",i="primary",o="memoDropdown";return e.extend({getResourceId:function(){return null},getFollowResource:function(){return null},getFollowClass:function(){return i},getUnfollowClass:function(){return n},toggleState:function(){this.setState(!this.options.followed),this.trigger("toggleFollow"),this.getResourceId()&&P.pubsub.publish(this.getResourceId(),this.options.followed?P.CONST.PUBSUB_TOPIC_USER_FOLLOW:P.CONST.PUBSUB_TOPIC_USER_UNFOLLOW,!0)},setState:function(e){this.$el.addClass(e?this.getUnfollowClass():this.getFollowClass()),this.$el.removeClass(e?this.getFollowClass():this.getUnfollowClass()),this.$el.text(this.options[e?"unfollow_text":"follow_text"]),this.options.followed=e},toggleFollow:function(){var e=this.getFollowResource(),t=this.options.followed?"delete":"create";if(!e)return P.log("ERROR","No resource returned in `getFollowResource()`"),void 0;this.showLoading();var n=this.options.followed?this.options.unfollow_ga_category:this.options.follow_ga_category,i=this;e.call(t,{success:function(){n&&P.trackGAEvent(n,P.CONST.GA_ACTION_SUCCESS),i.toggleState()},error:function(e){P.showError(e.message),n&&P.trackGAEvent(n,P.CONST.GA_ACTION_ERROR)},complete:function(){i.hideLoading()}})},onClick:function(){if(this.ensureAuthentication()&&!this.options.is_me){var e=this.options.followed?this.options.unfollow_ga_category:this.options.follow_ga_category;return e&&P.trackGAEvent(e,P.CONST.GA_ACTION_CLICK),this.toggleFollow(),!1}},hideMemo:function(){if(this.options.memo){var e=this.getChildById(o);e&&e.fadeOut(function(){e.destroy()})}},showMemo:function(){if(this.options.memo&&this.options.memo.show&&!this.getChildById(o)){this.setActiveStyle=P.NOOP,this.isClickButton=function(){return!1};var e={title:this.options.memo.title,anchor:this.getElement(),position_point:"RIGHT_CENTER",class_name:"autoFollowMemo",largeCaret:!1},n=new t({id:o,options:e});this.appendChild(n);var i=this;n.fadeIn(10,function(){setTimeout(function(){i.hideMemo()},2e3)})}}})}),P.Module.define("ui.ImageCrop",[],function(){return P.Module.extend({events:{"mousedown .drag":"onStartDrag"},onAddedToDom:function(){this._positionIfReady()},onContentReady:function(){_.defaults(this.options,{size:{width:222,height:150},padding:60}),this.$holder=this.$(".holder"),this.$bg=this.$(".bg"),this.$help=this.$(".help"),this.$frame=this.$(".frame"),this.$mask=this.$(".mask"),this.$spinner=this.$(".spinner"),this.$holder.show().css("height",this.options.size.height+2*this.options.padding),this.options.help_text&&this.$help.html(this.options.help_text),this._positionIfReady()},_positionIfReady:function(){if(!this._positioned&&this.inDom&&this.contentReady){this._positioned=!0;var e=this._frameBounds={left:this.$holder.width()/2-this.options.size.width/2,width:this.options.size.width,top:this.options.padding,height:this.options.size.height};e.ratio=e.height/e.width,this.$frame.css(e);var t=this.$mask.children();t.eq(0).css({top:0,left:0,right:0,height:e.top}),t.eq(1).css({top:e.top,left:e.left+e.width,right:0,height:e.height}),t.eq(2).css({top:e.top+e.height,left:0,right:0,bottom:0}),t.eq(3).css({top:e.top,left:0,width:e.left,height:e.height}),this.options.image_url&&this.setImage(this.options.image_url)}},initImage:function(){if(!this.$img.height()||!this.$img.width())return _.delay(_.bind(this.initImage,this),200),void 0;var e=this._imageBounds={nativeWidth:this.$img.width(),nativeHeight:this.$img.height()};e.ratio=e.nativeHeight/e.nativeWidth,this.$img.addClass("in"),this._fitImage(),this._centerImage(),this._hideSpinner()},onStartDrag:function(e){this._mousePosition={x:e.pageX,y:e.pageY},this._startPosition={x:parseInt(this.$bg.css("left"),10),y:parseInt(this.$bg.css("top"),10)},$("body").on({"mousemove.ui-ImageCrop":_.bind(this.onDragging,this),"mouseup.ui-ImageCrop":this.onStopDragging}),e.preventDefault()},onDragging:function(e){e.preventDefault();var t=e.pageX-this._mousePosition.x,n=e.pageY-this._mousePosition.y,i={top:this._startPosition.y+n,left:this._startPosition.x+t};this._clampValues(i),this.$bg.css(i)},onStopDragging:function(){$("body").off("mousemove.ui-ImageCrop mouseup.ui-ImageCrop")},_clampValues:function(e){e.top=Math.min(e.top,this._frameBounds.top),e.left=Math.min(e.left,this._frameBounds.left),e.top+this._imageBounds.height<this._frameBounds.top+this._frameBounds.height&&(e.top=this._frameBounds.top+this._frameBounds.height-this._imageBounds.height+1),e.left+this._imageBounds.width<this._frameBounds.left+this._frameBounds.width&&(e.left=this._frameBounds.left+this._frameBounds.width-this._imageBounds.width+1)},setImage:function(e){this._showSpinner();var t=this.$img=$("<img>",{src:e});this.$bg.empty().append(t),this.initImage()},_fitImage:function(){var e;e=this._imageBounds.ratio>=this._frameBounds.ratio?this._frameBounds.width/this._imageBounds.nativeWidth:this._frameBounds.height/this._imageBounds.nativeHeight,this._scaleImage(e)},_centerImage:function(){var e=this.$holder.height(),t=this.$holder.width();this.$bg.css({top:e/2-this.$bg.height()/2+1,left:t/2-this.$bg.width()/2+1})},_scaleImage:function(e){var t=this._imageBounds.width=this._imageBounds.nativeWidth*e,n=this._imageBounds.height=this._imageBounds.nativeHeight*e;this.$img.css({width:t,height:n})},_showSpinner:function(){this.$spinner.show()},_hideSpinner:function(){this.$spinner.hide()},getCropData:function(){var e={x:-1*(parseInt(this.$bg.css("left"),10)-this._frameBounds.left),y:-1*(parseInt(this.$bg.css("top"),10)-this._frameBounds.top)},t=this.$img.width()/this._imageBounds.nativeWidth,n={crop_x:e.x,crop_y:e.y,nativeHeight:this._imageBounds.nativeHeight,nativeWidth:this._imageBounds.nativeWidth,height:this.options.size.height,width:this.options.size.width,scale:t};return n}})}),P.Module.define("ui.ImageUploader",[],function(){return P.Module.extend({events:{},initialize:function(){_.bindAll(this,"onUploaderSubmit","onUploaderComplete","onUploaderProgress","onUploaderError")},onContentReady:function(){this.ensureUploader()},getUploadUrl:function(){return P.absolutify("/upload-image/")},getFileNameElement:function(){return this.$fileName||(this.$fileName=this.$(".uploaderProgress").find("span")),this.$fileName},getButton:function(){return this.getChildById("upload")},ensureUploader:function(){return this.uploader?this.uploader:(this.uploader=new qq.FineUploaderBasic({debug:P.DEBUG,button:this.getButton().getElement().get(0),multiple:!1,request:{endpoint:this.getUploadUrl(),inputName:"img",forceMultipart:!0,customHeaders:{"X-CSRFToken":P.getCSRFToken()}},callbacks:{onUpload:this.onUploaderSubmit,onComplete:this.onUploaderComplete,onProgress:this.onUploaderProgress,onError:this.onUploaderError,showAlert:function(e){P.log(e)}}}),this.uploader)},onUploaderSubmit:function(){this.getButton().showLoading(),this.triggerEvent(P.CONST.EVENT_UPLOAD_START),P.log("UploaderSubmit",arguments)},onUploaderComplete:function(e,t,n){n.success&&(this.getButton().hideLoading(),this.getButton().setStyles({primary:!1}),this.triggerEvent(P.CONST.EVENT_UPLOAD_SUCCESS,n,!0),this.getFileNameElement().text(n.filename),P.log("UploaderComplete",arguments))},onUploaderProgress:function(e,t,n,i){var o=Math.round(100*(n/i));this.triggerEvent(P.CONST.EVENT_UPLOAD_PROGRESS,{loaded:n,total:i,percent:o}),this.getFileNameElement().text(o+"%"),P.log("UploaderProgress",arguments)},resetFileNameElement:function(){this.getFileNameElement().text(this.extraData.placeholder)},onUploaderError:function(e,t,n){this.getButton().hideLoading(),this.triggerEvent(P.CONST.EVENT_UPLOAD_ERROR,n),P.log("UploaderError",arguments),this.resetFileNameElement()}})}),P.Module.define("ui.PinPreview",[],function(){return P.Module.extend({events:{},setImage:function(e){var t=this;this.showLoading(!0);var n=function(){t.hideLoading()},i=this.$("img").get(0);i&&(i.onerror=i.onload=n,i.src=e)}})}),P.Module.define("ui.Progress",[],function(){var e="active",t=P.Module.extend({moveStep:function(e){this.setStep(this.options.current_step+e)},setStep:function(e){e<0||e>this.options.steps||(this.options.current_step=e,this._localRender(),e===this.options.steps&&this.triggerEvent(P.CONST.EVENT_PROGRESS_COMPLETED,null,!0))},_localRender:function(){var t=this.$el.children("li"),n=this.options.current_step;$.each(t,function(t,i){$(i).toggleClass(e,n>=t+1)})}});return t}),P.Module.define("ui.SearchForm",[],function(){return P.Module.extend({events:{"submit > form":"onSubmit"},onChildItemSelected:function(e){var t=e.data.item,n=t.get("url");n&&(this.navigate(n),this.typeaheadField.blur());var i=t.get("query")||"";P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED,i)},onContentReady:function(){var e={};e[P.CONST.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED]=this.onSearchQueryUpdated,e[P.CONST.PUBSUB_TOPIC_SEARCH_SCOPE_UPDATED]=this.onSearchScopeUpdated,this.pubsubSubscribe(P.CONST.PUBSUB_CHANNEL_SITE,e),this.typeaheadField=this.getChildById("searchField"),this.selectedListener=this.childListen(P.CONST.EVENT_ITEM_SELECTED,this.onChildItemSelected)},onSearchQueryUpdated:function(e,t,n){var i=n||"";this.typeaheadField.setValue(i)},onSearchScopeUpdated:function(e,t,n){var i=n||"pins";this.currentScope=i,this.typeaheadField.setAutocompleteScope(i)},onSubmit:function(){var e=this.typeaheadField.getValue(),t=encodeURIComponent(e),n=this.currentScope||this.options.scope||"pins";return this.typeaheadField.setAutocompleteScope(n),this.navigate("/search/"+n+"/?q="+t),P.pubsub.publish(P.CONST.PUBSUB_CHANNEL_SITE,P.CONST.PUBSUB_TOPIC_SEARCH_QUERY_UPDATED,e),this.typeaheadField.blur(),!1}})}),P.Module.define("ui.Select",[],function(){return P.Module.extend({})}),P.Module.define("ui.TextField",[],function(){var e="active",t="has-value",n="<li data-value='${name}'><img src='${img}' /> ${name} <span>(${fullName})</span></li>";return P.Module.extend({events:{click:"onFocus","focus .content":"onContentFocus","blur .content":"onContentBlur"},onContentReady:function(){this.options.mentions&&this.initAtMentions(),this.getContent().placeholder()},initAtMentions:function(){this.typeahead=new P.TypeaheadProvider({tags:"mentions",pin_id:this.options.pin_id}),this.getContent().atwho("@",{data:"/",tpl:n,callbacks:{remote_filter:_.bind(this.onAtMentionFilter,this)}}),this.atwho=this.getContent().data("atwho")},onAtMentionFilter:function(e,t,n){if(e.q){var i=this;this.typeahead.search(e.q,function(e){var t=_.map(e.items,function(e){return{name:P.stripTags(e.username),fullName:P.stripTags(e.label),img:e.image}});n(t),i.atwho.settings["@"].data="/"})}},getContent:function(){return this.$content||(this.$content=this.$(".content")),this.$content},getValue:function(){return P.log("value:",$.trim(this.getContent().val()),this.getContent()),$.trim(this.getContent().val())},onFocus:function(){this.getContent().focus()},onContentFocus:function(){this.$el.addClass(e),this.triggerEvent("focus",null,!0)},onContentBlur:function(){this.getValue().length?this.$el.addClass(t):this.$el.removeClass(t),this.$el.removeClass(e)}})}),P.Module.define("ui.Typeahead",[],function(){var e="highlighted",t="cid",n="highlighted",i='<a><% if (image) { %><span class="img"><img src="<%- image %>"></span><% } %><% if (tag == "recent_queries") { %><button data-query="<%- query %>" class="remove">Remove</button><% } %><span class="name"><%- label %></span></a>',o='<a><% if (send_pin_image) { %><span class="img"><img src="<%- send_pin_image %>" alt=""></span><% } %><p class="name"><%- label %></p><div class="titleWrapper"><i class="titleIcon<% if (is_pinner) { %> isPinner<% } %>"></i><p class="title"><% if (is_pinner) { %>'+P.string("fellowPinner")+"<% } else if (email) { %>"+"<%- email %>"+"<% } else { %>"+P.string("pickEmailAddress")+"<% } %>"+"</p>"+"</div>"+"</a>",r={search:i,sendPin:o},s=Backbone.View.extend({tagName:"li",initialize:function(){var e=this.options.template;this.template=_.template(e),this.model.bind("change",this.render,this)},render:function(){return this.$el.html(this.template(this.model.toJSON())).toggleClass(e,!!this.model.get(n)).data(t,this.model.cid),this}});return P.Module.extend({events:{onchange:"onChange","click .results .remove":"onRemoveResult","click .results li":"onResultClick",mousedown:"onMousedown","mouseenter .results li":"onResultMouseenter",mouseleave:"onMouseleave"},_isOpen:!1,items:[],initialize:function(){this.typeahead=new P.TypeaheadProvider(this.options.options),this.listen(this.typeahead,P.CONST.EVENT_DATA,this.onTypeaheadData)},_triggerNoResultsReturned:function(){this.triggerEvent(P.CONST.EVENT_TYPEAHEAD_NO_RESULTS_RETURNED,null,!0)},_triggerResultsReturned:function(e){this.triggerEvent(P.CONST.EVENT_TYPEAHEAD_RESULTS_RETURNED,{count:e},!0)},getItemCount:function(){return this.itemsToRender.count},onTypeaheadData:function(e){this.items=e.items,this.itemsToRender=_.map(this.items,function(e){return e.tag=e.tag||"",new Backbone.Model(e)}),this.renderResults(),0===this.items.length?(this.hide(),this._triggerNoResultsReturned()):this._triggerResultsReturned(this.items.length)},onContentReady:function(){this.$results=this.$(".results")},onMousedown:function(){this.triggerEvent("mousedown")},onRemoveResult:function(e){e.stopPropagation(),e.preventDefault();var t=$(e.currentTarget),n=t.attr("data-query");if(n){var i=new P.Resource("TypeaheadClearRecentResource",{query:n});i.call("delete"),t.parents("li").remove(),this.items=_.reject(this.items,function(e){return e.query===n}),0===this.items.length&&this.hide()}},onResultClick:function(e){this.selectElement($(e.currentTarget))},onResultMouseenter:function(e){this.highlightElement($(e.currentTarget))},onMouseleave:function(){this.isOpen()&&this.highlightElement()},search:function(e){this.lastTerm=e,this.typeahead.search(e)},setAutocompleteScope:function(e){this.typeahead.setAutocompleteScope(e)},renderResults:function(){var e=this,t=_.map(this.itemsToRender,function(t){return e.renderItem(t)});this.$results.empty().append(t),this.show()},renderItem:function(e){var t=this.options.template?r[this.options.template]:r.search,n=new s({model:e,template:t});return n.render().$el},hide:function(){this._isOpen=!1,this.highlight(null),this.$el.hide()},show:function(){this._isOpen=!0,this.$el.show()},isOpen:function(){return this._isOpen},getLastTerm:function(){return this.lastTerm},selectElement:function(e){var t=this.getItemByElement(e);return this.select(t)},select:function(e){return e=e||this.highlightedItem,e&&this.triggerEvent(P.CONST.EVENT_ITEM_SELECTED,{item:e},!0),e},highlightUp:function(){var e=this.highlightedItem,t=this.itemsToRender,n=e?_.indexOf(t,e)-1:t.length-1;return this.highlight(t[n])},highlightDown:function(){var e=this.highlightedItem,t=this.itemsToRender,n=e?_.indexOf(t,e)+1:0;return this.highlight(t[n])},highlightElement:function(e){var t=null;return e&&e[0]&&(t=this.getItemByElement(e)),this.highlight(t)},highlight:function(e){return e=e||null,e===this.highlightedItem?e:(this.highlightedItem&&this.highlightedItem.set(n,!1),e&&e.set(n,!0),this.highlightedItem=e,this.triggerEvent(P.CONST.EVENT_ITEM_HIGHLIGHTED,{item:e},!0),e)},getItemByElement:function(e){var n=e.data(t);return _.find(this.itemsToRender,function(e){return e.cid===n})},abortSearch:function(){this.typeahead.abortSearch()},prefetch:function(){this.typeahead.prefetch()}})}),P.Module.define("ui.TypeaheadField",[],function(){return P.Module.extend({events:{"input .field":"onFieldInput","blur .field":"onFieldBlur","focus .field":"onFieldFocus","keydown .field":"onFieldKeydown"},initTypeahead:function(){this.typeahead=this.getChildById("typeahead"),this.childListen(P.CONST.EVENT_ITEM_SELECTED,this.onChildItemSelected),this.childListen(P.CONST.EVENT_ITEM_HIGHLIGHTED,this.onChildItemHighlighted),this.listen(this.typeahead,"mousedown",this.onTypeaheadMousedown)},hideTypeaheadUnlessPreserved:function(){this.options.preserve_typeahead||this.typeahead.hide()},onChildItemSelected:function(e){var t=e.data.item,n=t.get("label");n&&this.setValue(n),this.hideTypeaheadUnlessPreserved()},onChildItemHighlighted:function(e){var t=e.data.item,n=t?t.get("label"):this.typeahead.getLastTerm();this.options.populate_on_result_highlight&&this.setValue(n)},onContentReady:function(){this.initTypeahead(),this.$field=this.$(".field"),this.$field.placeholder()},onFieldInput:function(){this.search()},onFieldKeydown:function(e){var t=this.typeahead,n=P.keyCode;if(t.isOpen())switch(e.keyCode){case n.UP:t.highlightUp(),e.preventDefault();break;case n.DOWN:t.highlightDown(),e.preventDefault();break;case n.ENTER:case n.NUMPAD_ENTER:case n.TAB:var i=t.select();i?(this.abortSearch(),e.preventDefault()):this.closeTypeahead();break;case n.ESCAPE:this.closeTypeahead(),e.preventDefault();break;default:this.search()}else switch(e.keyCode){case n.ENTER:case n.NUMPAD_ENTER:this.abortSearch(),this.triggerEvent("enterPressed",{},!0);break;default:this.search()}},closeTypeahead:function(){this.abortSearch(),this.typeahead.hide()},onFieldBlur:function(){return this.cancelBlur?(this.cancelBlur=!1,void 0):(this.hideTypeaheadUnlessPreserved(),void 0)},onFieldFocus:function(){this.options.search_on_focus&&this.search(),this.options.prefetch_on_focus&&this.typeahead.prefetch()},onTypeaheadMousedown:function(){this.cancelBlur=!0,window.setTimeout(function(){this.cancelBlur=!1},300)},getValue:function(){return this.$field.val()},getField:function(){return this.$field},setValue:function(e){this.$field.val(e)},getTypeaheadResultCount:function(){return this.typeahead.getItemCount()},setAutocompleteScope:function(e){this.typeahead.setAutocompleteScope(e)},clear:function(){this.setValue("")},abortSearch:function(){this.searchTimer&&window.clearTimeout(this.searchTimer),this.typeahead.abortSearch()},search:function(){var e=this;this.searchTimer&&window.clearTimeout(this.searchTimer);var t=function(){e.typeahead.search(e.getValue())},n=this.options.search_delay;n?this.searchTimer=window.setTimeout(t,n):t()},blur:function(){this.$field.blur()}})}),function(){var e={};e["internal/LogLevel/LogLevel.html"]=function(){function e(e,t,n,i){var o=null,r=null,s="";try{var a=i.makeMacro(["log","levels"],[],function(t,o,r){n=n.push(),r=r||{},n.set("log",t),n.set("levels",o);var s="";s+="\n<li>\n    ",s+=i.suppressValue(i.memberLookup(t,"name",e.autoesc),e.autoesc),s+="\n    <select>\n        ",n=n.push();var a=o;if(void 0!==a)for(var l=0;l<a.length;l++){var u=a[l];n.set("level",u),s+="\n             <option value=",s+=i.suppressValue(i.memberLookup(t,"name",e.autoesc)+"_"+i.memberLookup(u,1,e.autoesc),e.autoesc),s+="\n             ",i.memberLookup(t,"logLevel",e.autoesc)==i.memberLookup(u,1,e.autoesc)&&(s+="\n                 selected\n             "),s+="\n             >",s+=i.suppressValue(i.memberLookup(u,0,e.autoesc),e.autoesc),s+="</option>\n        "}return n=n.pop(),s+="\n    </select>\n</li>\n",n=n.pop(),new i.SafeString(s)});t.addExport("single_log"),t.setVariable("single_log",a),s+='\n\n<div class="header">\n    <h1>Choose the log level you want for each logger</h1>\n    <a href="#" class="refreshButton">Refresh list</a>&nbsp;\n    <a href="/_/_/debug/">Back to Debug</a>\n</div>\n<div class="changeAll">\n    Change all to\n    ',n=n.push();var l=i.memberLookup(i.contextOrFrameLookup(t,n,"data"),"levels",e.autoesc);if(void 0!==l)for(var u=0;u<l.length;u++){var c=l[u];n.set("level",c),s+='\n         <a class="switch" data-val="',s+=i.suppressValue(i.memberLookup(c,1,e.autoesc),e.autoesc),s+='">',s+=i.suppressValue(i.memberLookup(c,0,e.autoesc),e.autoesc),s+="</a>&nbsp;\n    "}n=n.pop(),s+="\n</div>\n<div>\n    ",n=n.push();var d=i.memberLookup(i.contextOrFrameLookup(t,n,"data"),"loggerColumns",e.autoesc);if(void 0!==d)for(var h=0;h<d.length;h++){var p=d[h];n.set("loggerColumn",p),s+="\n        <ul>\n            ",n=n.push();var f=p;if(void 0!==f)for(var m=0;m<f.length;m++){var g=f[m];n.set("logItem",g),s+="\n                ",s+=i.suppressValue((o=30,r=27,i.callWrap(a,"single_log",[i.makeKeywordArgs({log:g,levels:i.memberLookup(i.contextOrFrameLookup(t,n,"data"),"levels",e.autoesc)})])),e.autoesc),s+="\n            "}n=n.pop(),s+="\n        </ul>\n    "}return n=n.pop(),s+="\n</div>\n"}catch(v){i.handleError(v,o,r)}}return{root:e}}(),"function"===typeof define&&define.amd?define(["nunjucks"],function(t){return t.env=new t.Environment([],null),t.env.registerPrecompiled(e),t}):"object"===typeof nunjucks?(nunjucks.env=new nunjucks.Environment([],null),nunjucks.env.registerPrecompiled(e)):console.error("ERROR: You must load nunjucks before the precompiled templates")}();