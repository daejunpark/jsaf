PassionList=[];PassionReady=function(a){if(PassionReady.status==1){a.call()}else{PassionList.push(a)}};PassionReady.status=0;(function(){if(typeof(jQuery)=="undefined"){setTimeout(arguments.callee,100);return}else{PassionReady.status=1;for(var a in PassionList){PassionList[a].call()}PassionList.length=0}})();PassionReady(function(){(function(e,f,g){var a=e.document,c=e.navigator,b=e.location;var d=function(h,j){h=h||{};j=j||0;if(f.isArray(h)){if(h.length>1){j=d.ad_queue.length;for(var i in h){d(h[i],j)}d.orderqueue(j);d.queue(j);return true}else{h=h[0]}}if(!h||!("resource" in h)||!("id" in h)){d.log("Invalid params");return false}h.type=h.type||"common";if(!(h.type in d.engine)){d.log("Invalid type: "+h.type);return false}if("order" in h){h.timeout=h.timeout||3000;d.ad_list[h.id]={bean:h,s:0,group_id:j};if(!(j in d.ad_queue)){d.ad_queue[j]=[]}d.ad_queue[j].push({order:h.order,id:h.id});return true}else{d.ad_list[h.id]={bean:h,s:0,group_id:-1};d.engine(h);return true}};d.extend=f.extend;f.fn.PositionFixed=function(h){var k={left:0,top:0};var l=f.extend(k,h);var j=false;var i=f("html");if(f.browser.msie&&parseInt(f.browser.version)<=6){j=true}if(j&&i.css("backgroundAttachment")!=="fixed"){i.css("backgroundAttachment","fixed")}return this.each(function(){var m=f(this)[0];var n=f(this);if(j){n.css("position","absolute");if("right" in l){m.style.setExpression("left","eval((document.documentElement).scrollLeft - "+parseInt(l.right)+' + (document.documentElement).clientWidth-this.offsetWidth-(parseInt(this.currentStyle.marginLeft,10)||0) -(parseInt(this.currentStyle.marginRight,10)||0) ) + "px"')}else{m.style.setExpression("left","eval((document.documentElement).scrollLeft + "+parseInt(l.left)+') + "px"')}if("bottom" in l){m.style.setExpression("top","eval((document.documentElement).scrollTop - "+parseInt(l.bottom)+' + (document.documentElement).clientHeight-this.offsetHeight-(parseInt(this.currentStyle.marginTop,10)||0) -(parseInt(this.currentStyle.marginBottom,10)||0) ) + "px"')}else{m.style.setExpression("top","eval((document.documentElement).scrollTop + "+parseInt(l.top)+') + "px"')}}else{n.css("position","fixed");if("right" in l){n.css("right",parseInt(l.right))}else{n.css("left",parseInt(l.left))}if("bottom" in l){n.css("bottom",parseInt(l.bottom))}else{n.css("top",parseInt(l.left))}}})};f.fn.Upzindex=function(h){return this.each(function(){var i='<iframe     style="position:absolute;z-index:-1;width:e-xpression(this.nextSibling.offsetWidth);height:e-xpression(this.nextSibling.offsetHeight);top:expression(this.nextSibling.offsetTop);left:expression(this.nextSibling.offsetLeft);" frameborder="0">'})};d.extend({debug:false,position_id_prefix:"beans_",default_timeout:3000,default_order:10,adserver_url:"http://s.go.sohu.com/new/",max_turn:12,adclick_url:"http://c.go.sohu.com/new/",adimp_url:"http://v.go.sohu.com/",flashplayer:"http://images.sohu.com/bill/s2011/gates/all/images/aplayer-0.3.0.swf?_=20121123.1",ad_list:{},ad_queue:[[]],ad_param:{},ad_default:{},init:function(){if(typeof(a.pv)=="undefined"){a.pv=new Array()}f(function(){d.orderqueue(0);d.queue(0)})},cookie:function(h,j,i,m,k,l){this.$document=h;this.$name=j;if(i&&i>1339111890){this.$expiration=new Date(i*1000)}else{this.$expiration=i?new Date((new Date()).getTime()+i*3600000):null}this.$path=m?m:"/";this.$domain=k?k:null;this.$secure=l},log:function(h){if(e.console){if(d.debug){if(e.console.debug){e.console.debug(h);e.console.trace()}}else{e.console.log(h)}}},setDefault:function(h){if(!h.slotid){d.log("Item Space must be specified!");return}h.id=h.slotid;h.itemspaceid=d.getItemSpaceId(h.slotid,0);d.ad_default[h.slotid]=h}});d.cookie.prototype.store=function(){var i="";for(var j in this){if((j.charAt(0)=="$")||((typeof this[j])=="function")){continue}if(i!=""){i+="&"}i+=j+":"+escape(this[j])}var h=this.$name+"="+i;if(this.$expiration){h+="; expires="+this.$expiration.toGMTString()}if(this.$path){h+="; path="+this.$path}if(this.$domain){h+="; domain="+this.$domain}if(this.$secure){h+="; secure"}this.$document.cookie=h};d.cookie.prototype.load=function(){var l=this.$document.cookie;if(l==""){return false}var n=l.indexOf(this.$name+"=");if(n==-1){return false}n+=this.$name.length+1;var j=l.indexOf(";",n);if(j==-1){j=l.length}var m=l.substring(n,j);var h=m.split("&");for(var k=0;k<h.length;k++){h[k]=h[k].split(":")}for(var k=0;k<h.length;k++){this[h[k][0]]=unescape(h[k][1])}return true};d.cookie.prototype.remove=function(){var h;h=this.$name+"=";if(this.$path){h+="; path="+this.$path}if(this.$domain){h+="; domain="+this.$domain}h+="; expires=Fri, 02-Jan-1970 00:00:00 GMT";this.$document.cookie=h};d.cookie.getTurn=function(i,h){var j=d.max_turn,k;var l=new d.cookie(a,"TurnSats",24);l.load();var h=h||false;if(!h||!d.check(l[h])){l[i]=k=(l[i]==null)?parseInt(Math.random()*j+1):parseInt(l[i]);l[i]++;if(l[i]>j){l[i]=1}l.store()}else{k=l[h]}return k};d.cookie.explod=function(k){var h=k.split("&");for(var j=0;j<h.length;j++){h[j]=h[j].split(":")}for(var j=0;j<h.lengtendh;j++){this[h[j][0]]=unescape(h[j][1])}};d.cookie.getTimesCookie=function(i){i.hour=i.hour||24;if(i.endtime){i.hour=i.endtime}var j=(i.label?i.label:"showtimes")+i.hour*60;i.category=i.category||j;var h=new d.cookie(a,i.category,i.hour,i.path,i.domain);h.load();return h};d.cookie.getShowtimes=function(i){var h=d.cookie.getTimesCookie(i);var j=i.key||"showid";return(h[j]==null)?0:h[j]};d.cookie.setShowtimes=function(i){var h=d.cookie.getTimesCookie(i);var j=i.key||"showid";h[j]=(h[j]==null)?1:(parseInt(h[j])+1);h.store();return h[j]};d.cookie.getShowtimesSearch=function(){var o=new RegExp(("showtimes\\d+=([^;$]*)"),"ig");var n=unescape(a.cookie).match(o);if(n){var l=[];for(var m=0;m<n.length;m++){var h=(n[m].split("="))[1].split("&");for(var k=0;k<h.length;k++){l.push("x:"+h[k].replace(":",""))}}return l.join(",")}return""};d.cookie.support=(function(){var h=new Cookie(a,"Tanchuang",24);h.load();h.visit=(h.visit==null)?1:1;h.store();var i=new Cookie(a,"Tanchuang",24);i.load();if(i.visit==null){return false}else{i.remove();return true}})();d.extend({flash:function(i){var l={id:"flash"+Math.random(),vars:{},width:300,height:400,src:"",style:"",params:{quality:"high",wmode:"opaque"}};var m=f.extend(true,l,i);var h=f.param(m.vars);if(f.browser.msie){var k='<object id="'+m.id+'" width="'+m.width+'" height="'+m.height+'" style="'+m.style+'"';k+=' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ';k+=' codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=';k+='11,0,0,0"><param name="movie" value="'+m.src+'">';for(var j in m.params){k+='<param name="'+j+'" value="'+m.params[j]+'">'}if(h!=""){k+='<param name="flashvars" value="'+h+'">'}k+="</object>"}else{var k='<embed  id="'+m.id+'" name="'+m.id+'" width="'+m.width+'" height="'+m.height+'" style="'+m.style+'"';k+=' src="'+m.src+'" ';for(var j in m.params){k+=" "+j+'="'+m.params[j]+'" '}if(h!=""){k+=' flashvars="'+h+'"'}k+=" type='application/x-shockwave-flash' pluginspage='http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash' swLiveConnect='true'></embed>"}return k}});d.extend({engine:function(h){if(f.isFunction(h.before)){h.before(h)}if(f.isFunction(d.engine[h.type]["initMaterial"])){d.engine[h.type]["initMaterial"](h)}d.ad_list[h.id]["s"]=1;var i=d.engine[h.type](h);if(!i){d.isSkip(h.id);d.log("Ad run error "+h.id);return false}else{d.pv.trace({imp:(h.impression_id||0),a:1,id:(h.adid||0),p:(h.itemspaceid||0),f:(h.adsrc||0),l:h.latency,k:(h.key||h.adid||""),_r:d.random()})}if(h.md5){d.pv.md5(h.md5)}if(h.imp){h.imp=h.imp.replace("${SLOTID}",d.getSlotId(h.id));d.pv.imp(h.imp)}if(f.isFunction(h.after)){h.after(h)}if(d.debug){d.timer.end=new Date().getTime();d.log(d.timer)}return true},ad:function(i,j){if(!i||!j){d.log("Need resource and beans_id");return false}if(i.click){}else{var h={itemspaceid:j,key:i.key||d.ad_list[j].bean.adid||"",impid:d.ad_list[j].bean.impression_id||"0",adid:d.ad_list[j].bean.adid||"0",rt:1};i.click=d.adclick_url+((d.adclick_url.indexOf("?")>=0)?"&":"?")+f.param(h)}i.click=i.click.replace("${SLOTID}",d.getSlotId(j));i.click=i.click.replace("${TS}",d.random());if(!("width" in i)){i.width=d.ad_list[j].bean.width||0}if(!("height" in i)){i.height=d.ad_list[j].bean.height||0}if(f.isFunction(d.ad[i.type])){d.ad[i.type](i,j)}else{d.log("Invalid ad type: "+i.type);return false}return true},button:function(h){switch(h){case"close":return f("<div></div>").css({cursor:"pointer",width:39,height:15}).css("position","absolute").css("z-index",20).css("background-image","url(http://images.sohu.com/bill/s2012/gates/all/close.png)").hover(function(){f(this).css("background-image","url(http://images.sohu.com/bill/s2012/gates/all/close_h.png)")},function(){f(this).css("background-image","url(http://images.sohu.com/bill/s2012/gates/all/close.png)")});case"replay":return f("<div></div>").css({cursor:"pointer",width:39,height:15}).css("position","absolute").css("z-index",20).css("background-image","url(http://images.sohu.com/bill/s2012/gates/all/replay.png)").hover(function(){f(this).css("background-image","url(http://images.sohu.com/bill/s2012/gates/all/replay_h.png)")},function(){f(this).css("background-image","url(http://images.sohu.com/bill/s2012/gates/all/replay.png)")});break}}});d.extend(d.ad,{inner_html:function(i,j){if(!i.html){d.log("Inner have no html!");return false}if(!i.wrap){d.log("Iframe have no wrap!");return false}f("#"+i.wrap).html(i.html);var h=d.clickTrace.Beans(j);d.clickTrace("#"+i.wrap+" a",h,function(k,l){l.c=f(k).attr("href")});d.isOver(j);return true},iframe:function(i,j){if(!i.file){d.log("Iframe have no src!");return false}if(!i.wrap){d.log("Iframe have no wrap!");return false}i.file=i.file.replace("document.location.href",escape(a.location.href));var h='<iframe id="'+j+'_frame" width="'+i.width+'" height="'+i.height+'" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" src="'+i.file+'"></iframe>';f(h).bind("load",function(){}).appendTo(f("#"+i.wrap));d.isOver(j);return true},flash:function(i,j){if(!i.wrap){d.log("Flash have no wrap!");return false}var h={vars:{},params:{}};if(i.allow){h.params.allowScriptAccess="always"}if(i.usePlayer){h.src=d.flashplayer;f.extend(h.vars,{clickthru:i.click,innersrc:i.file,outerparam:(i.imp||"")},i.vars)}else{h.src=i.file;i.vars=i.vars||{};f.extend(h.vars,{clickthru:i.click},i.vars);if(i.imp){i.imp=i.imp.replace("${SLOTID}",d.getSlotId(j));d.pv.imp(i.imp)}}h.width=i.width||0;h.height=i.height||0;h.style=i.style||"";f.extend(h.params,i.params);f("#"+i.wrap).html(d.flash(h));d.clickTrace("#"+i.wrap,d.clickTrace.Beans(j));d.isOver(j);return true},image:function(i,j){if(!i.wrap){d.log("Flash have no wrap!");return false}var h=a.createElement("a");h.id=j+"_a";h.href=i.click;h.target="_blank";f("#"+i.wrap).append(h);h.innerHTML='<img src="'+i.file+'" border="0" width="'+i.width+'" height="'+i.height+'"/>';if(i.imp){i.imp=i.imp.replace("${SLOTID}",d.getSlotId(j));d.pv.imp(i.imp)}d.clickTrace("#"+i.wrap,d.clickTrace.Beans(j));d.isOver(j);return true},text:function(i,j){var h=a.createElement("a");h.id=d.position_id_prefix+i.id;h.href=i.click;h.target="_blank";f("#"+i.wrap).append(h);h.innerHTML=i.text;d.isOver(j);return true},optaim:function(h,i){if(!h.wrap){d.log("Optaim have no wrap!");return false}h.tier=h.tier||1;h.visitorder=h.visitorder||1;if(typeof OptAim!=="function"){f.getScript(h.file,function(){clearTimeout(d.ad_list[i].timeout);d.ad_list[i].timeout=setTimeout(function(){d.isSkip(i)},d.ad_list[i]["bean"].timeout);OptAim.getHtml("sohu",h.wrap,i,h.visitorder,h.width,h.height,h.tier)})}else{OptAim.getHtml("sohu",h.wrap,i,h.visitorder,h.width,h.height,h.tier)}d.clickTrace("#"+h.wrap,d.clickTrace.Beans(i));return true}});d.engine.common=function(h){if(f("#"+d.ad_list[h.id]["wrap"]).size()==0){d.log("Common need wrap!");return false}h.resource.id=h.resource.id||h.id+"_ad";h.resource.wrap=h.resource.wrap||d.ad_list[h.id]["wrap"];d.ad(h.resource,h.id);if(h.timeout){d.ad_list[h.id].timeout=setTimeout(function(){d.isSkip(h.id)},h.timeout)}else{}return true};d.engine.common.initMaterial=function(i){if(!("wrap" in d.ad_list[i.id])){var h=i.id.split("_");d.ad_list[i.id]["wrap"]=d.position_id_prefix+h[0]}};d.engine.pop=function(h){h.resource.id=h.resource.id||h.id+"_ad";h.resource.wrap=h.resource.wrap||d.ad_list[h.id]["wrap"];h.resource.usePlayer=false;if("showtimes" in h.resource&&"times" in h.resource.showtimes){if(h.resource.showtimes.times<=d.cookie.getShowtimes(h.resource.showtimes)){return false}}d.ad(h.resource,h.id);d.isOver(h.id);if("showtimes" in h.resource){d.cookie.setShowtimes(h.resource.showtimes)}d.button("close").bind("click",function(){f("#"+h.resource.wrap).empty().hide()}).css("top",3).css("right",3).appendTo("#"+h.resource.wrap);return true};d.engine.pop.initMaterial=function(h){f("<div></div>").attr("id","Popadwrap").PositionFixed({right:5,bottom:0}).css("z-index",100).appendTo("body");d.ad_list[h.id]["wrap"]="Popadwrap"};d.extend({mouseXY:function(h){var i={};i.x=h.layerX||h.offsetX||"-33";i.y=h.layerY||h.offsetY||"-33";return i},md5:function(n){var k=n.match(/^([a-f0-9]{8})([a-f0-9]{2})([a-f0-9]{8})([a-f0-9]{2})([a-f0-9]{6})([a-f0-9]{6})$/);if(k){var j=n.match(/^([a-f0-9]{8})([a-f0-9]{8})([a-f0-9]{8})([a-f0-9]{8})$/);var i=["sohu","sohu"];var h=(parseInt(k[3],16)-parseInt(k[1],16));var l=parseInt(k[4],16)-parseInt(k[2],16);if(h>20500000||h<20110101){return false}if(l<0||l>3){return false}return{md5:j[1]+","+j[2]+","+j[3]+","+j[4],m:h+"",tag:i[l],id:parseInt(k[6],16)}}return false},random:function(h){var i=new Date;return h?parseInt((i.getTime())/1000):i.getTime()},pv:{imp:function(h){h=h.split("|");for(var k=h.length-1;k>=0;k--){var j=new Image();h[k]=h[k].replace("${TS}",d.random());h[k]=h[k].replace("@local@",e.location.href);j.src=h[k];a.pv.push(j)}},old:function(h,j){var i=d.md5(h);j=j||99;if(i){d.pv.imp("http://xls.go.sohu.com/"+ad._md5.m.substring(0,6)+"/"+h+".php?a="+j)}},trace:function(i){var h=d.adimp_url+((d.adimp_url.indexOf("?")>=0)?"&":"?")+f.param(i);d.pv.imp(h)}}});d.extend({get:function(j){j=j||{};var m,o=j.timeout||3000,h=j.url||d.adserver_url,n=j.query||{},p=new Date().getTime();var l=j.type||"ajax";if(!j.slotid){d.log("Item Space must be specified!");return}if("gettimes" in j&&"times" in j.gettimes){j.gettimes.label="gettimes";if(j.gettimes.times<=d.cookie.getShowtimes(j.gettimes)){return false}}if(typeof h==="undefined"){d.log("URL must be specified!");return}if(j.hold&&!f.isArray(j.slotid)&&!d.checkAdPosition(j.slotid)){a.write("<div id='"+d.position_id_prefix+j.slotid+"'></div>")}m=d.cookie.getTurn(j.slotid,j.turnsync_id);if(f.isArray(j.slotid)){for(var k=j.slotid.length-1;k>=0;k--){d.ad_param[j.slotid[k]]={start:p,options:j}}}else{d.ad_param[j.slotid]={start:p}}n.turn=m;n.itemspaceid=d.getItemSpaceId(j.slotid,m,j.unrotate);if(!n.itemspaceid){return}n.ec=n.ec||"utf-8";n.rt=n.rt||0;n.ref=a.referrer||"";n.flash=d.flashVersion;h=h+((h.indexOf("?")>=0)?"&":"?")+"showtimes="+d.cookie.getShowtimesSearch();switch(l){case"iframe":if(f.isArray(j.slotid)){d.log("iframe type not allow array slotid");return false}j.width=j.width||f("#"+d.position_id_prefix+j.slotid).width()||450;j.height=j.height||f("#"+d.position_id_prefix+j.slotid).height()||100;n.respform=1;h=h+"&"+f.param(n);d({id:n.itemspaceid,resource:{height:j.height,width:j.width,file:h,type:"iframe"}});break;case"ajax":default:f.ajax({dataType:"jsonp",timeout:o,scriptCharset:n.ec,error:d.onGetError,success:d.onGetSuccess,itemspaceid:n.itemspaceid,slotid:j.slotid,start:p,url:h,data:n});break}if("gettimes" in j){d.cookie.setShowtimes(j.gettimes)}},onGetSuccess:function(l,m){if(f.isArray(l)){var k={};for(var j=0;j<l.length;j++){l[j].latency=d.getLatency(this.start);if("ad" in l[j]){f.extend(l[j],l[j]["ad"])}if("itemspaceid" in l[j]){var h=l[j]["itemspaceid"].split(" ");l[j]["itemspaceid"]=h[0];if(l[j]["itemspaceid"] in k){k[l[j]["itemspaceid"]]++}else{k[l[j]["itemspaceid"]]=0}l[j]["id"]=l[j]["itemspaceid"]+"_"+k[l[j]["itemspaceid"]]}if(l.length>1&&(!("order" in l[j]))){l[j]["order"]=d.default_order}}}d(l)},onGetError:function(k,o,m){if(!f.isArray(this.slotid)){this.slotid=[this.slotid]}for(var j=this.slotid.length-1;j>=0;j--){if(this.slotid in d.ad_default){d(d.ad_default[this.slotid[j]])}}var n=o.toString()||m.toString()||"error0";var h={msg:n,latency:d.getLatency(this.start),rt:12,_r:d.random,itemspaceid:this.itemspaceid};var l=d.adimp_url+"?"+f.param(h);d.pv.imp(l)},getLatency:function(j){var h=new Date().getTime();var i=h-j;return i},checkAdPosition:function(h){return(f("#"+d.position_id_prefix+h).size()>0)?true:false},parseItemSpace:function(i){i=i||"";var h=d.getPositionId(i);d.slot=e.document.getElementById(h);var j=e.document.getElementById(h+"_frame");if(!d.checknode(d.slot)){d.log("Cannot find slot "+h);return}return{id:h,frame:j}},getPositionId:function(i){i=i.split("_");var h=d.position_id_prefix+i[0];return h},getSlotId:function(i){i=i.split("_");var h=+i[0];return h},getItemSpaceId:function(j,m,l){l=f.isArray(l)?l:[];if(!f.isArray(j)){j=[j]}var h=[];for(var k=j.length-1;k>=0;k--){h.push(j[k])}return h.join(",")}});d.flashVersion=(function(){try{var k=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(k){var h=k.GetVariable("$version");return parseInt(h.split(" ")[1].split(",")[0])}return false}catch(l){if(c.plugins&&c.plugins.length>0){var k=c.plugins["Shockwave Flash"];if(k){hasFlash=1;var m=k.description.split(" ");for(var j=0;j<m.length;++j){if(isNaN(parseInt(m[j]))){continue}return parseInt(m[j])}}return false}return false}})();d.queue=function(j){j=j||0;if(!(j in d.ad_queue)){return}for(var h=0;h<d.ad_queue[j].length;h++){if(d.ad_list[d.ad_queue[j][h]["id"]]["s"]==0){d.engine(d.ad_list[d.ad_queue[j][h]["id"]].bean);return}}return};d.orderqueue=function(h){h=h||0;if(!(h in d.ad_queue)){return}d.ad_queue[h].sort(function(j,i){if(!("order" in j)||!("order" in i)){return 1}return(j.order>i.order)?1:((j.order==i.order)?0:-1)});return};d.slotover=function(m){var j=d.ad_list[m].group_id;if(!(j in d.ad_queue)){return}m=m||"noid";var k=m.split("_");for(var h=0;h<d.ad_queue[j].length;h++){var l=d.ad_queue[j][h].id.split("_");if(l[0]==k[0]&&(m!=d.ad_queue[j][h].id)){d.ad_list[d.ad_queue[j][h]["id"]]["s"]=2}}return};d.isOver=function(h){if(h in d.ad_list){d.ad_list[h]["s"]=2;if(d.ad_list[h].timeout){clearTimeout(d.ad_list[h].timeout)}d.slotover(h);d.queue(d.ad_list[h].group_id)}};d.isSkip=function(h){if(h in d.ad_list){d.ad_list[h]["s"]=2;if(d.ad_list[h].timeout){clearTimeout(d.ad_list[h].timeout)}d.queue(d.ad_list[h].group_id)}};d.check=function(h){if(h in d.ad_list){return d.ad_list[h]["s"]!=2?true:false}return false};d.clickTrace=function(h,j,i){f(h).bind("mousedown",function(m){var k=m||k;var l=d.mouseXY(k);if(typeof(i)=="function"){i(h,j)}d.extend(j,l);d.pv.trace(j)})};d.clickTrace.Beans=function(h){return{imp:(d.ad_list[h]["bean"].impression_id||0),a:2,id:(d.ad_list[h]["bean"].adid||0),p:(d.ad_list[h]["bean"].itemspaceid||0),f:(d.ad_list[h]["bean"].adsrc||0),l:d.ad_list[h]["bean"].latency,k:(d.ad_list[h]["bean"].key||d.ad_list[h]["bean"].adid||""),_r:d.random()}};e.Passion=d;d.init()})(window,jQuery,undefined)});
